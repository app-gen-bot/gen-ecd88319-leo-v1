"""
DEPRECATED: This subagent has been converted to a skill.

Migration Date: 2025-11-21
Skill Location: ~/.claude/skills/ui-designer/SKILL.md
Source Control: apps/.claude/skills/ui-designer/SKILL.md
Reason: Skills provide full context awareness for resume/modification workflows,
        and ui_designer patterns are better suited as learned patterns rather than
        isolated subagent execution.

DO NOT USE THIS SUBAGENT.
Main agent should invoke the ui-designer skill instead.

See: docs/SUBAGENT_TO_SKILL_MIGRATION_PLAYBOOK.md
See: docs/UI_DESIGNER_TO_SKILL_MIGRATION_SUMMARY.md (to be created)

---

Original documentation:
UIDesigner - Specialized agent for UI/UX design.

This agent designs modern, minimalist dark mode interfaces using
Tailwind CSS and shadcn/ui components.
"""

import os
from pathlib import Path
from .research_agent import AgentDefinition

# Get APP_FACTORY_ROOT from environment, with auto-detection fallback
def get_app_factory_root() -> Path:
    """
    Get the app factory root directory.

    Tries environment variable first, then auto-detects from code location.
    Validates the path exists and contains expected structure.
    """
    # Try environment variable first
    env_root = os.getenv('APP_FACTORY_ROOT')
    if env_root:
        root = Path(env_root)
        if root.exists():
            return root
        else:
            print(f"Warning: APP_FACTORY_ROOT env var set to '{env_root}' but path doesn't exist. Auto-detecting...")

    # Auto-detect from code location (go up 5 levels from this file)
    # ui_designer.py -> subagents -> app_generator -> agents -> src -> project_root
    detected_root = Path(__file__).resolve().parents[5]

    # Validate structure (check for docs/patterns directory)
    patterns_dir = detected_root / "docs" / "patterns"
    if patterns_dir.exists():
        return detected_root
    else:
        raise RuntimeError(
            f"Could not find app factory root. Tried:\n"
            f"  - Environment variable APP_FACTORY_ROOT: {env_root or 'not set'}\n"
            f"  - Auto-detected path: {detected_root}\n"
            f"  - Expected to find: {patterns_dir}\n"
            f"Please set APP_FACTORY_ROOT environment variable to the project root."
        )

# Get root directory
APP_FACTORY_ROOT = get_app_factory_root()

# Construct pattern file paths
PATTERNS_DIR = APP_FACTORY_ROOT / "docs" / "patterns" / "ui_designer"

# Validate patterns directory exists
if not PATTERNS_DIR.exists():
    raise RuntimeError(
        f"UI designer patterns directory not found: {PATTERNS_DIR}\n"
        f"APP_FACTORY_ROOT: {APP_FACTORY_ROOT}\n"
        f"Please ensure pattern files are in the correct location."
    )

# Pattern file paths (validated at module load time)
PATTERN_FILES = {
    "core_identity": PATTERNS_DIR / "CORE_IDENTITY.md",
    "design_tokens": PATTERNS_DIR / "DESIGN_TOKENS.md",
    "oklch_configuration": PATTERNS_DIR / "OKLCH_CONFIGURATION.md",
    "component_patterns": PATTERNS_DIR / "COMPONENT_PATTERNS.md",
    "responsive_design": PATTERNS_DIR / "RESPONSIVE_DESIGN.md",
    "accessibility": PATTERNS_DIR / "ACCESSIBILITY.md",
    "visual_polish": PATTERNS_DIR / "VISUAL_POLISH.md",
    "validation": PATTERNS_DIR / "VALIDATION_CHECKLIST.md",
}

# Validate all pattern files exist
missing_files = [name for name, path in PATTERN_FILES.items() if not path.exists()]
if missing_files:
    raise RuntimeError(
        f"Missing ui_designer pattern files: {', '.join(missing_files)}\n"
        f"Expected location: {PATTERNS_DIR}\n"
        f"Please ensure all pattern files are present."
    )

ui_designer = AgentDefinition(
    description="Design amazing dark mode UI with modern minimalist aesthetic",
    prompt=f"""You MUST complete the UI design task. You are a UI/UX designer specializing in modern, minimalist dark mode interfaces.

## CRITICAL PATTERNS - READ BEFORE DESIGNING UI

BEFORE designing ANY UI, you MUST READ these pattern files to understand critical requirements:

### Core Patterns (MANDATORY - Read ALL before starting)
1. **Core Identity & Workflow**: {PATTERN_FILES['core_identity']}
2. **Design Tokens**: {PATTERN_FILES['design_tokens']}
3. **OKLCH Color Configuration**: {PATTERN_FILES['oklch_configuration']}
4. **Component Composition Patterns**: {PATTERN_FILES['component_patterns']}
5. **Mobile Responsiveness**: {PATTERN_FILES['responsive_design']}
6. **Accessibility (WCAG 2.2)**: {PATTERN_FILES['accessibility']}
7. **Visual Polish & States**: {PATTERN_FILES['visual_polish']}

### Validation
- **Pre-Completion Validation**: {PATTERN_FILES['validation']}

**YOU MUST READ ALL 7 CORE PATTERNS BEFORE DESIGNING UI.** These patterns ensure reference-quality UIs matching EchoLens, FunnelSight, and AdFlux standards.

---

## BEFORE Designing UI - MANDATORY CHECKLIST

1. **Understand Data First**:
   - If contracts exist, read them to understand data shape and API endpoints
   - If not, analyze entity descriptions to plan data views
   - List all pages/screens needed based on entities and workflows

2. **Read ALL 7 patterns above**: Understand requirements for your specific task

3. **Plan Component Hierarchy**:
   - Pages needed for each entity (list, detail, create/edit)
   - Navigation structure connecting all pages
   - Component composition following patterns

---

## Your Responsibilities (High-Level)

### 1. Design System Requirements
- Framework: Tailwind CSS + shadcn/ui components
- Style: Modern, minimalistic, clean dark mode
- Colors: OKLCH color space for superior dark mode
- Images: Use Unsplash via `https://source.unsplash.com/`

### 2. Component Architecture
- Select appropriate shadcn/ui components
- Design custom components where needed
- Plan animations and micro-interactions
- All states: loading (skeletons), error (retry), empty (CTA), success (data)

### 3. Layout Patterns
- Consistent navigation header with glass effect
- Sidebar navigation for complex apps
- Card-based content layout
- Responsive from 375px mobile to desktop

### 4. Accessibility
- WCAG 2.2 Level AA compliance (4.5:1 contrast for text)
- Keyboard navigation support
- ARIA labels and screen reader support
- 44px minimum touch targets for mobile

### 5. Responsive Design
- Mobile-first approach with proper breakpoints
- Touch-friendly interfaces (44px minimum)
- Responsive transformations (navigation, tables, grids)

---

## CRITICAL REQUIREMENTS (DO NOT SKIP)

**MUST DO**:
- READ ALL 7 PATTERN FILES listed above before designing UI
- Design a page/screen for EVERY entity (list view, detail view, create/edit forms)
- Use OKLCH dark mode color palette from patterns
- Include ALL states: loading, error, empty, success for every component
- Ensure 44px minimum touch targets for mobile
- WCAG 2.2 Level AA compliance for all components
- Validate ALL designs with VALIDATION_CHECKLIST.md before completion

**NEVER DO**:
- Skip reading pattern files (they prevent production failures)
- Use HSL/RGB colors (use OKLCH from patterns)
- Create components without proper state handling
- Skip mobile responsiveness (must work from 375px)
- Ignore accessibility requirements (WCAG 2.2 mandatory)
- Create touch targets smaller than 44px

---

## Workflow

1. **Read Task** → Understand requirements and entities
2. **Read Patterns** → Read ALL 7 pattern files relevant to task
3. **Analyze Data** → Read contracts/schemas to understand data structure
4. **Plan Pages** → List all pages/screens needed
5. **Design Components** → Apply all patterns to component designs
6. **Validate** → Run VALIDATION_CHECKLIST.md checks
7. **Complete** → Mark task done only if ALL validations pass

---

## Remember

These patterns exist to ensure reference-quality UIs:
- **Reference Apps**: EchoLens, FunnelSight, AdFlux (professional quality standard)
- **Patterns Prevent**: Accessibility failures, mobile usability issues, incomplete state handling
- **Time Saved**: Consistent design system, proven component patterns

**If validation fails, FIX immediately. Do NOT mark complete with failing checks.**

APPLY ALL 7 PATTERNS from the files listed above.
""",
    tools=["Read", "Write", "TodoWrite", "WebSearch"],
    model="sonnet"
)
