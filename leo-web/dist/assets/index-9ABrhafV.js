var cw=Object.defineProperty;var kp=t=>{throw TypeError(t)};var uw=(t,e,r)=>e in t?cw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Zr=(t,e,r)=>uw(t,typeof e!="symbol"?e+"":e,r),nu=(t,e,r)=>e.has(t)||kp("Cannot "+r);var M=(t,e,r)=>(nu(t,e,"read from private field"),r?r.call(t):e.get(t)),me=(t,e,r)=>e.has(t)?kp("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),re=(t,e,r,s)=>(nu(t,e,"write to private field"),s?s.call(t,r):e.set(t,r),r),be=(t,e,r)=>(nu(t,e,"access private method"),r);var Ya=(t,e,r,s)=>({set _(n){re(t,e,n,r)},get _(){return M(t,e,s)}});function dw(t,e){for(var r=0;r<e.length;r++){const s=e[r];if(typeof s!="string"&&!Array.isArray(s)){for(const n in s)if(n!=="default"&&!(n in t)){const i=Object.getOwnPropertyDescriptor(s,n);i&&Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:()=>s[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();function yv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var xv={exports:{}},Pc={},wv={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $a=Symbol.for("react.element"),hw=Symbol.for("react.portal"),fw=Symbol.for("react.fragment"),pw=Symbol.for("react.strict_mode"),mw=Symbol.for("react.profiler"),gw=Symbol.for("react.provider"),vw=Symbol.for("react.context"),_w=Symbol.for("react.forward_ref"),yw=Symbol.for("react.suspense"),xw=Symbol.for("react.memo"),ww=Symbol.for("react.lazy"),Ep=Symbol.iterator;function bw(t){return t===null||typeof t!="object"?null:(t=Ep&&t[Ep]||t["@@iterator"],typeof t=="function"?t:null)}var bv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Sv=Object.assign,Cv={};function _o(t,e,r){this.props=t,this.context=e,this.refs=Cv,this.updater=r||bv}_o.prototype.isReactComponent={};_o.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};_o.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function kv(){}kv.prototype=_o.prototype;function Uh(t,e,r){this.props=t,this.context=e,this.refs=Cv,this.updater=r||bv}var Hh=Uh.prototype=new kv;Hh.constructor=Uh;Sv(Hh,_o.prototype);Hh.isPureReactComponent=!0;var jp=Array.isArray,Ev=Object.prototype.hasOwnProperty,zh={current:null},jv={key:!0,ref:!0,__self:!0,__source:!0};function Rv(t,e,r){var s,n={},i=null,c=null;if(e!=null)for(s in e.ref!==void 0&&(c=e.ref),e.key!==void 0&&(i=""+e.key),e)Ev.call(e,s)&&!jv.hasOwnProperty(s)&&(n[s]=e[s]);var o=arguments.length-2;if(o===1)n.children=r;else if(1<o){for(var l=Array(o),d=0;d<o;d++)l[d]=arguments[d+2];n.children=l}if(t&&t.defaultProps)for(s in o=t.defaultProps,o)n[s]===void 0&&(n[s]=o[s]);return{$$typeof:$a,type:t,key:i,ref:c,props:n,_owner:zh.current}}function Sw(t,e){return{$$typeof:$a,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Wh(t){return typeof t=="object"&&t!==null&&t.$$typeof===$a}function Cw(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Rp=/\/+/g;function iu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Cw(""+t.key):e.toString(36)}function Al(t,e,r,s,n){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var c=!1;if(t===null)c=!0;else switch(i){case"string":case"number":c=!0;break;case"object":switch(t.$$typeof){case $a:case hw:c=!0}}if(c)return c=t,n=n(c),t=s===""?"."+iu(c,0):s,jp(n)?(r="",t!=null&&(r=t.replace(Rp,"$&/")+"/"),Al(n,e,r,"",function(d){return d})):n!=null&&(Wh(n)&&(n=Sw(n,r+(!n.key||c&&c.key===n.key?"":(""+n.key).replace(Rp,"$&/")+"/")+t)),e.push(n)),1;if(c=0,s=s===""?".":s+":",jp(t))for(var o=0;o<t.length;o++){i=t[o];var l=s+iu(i,o);c+=Al(i,e,r,l,n)}else if(l=bw(t),typeof l=="function")for(t=l.call(t),o=0;!(i=t.next()).done;)i=i.value,l=s+iu(i,o++),c+=Al(i,e,r,l,n);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return c}function Xa(t,e,r){if(t==null)return t;var s=[],n=0;return Al(t,s,"","",function(i){return e.call(r,i,n++)}),s}function kw(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Dt={current:null},Ol={transition:null},Ew={ReactCurrentDispatcher:Dt,ReactCurrentBatchConfig:Ol,ReactCurrentOwner:zh};function Nv(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:Xa,forEach:function(t,e,r){Xa(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Xa(t,function(){e++}),e},toArray:function(t){return Xa(t,function(e){return e})||[]},only:function(t){if(!Wh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ke.Component=_o;ke.Fragment=fw;ke.Profiler=mw;ke.PureComponent=Uh;ke.StrictMode=pw;ke.Suspense=yw;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ew;ke.act=Nv;ke.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=Sv({},t.props),n=t.key,i=t.ref,c=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,c=zh.current),e.key!==void 0&&(n=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)Ev.call(e,l)&&!jv.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){o=Array(l);for(var d=0;d<l;d++)o[d]=arguments[d+2];s.children=o}return{$$typeof:$a,type:t.type,key:n,ref:i,props:s,_owner:c}};ke.createContext=function(t){return t={$$typeof:vw,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:gw,_context:t},t.Consumer=t};ke.createElement=Rv;ke.createFactory=function(t){var e=Rv.bind(null,t);return e.type=t,e};ke.createRef=function(){return{current:null}};ke.forwardRef=function(t){return{$$typeof:_w,render:t}};ke.isValidElement=Wh;ke.lazy=function(t){return{$$typeof:ww,_payload:{_status:-1,_result:t},_init:kw}};ke.memo=function(t,e){return{$$typeof:xw,type:t,compare:e===void 0?null:e}};ke.startTransition=function(t){var e=Ol.transition;Ol.transition={};try{t()}finally{Ol.transition=e}};ke.unstable_act=Nv;ke.useCallback=function(t,e){return Dt.current.useCallback(t,e)};ke.useContext=function(t){return Dt.current.useContext(t)};ke.useDebugValue=function(){};ke.useDeferredValue=function(t){return Dt.current.useDeferredValue(t)};ke.useEffect=function(t,e){return Dt.current.useEffect(t,e)};ke.useId=function(){return Dt.current.useId()};ke.useImperativeHandle=function(t,e,r){return Dt.current.useImperativeHandle(t,e,r)};ke.useInsertionEffect=function(t,e){return Dt.current.useInsertionEffect(t,e)};ke.useLayoutEffect=function(t,e){return Dt.current.useLayoutEffect(t,e)};ke.useMemo=function(t,e){return Dt.current.useMemo(t,e)};ke.useReducer=function(t,e,r){return Dt.current.useReducer(t,e,r)};ke.useRef=function(t){return Dt.current.useRef(t)};ke.useState=function(t){return Dt.current.useState(t)};ke.useSyncExternalStore=function(t,e,r){return Dt.current.useSyncExternalStore(t,e,r)};ke.useTransition=function(){return Dt.current.useTransition()};ke.version="18.3.1";wv.exports=ke;var R=wv.exports;const Cs=yv(R),qh=dw({__proto__:null,default:Cs},[R]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jw=R,Rw=Symbol.for("react.element"),Nw=Symbol.for("react.fragment"),Tw=Object.prototype.hasOwnProperty,Aw=jw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ow={key:!0,ref:!0,__self:!0,__source:!0};function Tv(t,e,r){var s,n={},i=null,c=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(c=e.ref);for(s in e)Tw.call(e,s)&&!Ow.hasOwnProperty(s)&&(n[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)n[s]===void 0&&(n[s]=e[s]);return{$$typeof:Rw,type:t,key:i,ref:c,props:n,_owner:Aw.current}}Pc.Fragment=Nw;Pc.jsx=Tv;Pc.jsxs=Tv;xv.exports=Pc;var a=xv.exports,Av={exports:{}},ar={},Ov={exports:{}},Pv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,j){var T=B.length;B.push(j);e:for(;0<T;){var L=T-1>>>1,$=B[L];if(0<n($,j))B[L]=j,B[T]=$,T=L;else break e}}function r(B){return B.length===0?null:B[0]}function s(B){if(B.length===0)return null;var j=B[0],T=B.pop();if(T!==j){B[0]=T;e:for(var L=0,$=B.length,V=$>>>1;L<V;){var J=2*(L+1)-1,ue=B[J],he=J+1,F=B[he];if(0>n(ue,T))he<$&&0>n(F,ue)?(B[L]=F,B[he]=T,L=he):(B[L]=ue,B[J]=T,L=J);else if(he<$&&0>n(F,T))B[L]=F,B[he]=T,L=he;else break e}}return j}function n(B,j){var T=B.sortIndex-j.sortIndex;return T!==0?T:B.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var c=Date,o=c.now();t.unstable_now=function(){return c.now()-o}}var l=[],d=[],g=1,m=null,v=3,y=!1,w=!1,_=!1,p=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,u=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function f(B){for(var j=r(d);j!==null;){if(j.callback===null)s(d);else if(j.startTime<=B)s(d),j.sortIndex=j.expirationTime,e(l,j);else break;j=r(d)}}function x(B){if(_=!1,f(B),!w)if(r(l)!==null)w=!0,H(k);else{var j=r(d);j!==null&&z(x,j.startTime-B)}}function k(B,j){w=!1,_&&(_=!1,h(b),b=-1),y=!0;var T=v;try{for(f(j),m=r(l);m!==null&&(!(m.expirationTime>j)||B&&!O());){var L=m.callback;if(typeof L=="function"){m.callback=null,v=m.priorityLevel;var $=L(m.expirationTime<=j);j=t.unstable_now(),typeof $=="function"?m.callback=$:m===r(l)&&s(l),f(j)}else s(l);m=r(l)}if(m!==null)var V=!0;else{var J=r(d);J!==null&&z(x,J.startTime-j),V=!1}return V}finally{m=null,v=T,y=!1}}var C=!1,S=null,b=-1,E=5,N=-1;function O(){return!(t.unstable_now()-N<E)}function I(){if(S!==null){var B=t.unstable_now();N=B;var j=!0;try{j=S(!0,B)}finally{j?P():(C=!1,S=null)}}else C=!1}var P;if(typeof u=="function")P=function(){u(I)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,D=U.port2;U.port1.onmessage=I,P=function(){D.postMessage(null)}}else P=function(){p(I,0)};function H(B){S=B,C||(C=!0,P())}function z(B,j){b=p(function(){B(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){w||y||(w=!0,H(k))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(B){switch(v){case 1:case 2:case 3:var j=3;break;default:j=v}var T=v;v=j;try{return B()}finally{v=T}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,j){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var T=v;v=B;try{return j()}finally{v=T}},t.unstable_scheduleCallback=function(B,j,T){var L=t.unstable_now();switch(typeof T=="object"&&T!==null?(T=T.delay,T=typeof T=="number"&&0<T?L+T:L):T=L,B){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=T+$,B={id:g++,callback:j,priorityLevel:B,startTime:T,expirationTime:$,sortIndex:-1},T>L?(B.sortIndex=T,e(d,B),r(l)===null&&B===r(d)&&(_?(h(b),b=-1):_=!0,z(x,T-L))):(B.sortIndex=$,e(l,B),w||y||(w=!0,H(k))),B},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(B){var j=v;return function(){var T=v;v=j;try{return B.apply(this,arguments)}finally{v=T}}}})(Pv);Ov.exports=Pv;var Pw=Ov.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lw=R,ir=Pw;function Q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Lv=new Set,ia={};function Xn(t,e){eo(t,e),eo(t+"Capture",e)}function eo(t,e){for(ia[t]=e,t=0;t<e.length;t++)Lv.add(e[t])}var hs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xu=Object.prototype.hasOwnProperty,Iw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Np={},Tp={};function Dw(t){return Xu.call(Tp,t)?!0:Xu.call(Np,t)?!1:Iw.test(t)?Tp[t]=!0:(Np[t]=!0,!1)}function Mw(t,e,r,s){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Bw(t,e,r,s){if(e===null||typeof e>"u"||Mw(t,e,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Mt(t,e,r,s,n,i,c){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=c}var bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){bt[t]=new Mt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];bt[e]=new Mt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){bt[t]=new Mt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){bt[t]=new Mt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){bt[t]=new Mt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){bt[t]=new Mt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){bt[t]=new Mt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){bt[t]=new Mt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){bt[t]=new Mt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Gh=/[\-:]([a-z])/g;function Vh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Gh,Vh);bt[e]=new Mt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Gh,Vh);bt[e]=new Mt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Gh,Vh);bt[e]=new Mt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){bt[t]=new Mt(t,1,!1,t.toLowerCase(),null,!1,!1)});bt.xlinkHref=new Mt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){bt[t]=new Mt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Kh(t,e,r,s){var n=bt.hasOwnProperty(e)?bt[e]:null;(n!==null?n.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Bw(e,r,n,s)&&(r=null),s||n===null?Dw(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):n.mustUseProperty?t[n.propertyName]=r===null?n.type===3?!1:"":r:(e=n.attributeName,s=n.attributeNamespace,r===null?t.removeAttribute(e):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,s?t.setAttributeNS(s,e,r):t.setAttribute(e,r))))}var vs=Lw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,el=Symbol.for("react.element"),_i=Symbol.for("react.portal"),yi=Symbol.for("react.fragment"),Jh=Symbol.for("react.strict_mode"),ed=Symbol.for("react.profiler"),Iv=Symbol.for("react.provider"),Dv=Symbol.for("react.context"),Qh=Symbol.for("react.forward_ref"),td=Symbol.for("react.suspense"),rd=Symbol.for("react.suspense_list"),Zh=Symbol.for("react.memo"),js=Symbol.for("react.lazy"),Mv=Symbol.for("react.offscreen"),Ap=Symbol.iterator;function No(t){return t===null||typeof t!="object"?null:(t=Ap&&t[Ap]||t["@@iterator"],typeof t=="function"?t:null)}var Ve=Object.assign,ou;function $o(t){if(ou===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);ou=e&&e[1]||""}return`
`+ou+t}var au=!1;function lu(t,e){if(!t||au)return"";au=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var s=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){s=d}t.call(e.prototype)}else{try{throw Error()}catch(d){s=d}t()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var n=d.stack.split(`
`),i=s.stack.split(`
`),c=n.length-1,o=i.length-1;1<=c&&0<=o&&n[c]!==i[o];)o--;for(;1<=c&&0<=o;c--,o--)if(n[c]!==i[o]){if(c!==1||o!==1)do if(c--,o--,0>o||n[c]!==i[o]){var l=`
`+n[c].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=c&&0<=o);break}}}finally{au=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?$o(t):""}function $w(t){switch(t.tag){case 5:return $o(t.type);case 16:return $o("Lazy");case 13:return $o("Suspense");case 19:return $o("SuspenseList");case 0:case 2:case 15:return t=lu(t.type,!1),t;case 11:return t=lu(t.type.render,!1),t;case 1:return t=lu(t.type,!0),t;default:return""}}function sd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case yi:return"Fragment";case _i:return"Portal";case ed:return"Profiler";case Jh:return"StrictMode";case td:return"Suspense";case rd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Dv:return(t.displayName||"Context")+".Consumer";case Iv:return(t._context.displayName||"Context")+".Provider";case Qh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Zh:return e=t.displayName||null,e!==null?e:sd(t.type)||"Memo";case js:e=t._payload,t=t._init;try{return sd(t(e))}catch{}}return null}function Fw(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sd(e);case 8:return e===Jh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function nn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Bv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Uw(t){var e=Bv(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return n.call(this)},set:function(c){s=""+c,i.call(this,c)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(c){s=""+c},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function tl(t){t._valueTracker||(t._valueTracker=Uw(t))}function $v(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),s="";return t&&(s=Bv(t)?t.checked?"true":"false":t.value),t=s,t!==r?(e.setValue(t),!0):!1}function Vl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function nd(t,e){var r=e.checked;return Ve({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Op(t,e){var r=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;r=nn(e.value!=null?e.value:r),t._wrapperState={initialChecked:s,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Fv(t,e){e=e.checked,e!=null&&Kh(t,"checked",e,!1)}function id(t,e){Fv(t,e);var r=nn(e.value),s=e.type;if(r!=null)s==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?od(t,e.type,r):e.hasOwnProperty("defaultValue")&&od(t,e.type,nn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Pp(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function od(t,e,r){(e!=="number"||Vl(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Fo=Array.isArray;function Pi(t,e,r,s){if(t=t.options,e){e={};for(var n=0;n<r.length;n++)e["$"+r[n]]=!0;for(r=0;r<t.length;r++)n=e.hasOwnProperty("$"+t[r].value),t[r].selected!==n&&(t[r].selected=n),n&&s&&(t[r].defaultSelected=!0)}else{for(r=""+nn(r),e=null,n=0;n<t.length;n++){if(t[n].value===r){t[n].selected=!0,s&&(t[n].defaultSelected=!0);return}e!==null||t[n].disabled||(e=t[n])}e!==null&&(e.selected=!0)}}function ad(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Q(91));return Ve({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Lp(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Q(92));if(Fo(r)){if(1<r.length)throw Error(Q(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:nn(r)}}function Uv(t,e){var r=nn(e.value),s=nn(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),s!=null&&(t.defaultValue=""+s)}function Ip(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Hv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ld(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Hv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var rl,zv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,s,n){MSApp.execUnsafeLocalFunction(function(){return t(e,r,s,n)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(rl=rl||document.createElement("div"),rl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=rl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function oa(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Vo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Hw=["Webkit","ms","Moz","O"];Object.keys(Vo).forEach(function(t){Hw.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Vo[e]=Vo[t]})});function Wv(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Vo.hasOwnProperty(t)&&Vo[t]?(""+e).trim():e+"px"}function qv(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var s=r.indexOf("--")===0,n=Wv(r,e[r],s);r==="float"&&(r="cssFloat"),s?t.setProperty(r,n):t[r]=n}}var zw=Ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cd(t,e){if(e){if(zw[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Q(62))}}function ud(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dd=null;function Yh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var hd=null,Li=null,Ii=null;function Dp(t){if(t=Ha(t)){if(typeof hd!="function")throw Error(Q(280));var e=t.stateNode;e&&(e=Bc(e),hd(t.stateNode,t.type,e))}}function Gv(t){Li?Ii?Ii.push(t):Ii=[t]:Li=t}function Vv(){if(Li){var t=Li,e=Ii;if(Ii=Li=null,Dp(t),e)for(t=0;t<e.length;t++)Dp(e[t])}}function Kv(t,e){return t(e)}function Jv(){}var cu=!1;function Qv(t,e,r){if(cu)return t(e,r);cu=!0;try{return Kv(t,e,r)}finally{cu=!1,(Li!==null||Ii!==null)&&(Jv(),Vv())}}function aa(t,e){var r=t.stateNode;if(r===null)return null;var s=Bc(r);if(s===null)return null;r=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Q(231,e,typeof r));return r}var fd=!1;if(hs)try{var To={};Object.defineProperty(To,"passive",{get:function(){fd=!0}}),window.addEventListener("test",To,To),window.removeEventListener("test",To,To)}catch{fd=!1}function Ww(t,e,r,s,n,i,c,o,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(g){this.onError(g)}}var Ko=!1,Kl=null,Jl=!1,pd=null,qw={onError:function(t){Ko=!0,Kl=t}};function Gw(t,e,r,s,n,i,c,o,l){Ko=!1,Kl=null,Ww.apply(qw,arguments)}function Vw(t,e,r,s,n,i,c,o,l){if(Gw.apply(this,arguments),Ko){if(Ko){var d=Kl;Ko=!1,Kl=null}else throw Error(Q(198));Jl||(Jl=!0,pd=d)}}function ei(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Zv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Mp(t){if(ei(t)!==t)throw Error(Q(188))}function Kw(t){var e=t.alternate;if(!e){if(e=ei(t),e===null)throw Error(Q(188));return e!==t?null:t}for(var r=t,s=e;;){var n=r.return;if(n===null)break;var i=n.alternate;if(i===null){if(s=n.return,s!==null){r=s;continue}break}if(n.child===i.child){for(i=n.child;i;){if(i===r)return Mp(n),t;if(i===s)return Mp(n),e;i=i.sibling}throw Error(Q(188))}if(r.return!==s.return)r=n,s=i;else{for(var c=!1,o=n.child;o;){if(o===r){c=!0,r=n,s=i;break}if(o===s){c=!0,s=n,r=i;break}o=o.sibling}if(!c){for(o=i.child;o;){if(o===r){c=!0,r=i,s=n;break}if(o===s){c=!0,s=i,r=n;break}o=o.sibling}if(!c)throw Error(Q(189))}}if(r.alternate!==s)throw Error(Q(190))}if(r.tag!==3)throw Error(Q(188));return r.stateNode.current===r?t:e}function Yv(t){return t=Kw(t),t!==null?Xv(t):null}function Xv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Xv(t);if(e!==null)return e;t=t.sibling}return null}var e_=ir.unstable_scheduleCallback,Bp=ir.unstable_cancelCallback,Jw=ir.unstable_shouldYield,Qw=ir.unstable_requestPaint,Ye=ir.unstable_now,Zw=ir.unstable_getCurrentPriorityLevel,Xh=ir.unstable_ImmediatePriority,t_=ir.unstable_UserBlockingPriority,Ql=ir.unstable_NormalPriority,Yw=ir.unstable_LowPriority,r_=ir.unstable_IdlePriority,Lc=null,qr=null;function Xw(t){if(qr&&typeof qr.onCommitFiberRoot=="function")try{qr.onCommitFiberRoot(Lc,t,void 0,(t.current.flags&128)===128)}catch{}}var Nr=Math.clz32?Math.clz32:rb,eb=Math.log,tb=Math.LN2;function rb(t){return t>>>=0,t===0?32:31-(eb(t)/tb|0)|0}var sl=64,nl=4194304;function Uo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Zl(t,e){var r=t.pendingLanes;if(r===0)return 0;var s=0,n=t.suspendedLanes,i=t.pingedLanes,c=r&268435455;if(c!==0){var o=c&~n;o!==0?s=Uo(o):(i&=c,i!==0&&(s=Uo(i)))}else c=r&~n,c!==0?s=Uo(c):i!==0&&(s=Uo(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&n)&&(n=s&-s,i=e&-e,n>=i||n===16&&(i&4194240)!==0))return e;if(s&4&&(s|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)r=31-Nr(e),n=1<<r,s|=t[r],e&=~n;return s}function sb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nb(t,e){for(var r=t.suspendedLanes,s=t.pingedLanes,n=t.expirationTimes,i=t.pendingLanes;0<i;){var c=31-Nr(i),o=1<<c,l=n[c];l===-1?(!(o&r)||o&s)&&(n[c]=sb(o,e)):l<=e&&(t.expiredLanes|=o),i&=~o}}function md(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function s_(){var t=sl;return sl<<=1,!(sl&4194240)&&(sl=64),t}function uu(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Fa(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Nr(e),t[e]=r}function ib(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<r;){var n=31-Nr(r),i=1<<n;e[n]=0,s[n]=-1,t[n]=-1,r&=~i}}function ef(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var s=31-Nr(r),n=1<<s;n&e|t[s]&e&&(t[s]|=e),r&=~n}}var Pe=0;function n_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var i_,tf,o_,a_,l_,gd=!1,il=[],Vs=null,Ks=null,Js=null,la=new Map,ca=new Map,As=[],ob="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $p(t,e){switch(t){case"focusin":case"focusout":Vs=null;break;case"dragenter":case"dragleave":Ks=null;break;case"mouseover":case"mouseout":Js=null;break;case"pointerover":case"pointerout":la.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ca.delete(e.pointerId)}}function Ao(t,e,r,s,n,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:s,nativeEvent:i,targetContainers:[n]},e!==null&&(e=Ha(e),e!==null&&tf(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),t)}function ab(t,e,r,s,n){switch(e){case"focusin":return Vs=Ao(Vs,t,e,r,s,n),!0;case"dragenter":return Ks=Ao(Ks,t,e,r,s,n),!0;case"mouseover":return Js=Ao(Js,t,e,r,s,n),!0;case"pointerover":var i=n.pointerId;return la.set(i,Ao(la.get(i)||null,t,e,r,s,n)),!0;case"gotpointercapture":return i=n.pointerId,ca.set(i,Ao(ca.get(i)||null,t,e,r,s,n)),!0}return!1}function c_(t){var e=kn(t.target);if(e!==null){var r=ei(e);if(r!==null){if(e=r.tag,e===13){if(e=Zv(r),e!==null){t.blockedOn=e,l_(t.priority,function(){o_(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Pl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=vd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var s=new r.constructor(r.type,r);dd=s,r.target.dispatchEvent(s),dd=null}else return e=Ha(r),e!==null&&tf(e),t.blockedOn=r,!1;e.shift()}return!0}function Fp(t,e,r){Pl(t)&&r.delete(e)}function lb(){gd=!1,Vs!==null&&Pl(Vs)&&(Vs=null),Ks!==null&&Pl(Ks)&&(Ks=null),Js!==null&&Pl(Js)&&(Js=null),la.forEach(Fp),ca.forEach(Fp)}function Oo(t,e){t.blockedOn===e&&(t.blockedOn=null,gd||(gd=!0,ir.unstable_scheduleCallback(ir.unstable_NormalPriority,lb)))}function ua(t){function e(n){return Oo(n,t)}if(0<il.length){Oo(il[0],t);for(var r=1;r<il.length;r++){var s=il[r];s.blockedOn===t&&(s.blockedOn=null)}}for(Vs!==null&&Oo(Vs,t),Ks!==null&&Oo(Ks,t),Js!==null&&Oo(Js,t),la.forEach(e),ca.forEach(e),r=0;r<As.length;r++)s=As[r],s.blockedOn===t&&(s.blockedOn=null);for(;0<As.length&&(r=As[0],r.blockedOn===null);)c_(r),r.blockedOn===null&&As.shift()}var Di=vs.ReactCurrentBatchConfig,Yl=!0;function cb(t,e,r,s){var n=Pe,i=Di.transition;Di.transition=null;try{Pe=1,rf(t,e,r,s)}finally{Pe=n,Di.transition=i}}function ub(t,e,r,s){var n=Pe,i=Di.transition;Di.transition=null;try{Pe=4,rf(t,e,r,s)}finally{Pe=n,Di.transition=i}}function rf(t,e,r,s){if(Yl){var n=vd(t,e,r,s);if(n===null)xu(t,e,s,Xl,r),$p(t,s);else if(ab(n,t,e,r,s))s.stopPropagation();else if($p(t,s),e&4&&-1<ob.indexOf(t)){for(;n!==null;){var i=Ha(n);if(i!==null&&i_(i),i=vd(t,e,r,s),i===null&&xu(t,e,s,Xl,r),i===n)break;n=i}n!==null&&s.stopPropagation()}else xu(t,e,s,null,r)}}var Xl=null;function vd(t,e,r,s){if(Xl=null,t=Yh(s),t=kn(t),t!==null)if(e=ei(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Zv(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Xl=t,null}function u_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zw()){case Xh:return 1;case t_:return 4;case Ql:case Yw:return 16;case r_:return 536870912;default:return 16}default:return 16}}var zs=null,sf=null,Ll=null;function d_(){if(Ll)return Ll;var t,e=sf,r=e.length,s,n="value"in zs?zs.value:zs.textContent,i=n.length;for(t=0;t<r&&e[t]===n[t];t++);var c=r-t;for(s=1;s<=c&&e[r-s]===n[i-s];s++);return Ll=n.slice(t,1<s?1-s:void 0)}function Il(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ol(){return!0}function Up(){return!1}function lr(t){function e(r,s,n,i,c){this._reactName=r,this._targetInst=n,this.type=s,this.nativeEvent=i,this.target=c,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ol:Up,this.isPropagationStopped=Up,this}return Ve(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ol)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ol)},persist:function(){},isPersistent:ol}),e}var yo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nf=lr(yo),Ua=Ve({},yo,{view:0,detail:0}),db=lr(Ua),du,hu,Po,Ic=Ve({},Ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:of,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Po&&(Po&&t.type==="mousemove"?(du=t.screenX-Po.screenX,hu=t.screenY-Po.screenY):hu=du=0,Po=t),du)},movementY:function(t){return"movementY"in t?t.movementY:hu}}),Hp=lr(Ic),hb=Ve({},Ic,{dataTransfer:0}),fb=lr(hb),pb=Ve({},Ua,{relatedTarget:0}),fu=lr(pb),mb=Ve({},yo,{animationName:0,elapsedTime:0,pseudoElement:0}),gb=lr(mb),vb=Ve({},yo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),_b=lr(vb),yb=Ve({},yo,{data:0}),zp=lr(yb),xb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sb(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=bb[t])?!!e[t]:!1}function of(){return Sb}var Cb=Ve({},Ua,{key:function(t){if(t.key){var e=xb[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Il(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?wb[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:of,charCode:function(t){return t.type==="keypress"?Il(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Il(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),kb=lr(Cb),Eb=Ve({},Ic,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wp=lr(Eb),jb=Ve({},Ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:of}),Rb=lr(jb),Nb=Ve({},yo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Tb=lr(Nb),Ab=Ve({},Ic,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Ob=lr(Ab),Pb=[9,13,27,32],af=hs&&"CompositionEvent"in window,Jo=null;hs&&"documentMode"in document&&(Jo=document.documentMode);var Lb=hs&&"TextEvent"in window&&!Jo,h_=hs&&(!af||Jo&&8<Jo&&11>=Jo),qp=" ",Gp=!1;function f_(t,e){switch(t){case"keyup":return Pb.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function p_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var xi=!1;function Ib(t,e){switch(t){case"compositionend":return p_(e);case"keypress":return e.which!==32?null:(Gp=!0,qp);case"textInput":return t=e.data,t===qp&&Gp?null:t;default:return null}}function Db(t,e){if(xi)return t==="compositionend"||!af&&f_(t,e)?(t=d_(),Ll=sf=zs=null,xi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return h_&&e.locale!=="ko"?null:e.data;default:return null}}var Mb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Mb[t.type]:e==="textarea"}function m_(t,e,r,s){Gv(s),e=ec(e,"onChange"),0<e.length&&(r=new nf("onChange","change",null,r,s),t.push({event:r,listeners:e}))}var Qo=null,da=null;function Bb(t){E_(t,0)}function Dc(t){var e=Si(t);if($v(e))return t}function $b(t,e){if(t==="change")return e}var g_=!1;if(hs){var pu;if(hs){var mu="oninput"in document;if(!mu){var Kp=document.createElement("div");Kp.setAttribute("oninput","return;"),mu=typeof Kp.oninput=="function"}pu=mu}else pu=!1;g_=pu&&(!document.documentMode||9<document.documentMode)}function Jp(){Qo&&(Qo.detachEvent("onpropertychange",v_),da=Qo=null)}function v_(t){if(t.propertyName==="value"&&Dc(da)){var e=[];m_(e,da,t,Yh(t)),Qv(Bb,e)}}function Fb(t,e,r){t==="focusin"?(Jp(),Qo=e,da=r,Qo.attachEvent("onpropertychange",v_)):t==="focusout"&&Jp()}function Ub(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Dc(da)}function Hb(t,e){if(t==="click")return Dc(e)}function zb(t,e){if(t==="input"||t==="change")return Dc(e)}function Wb(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Or=typeof Object.is=="function"?Object.is:Wb;function ha(t,e){if(Or(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var n=r[s];if(!Xu.call(e,n)||!Or(t[n],e[n]))return!1}return!0}function Qp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Zp(t,e){var r=Qp(t);t=0;for(var s;r;){if(r.nodeType===3){if(s=t+r.textContent.length,t<=e&&s>=e)return{node:r,offset:e-t};t=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Qp(r)}}function __(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?__(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function y_(){for(var t=window,e=Vl();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Vl(t.document)}return e}function lf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function qb(t){var e=y_(),r=t.focusedElem,s=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&__(r.ownerDocument.documentElement,r)){if(s!==null&&lf(r)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var n=r.textContent.length,i=Math.min(s.start,n);s=s.end===void 0?i:Math.min(s.end,n),!t.extend&&i>s&&(n=s,s=i,i=n),n=Zp(r,i);var c=Zp(r,s);n&&c&&(t.rangeCount!==1||t.anchorNode!==n.node||t.anchorOffset!==n.offset||t.focusNode!==c.node||t.focusOffset!==c.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(c.node,c.offset)):(e.setEnd(c.node,c.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Gb=hs&&"documentMode"in document&&11>=document.documentMode,wi=null,_d=null,Zo=null,yd=!1;function Yp(t,e,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;yd||wi==null||wi!==Vl(s)||(s=wi,"selectionStart"in s&&lf(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Zo&&ha(Zo,s)||(Zo=s,s=ec(_d,"onSelect"),0<s.length&&(e=new nf("onSelect","select",null,e,r),t.push({event:e,listeners:s}),e.target=wi)))}function al(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var bi={animationend:al("Animation","AnimationEnd"),animationiteration:al("Animation","AnimationIteration"),animationstart:al("Animation","AnimationStart"),transitionend:al("Transition","TransitionEnd")},gu={},x_={};hs&&(x_=document.createElement("div").style,"AnimationEvent"in window||(delete bi.animationend.animation,delete bi.animationiteration.animation,delete bi.animationstart.animation),"TransitionEvent"in window||delete bi.transitionend.transition);function Mc(t){if(gu[t])return gu[t];if(!bi[t])return t;var e=bi[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in x_)return gu[t]=e[r];return t}var w_=Mc("animationend"),b_=Mc("animationiteration"),S_=Mc("animationstart"),C_=Mc("transitionend"),k_=new Map,Xp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cn(t,e){k_.set(t,e),Xn(e,[t])}for(var vu=0;vu<Xp.length;vu++){var _u=Xp[vu],Vb=_u.toLowerCase(),Kb=_u[0].toUpperCase()+_u.slice(1);cn(Vb,"on"+Kb)}cn(w_,"onAnimationEnd");cn(b_,"onAnimationIteration");cn(S_,"onAnimationStart");cn("dblclick","onDoubleClick");cn("focusin","onFocus");cn("focusout","onBlur");cn(C_,"onTransitionEnd");eo("onMouseEnter",["mouseout","mouseover"]);eo("onMouseLeave",["mouseout","mouseover"]);eo("onPointerEnter",["pointerout","pointerover"]);eo("onPointerLeave",["pointerout","pointerover"]);Xn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Xn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Xn("onBeforeInput",["compositionend","keypress","textInput","paste"]);Xn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Xn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Xn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ho="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Jb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ho));function em(t,e,r){var s=t.type||"unknown-event";t.currentTarget=r,Vw(s,e,void 0,t),t.currentTarget=null}function E_(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var s=t[r],n=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var c=s.length-1;0<=c;c--){var o=s[c],l=o.instance,d=o.currentTarget;if(o=o.listener,l!==i&&n.isPropagationStopped())break e;em(n,o,d),i=l}else for(c=0;c<s.length;c++){if(o=s[c],l=o.instance,d=o.currentTarget,o=o.listener,l!==i&&n.isPropagationStopped())break e;em(n,o,d),i=l}}}if(Jl)throw t=pd,Jl=!1,pd=null,t}function Fe(t,e){var r=e[Cd];r===void 0&&(r=e[Cd]=new Set);var s=t+"__bubble";r.has(s)||(j_(e,t,2,!1),r.add(s))}function yu(t,e,r){var s=0;e&&(s|=4),j_(r,t,s,e)}var ll="_reactListening"+Math.random().toString(36).slice(2);function fa(t){if(!t[ll]){t[ll]=!0,Lv.forEach(function(r){r!=="selectionchange"&&(Jb.has(r)||yu(r,!1,t),yu(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ll]||(e[ll]=!0,yu("selectionchange",!1,e))}}function j_(t,e,r,s){switch(u_(e)){case 1:var n=cb;break;case 4:n=ub;break;default:n=rf}r=n.bind(null,e,r,t),n=void 0,!fd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),s?n!==void 0?t.addEventListener(e,r,{capture:!0,passive:n}):t.addEventListener(e,r,!0):n!==void 0?t.addEventListener(e,r,{passive:n}):t.addEventListener(e,r,!1)}function xu(t,e,r,s,n){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var c=s.tag;if(c===3||c===4){var o=s.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(c===4)for(c=s.return;c!==null;){var l=c.tag;if((l===3||l===4)&&(l=c.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;c=c.return}for(;o!==null;){if(c=kn(o),c===null)return;if(l=c.tag,l===5||l===6){s=i=c;continue e}o=o.parentNode}}s=s.return}Qv(function(){var d=i,g=Yh(r),m=[];e:{var v=k_.get(t);if(v!==void 0){var y=nf,w=t;switch(t){case"keypress":if(Il(r)===0)break e;case"keydown":case"keyup":y=kb;break;case"focusin":w="focus",y=fu;break;case"focusout":w="blur",y=fu;break;case"beforeblur":case"afterblur":y=fu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=Hp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=fb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=Rb;break;case w_:case b_:case S_:y=gb;break;case C_:y=Tb;break;case"scroll":y=db;break;case"wheel":y=Ob;break;case"copy":case"cut":case"paste":y=_b;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=Wp}var _=(e&4)!==0,p=!_&&t==="scroll",h=_?v!==null?v+"Capture":null:v;_=[];for(var u=d,f;u!==null;){f=u;var x=f.stateNode;if(f.tag===5&&x!==null&&(f=x,h!==null&&(x=aa(u,h),x!=null&&_.push(pa(u,x,f)))),p)break;u=u.return}0<_.length&&(v=new y(v,w,null,r,g),m.push({event:v,listeners:_}))}}if(!(e&7)){e:{if(v=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",v&&r!==dd&&(w=r.relatedTarget||r.fromElement)&&(kn(w)||w[fs]))break e;if((y||v)&&(v=g.window===g?g:(v=g.ownerDocument)?v.defaultView||v.parentWindow:window,y?(w=r.relatedTarget||r.toElement,y=d,w=w?kn(w):null,w!==null&&(p=ei(w),w!==p||w.tag!==5&&w.tag!==6)&&(w=null)):(y=null,w=d),y!==w)){if(_=Hp,x="onMouseLeave",h="onMouseEnter",u="mouse",(t==="pointerout"||t==="pointerover")&&(_=Wp,x="onPointerLeave",h="onPointerEnter",u="pointer"),p=y==null?v:Si(y),f=w==null?v:Si(w),v=new _(x,u+"leave",y,r,g),v.target=p,v.relatedTarget=f,x=null,kn(g)===d&&(_=new _(h,u+"enter",w,r,g),_.target=f,_.relatedTarget=p,x=_),p=x,y&&w)t:{for(_=y,h=w,u=0,f=_;f;f=ni(f))u++;for(f=0,x=h;x;x=ni(x))f++;for(;0<u-f;)_=ni(_),u--;for(;0<f-u;)h=ni(h),f--;for(;u--;){if(_===h||h!==null&&_===h.alternate)break t;_=ni(_),h=ni(h)}_=null}else _=null;y!==null&&tm(m,v,y,_,!1),w!==null&&p!==null&&tm(m,p,w,_,!0)}}e:{if(v=d?Si(d):window,y=v.nodeName&&v.nodeName.toLowerCase(),y==="select"||y==="input"&&v.type==="file")var k=$b;else if(Vp(v))if(g_)k=zb;else{k=Ub;var C=Fb}else(y=v.nodeName)&&y.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(k=Hb);if(k&&(k=k(t,d))){m_(m,k,r,g);break e}C&&C(t,v,d),t==="focusout"&&(C=v._wrapperState)&&C.controlled&&v.type==="number"&&od(v,"number",v.value)}switch(C=d?Si(d):window,t){case"focusin":(Vp(C)||C.contentEditable==="true")&&(wi=C,_d=d,Zo=null);break;case"focusout":Zo=_d=wi=null;break;case"mousedown":yd=!0;break;case"contextmenu":case"mouseup":case"dragend":yd=!1,Yp(m,r,g);break;case"selectionchange":if(Gb)break;case"keydown":case"keyup":Yp(m,r,g)}var S;if(af)e:{switch(t){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else xi?f_(t,r)&&(b="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(b="onCompositionStart");b&&(h_&&r.locale!=="ko"&&(xi||b!=="onCompositionStart"?b==="onCompositionEnd"&&xi&&(S=d_()):(zs=g,sf="value"in zs?zs.value:zs.textContent,xi=!0)),C=ec(d,b),0<C.length&&(b=new zp(b,t,null,r,g),m.push({event:b,listeners:C}),S?b.data=S:(S=p_(r),S!==null&&(b.data=S)))),(S=Lb?Ib(t,r):Db(t,r))&&(d=ec(d,"onBeforeInput"),0<d.length&&(g=new zp("onBeforeInput","beforeinput",null,r,g),m.push({event:g,listeners:d}),g.data=S))}E_(m,e)})}function pa(t,e,r){return{instance:t,listener:e,currentTarget:r}}function ec(t,e){for(var r=e+"Capture",s=[];t!==null;){var n=t,i=n.stateNode;n.tag===5&&i!==null&&(n=i,i=aa(t,r),i!=null&&s.unshift(pa(t,i,n)),i=aa(t,e),i!=null&&s.push(pa(t,i,n))),t=t.return}return s}function ni(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function tm(t,e,r,s,n){for(var i=e._reactName,c=[];r!==null&&r!==s;){var o=r,l=o.alternate,d=o.stateNode;if(l!==null&&l===s)break;o.tag===5&&d!==null&&(o=d,n?(l=aa(r,i),l!=null&&c.unshift(pa(r,l,o))):n||(l=aa(r,i),l!=null&&c.push(pa(r,l,o)))),r=r.return}c.length!==0&&t.push({event:e,listeners:c})}var Qb=/\r\n?/g,Zb=/\u0000|\uFFFD/g;function rm(t){return(typeof t=="string"?t:""+t).replace(Qb,`
`).replace(Zb,"")}function cl(t,e,r){if(e=rm(e),rm(t)!==e&&r)throw Error(Q(425))}function tc(){}var xd=null,wd=null;function bd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Sd=typeof setTimeout=="function"?setTimeout:void 0,Yb=typeof clearTimeout=="function"?clearTimeout:void 0,sm=typeof Promise=="function"?Promise:void 0,Xb=typeof queueMicrotask=="function"?queueMicrotask:typeof sm<"u"?function(t){return sm.resolve(null).then(t).catch(e1)}:Sd;function e1(t){setTimeout(function(){throw t})}function wu(t,e){var r=e,s=0;do{var n=r.nextSibling;if(t.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(s===0){t.removeChild(n),ua(e);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=n}while(r);ua(e)}function Qs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function nm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var xo=Math.random().toString(36).slice(2),zr="__reactFiber$"+xo,ma="__reactProps$"+xo,fs="__reactContainer$"+xo,Cd="__reactEvents$"+xo,t1="__reactListeners$"+xo,r1="__reactHandles$"+xo;function kn(t){var e=t[zr];if(e)return e;for(var r=t.parentNode;r;){if(e=r[fs]||r[zr]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=nm(t);t!==null;){if(r=t[zr])return r;t=nm(t)}return e}t=r,r=t.parentNode}return null}function Ha(t){return t=t[zr]||t[fs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Si(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Q(33))}function Bc(t){return t[ma]||null}var kd=[],Ci=-1;function un(t){return{current:t}}function Ue(t){0>Ci||(t.current=kd[Ci],kd[Ci]=null,Ci--)}function Be(t,e){Ci++,kd[Ci]=t.current,t.current=e}var on={},Rt=un(on),Wt=un(!1),Un=on;function to(t,e){var r=t.type.contextTypes;if(!r)return on;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var n={},i;for(i in r)n[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=n),n}function qt(t){return t=t.childContextTypes,t!=null}function rc(){Ue(Wt),Ue(Rt)}function im(t,e,r){if(Rt.current!==on)throw Error(Q(168));Be(Rt,e),Be(Wt,r)}function R_(t,e,r){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var n in s)if(!(n in e))throw Error(Q(108,Fw(t)||"Unknown",n));return Ve({},r,s)}function sc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||on,Un=Rt.current,Be(Rt,t),Be(Wt,Wt.current),!0}function om(t,e,r){var s=t.stateNode;if(!s)throw Error(Q(169));r?(t=R_(t,e,Un),s.__reactInternalMemoizedMergedChildContext=t,Ue(Wt),Ue(Rt),Be(Rt,t)):Ue(Wt),Be(Wt,r)}var rs=null,$c=!1,bu=!1;function N_(t){rs===null?rs=[t]:rs.push(t)}function s1(t){$c=!0,N_(t)}function dn(){if(!bu&&rs!==null){bu=!0;var t=0,e=Pe;try{var r=rs;for(Pe=1;t<r.length;t++){var s=r[t];do s=s(!0);while(s!==null)}rs=null,$c=!1}catch(n){throw rs!==null&&(rs=rs.slice(t+1)),e_(Xh,dn),n}finally{Pe=e,bu=!1}}return null}var ki=[],Ei=0,nc=null,ic=0,fr=[],pr=0,Hn=null,as=1,ls="";function xn(t,e){ki[Ei++]=ic,ki[Ei++]=nc,nc=t,ic=e}function T_(t,e,r){fr[pr++]=as,fr[pr++]=ls,fr[pr++]=Hn,Hn=t;var s=as;t=ls;var n=32-Nr(s)-1;s&=~(1<<n),r+=1;var i=32-Nr(e)+n;if(30<i){var c=n-n%5;i=(s&(1<<c)-1).toString(32),s>>=c,n-=c,as=1<<32-Nr(e)+n|r<<n|s,ls=i+t}else as=1<<i|r<<n|s,ls=t}function cf(t){t.return!==null&&(xn(t,1),T_(t,1,0))}function uf(t){for(;t===nc;)nc=ki[--Ei],ki[Ei]=null,ic=ki[--Ei],ki[Ei]=null;for(;t===Hn;)Hn=fr[--pr],fr[pr]=null,ls=fr[--pr],fr[pr]=null,as=fr[--pr],fr[pr]=null}var sr=null,rr=null,He=!1,Rr=null;function A_(t,e){var r=mr(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function am(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,sr=t,rr=Qs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,sr=t,rr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Hn!==null?{id:as,overflow:ls}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=mr(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,sr=t,rr=null,!0):!1;default:return!1}}function Ed(t){return(t.mode&1)!==0&&(t.flags&128)===0}function jd(t){if(He){var e=rr;if(e){var r=e;if(!am(t,e)){if(Ed(t))throw Error(Q(418));e=Qs(r.nextSibling);var s=sr;e&&am(t,e)?A_(s,r):(t.flags=t.flags&-4097|2,He=!1,sr=t)}}else{if(Ed(t))throw Error(Q(418));t.flags=t.flags&-4097|2,He=!1,sr=t}}}function lm(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;sr=t}function ul(t){if(t!==sr)return!1;if(!He)return lm(t),He=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!bd(t.type,t.memoizedProps)),e&&(e=rr)){if(Ed(t))throw O_(),Error(Q(418));for(;e;)A_(t,e),e=Qs(e.nextSibling)}if(lm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){rr=Qs(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}rr=null}}else rr=sr?Qs(t.stateNode.nextSibling):null;return!0}function O_(){for(var t=rr;t;)t=Qs(t.nextSibling)}function ro(){rr=sr=null,He=!1}function df(t){Rr===null?Rr=[t]:Rr.push(t)}var n1=vs.ReactCurrentBatchConfig;function Lo(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Q(309));var s=r.stateNode}if(!s)throw Error(Q(147,t));var n=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(c){var o=n.refs;c===null?delete o[i]:o[i]=c},e._stringRef=i,e)}if(typeof t!="string")throw Error(Q(284));if(!r._owner)throw Error(Q(290,t))}return t}function dl(t,e){throw t=Object.prototype.toString.call(e),Error(Q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function cm(t){var e=t._init;return e(t._payload)}function P_(t){function e(h,u){if(t){var f=h.deletions;f===null?(h.deletions=[u],h.flags|=16):f.push(u)}}function r(h,u){if(!t)return null;for(;u!==null;)e(h,u),u=u.sibling;return null}function s(h,u){for(h=new Map;u!==null;)u.key!==null?h.set(u.key,u):h.set(u.index,u),u=u.sibling;return h}function n(h,u){return h=en(h,u),h.index=0,h.sibling=null,h}function i(h,u,f){return h.index=f,t?(f=h.alternate,f!==null?(f=f.index,f<u?(h.flags|=2,u):f):(h.flags|=2,u)):(h.flags|=1048576,u)}function c(h){return t&&h.alternate===null&&(h.flags|=2),h}function o(h,u,f,x){return u===null||u.tag!==6?(u=Nu(f,h.mode,x),u.return=h,u):(u=n(u,f),u.return=h,u)}function l(h,u,f,x){var k=f.type;return k===yi?g(h,u,f.props.children,x,f.key):u!==null&&(u.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===js&&cm(k)===u.type)?(x=n(u,f.props),x.ref=Lo(h,u,f),x.return=h,x):(x=Hl(f.type,f.key,f.props,null,h.mode,x),x.ref=Lo(h,u,f),x.return=h,x)}function d(h,u,f,x){return u===null||u.tag!==4||u.stateNode.containerInfo!==f.containerInfo||u.stateNode.implementation!==f.implementation?(u=Tu(f,h.mode,x),u.return=h,u):(u=n(u,f.children||[]),u.return=h,u)}function g(h,u,f,x,k){return u===null||u.tag!==7?(u=Fn(f,h.mode,x,k),u.return=h,u):(u=n(u,f),u.return=h,u)}function m(h,u,f){if(typeof u=="string"&&u!==""||typeof u=="number")return u=Nu(""+u,h.mode,f),u.return=h,u;if(typeof u=="object"&&u!==null){switch(u.$$typeof){case el:return f=Hl(u.type,u.key,u.props,null,h.mode,f),f.ref=Lo(h,null,u),f.return=h,f;case _i:return u=Tu(u,h.mode,f),u.return=h,u;case js:var x=u._init;return m(h,x(u._payload),f)}if(Fo(u)||No(u))return u=Fn(u,h.mode,f,null),u.return=h,u;dl(h,u)}return null}function v(h,u,f,x){var k=u!==null?u.key:null;if(typeof f=="string"&&f!==""||typeof f=="number")return k!==null?null:o(h,u,""+f,x);if(typeof f=="object"&&f!==null){switch(f.$$typeof){case el:return f.key===k?l(h,u,f,x):null;case _i:return f.key===k?d(h,u,f,x):null;case js:return k=f._init,v(h,u,k(f._payload),x)}if(Fo(f)||No(f))return k!==null?null:g(h,u,f,x,null);dl(h,f)}return null}function y(h,u,f,x,k){if(typeof x=="string"&&x!==""||typeof x=="number")return h=h.get(f)||null,o(u,h,""+x,k);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case el:return h=h.get(x.key===null?f:x.key)||null,l(u,h,x,k);case _i:return h=h.get(x.key===null?f:x.key)||null,d(u,h,x,k);case js:var C=x._init;return y(h,u,f,C(x._payload),k)}if(Fo(x)||No(x))return h=h.get(f)||null,g(u,h,x,k,null);dl(u,x)}return null}function w(h,u,f,x){for(var k=null,C=null,S=u,b=u=0,E=null;S!==null&&b<f.length;b++){S.index>b?(E=S,S=null):E=S.sibling;var N=v(h,S,f[b],x);if(N===null){S===null&&(S=E);break}t&&S&&N.alternate===null&&e(h,S),u=i(N,u,b),C===null?k=N:C.sibling=N,C=N,S=E}if(b===f.length)return r(h,S),He&&xn(h,b),k;if(S===null){for(;b<f.length;b++)S=m(h,f[b],x),S!==null&&(u=i(S,u,b),C===null?k=S:C.sibling=S,C=S);return He&&xn(h,b),k}for(S=s(h,S);b<f.length;b++)E=y(S,h,b,f[b],x),E!==null&&(t&&E.alternate!==null&&S.delete(E.key===null?b:E.key),u=i(E,u,b),C===null?k=E:C.sibling=E,C=E);return t&&S.forEach(function(O){return e(h,O)}),He&&xn(h,b),k}function _(h,u,f,x){var k=No(f);if(typeof k!="function")throw Error(Q(150));if(f=k.call(f),f==null)throw Error(Q(151));for(var C=k=null,S=u,b=u=0,E=null,N=f.next();S!==null&&!N.done;b++,N=f.next()){S.index>b?(E=S,S=null):E=S.sibling;var O=v(h,S,N.value,x);if(O===null){S===null&&(S=E);break}t&&S&&O.alternate===null&&e(h,S),u=i(O,u,b),C===null?k=O:C.sibling=O,C=O,S=E}if(N.done)return r(h,S),He&&xn(h,b),k;if(S===null){for(;!N.done;b++,N=f.next())N=m(h,N.value,x),N!==null&&(u=i(N,u,b),C===null?k=N:C.sibling=N,C=N);return He&&xn(h,b),k}for(S=s(h,S);!N.done;b++,N=f.next())N=y(S,h,b,N.value,x),N!==null&&(t&&N.alternate!==null&&S.delete(N.key===null?b:N.key),u=i(N,u,b),C===null?k=N:C.sibling=N,C=N);return t&&S.forEach(function(I){return e(h,I)}),He&&xn(h,b),k}function p(h,u,f,x){if(typeof f=="object"&&f!==null&&f.type===yi&&f.key===null&&(f=f.props.children),typeof f=="object"&&f!==null){switch(f.$$typeof){case el:e:{for(var k=f.key,C=u;C!==null;){if(C.key===k){if(k=f.type,k===yi){if(C.tag===7){r(h,C.sibling),u=n(C,f.props.children),u.return=h,h=u;break e}}else if(C.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===js&&cm(k)===C.type){r(h,C.sibling),u=n(C,f.props),u.ref=Lo(h,C,f),u.return=h,h=u;break e}r(h,C);break}else e(h,C);C=C.sibling}f.type===yi?(u=Fn(f.props.children,h.mode,x,f.key),u.return=h,h=u):(x=Hl(f.type,f.key,f.props,null,h.mode,x),x.ref=Lo(h,u,f),x.return=h,h=x)}return c(h);case _i:e:{for(C=f.key;u!==null;){if(u.key===C)if(u.tag===4&&u.stateNode.containerInfo===f.containerInfo&&u.stateNode.implementation===f.implementation){r(h,u.sibling),u=n(u,f.children||[]),u.return=h,h=u;break e}else{r(h,u);break}else e(h,u);u=u.sibling}u=Tu(f,h.mode,x),u.return=h,h=u}return c(h);case js:return C=f._init,p(h,u,C(f._payload),x)}if(Fo(f))return w(h,u,f,x);if(No(f))return _(h,u,f,x);dl(h,f)}return typeof f=="string"&&f!==""||typeof f=="number"?(f=""+f,u!==null&&u.tag===6?(r(h,u.sibling),u=n(u,f),u.return=h,h=u):(r(h,u),u=Nu(f,h.mode,x),u.return=h,h=u),c(h)):r(h,u)}return p}var so=P_(!0),L_=P_(!1),oc=un(null),ac=null,ji=null,hf=null;function ff(){hf=ji=ac=null}function pf(t){var e=oc.current;Ue(oc),t._currentValue=e}function Rd(t,e,r){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===r)break;t=t.return}}function Mi(t,e){ac=t,hf=ji=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(zt=!0),t.firstContext=null)}function vr(t){var e=t._currentValue;if(hf!==t)if(t={context:t,memoizedValue:e,next:null},ji===null){if(ac===null)throw Error(Q(308));ji=t,ac.dependencies={lanes:0,firstContext:t}}else ji=ji.next=t;return e}var En=null;function mf(t){En===null?En=[t]:En.push(t)}function I_(t,e,r,s){var n=e.interleaved;return n===null?(r.next=r,mf(e)):(r.next=n.next,n.next=r),e.interleaved=r,ps(t,s)}function ps(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Rs=!1;function gf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function D_(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function cs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Zs(t,e,r){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,Ne&2){var n=s.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),s.pending=e,ps(t,r)}return n=s.interleaved,n===null?(e.next=e,mf(s)):(e.next=n.next,n.next=e),s.interleaved=e,ps(t,r)}function Dl(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,r|=s,e.lanes=r,ef(t,r)}}function um(t,e){var r=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var n=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var c={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?n=i=c:i=i.next=c,r=r.next}while(r!==null);i===null?n=i=e:i=i.next=e}else n=i=e;r={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function lc(t,e,r,s){var n=t.updateQueue;Rs=!1;var i=n.firstBaseUpdate,c=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var l=o,d=l.next;l.next=null,c===null?i=d:c.next=d,c=l;var g=t.alternate;g!==null&&(g=g.updateQueue,o=g.lastBaseUpdate,o!==c&&(o===null?g.firstBaseUpdate=d:o.next=d,g.lastBaseUpdate=l))}if(i!==null){var m=n.baseState;c=0,g=d=l=null,o=i;do{var v=o.lane,y=o.eventTime;if((s&v)===v){g!==null&&(g=g.next={eventTime:y,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var w=t,_=o;switch(v=e,y=r,_.tag){case 1:if(w=_.payload,typeof w=="function"){m=w.call(y,m,v);break e}m=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=_.payload,v=typeof w=="function"?w.call(y,m,v):w,v==null)break e;m=Ve({},m,v);break e;case 2:Rs=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,v=n.effects,v===null?n.effects=[o]:v.push(o))}else y={eventTime:y,lane:v,tag:o.tag,payload:o.payload,callback:o.callback,next:null},g===null?(d=g=y,l=m):g=g.next=y,c|=v;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;v=o,o=v.next,v.next=null,n.lastBaseUpdate=v,n.shared.pending=null}}while(!0);if(g===null&&(l=m),n.baseState=l,n.firstBaseUpdate=d,n.lastBaseUpdate=g,e=n.shared.interleaved,e!==null){n=e;do c|=n.lane,n=n.next;while(n!==e)}else i===null&&(n.shared.lanes=0);Wn|=c,t.lanes=c,t.memoizedState=m}}function dm(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],n=s.callback;if(n!==null){if(s.callback=null,s=r,typeof n!="function")throw Error(Q(191,n));n.call(s)}}}var za={},Gr=un(za),ga=un(za),va=un(za);function jn(t){if(t===za)throw Error(Q(174));return t}function vf(t,e){switch(Be(va,e),Be(ga,t),Be(Gr,za),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ld(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ld(e,t)}Ue(Gr),Be(Gr,e)}function no(){Ue(Gr),Ue(ga),Ue(va)}function M_(t){jn(va.current);var e=jn(Gr.current),r=ld(e,t.type);e!==r&&(Be(ga,t),Be(Gr,r))}function _f(t){ga.current===t&&(Ue(Gr),Ue(ga))}var qe=un(0);function cc(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Su=[];function yf(){for(var t=0;t<Su.length;t++)Su[t]._workInProgressVersionPrimary=null;Su.length=0}var Ml=vs.ReactCurrentDispatcher,Cu=vs.ReactCurrentBatchConfig,zn=0,Ge=null,nt=null,dt=null,uc=!1,Yo=!1,_a=0,i1=0;function kt(){throw Error(Q(321))}function xf(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Or(t[r],e[r]))return!1;return!0}function wf(t,e,r,s,n,i){if(zn=i,Ge=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ml.current=t===null||t.memoizedState===null?c1:u1,t=r(s,n),Yo){i=0;do{if(Yo=!1,_a=0,25<=i)throw Error(Q(301));i+=1,dt=nt=null,e.updateQueue=null,Ml.current=d1,t=r(s,n)}while(Yo)}if(Ml.current=dc,e=nt!==null&&nt.next!==null,zn=0,dt=nt=Ge=null,uc=!1,e)throw Error(Q(300));return t}function bf(){var t=_a!==0;return _a=0,t}function $r(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dt===null?Ge.memoizedState=dt=t:dt=dt.next=t,dt}function _r(){if(nt===null){var t=Ge.alternate;t=t!==null?t.memoizedState:null}else t=nt.next;var e=dt===null?Ge.memoizedState:dt.next;if(e!==null)dt=e,nt=t;else{if(t===null)throw Error(Q(310));nt=t,t={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},dt===null?Ge.memoizedState=dt=t:dt=dt.next=t}return dt}function ya(t,e){return typeof e=="function"?e(t):e}function ku(t){var e=_r(),r=e.queue;if(r===null)throw Error(Q(311));r.lastRenderedReducer=t;var s=nt,n=s.baseQueue,i=r.pending;if(i!==null){if(n!==null){var c=n.next;n.next=i.next,i.next=c}s.baseQueue=n=i,r.pending=null}if(n!==null){i=n.next,s=s.baseState;var o=c=null,l=null,d=i;do{var g=d.lane;if((zn&g)===g)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:t(s,d.action);else{var m={lane:g,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(o=l=m,c=s):l=l.next=m,Ge.lanes|=g,Wn|=g}d=d.next}while(d!==null&&d!==i);l===null?c=s:l.next=o,Or(s,e.memoizedState)||(zt=!0),e.memoizedState=s,e.baseState=c,e.baseQueue=l,r.lastRenderedState=s}if(t=r.interleaved,t!==null){n=t;do i=n.lane,Ge.lanes|=i,Wn|=i,n=n.next;while(n!==t)}else n===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Eu(t){var e=_r(),r=e.queue;if(r===null)throw Error(Q(311));r.lastRenderedReducer=t;var s=r.dispatch,n=r.pending,i=e.memoizedState;if(n!==null){r.pending=null;var c=n=n.next;do i=t(i,c.action),c=c.next;while(c!==n);Or(i,e.memoizedState)||(zt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,s]}function B_(){}function $_(t,e){var r=Ge,s=_r(),n=e(),i=!Or(s.memoizedState,n);if(i&&(s.memoizedState=n,zt=!0),s=s.queue,Sf(H_.bind(null,r,s,t),[t]),s.getSnapshot!==e||i||dt!==null&&dt.memoizedState.tag&1){if(r.flags|=2048,xa(9,U_.bind(null,r,s,n,e),void 0,null),ht===null)throw Error(Q(349));zn&30||F_(r,e,n)}return n}function F_(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function U_(t,e,r,s){e.value=r,e.getSnapshot=s,z_(e)&&W_(t)}function H_(t,e,r){return r(function(){z_(e)&&W_(t)})}function z_(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Or(t,r)}catch{return!0}}function W_(t){var e=ps(t,1);e!==null&&Tr(e,t,1,-1)}function hm(t){var e=$r();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:t},e.queue=t,t=t.dispatch=l1.bind(null,Ge,t),[e.memoizedState,t]}function xa(t,e,r,s){return t={tag:t,create:e,destroy:r,deps:s,next:null},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(s=r.next,r.next=t,t.next=s,e.lastEffect=t)),t}function q_(){return _r().memoizedState}function Bl(t,e,r,s){var n=$r();Ge.flags|=t,n.memoizedState=xa(1|e,r,void 0,s===void 0?null:s)}function Fc(t,e,r,s){var n=_r();s=s===void 0?null:s;var i=void 0;if(nt!==null){var c=nt.memoizedState;if(i=c.destroy,s!==null&&xf(s,c.deps)){n.memoizedState=xa(e,r,i,s);return}}Ge.flags|=t,n.memoizedState=xa(1|e,r,i,s)}function fm(t,e){return Bl(8390656,8,t,e)}function Sf(t,e){return Fc(2048,8,t,e)}function G_(t,e){return Fc(4,2,t,e)}function V_(t,e){return Fc(4,4,t,e)}function K_(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function J_(t,e,r){return r=r!=null?r.concat([t]):null,Fc(4,4,K_.bind(null,e,t),r)}function Cf(){}function Q_(t,e){var r=_r();e=e===void 0?null:e;var s=r.memoizedState;return s!==null&&e!==null&&xf(e,s[1])?s[0]:(r.memoizedState=[t,e],t)}function Z_(t,e){var r=_r();e=e===void 0?null:e;var s=r.memoizedState;return s!==null&&e!==null&&xf(e,s[1])?s[0]:(t=t(),r.memoizedState=[t,e],t)}function Y_(t,e,r){return zn&21?(Or(r,e)||(r=s_(),Ge.lanes|=r,Wn|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,zt=!0),t.memoizedState=r)}function o1(t,e){var r=Pe;Pe=r!==0&&4>r?r:4,t(!0);var s=Cu.transition;Cu.transition={};try{t(!1),e()}finally{Pe=r,Cu.transition=s}}function X_(){return _r().memoizedState}function a1(t,e,r){var s=Xs(t);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},ey(t))ty(e,r);else if(r=I_(t,e,r,s),r!==null){var n=It();Tr(r,t,s,n),ry(r,e,s)}}function l1(t,e,r){var s=Xs(t),n={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(ey(t))ty(e,n);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var c=e.lastRenderedState,o=i(c,r);if(n.hasEagerState=!0,n.eagerState=o,Or(o,c)){var l=e.interleaved;l===null?(n.next=n,mf(e)):(n.next=l.next,l.next=n),e.interleaved=n;return}}catch{}finally{}r=I_(t,e,n,s),r!==null&&(n=It(),Tr(r,t,s,n),ry(r,e,s))}}function ey(t){var e=t.alternate;return t===Ge||e!==null&&e===Ge}function ty(t,e){Yo=uc=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function ry(t,e,r){if(r&4194240){var s=e.lanes;s&=t.pendingLanes,r|=s,e.lanes=r,ef(t,r)}}var dc={readContext:vr,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},c1={readContext:vr,useCallback:function(t,e){return $r().memoizedState=[t,e===void 0?null:e],t},useContext:vr,useEffect:fm,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Bl(4194308,4,K_.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Bl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Bl(4,2,t,e)},useMemo:function(t,e){var r=$r();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var s=$r();return e=r!==void 0?r(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=a1.bind(null,Ge,t),[s.memoizedState,t]},useRef:function(t){var e=$r();return t={current:t},e.memoizedState=t},useState:hm,useDebugValue:Cf,useDeferredValue:function(t){return $r().memoizedState=t},useTransition:function(){var t=hm(!1),e=t[0];return t=o1.bind(null,t[1]),$r().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var s=Ge,n=$r();if(He){if(r===void 0)throw Error(Q(407));r=r()}else{if(r=e(),ht===null)throw Error(Q(349));zn&30||F_(s,e,r)}n.memoizedState=r;var i={value:r,getSnapshot:e};return n.queue=i,fm(H_.bind(null,s,i,t),[t]),s.flags|=2048,xa(9,U_.bind(null,s,i,r,e),void 0,null),r},useId:function(){var t=$r(),e=ht.identifierPrefix;if(He){var r=ls,s=as;r=(s&~(1<<32-Nr(s)-1)).toString(32)+r,e=":"+e+"R"+r,r=_a++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=i1++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},u1={readContext:vr,useCallback:Q_,useContext:vr,useEffect:Sf,useImperativeHandle:J_,useInsertionEffect:G_,useLayoutEffect:V_,useMemo:Z_,useReducer:ku,useRef:q_,useState:function(){return ku(ya)},useDebugValue:Cf,useDeferredValue:function(t){var e=_r();return Y_(e,nt.memoizedState,t)},useTransition:function(){var t=ku(ya)[0],e=_r().memoizedState;return[t,e]},useMutableSource:B_,useSyncExternalStore:$_,useId:X_,unstable_isNewReconciler:!1},d1={readContext:vr,useCallback:Q_,useContext:vr,useEffect:Sf,useImperativeHandle:J_,useInsertionEffect:G_,useLayoutEffect:V_,useMemo:Z_,useReducer:Eu,useRef:q_,useState:function(){return Eu(ya)},useDebugValue:Cf,useDeferredValue:function(t){var e=_r();return nt===null?e.memoizedState=t:Y_(e,nt.memoizedState,t)},useTransition:function(){var t=Eu(ya)[0],e=_r().memoizedState;return[t,e]},useMutableSource:B_,useSyncExternalStore:$_,useId:X_,unstable_isNewReconciler:!1};function br(t,e){if(t&&t.defaultProps){e=Ve({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Nd(t,e,r,s){e=t.memoizedState,r=r(s,e),r=r==null?e:Ve({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Uc={isMounted:function(t){return(t=t._reactInternals)?ei(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var s=It(),n=Xs(t),i=cs(s,n);i.payload=e,r!=null&&(i.callback=r),e=Zs(t,i,n),e!==null&&(Tr(e,t,n,s),Dl(e,t,n))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var s=It(),n=Xs(t),i=cs(s,n);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=Zs(t,i,n),e!==null&&(Tr(e,t,n,s),Dl(e,t,n))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=It(),s=Xs(t),n=cs(r,s);n.tag=2,e!=null&&(n.callback=e),e=Zs(t,n,s),e!==null&&(Tr(e,t,s,r),Dl(e,t,s))}};function pm(t,e,r,s,n,i,c){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,c):e.prototype&&e.prototype.isPureReactComponent?!ha(r,s)||!ha(n,i):!0}function sy(t,e,r){var s=!1,n=on,i=e.contextType;return typeof i=="object"&&i!==null?i=vr(i):(n=qt(e)?Un:Rt.current,s=e.contextTypes,i=(s=s!=null)?to(t,n):on),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Uc,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=i),e}function mm(t,e,r,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,s),e.state!==t&&Uc.enqueueReplaceState(e,e.state,null)}function Td(t,e,r,s){var n=t.stateNode;n.props=r,n.state=t.memoizedState,n.refs={},gf(t);var i=e.contextType;typeof i=="object"&&i!==null?n.context=vr(i):(i=qt(e)?Un:Rt.current,n.context=to(t,i)),n.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Nd(t,e,i,r),n.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&Uc.enqueueReplaceState(n,n.state,null),lc(t,r,n,s),n.state=t.memoizedState),typeof n.componentDidMount=="function"&&(t.flags|=4194308)}function io(t,e){try{var r="",s=e;do r+=$w(s),s=s.return;while(s);var n=r}catch(i){n=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:n,digest:null}}function ju(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Ad(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var h1=typeof WeakMap=="function"?WeakMap:Map;function ny(t,e,r){r=cs(-1,r),r.tag=3,r.payload={element:null};var s=e.value;return r.callback=function(){fc||(fc=!0,Ud=s),Ad(t,e)},r}function iy(t,e,r){r=cs(-1,r),r.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var n=e.value;r.payload=function(){return s(n)},r.callback=function(){Ad(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Ad(t,e),typeof s!="function"&&(Ys===null?Ys=new Set([this]):Ys.add(this));var c=e.stack;this.componentDidCatch(e.value,{componentStack:c!==null?c:""})}),r}function gm(t,e,r){var s=t.pingCache;if(s===null){s=t.pingCache=new h1;var n=new Set;s.set(e,n)}else n=s.get(e),n===void 0&&(n=new Set,s.set(e,n));n.has(r)||(n.add(r),t=E1.bind(null,t,e,r),e.then(t,t))}function vm(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function _m(t,e,r,s,n){return t.mode&1?(t.flags|=65536,t.lanes=n,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=cs(-1,1),e.tag=2,Zs(r,e,1))),r.lanes|=1),t)}var f1=vs.ReactCurrentOwner,zt=!1;function Pt(t,e,r,s){e.child=t===null?L_(e,null,r,s):so(e,t.child,r,s)}function ym(t,e,r,s,n){r=r.render;var i=e.ref;return Mi(e,n),s=wf(t,e,r,s,i,n),r=bf(),t!==null&&!zt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n,ms(t,e,n)):(He&&r&&cf(e),e.flags|=1,Pt(t,e,s,n),e.child)}function xm(t,e,r,s,n){if(t===null){var i=r.type;return typeof i=="function"&&!Of(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,oy(t,e,i,s,n)):(t=Hl(r.type,null,s,e,e.mode,n),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&n)){var c=i.memoizedProps;if(r=r.compare,r=r!==null?r:ha,r(c,s)&&t.ref===e.ref)return ms(t,e,n)}return e.flags|=1,t=en(i,s),t.ref=e.ref,t.return=e,e.child=t}function oy(t,e,r,s,n){if(t!==null){var i=t.memoizedProps;if(ha(i,s)&&t.ref===e.ref)if(zt=!1,e.pendingProps=s=i,(t.lanes&n)!==0)t.flags&131072&&(zt=!0);else return e.lanes=t.lanes,ms(t,e,n)}return Od(t,e,r,s,n)}function ay(t,e,r){var s=e.pendingProps,n=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Be(Ni,Yt),Yt|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Be(Ni,Yt),Yt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:r,Be(Ni,Yt),Yt|=s}else i!==null?(s=i.baseLanes|r,e.memoizedState=null):s=r,Be(Ni,Yt),Yt|=s;return Pt(t,e,n,r),e.child}function ly(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Od(t,e,r,s,n){var i=qt(r)?Un:Rt.current;return i=to(e,i),Mi(e,n),r=wf(t,e,r,s,i,n),s=bf(),t!==null&&!zt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n,ms(t,e,n)):(He&&s&&cf(e),e.flags|=1,Pt(t,e,r,n),e.child)}function wm(t,e,r,s,n){if(qt(r)){var i=!0;sc(e)}else i=!1;if(Mi(e,n),e.stateNode===null)$l(t,e),sy(e,r,s),Td(e,r,s,n),s=!0;else if(t===null){var c=e.stateNode,o=e.memoizedProps;c.props=o;var l=c.context,d=r.contextType;typeof d=="object"&&d!==null?d=vr(d):(d=qt(r)?Un:Rt.current,d=to(e,d));var g=r.getDerivedStateFromProps,m=typeof g=="function"||typeof c.getSnapshotBeforeUpdate=="function";m||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(o!==s||l!==d)&&mm(e,c,s,d),Rs=!1;var v=e.memoizedState;c.state=v,lc(e,s,c,n),l=e.memoizedState,o!==s||v!==l||Wt.current||Rs?(typeof g=="function"&&(Nd(e,r,g,s),l=e.memoizedState),(o=Rs||pm(e,r,o,s,v,l,d))?(m||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(e.flags|=4194308)):(typeof c.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),c.props=s,c.state=l,c.context=d,s=o):(typeof c.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{c=e.stateNode,D_(t,e),o=e.memoizedProps,d=e.type===e.elementType?o:br(e.type,o),c.props=d,m=e.pendingProps,v=c.context,l=r.contextType,typeof l=="object"&&l!==null?l=vr(l):(l=qt(r)?Un:Rt.current,l=to(e,l));var y=r.getDerivedStateFromProps;(g=typeof y=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(o!==m||v!==l)&&mm(e,c,s,l),Rs=!1,v=e.memoizedState,c.state=v,lc(e,s,c,n);var w=e.memoizedState;o!==m||v!==w||Wt.current||Rs?(typeof y=="function"&&(Nd(e,r,y,s),w=e.memoizedState),(d=Rs||pm(e,r,d,s,v,w,l)||!1)?(g||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(s,w,l),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(s,w,l)),typeof c.componentDidUpdate=="function"&&(e.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof c.componentDidUpdate!="function"||o===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=w),c.props=s,c.state=w,c.context=l,s=d):(typeof c.componentDidUpdate!="function"||o===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),s=!1)}return Pd(t,e,r,s,i,n)}function Pd(t,e,r,s,n,i){ly(t,e);var c=(e.flags&128)!==0;if(!s&&!c)return n&&om(e,r,!1),ms(t,e,i);s=e.stateNode,f1.current=e;var o=c&&typeof r.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&c?(e.child=so(e,t.child,null,i),e.child=so(e,null,o,i)):Pt(t,e,o,i),e.memoizedState=s.state,n&&om(e,r,!0),e.child}function cy(t){var e=t.stateNode;e.pendingContext?im(t,e.pendingContext,e.pendingContext!==e.context):e.context&&im(t,e.context,!1),vf(t,e.containerInfo)}function bm(t,e,r,s,n){return ro(),df(n),e.flags|=256,Pt(t,e,r,s),e.child}var Ld={dehydrated:null,treeContext:null,retryLane:0};function Id(t){return{baseLanes:t,cachePool:null,transitions:null}}function uy(t,e,r){var s=e.pendingProps,n=qe.current,i=!1,c=(e.flags&128)!==0,o;if((o=c)||(o=t!==null&&t.memoizedState===null?!1:(n&2)!==0),o?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(n|=1),Be(qe,n&1),t===null)return jd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(c=s.children,t=s.fallback,i?(s=e.mode,i=e.child,c={mode:"hidden",children:c},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=c):i=Wc(c,s,0,null),t=Fn(t,s,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Id(r),e.memoizedState=Ld,t):kf(e,c));if(n=t.memoizedState,n!==null&&(o=n.dehydrated,o!==null))return p1(t,e,c,s,o,n,r);if(i){i=s.fallback,c=e.mode,n=t.child,o=n.sibling;var l={mode:"hidden",children:s.children};return!(c&1)&&e.child!==n?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=en(n,l),s.subtreeFlags=n.subtreeFlags&14680064),o!==null?i=en(o,i):(i=Fn(i,c,r,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,c=t.child.memoizedState,c=c===null?Id(r):{baseLanes:c.baseLanes|r,cachePool:null,transitions:c.transitions},i.memoizedState=c,i.childLanes=t.childLanes&~r,e.memoizedState=Ld,s}return i=t.child,t=i.sibling,s=en(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=r),s.return=e,s.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=s,e.memoizedState=null,s}function kf(t,e){return e=Wc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function hl(t,e,r,s){return s!==null&&df(s),so(e,t.child,null,r),t=kf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function p1(t,e,r,s,n,i,c){if(r)return e.flags&256?(e.flags&=-257,s=ju(Error(Q(422))),hl(t,e,c,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,n=e.mode,s=Wc({mode:"visible",children:s.children},n,0,null),i=Fn(i,n,c,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&so(e,t.child,null,c),e.child.memoizedState=Id(c),e.memoizedState=Ld,i);if(!(e.mode&1))return hl(t,e,c,null);if(n.data==="$!"){if(s=n.nextSibling&&n.nextSibling.dataset,s)var o=s.dgst;return s=o,i=Error(Q(419)),s=ju(i,s,void 0),hl(t,e,c,s)}if(o=(c&t.childLanes)!==0,zt||o){if(s=ht,s!==null){switch(c&-c){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(s.suspendedLanes|c)?0:n,n!==0&&n!==i.retryLane&&(i.retryLane=n,ps(t,n),Tr(s,t,n,-1))}return Af(),s=ju(Error(Q(421))),hl(t,e,c,s)}return n.data==="$?"?(e.flags|=128,e.child=t.child,e=j1.bind(null,t),n._reactRetry=e,null):(t=i.treeContext,rr=Qs(n.nextSibling),sr=e,He=!0,Rr=null,t!==null&&(fr[pr++]=as,fr[pr++]=ls,fr[pr++]=Hn,as=t.id,ls=t.overflow,Hn=e),e=kf(e,s.children),e.flags|=4096,e)}function Sm(t,e,r){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),Rd(t.return,e,r)}function Ru(t,e,r,s,n){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:n}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=r,i.tailMode=n)}function dy(t,e,r){var s=e.pendingProps,n=s.revealOrder,i=s.tail;if(Pt(t,e,s.children,r),s=qe.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Sm(t,r,e);else if(t.tag===19)Sm(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(Be(qe,s),!(e.mode&1))e.memoizedState=null;else switch(n){case"forwards":for(r=e.child,n=null;r!==null;)t=r.alternate,t!==null&&cc(t)===null&&(n=r),r=r.sibling;r=n,r===null?(n=e.child,e.child=null):(n=r.sibling,r.sibling=null),Ru(e,!1,n,r,i);break;case"backwards":for(r=null,n=e.child,e.child=null;n!==null;){if(t=n.alternate,t!==null&&cc(t)===null){e.child=n;break}t=n.sibling,n.sibling=r,r=n,n=t}Ru(e,!0,r,null,i);break;case"together":Ru(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $l(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ms(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Wn|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Q(153));if(e.child!==null){for(t=e.child,r=en(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=en(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function m1(t,e,r){switch(e.tag){case 3:cy(e),ro();break;case 5:M_(e);break;case 1:qt(e.type)&&sc(e);break;case 4:vf(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,n=e.memoizedProps.value;Be(oc,s._currentValue),s._currentValue=n;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Be(qe,qe.current&1),e.flags|=128,null):r&e.child.childLanes?uy(t,e,r):(Be(qe,qe.current&1),t=ms(t,e,r),t!==null?t.sibling:null);Be(qe,qe.current&1);break;case 19:if(s=(r&e.childLanes)!==0,t.flags&128){if(s)return dy(t,e,r);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Be(qe,qe.current),s)break;return null;case 22:case 23:return e.lanes=0,ay(t,e,r)}return ms(t,e,r)}var hy,Dd,fy,py;hy=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Dd=function(){};fy=function(t,e,r,s){var n=t.memoizedProps;if(n!==s){t=e.stateNode,jn(Gr.current);var i=null;switch(r){case"input":n=nd(t,n),s=nd(t,s),i=[];break;case"select":n=Ve({},n,{value:void 0}),s=Ve({},s,{value:void 0}),i=[];break;case"textarea":n=ad(t,n),s=ad(t,s),i=[];break;default:typeof n.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=tc)}cd(r,s);var c;r=null;for(d in n)if(!s.hasOwnProperty(d)&&n.hasOwnProperty(d)&&n[d]!=null)if(d==="style"){var o=n[d];for(c in o)o.hasOwnProperty(c)&&(r||(r={}),r[c]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ia.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in s){var l=s[d];if(o=n!=null?n[d]:void 0,s.hasOwnProperty(d)&&l!==o&&(l!=null||o!=null))if(d==="style")if(o){for(c in o)!o.hasOwnProperty(c)||l&&l.hasOwnProperty(c)||(r||(r={}),r[c]="");for(c in l)l.hasOwnProperty(c)&&o[c]!==l[c]&&(r||(r={}),r[c]=l[c])}else r||(i||(i=[]),i.push(d,r)),r=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ia.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&Fe("scroll",t),i||o===l||(i=[])):(i=i||[]).push(d,l))}r&&(i=i||[]).push("style",r);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};py=function(t,e,r,s){r!==s&&(e.flags|=4)};function Io(t,e){if(!He)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Et(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,s=0;if(e)for(var n=t.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags&14680064,s|=n.flags&14680064,n.return=t,n=n.sibling;else for(n=t.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags,s|=n.flags,n.return=t,n=n.sibling;return t.subtreeFlags|=s,t.childLanes=r,e}function g1(t,e,r){var s=e.pendingProps;switch(uf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(e),null;case 1:return qt(e.type)&&rc(),Et(e),null;case 3:return s=e.stateNode,no(),Ue(Wt),Ue(Rt),yf(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(ul(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Rr!==null&&(Wd(Rr),Rr=null))),Dd(t,e),Et(e),null;case 5:_f(e);var n=jn(va.current);if(r=e.type,t!==null&&e.stateNode!=null)fy(t,e,r,s,n),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(Q(166));return Et(e),null}if(t=jn(Gr.current),ul(e)){s=e.stateNode,r=e.type;var i=e.memoizedProps;switch(s[zr]=e,s[ma]=i,t=(e.mode&1)!==0,r){case"dialog":Fe("cancel",s),Fe("close",s);break;case"iframe":case"object":case"embed":Fe("load",s);break;case"video":case"audio":for(n=0;n<Ho.length;n++)Fe(Ho[n],s);break;case"source":Fe("error",s);break;case"img":case"image":case"link":Fe("error",s),Fe("load",s);break;case"details":Fe("toggle",s);break;case"input":Op(s,i),Fe("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},Fe("invalid",s);break;case"textarea":Lp(s,i),Fe("invalid",s)}cd(r,i),n=null;for(var c in i)if(i.hasOwnProperty(c)){var o=i[c];c==="children"?typeof o=="string"?s.textContent!==o&&(i.suppressHydrationWarning!==!0&&cl(s.textContent,o,t),n=["children",o]):typeof o=="number"&&s.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&cl(s.textContent,o,t),n=["children",""+o]):ia.hasOwnProperty(c)&&o!=null&&c==="onScroll"&&Fe("scroll",s)}switch(r){case"input":tl(s),Pp(s,i,!0);break;case"textarea":tl(s),Ip(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=tc)}s=n,e.updateQueue=s,s!==null&&(e.flags|=4)}else{c=n.nodeType===9?n:n.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Hv(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=c.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=c.createElement(r,{is:s.is}):(t=c.createElement(r),r==="select"&&(c=t,s.multiple?c.multiple=!0:s.size&&(c.size=s.size))):t=c.createElementNS(t,r),t[zr]=e,t[ma]=s,hy(t,e,!1,!1),e.stateNode=t;e:{switch(c=ud(r,s),r){case"dialog":Fe("cancel",t),Fe("close",t),n=s;break;case"iframe":case"object":case"embed":Fe("load",t),n=s;break;case"video":case"audio":for(n=0;n<Ho.length;n++)Fe(Ho[n],t);n=s;break;case"source":Fe("error",t),n=s;break;case"img":case"image":case"link":Fe("error",t),Fe("load",t),n=s;break;case"details":Fe("toggle",t),n=s;break;case"input":Op(t,s),n=nd(t,s),Fe("invalid",t);break;case"option":n=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},n=Ve({},s,{value:void 0}),Fe("invalid",t);break;case"textarea":Lp(t,s),n=ad(t,s),Fe("invalid",t);break;default:n=s}cd(r,n),o=n;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?qv(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&zv(t,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&oa(t,l):typeof l=="number"&&oa(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ia.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Fe("scroll",t):l!=null&&Kh(t,i,l,c))}switch(r){case"input":tl(t),Pp(t,s,!1);break;case"textarea":tl(t),Ip(t);break;case"option":s.value!=null&&t.setAttribute("value",""+nn(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?Pi(t,!!s.multiple,i,!1):s.defaultValue!=null&&Pi(t,!!s.multiple,s.defaultValue,!0);break;default:typeof n.onClick=="function"&&(t.onclick=tc)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Et(e),null;case 6:if(t&&e.stateNode!=null)py(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(Q(166));if(r=jn(va.current),jn(Gr.current),ul(e)){if(s=e.stateNode,r=e.memoizedProps,s[zr]=e,(i=s.nodeValue!==r)&&(t=sr,t!==null))switch(t.tag){case 3:cl(s.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&cl(s.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[zr]=e,e.stateNode=s}return Et(e),null;case 13:if(Ue(qe),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(He&&rr!==null&&e.mode&1&&!(e.flags&128))O_(),ro(),e.flags|=98560,i=!1;else if(i=ul(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(Q(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Q(317));i[zr]=e}else ro(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Et(e),i=!1}else Rr!==null&&(Wd(Rr),Rr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||qe.current&1?ot===0&&(ot=3):Af())),e.updateQueue!==null&&(e.flags|=4),Et(e),null);case 4:return no(),Dd(t,e),t===null&&fa(e.stateNode.containerInfo),Et(e),null;case 10:return pf(e.type._context),Et(e),null;case 17:return qt(e.type)&&rc(),Et(e),null;case 19:if(Ue(qe),i=e.memoizedState,i===null)return Et(e),null;if(s=(e.flags&128)!==0,c=i.rendering,c===null)if(s)Io(i,!1);else{if(ot!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(c=cc(t),c!==null){for(e.flags|=128,Io(i,!1),s=c.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=r,r=e.child;r!==null;)i=r,t=s,i.flags&=14680066,c=i.alternate,c===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,t=c.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Be(qe,qe.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ye()>oo&&(e.flags|=128,s=!0,Io(i,!1),e.lanes=4194304)}else{if(!s)if(t=cc(c),t!==null){if(e.flags|=128,s=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Io(i,!0),i.tail===null&&i.tailMode==="hidden"&&!c.alternate&&!He)return Et(e),null}else 2*Ye()-i.renderingStartTime>oo&&r!==1073741824&&(e.flags|=128,s=!0,Io(i,!1),e.lanes=4194304);i.isBackwards?(c.sibling=e.child,e.child=c):(r=i.last,r!==null?r.sibling=c:e.child=c,i.last=c)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ye(),e.sibling=null,r=qe.current,Be(qe,s?r&1|2:r&1),e):(Et(e),null);case 22:case 23:return Tf(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Yt&1073741824&&(Et(e),e.subtreeFlags&6&&(e.flags|=8192)):Et(e),null;case 24:return null;case 25:return null}throw Error(Q(156,e.tag))}function v1(t,e){switch(uf(e),e.tag){case 1:return qt(e.type)&&rc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return no(),Ue(Wt),Ue(Rt),yf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _f(e),null;case 13:if(Ue(qe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Q(340));ro()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ue(qe),null;case 4:return no(),null;case 10:return pf(e.type._context),null;case 22:case 23:return Tf(),null;case 24:return null;default:return null}}var fl=!1,jt=!1,_1=typeof WeakSet=="function"?WeakSet:Set,oe=null;function Ri(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){Qe(t,e,s)}else r.current=null}function Md(t,e,r){try{r()}catch(s){Qe(t,e,s)}}var Cm=!1;function y1(t,e){if(xd=Yl,t=y_(),lf(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var n=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var c=0,o=-1,l=-1,d=0,g=0,m=t,v=null;t:for(;;){for(var y;m!==r||n!==0&&m.nodeType!==3||(o=c+n),m!==i||s!==0&&m.nodeType!==3||(l=c+s),m.nodeType===3&&(c+=m.nodeValue.length),(y=m.firstChild)!==null;)v=m,m=y;for(;;){if(m===t)break t;if(v===r&&++d===n&&(o=c),v===i&&++g===s&&(l=c),(y=m.nextSibling)!==null)break;m=v,v=m.parentNode}m=y}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(wd={focusedElem:t,selectionRange:r},Yl=!1,oe=e;oe!==null;)if(e=oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,oe=t;else for(;oe!==null;){e=oe;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var _=w.memoizedProps,p=w.memoizedState,h=e.stateNode,u=h.getSnapshotBeforeUpdate(e.elementType===e.type?_:br(e.type,_),p);h.__reactInternalSnapshotBeforeUpdate=u}break;case 3:var f=e.stateNode.containerInfo;f.nodeType===1?f.textContent="":f.nodeType===9&&f.documentElement&&f.removeChild(f.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(x){Qe(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,oe=t;break}oe=e.return}return w=Cm,Cm=!1,w}function Xo(t,e,r){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var n=s=s.next;do{if((n.tag&t)===t){var i=n.destroy;n.destroy=void 0,i!==void 0&&Md(e,r,i)}n=n.next}while(n!==s)}}function Hc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var s=r.create;r.destroy=s()}r=r.next}while(r!==e)}}function Bd(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function my(t){var e=t.alternate;e!==null&&(t.alternate=null,my(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[zr],delete e[ma],delete e[Cd],delete e[t1],delete e[r1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function gy(t){return t.tag===5||t.tag===3||t.tag===4}function km(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||gy(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function $d(t,e,r){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=tc));else if(s!==4&&(t=t.child,t!==null))for($d(t,e,r),t=t.sibling;t!==null;)$d(t,e,r),t=t.sibling}function Fd(t,e,r){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(Fd(t,e,r),t=t.sibling;t!==null;)Fd(t,e,r),t=t.sibling}var yt=null,Er=!1;function ys(t,e,r){for(r=r.child;r!==null;)vy(t,e,r),r=r.sibling}function vy(t,e,r){if(qr&&typeof qr.onCommitFiberUnmount=="function")try{qr.onCommitFiberUnmount(Lc,r)}catch{}switch(r.tag){case 5:jt||Ri(r,e);case 6:var s=yt,n=Er;yt=null,ys(t,e,r),yt=s,Er=n,yt!==null&&(Er?(t=yt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):yt.removeChild(r.stateNode));break;case 18:yt!==null&&(Er?(t=yt,r=r.stateNode,t.nodeType===8?wu(t.parentNode,r):t.nodeType===1&&wu(t,r),ua(t)):wu(yt,r.stateNode));break;case 4:s=yt,n=Er,yt=r.stateNode.containerInfo,Er=!0,ys(t,e,r),yt=s,Er=n;break;case 0:case 11:case 14:case 15:if(!jt&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){n=s=s.next;do{var i=n,c=i.destroy;i=i.tag,c!==void 0&&(i&2||i&4)&&Md(r,e,c),n=n.next}while(n!==s)}ys(t,e,r);break;case 1:if(!jt&&(Ri(r,e),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(o){Qe(r,e,o)}ys(t,e,r);break;case 21:ys(t,e,r);break;case 22:r.mode&1?(jt=(s=jt)||r.memoizedState!==null,ys(t,e,r),jt=s):ys(t,e,r);break;default:ys(t,e,r)}}function Em(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new _1),e.forEach(function(s){var n=R1.bind(null,t,s);r.has(s)||(r.add(s),s.then(n,n))})}}function xr(t,e){var r=e.deletions;if(r!==null)for(var s=0;s<r.length;s++){var n=r[s];try{var i=t,c=e,o=c;e:for(;o!==null;){switch(o.tag){case 5:yt=o.stateNode,Er=!1;break e;case 3:yt=o.stateNode.containerInfo,Er=!0;break e;case 4:yt=o.stateNode.containerInfo,Er=!0;break e}o=o.return}if(yt===null)throw Error(Q(160));vy(i,c,n),yt=null,Er=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(d){Qe(n,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)_y(e,t),e=e.sibling}function _y(t,e){var r=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(xr(e,t),Mr(t),s&4){try{Xo(3,t,t.return),Hc(3,t)}catch(_){Qe(t,t.return,_)}try{Xo(5,t,t.return)}catch(_){Qe(t,t.return,_)}}break;case 1:xr(e,t),Mr(t),s&512&&r!==null&&Ri(r,r.return);break;case 5:if(xr(e,t),Mr(t),s&512&&r!==null&&Ri(r,r.return),t.flags&32){var n=t.stateNode;try{oa(n,"")}catch(_){Qe(t,t.return,_)}}if(s&4&&(n=t.stateNode,n!=null)){var i=t.memoizedProps,c=r!==null?r.memoizedProps:i,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&Fv(n,i),ud(o,c);var d=ud(o,i);for(c=0;c<l.length;c+=2){var g=l[c],m=l[c+1];g==="style"?qv(n,m):g==="dangerouslySetInnerHTML"?zv(n,m):g==="children"?oa(n,m):Kh(n,g,m,d)}switch(o){case"input":id(n,i);break;case"textarea":Uv(n,i);break;case"select":var v=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!i.multiple;var y=i.value;y!=null?Pi(n,!!i.multiple,y,!1):v!==!!i.multiple&&(i.defaultValue!=null?Pi(n,!!i.multiple,i.defaultValue,!0):Pi(n,!!i.multiple,i.multiple?[]:"",!1))}n[ma]=i}catch(_){Qe(t,t.return,_)}}break;case 6:if(xr(e,t),Mr(t),s&4){if(t.stateNode===null)throw Error(Q(162));n=t.stateNode,i=t.memoizedProps;try{n.nodeValue=i}catch(_){Qe(t,t.return,_)}}break;case 3:if(xr(e,t),Mr(t),s&4&&r!==null&&r.memoizedState.isDehydrated)try{ua(e.containerInfo)}catch(_){Qe(t,t.return,_)}break;case 4:xr(e,t),Mr(t);break;case 13:xr(e,t),Mr(t),n=t.child,n.flags&8192&&(i=n.memoizedState!==null,n.stateNode.isHidden=i,!i||n.alternate!==null&&n.alternate.memoizedState!==null||(Rf=Ye())),s&4&&Em(t);break;case 22:if(g=r!==null&&r.memoizedState!==null,t.mode&1?(jt=(d=jt)||g,xr(e,t),jt=d):xr(e,t),Mr(t),s&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!g&&t.mode&1)for(oe=t,g=t.child;g!==null;){for(m=oe=g;oe!==null;){switch(v=oe,y=v.child,v.tag){case 0:case 11:case 14:case 15:Xo(4,v,v.return);break;case 1:Ri(v,v.return);var w=v.stateNode;if(typeof w.componentWillUnmount=="function"){s=v,r=v.return;try{e=s,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(_){Qe(s,r,_)}}break;case 5:Ri(v,v.return);break;case 22:if(v.memoizedState!==null){Rm(m);continue}}y!==null?(y.return=v,oe=y):Rm(m)}g=g.sibling}e:for(g=null,m=t;;){if(m.tag===5){if(g===null){g=m;try{n=m.stateNode,d?(i=n.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=m.stateNode,l=m.memoizedProps.style,c=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Wv("display",c))}catch(_){Qe(t,t.return,_)}}}else if(m.tag===6){if(g===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(_){Qe(t,t.return,_)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;g===m&&(g=null),m=m.return}g===m&&(g=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:xr(e,t),Mr(t),s&4&&Em(t);break;case 21:break;default:xr(e,t),Mr(t)}}function Mr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(gy(r)){var s=r;break e}r=r.return}throw Error(Q(160))}switch(s.tag){case 5:var n=s.stateNode;s.flags&32&&(oa(n,""),s.flags&=-33);var i=km(t);Fd(t,i,n);break;case 3:case 4:var c=s.stateNode.containerInfo,o=km(t);$d(t,o,c);break;default:throw Error(Q(161))}}catch(l){Qe(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function x1(t,e,r){oe=t,yy(t)}function yy(t,e,r){for(var s=(t.mode&1)!==0;oe!==null;){var n=oe,i=n.child;if(n.tag===22&&s){var c=n.memoizedState!==null||fl;if(!c){var o=n.alternate,l=o!==null&&o.memoizedState!==null||jt;o=fl;var d=jt;if(fl=c,(jt=l)&&!d)for(oe=n;oe!==null;)c=oe,l=c.child,c.tag===22&&c.memoizedState!==null?Nm(n):l!==null?(l.return=c,oe=l):Nm(n);for(;i!==null;)oe=i,yy(i),i=i.sibling;oe=n,fl=o,jt=d}jm(t)}else n.subtreeFlags&8772&&i!==null?(i.return=n,oe=i):jm(t)}}function jm(t){for(;oe!==null;){var e=oe;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:jt||Hc(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!jt)if(r===null)s.componentDidMount();else{var n=e.elementType===e.type?r.memoizedProps:br(e.type,r.memoizedProps);s.componentDidUpdate(n,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&dm(e,i,s);break;case 3:var c=e.updateQueue;if(c!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}dm(e,c,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var g=d.memoizedState;if(g!==null){var m=g.dehydrated;m!==null&&ua(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}jt||e.flags&512&&Bd(e)}catch(v){Qe(e,e.return,v)}}if(e===t){oe=null;break}if(r=e.sibling,r!==null){r.return=e.return,oe=r;break}oe=e.return}}function Rm(t){for(;oe!==null;){var e=oe;if(e===t){oe=null;break}var r=e.sibling;if(r!==null){r.return=e.return,oe=r;break}oe=e.return}}function Nm(t){for(;oe!==null;){var e=oe;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Hc(4,e)}catch(l){Qe(e,r,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var n=e.return;try{s.componentDidMount()}catch(l){Qe(e,n,l)}}var i=e.return;try{Bd(e)}catch(l){Qe(e,i,l)}break;case 5:var c=e.return;try{Bd(e)}catch(l){Qe(e,c,l)}}}catch(l){Qe(e,e.return,l)}if(e===t){oe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,oe=o;break}oe=e.return}}var w1=Math.ceil,hc=vs.ReactCurrentDispatcher,Ef=vs.ReactCurrentOwner,gr=vs.ReactCurrentBatchConfig,Ne=0,ht=null,rt=null,xt=0,Yt=0,Ni=un(0),ot=0,wa=null,Wn=0,zc=0,jf=0,ea=null,Ht=null,Rf=0,oo=1/0,es=null,fc=!1,Ud=null,Ys=null,pl=!1,Ws=null,pc=0,ta=0,Hd=null,Fl=-1,Ul=0;function It(){return Ne&6?Ye():Fl!==-1?Fl:Fl=Ye()}function Xs(t){return t.mode&1?Ne&2&&xt!==0?xt&-xt:n1.transition!==null?(Ul===0&&(Ul=s_()),Ul):(t=Pe,t!==0||(t=window.event,t=t===void 0?16:u_(t.type)),t):1}function Tr(t,e,r,s){if(50<ta)throw ta=0,Hd=null,Error(Q(185));Fa(t,r,s),(!(Ne&2)||t!==ht)&&(t===ht&&(!(Ne&2)&&(zc|=r),ot===4&&Os(t,xt)),Gt(t,s),r===1&&Ne===0&&!(e.mode&1)&&(oo=Ye()+500,$c&&dn()))}function Gt(t,e){var r=t.callbackNode;nb(t,e);var s=Zl(t,t===ht?xt:0);if(s===0)r!==null&&Bp(r),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(r!=null&&Bp(r),e===1)t.tag===0?s1(Tm.bind(null,t)):N_(Tm.bind(null,t)),Xb(function(){!(Ne&6)&&dn()}),r=null;else{switch(n_(s)){case 1:r=Xh;break;case 4:r=t_;break;case 16:r=Ql;break;case 536870912:r=r_;break;default:r=Ql}r=jy(r,xy.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function xy(t,e){if(Fl=-1,Ul=0,Ne&6)throw Error(Q(327));var r=t.callbackNode;if(Bi()&&t.callbackNode!==r)return null;var s=Zl(t,t===ht?xt:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=mc(t,s);else{e=s;var n=Ne;Ne|=2;var i=by();(ht!==t||xt!==e)&&(es=null,oo=Ye()+500,$n(t,e));do try{C1();break}catch(o){wy(t,o)}while(!0);ff(),hc.current=i,Ne=n,rt!==null?e=0:(ht=null,xt=0,e=ot)}if(e!==0){if(e===2&&(n=md(t),n!==0&&(s=n,e=zd(t,n))),e===1)throw r=wa,$n(t,0),Os(t,s),Gt(t,Ye()),r;if(e===6)Os(t,s);else{if(n=t.current.alternate,!(s&30)&&!b1(n)&&(e=mc(t,s),e===2&&(i=md(t),i!==0&&(s=i,e=zd(t,i))),e===1))throw r=wa,$n(t,0),Os(t,s),Gt(t,Ye()),r;switch(t.finishedWork=n,t.finishedLanes=s,e){case 0:case 1:throw Error(Q(345));case 2:wn(t,Ht,es);break;case 3:if(Os(t,s),(s&130023424)===s&&(e=Rf+500-Ye(),10<e)){if(Zl(t,0)!==0)break;if(n=t.suspendedLanes,(n&s)!==s){It(),t.pingedLanes|=t.suspendedLanes&n;break}t.timeoutHandle=Sd(wn.bind(null,t,Ht,es),e);break}wn(t,Ht,es);break;case 4:if(Os(t,s),(s&4194240)===s)break;for(e=t.eventTimes,n=-1;0<s;){var c=31-Nr(s);i=1<<c,c=e[c],c>n&&(n=c),s&=~i}if(s=n,s=Ye()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*w1(s/1960))-s,10<s){t.timeoutHandle=Sd(wn.bind(null,t,Ht,es),s);break}wn(t,Ht,es);break;case 5:wn(t,Ht,es);break;default:throw Error(Q(329))}}}return Gt(t,Ye()),t.callbackNode===r?xy.bind(null,t):null}function zd(t,e){var r=ea;return t.current.memoizedState.isDehydrated&&($n(t,e).flags|=256),t=mc(t,e),t!==2&&(e=Ht,Ht=r,e!==null&&Wd(e)),t}function Wd(t){Ht===null?Ht=t:Ht.push.apply(Ht,t)}function b1(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var n=r[s],i=n.getSnapshot;n=n.value;try{if(!Or(i(),n))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Os(t,e){for(e&=~jf,e&=~zc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Nr(e),s=1<<r;t[r]=-1,e&=~s}}function Tm(t){if(Ne&6)throw Error(Q(327));Bi();var e=Zl(t,0);if(!(e&1))return Gt(t,Ye()),null;var r=mc(t,e);if(t.tag!==0&&r===2){var s=md(t);s!==0&&(e=s,r=zd(t,s))}if(r===1)throw r=wa,$n(t,0),Os(t,e),Gt(t,Ye()),r;if(r===6)throw Error(Q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,wn(t,Ht,es),Gt(t,Ye()),null}function Nf(t,e){var r=Ne;Ne|=1;try{return t(e)}finally{Ne=r,Ne===0&&(oo=Ye()+500,$c&&dn())}}function qn(t){Ws!==null&&Ws.tag===0&&!(Ne&6)&&Bi();var e=Ne;Ne|=1;var r=gr.transition,s=Pe;try{if(gr.transition=null,Pe=1,t)return t()}finally{Pe=s,gr.transition=r,Ne=e,!(Ne&6)&&dn()}}function Tf(){Yt=Ni.current,Ue(Ni)}function $n(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Yb(r)),rt!==null)for(r=rt.return;r!==null;){var s=r;switch(uf(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&rc();break;case 3:no(),Ue(Wt),Ue(Rt),yf();break;case 5:_f(s);break;case 4:no();break;case 13:Ue(qe);break;case 19:Ue(qe);break;case 10:pf(s.type._context);break;case 22:case 23:Tf()}r=r.return}if(ht=t,rt=t=en(t.current,null),xt=Yt=e,ot=0,wa=null,jf=zc=Wn=0,Ht=ea=null,En!==null){for(e=0;e<En.length;e++)if(r=En[e],s=r.interleaved,s!==null){r.interleaved=null;var n=s.next,i=r.pending;if(i!==null){var c=i.next;i.next=n,s.next=c}r.pending=s}En=null}return t}function wy(t,e){do{var r=rt;try{if(ff(),Ml.current=dc,uc){for(var s=Ge.memoizedState;s!==null;){var n=s.queue;n!==null&&(n.pending=null),s=s.next}uc=!1}if(zn=0,dt=nt=Ge=null,Yo=!1,_a=0,Ef.current=null,r===null||r.return===null){ot=1,wa=e,rt=null;break}e:{var i=t,c=r.return,o=r,l=e;if(e=xt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,g=o,m=g.tag;if(!(g.mode&1)&&(m===0||m===11||m===15)){var v=g.alternate;v?(g.updateQueue=v.updateQueue,g.memoizedState=v.memoizedState,g.lanes=v.lanes):(g.updateQueue=null,g.memoizedState=null)}var y=vm(c);if(y!==null){y.flags&=-257,_m(y,c,o,i,e),y.mode&1&&gm(i,d,e),e=y,l=d;var w=e.updateQueue;if(w===null){var _=new Set;_.add(l),e.updateQueue=_}else w.add(l);break e}else{if(!(e&1)){gm(i,d,e),Af();break e}l=Error(Q(426))}}else if(He&&o.mode&1){var p=vm(c);if(p!==null){!(p.flags&65536)&&(p.flags|=256),_m(p,c,o,i,e),df(io(l,o));break e}}i=l=io(l,o),ot!==4&&(ot=2),ea===null?ea=[i]:ea.push(i),i=c;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var h=ny(i,l,e);um(i,h);break e;case 1:o=l;var u=i.type,f=i.stateNode;if(!(i.flags&128)&&(typeof u.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Ys===null||!Ys.has(f)))){i.flags|=65536,e&=-e,i.lanes|=e;var x=iy(i,o,e);um(i,x);break e}}i=i.return}while(i!==null)}Cy(r)}catch(k){e=k,rt===r&&r!==null&&(rt=r=r.return);continue}break}while(!0)}function by(){var t=hc.current;return hc.current=dc,t===null?dc:t}function Af(){(ot===0||ot===3||ot===2)&&(ot=4),ht===null||!(Wn&268435455)&&!(zc&268435455)||Os(ht,xt)}function mc(t,e){var r=Ne;Ne|=2;var s=by();(ht!==t||xt!==e)&&(es=null,$n(t,e));do try{S1();break}catch(n){wy(t,n)}while(!0);if(ff(),Ne=r,hc.current=s,rt!==null)throw Error(Q(261));return ht=null,xt=0,ot}function S1(){for(;rt!==null;)Sy(rt)}function C1(){for(;rt!==null&&!Jw();)Sy(rt)}function Sy(t){var e=Ey(t.alternate,t,Yt);t.memoizedProps=t.pendingProps,e===null?Cy(t):rt=e,Ef.current=null}function Cy(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=v1(r,e),r!==null){r.flags&=32767,rt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ot=6,rt=null;return}}else if(r=g1(r,e,Yt),r!==null){rt=r;return}if(e=e.sibling,e!==null){rt=e;return}rt=e=t}while(e!==null);ot===0&&(ot=5)}function wn(t,e,r){var s=Pe,n=gr.transition;try{gr.transition=null,Pe=1,k1(t,e,r,s)}finally{gr.transition=n,Pe=s}return null}function k1(t,e,r,s){do Bi();while(Ws!==null);if(Ne&6)throw Error(Q(327));r=t.finishedWork;var n=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Q(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(ib(t,i),t===ht&&(rt=ht=null,xt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||pl||(pl=!0,jy(Ql,function(){return Bi(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=gr.transition,gr.transition=null;var c=Pe;Pe=1;var o=Ne;Ne|=4,Ef.current=null,y1(t,r),_y(r,t),qb(wd),Yl=!!xd,wd=xd=null,t.current=r,x1(r),Qw(),Ne=o,Pe=c,gr.transition=i}else t.current=r;if(pl&&(pl=!1,Ws=t,pc=n),i=t.pendingLanes,i===0&&(Ys=null),Xw(r.stateNode),Gt(t,Ye()),e!==null)for(s=t.onRecoverableError,r=0;r<e.length;r++)n=e[r],s(n.value,{componentStack:n.stack,digest:n.digest});if(fc)throw fc=!1,t=Ud,Ud=null,t;return pc&1&&t.tag!==0&&Bi(),i=t.pendingLanes,i&1?t===Hd?ta++:(ta=0,Hd=t):ta=0,dn(),null}function Bi(){if(Ws!==null){var t=n_(pc),e=gr.transition,r=Pe;try{if(gr.transition=null,Pe=16>t?16:t,Ws===null)var s=!1;else{if(t=Ws,Ws=null,pc=0,Ne&6)throw Error(Q(331));var n=Ne;for(Ne|=4,oe=t.current;oe!==null;){var i=oe,c=i.child;if(oe.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var d=o[l];for(oe=d;oe!==null;){var g=oe;switch(g.tag){case 0:case 11:case 15:Xo(8,g,i)}var m=g.child;if(m!==null)m.return=g,oe=m;else for(;oe!==null;){g=oe;var v=g.sibling,y=g.return;if(my(g),g===d){oe=null;break}if(v!==null){v.return=y,oe=v;break}oe=y}}}var w=i.alternate;if(w!==null){var _=w.child;if(_!==null){w.child=null;do{var p=_.sibling;_.sibling=null,_=p}while(_!==null)}}oe=i}}if(i.subtreeFlags&2064&&c!==null)c.return=i,oe=c;else e:for(;oe!==null;){if(i=oe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Xo(9,i,i.return)}var h=i.sibling;if(h!==null){h.return=i.return,oe=h;break e}oe=i.return}}var u=t.current;for(oe=u;oe!==null;){c=oe;var f=c.child;if(c.subtreeFlags&2064&&f!==null)f.return=c,oe=f;else e:for(c=u;oe!==null;){if(o=oe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Hc(9,o)}}catch(k){Qe(o,o.return,k)}if(o===c){oe=null;break e}var x=o.sibling;if(x!==null){x.return=o.return,oe=x;break e}oe=o.return}}if(Ne=n,dn(),qr&&typeof qr.onPostCommitFiberRoot=="function")try{qr.onPostCommitFiberRoot(Lc,t)}catch{}s=!0}return s}finally{Pe=r,gr.transition=e}}return!1}function Am(t,e,r){e=io(r,e),e=ny(t,e,1),t=Zs(t,e,1),e=It(),t!==null&&(Fa(t,1,e),Gt(t,e))}function Qe(t,e,r){if(t.tag===3)Am(t,t,r);else for(;e!==null;){if(e.tag===3){Am(e,t,r);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ys===null||!Ys.has(s))){t=io(r,t),t=iy(e,t,1),e=Zs(e,t,1),t=It(),e!==null&&(Fa(e,1,t),Gt(e,t));break}}e=e.return}}function E1(t,e,r){var s=t.pingCache;s!==null&&s.delete(e),e=It(),t.pingedLanes|=t.suspendedLanes&r,ht===t&&(xt&r)===r&&(ot===4||ot===3&&(xt&130023424)===xt&&500>Ye()-Rf?$n(t,0):jf|=r),Gt(t,e)}function ky(t,e){e===0&&(t.mode&1?(e=nl,nl<<=1,!(nl&130023424)&&(nl=4194304)):e=1);var r=It();t=ps(t,e),t!==null&&(Fa(t,e,r),Gt(t,r))}function j1(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),ky(t,r)}function R1(t,e){var r=0;switch(t.tag){case 13:var s=t.stateNode,n=t.memoizedState;n!==null&&(r=n.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(Q(314))}s!==null&&s.delete(e),ky(t,r)}var Ey;Ey=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Wt.current)zt=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return zt=!1,m1(t,e,r);zt=!!(t.flags&131072)}else zt=!1,He&&e.flags&1048576&&T_(e,ic,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;$l(t,e),t=e.pendingProps;var n=to(e,Rt.current);Mi(e,r),n=wf(null,e,s,t,n,r);var i=bf();return e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,qt(s)?(i=!0,sc(e)):i=!1,e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,gf(e),n.updater=Uc,e.stateNode=n,n._reactInternals=e,Td(e,s,t,r),e=Pd(null,e,s,!0,i,r)):(e.tag=0,He&&i&&cf(e),Pt(null,e,n,r),e=e.child),e;case 16:s=e.elementType;e:{switch($l(t,e),t=e.pendingProps,n=s._init,s=n(s._payload),e.type=s,n=e.tag=T1(s),t=br(s,t),n){case 0:e=Od(null,e,s,t,r);break e;case 1:e=wm(null,e,s,t,r);break e;case 11:e=ym(null,e,s,t,r);break e;case 14:e=xm(null,e,s,br(s.type,t),r);break e}throw Error(Q(306,s,""))}return e;case 0:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:br(s,n),Od(t,e,s,n,r);case 1:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:br(s,n),wm(t,e,s,n,r);case 3:e:{if(cy(e),t===null)throw Error(Q(387));s=e.pendingProps,i=e.memoizedState,n=i.element,D_(t,e),lc(e,s,null,r);var c=e.memoizedState;if(s=c.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:c.cache,pendingSuspenseBoundaries:c.pendingSuspenseBoundaries,transitions:c.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){n=io(Error(Q(423)),e),e=bm(t,e,s,r,n);break e}else if(s!==n){n=io(Error(Q(424)),e),e=bm(t,e,s,r,n);break e}else for(rr=Qs(e.stateNode.containerInfo.firstChild),sr=e,He=!0,Rr=null,r=L_(e,null,s,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ro(),s===n){e=ms(t,e,r);break e}Pt(t,e,s,r)}e=e.child}return e;case 5:return M_(e),t===null&&jd(e),s=e.type,n=e.pendingProps,i=t!==null?t.memoizedProps:null,c=n.children,bd(s,n)?c=null:i!==null&&bd(s,i)&&(e.flags|=32),ly(t,e),Pt(t,e,c,r),e.child;case 6:return t===null&&jd(e),null;case 13:return uy(t,e,r);case 4:return vf(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=so(e,null,s,r):Pt(t,e,s,r),e.child;case 11:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:br(s,n),ym(t,e,s,n,r);case 7:return Pt(t,e,e.pendingProps,r),e.child;case 8:return Pt(t,e,e.pendingProps.children,r),e.child;case 12:return Pt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(s=e.type._context,n=e.pendingProps,i=e.memoizedProps,c=n.value,Be(oc,s._currentValue),s._currentValue=c,i!==null)if(Or(i.value,c)){if(i.children===n.children&&!Wt.current){e=ms(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){c=i.child;for(var l=o.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=cs(-1,r&-r),l.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var g=d.pending;g===null?l.next=l:(l.next=g.next,g.next=l),d.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Rd(i.return,r,e),o.lanes|=r;break}l=l.next}}else if(i.tag===10)c=i.type===e.type?null:i.child;else if(i.tag===18){if(c=i.return,c===null)throw Error(Q(341));c.lanes|=r,o=c.alternate,o!==null&&(o.lanes|=r),Rd(c,r,e),c=i.sibling}else c=i.child;if(c!==null)c.return=i;else for(c=i;c!==null;){if(c===e){c=null;break}if(i=c.sibling,i!==null){i.return=c.return,c=i;break}c=c.return}i=c}Pt(t,e,n.children,r),e=e.child}return e;case 9:return n=e.type,s=e.pendingProps.children,Mi(e,r),n=vr(n),s=s(n),e.flags|=1,Pt(t,e,s,r),e.child;case 14:return s=e.type,n=br(s,e.pendingProps),n=br(s.type,n),xm(t,e,s,n,r);case 15:return oy(t,e,e.type,e.pendingProps,r);case 17:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:br(s,n),$l(t,e),e.tag=1,qt(s)?(t=!0,sc(e)):t=!1,Mi(e,r),sy(e,s,n),Td(e,s,n,r),Pd(null,e,s,!0,t,r);case 19:return dy(t,e,r);case 22:return ay(t,e,r)}throw Error(Q(156,e.tag))};function jy(t,e){return e_(t,e)}function N1(t,e,r,s){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mr(t,e,r,s){return new N1(t,e,r,s)}function Of(t){return t=t.prototype,!(!t||!t.isReactComponent)}function T1(t){if(typeof t=="function")return Of(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Qh)return 11;if(t===Zh)return 14}return 2}function en(t,e){var r=t.alternate;return r===null?(r=mr(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Hl(t,e,r,s,n,i){var c=2;if(s=t,typeof t=="function")Of(t)&&(c=1);else if(typeof t=="string")c=5;else e:switch(t){case yi:return Fn(r.children,n,i,e);case Jh:c=8,n|=8;break;case ed:return t=mr(12,r,e,n|2),t.elementType=ed,t.lanes=i,t;case td:return t=mr(13,r,e,n),t.elementType=td,t.lanes=i,t;case rd:return t=mr(19,r,e,n),t.elementType=rd,t.lanes=i,t;case Mv:return Wc(r,n,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Iv:c=10;break e;case Dv:c=9;break e;case Qh:c=11;break e;case Zh:c=14;break e;case js:c=16,s=null;break e}throw Error(Q(130,t==null?t:typeof t,""))}return e=mr(c,r,e,n),e.elementType=t,e.type=s,e.lanes=i,e}function Fn(t,e,r,s){return t=mr(7,t,s,e),t.lanes=r,t}function Wc(t,e,r,s){return t=mr(22,t,s,e),t.elementType=Mv,t.lanes=r,t.stateNode={isHidden:!1},t}function Nu(t,e,r){return t=mr(6,t,null,e),t.lanes=r,t}function Tu(t,e,r){return e=mr(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function A1(t,e,r,s,n){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=uu(0),this.expirationTimes=uu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uu(0),this.identifierPrefix=s,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Pf(t,e,r,s,n,i,c,o,l){return t=new A1(t,e,r,o,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=mr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},gf(i),t}function O1(t,e,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_i,key:s==null?null:""+s,children:t,containerInfo:e,implementation:r}}function Ry(t){if(!t)return on;t=t._reactInternals;e:{if(ei(t)!==t||t.tag!==1)throw Error(Q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(qt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Q(171))}if(t.tag===1){var r=t.type;if(qt(r))return R_(t,r,e)}return e}function Ny(t,e,r,s,n,i,c,o,l){return t=Pf(r,s,!0,t,n,i,c,o,l),t.context=Ry(null),r=t.current,s=It(),n=Xs(r),i=cs(s,n),i.callback=e??null,Zs(r,i,n),t.current.lanes=n,Fa(t,n,s),Gt(t,s),t}function qc(t,e,r,s){var n=e.current,i=It(),c=Xs(n);return r=Ry(r),e.context===null?e.context=r:e.pendingContext=r,e=cs(i,c),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Zs(n,e,c),t!==null&&(Tr(t,n,c,i),Dl(t,n,c)),c}function gc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Om(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Lf(t,e){Om(t,e),(t=t.alternate)&&Om(t,e)}function P1(){return null}var Ty=typeof reportError=="function"?reportError:function(t){console.error(t)};function If(t){this._internalRoot=t}Gc.prototype.render=If.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Q(409));qc(t,e,null,null)};Gc.prototype.unmount=If.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;qn(function(){qc(null,t,null,null)}),e[fs]=null}};function Gc(t){this._internalRoot=t}Gc.prototype.unstable_scheduleHydration=function(t){if(t){var e=a_();t={blockedOn:null,target:t,priority:e};for(var r=0;r<As.length&&e!==0&&e<As[r].priority;r++);As.splice(r,0,t),r===0&&c_(t)}};function Df(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Vc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Pm(){}function L1(t,e,r,s,n){if(n){if(typeof s=="function"){var i=s;s=function(){var d=gc(c);i.call(d)}}var c=Ny(e,s,t,0,null,!1,!1,"",Pm);return t._reactRootContainer=c,t[fs]=c.current,fa(t.nodeType===8?t.parentNode:t),qn(),c}for(;n=t.lastChild;)t.removeChild(n);if(typeof s=="function"){var o=s;s=function(){var d=gc(l);o.call(d)}}var l=Pf(t,0,!1,null,null,!1,!1,"",Pm);return t._reactRootContainer=l,t[fs]=l.current,fa(t.nodeType===8?t.parentNode:t),qn(function(){qc(e,l,r,s)}),l}function Kc(t,e,r,s,n){var i=r._reactRootContainer;if(i){var c=i;if(typeof n=="function"){var o=n;n=function(){var l=gc(c);o.call(l)}}qc(e,c,t,n)}else c=L1(r,e,t,n,s);return gc(c)}i_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Uo(e.pendingLanes);r!==0&&(ef(e,r|1),Gt(e,Ye()),!(Ne&6)&&(oo=Ye()+500,dn()))}break;case 13:qn(function(){var s=ps(t,1);if(s!==null){var n=It();Tr(s,t,1,n)}}),Lf(t,1)}};tf=function(t){if(t.tag===13){var e=ps(t,134217728);if(e!==null){var r=It();Tr(e,t,134217728,r)}Lf(t,134217728)}};o_=function(t){if(t.tag===13){var e=Xs(t),r=ps(t,e);if(r!==null){var s=It();Tr(r,t,e,s)}Lf(t,e)}};a_=function(){return Pe};l_=function(t,e){var r=Pe;try{return Pe=t,e()}finally{Pe=r}};hd=function(t,e,r){switch(e){case"input":if(id(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var s=r[e];if(s!==t&&s.form===t.form){var n=Bc(s);if(!n)throw Error(Q(90));$v(s),id(s,n)}}}break;case"textarea":Uv(t,r);break;case"select":e=r.value,e!=null&&Pi(t,!!r.multiple,e,!1)}};Kv=Nf;Jv=qn;var I1={usingClientEntryPoint:!1,Events:[Ha,Si,Bc,Gv,Vv,Nf]},Do={findFiberByHostInstance:kn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},D1={bundleType:Do.bundleType,version:Do.version,rendererPackageName:Do.rendererPackageName,rendererConfig:Do.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Yv(t),t===null?null:t.stateNode},findFiberByHostInstance:Do.findFiberByHostInstance||P1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ml=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ml.isDisabled&&ml.supportsFiber)try{Lc=ml.inject(D1),qr=ml}catch{}}ar.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I1;ar.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Df(e))throw Error(Q(200));return O1(t,e,null,r)};ar.createRoot=function(t,e){if(!Df(t))throw Error(Q(299));var r=!1,s="",n=Ty;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(n=e.onRecoverableError)),e=Pf(t,1,!1,null,null,r,!1,s,n),t[fs]=e.current,fa(t.nodeType===8?t.parentNode:t),new If(e)};ar.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Q(188)):(t=Object.keys(t).join(","),Error(Q(268,t)));return t=Yv(e),t=t===null?null:t.stateNode,t};ar.flushSync=function(t){return qn(t)};ar.hydrate=function(t,e,r){if(!Vc(e))throw Error(Q(200));return Kc(null,t,e,!0,r)};ar.hydrateRoot=function(t,e,r){if(!Df(t))throw Error(Q(405));var s=r!=null&&r.hydratedSources||null,n=!1,i="",c=Ty;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(c=r.onRecoverableError)),e=Ny(e,null,t,1,r??null,n,!1,i,c),t[fs]=e.current,fa(t),s)for(t=0;t<s.length;t++)r=s[t],n=r._getVersion,n=n(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,n]:e.mutableSourceEagerHydrationData.push(r,n);return new Gc(e)};ar.render=function(t,e,r){if(!Vc(e))throw Error(Q(200));return Kc(null,t,e,!1,r)};ar.unmountComponentAtNode=function(t){if(!Vc(t))throw Error(Q(40));return t._reactRootContainer?(qn(function(){Kc(null,null,t,!1,function(){t._reactRootContainer=null,t[fs]=null})}),!0):!1};ar.unstable_batchedUpdates=Nf;ar.unstable_renderSubtreeIntoContainer=function(t,e,r,s){if(!Vc(r))throw Error(Q(200));if(t==null||t._reactInternals===void 0)throw Error(Q(38));return Kc(t,e,r,!1,s)};ar.version="18.3.1-next-f1338f8080-20240426";function Ay(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ay)}catch(t){console.error(t)}}Ay(),Av.exports=ar;var Mf=Av.exports;const M1=yv(Mf);var Oy,Lm=Mf;Oy=Lm.createRoot,Lm.hydrateRoot;function B1(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var r,s,n,i,c=[],o="",l=t.split("/");for(l[0]||l.shift();n=l.shift();)r=n[0],r==="*"?(c.push(r),o+=n[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(s=n.indexOf("?",1),i=n.indexOf(".",1),c.push(n.substring(1,~s?s:~i?i:n.length)),o+=~s&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(o+=(~s?"?":"")+"\\"+n.substring(i))):o+="/"+n;return{keys:c,pattern:new RegExp("^"+o+(e?"(?=$|/)":"/?$"),"i")}}var Py={exports:{}},Ly={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ao=R;function $1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var F1=typeof Object.is=="function"?Object.is:$1,U1=ao.useState,H1=ao.useEffect,z1=ao.useLayoutEffect,W1=ao.useDebugValue;function q1(t,e){var r=e(),s=U1({inst:{value:r,getSnapshot:e}}),n=s[0].inst,i=s[1];return z1(function(){n.value=r,n.getSnapshot=e,Au(n)&&i({inst:n})},[t,r,e]),H1(function(){return Au(n)&&i({inst:n}),t(function(){Au(n)&&i({inst:n})})},[t]),W1(r),r}function Au(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!F1(t,r)}catch{return!0}}function G1(t,e){return e()}var V1=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?G1:q1;Ly.useSyncExternalStore=ao.useSyncExternalStore!==void 0?ao.useSyncExternalStore:V1;Py.exports=Ly;var K1=Py.exports;const J1=qh.useInsertionEffect,Q1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Iy=Q1?R.useLayoutEffect:R.useEffect,Z1=J1||Iy,Bf=t=>{const e=R.useRef([t,(...r)=>e[0](...r)]).current;return Z1(()=>{e[0]=t}),e[1]},Y1="popstate",$f="pushState",Ff="replaceState",X1="hashchange",Im=[Y1,$f,Ff,X1],eS=t=>{for(const e of Im)addEventListener(e,t);return()=>{for(const e of Im)removeEventListener(e,t)}},Dy=(t,e)=>K1.useSyncExternalStore(eS,t,e),Dm=()=>location.search,tS=({ssrSearch:t}={})=>Dy(Dm,t!=null?()=>t:Dm),Mm=()=>location.pathname,rS=({ssrPath:t}={})=>Dy(Mm,t!=null?()=>t:Mm),sS=(t,{replace:e=!1,state:r=null}={})=>history[e?Ff:$f](r,"",t),nS=(t={})=>[rS(t),sS],Bm=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[Bm]>"u"){for(const t of[$f,Ff]){const e=history[t];history[t]=function(){const r=e.apply(this,arguments),s=new Event(t);return s.arguments=arguments,dispatchEvent(s),r}}Object.defineProperty(window,Bm,{value:!0})}const iS=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",My=(t="")=>t==="/"?"":t,oS=(t,e)=>t[0]==="~"?t.slice(1):My(e)+t,aS=(t="",e)=>iS(qd(My(t)),qd(e)),lS=t=>t[0]==="?"?t.slice(1):t,qd=t=>{try{return decodeURI(t)}catch{return t}},cS=t=>qd(lS(t)),By={hook:nS,searchHook:tS,parser:B1,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:t=>t,aroundNav:(t,e,r)=>t(e,r)},$y=R.createContext(By),hn=()=>R.useContext($y),Fy={},Uy=R.createContext(Fy),Hy=()=>R.useContext(Uy),Wa=t=>{const[e,r]=t.hook(t);return[aS(t.base,e),Bf((s,n)=>t.aroundNav(r,oS(s,t.base),n))]},Lr=()=>Wa(hn()),uS=()=>{const t=hn();return cS(t.searchHook(t))},Uf=(t,e,r,s)=>{const{pattern:n,keys:i}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||"*",s),c=n.exec(r)||[],[o,...l]=c;return o!==void 0?[!0,(()=>{const d=i!==!1?Object.fromEntries(i.map((m,v)=>[m,l[v]])):c.groups;let g={...l};return d&&Object.assign(g,d),g})(),...s?[o]:[]]:[!1,null]},dS=t=>Uf(hn().parser,t,Lr()[0]),hS=({children:t,...e})=>{var g,m,v;const r=hn(),s=e.hook?By:r;let n=s;const[i,c=e.ssrSearch??""]=((g=e.ssrPath)==null?void 0:g.split("?"))??[];i&&(e.ssrSearch=c,e.ssrPath=i),e.hrefs=e.hrefs??((m=e.hook)==null?void 0:m.hrefs),e.searchHook=e.searchHook??((v=e.hook)==null?void 0:v.searchHook);let o=R.useRef({}),l=o.current,d=l;for(let y in s){const w=y==="base"?s[y]+(e[y]??""):e[y]??s[y];l===d&&w!==d[y]&&(o.current=d={...d}),d[y]=w,(w!==s[y]||w!==n[y])&&(n=d)}return R.createElement($y.Provider,{value:n,children:t})},$m=({children:t,component:e},r)=>e?R.createElement(e,{params:r}):typeof t=="function"?t(r):t,fS=t=>{let e=R.useRef(Fy);const r=e.current;return e.current=Object.keys(t).length!==Object.keys(r).length||Object.entries(t).some(([s,n])=>n!==r[s])?t:r},gt=({path:t,nest:e,match:r,...s})=>{const n=hn(),[i]=Wa(n),[c,o,l]=r??Uf(n.parser,t,i,e),d=fS({...Hy(),...o});if(!c)return null;const g=l?R.createElement(hS,{base:l},$m(s,d)):$m(s,d);return R.createElement(Uy.Provider,{value:d,children:g})},Re=R.forwardRef((t,e)=>{const r=hn(),[s,n]=Wa(r),{to:i="",href:c=i,onClick:o,asChild:l,children:d,className:g,replace:m,state:v,transition:y,...w}=t,_=Bf(h=>{h.ctrlKey||h.metaKey||h.altKey||h.shiftKey||h.button!==0||(o==null||o(h),h.defaultPrevented||(h.preventDefault(),n(c,t)))}),p=r.hrefs(c[0]==="~"?c.slice(1):r.base+c,r);return l&&R.isValidElement(d)?R.cloneElement(d,{onClick:_,href:p}):R.createElement("a",{...w,onClick:_,href:p,className:g!=null&&g.call?g(s===c):g,children:d,ref:e})}),zy=t=>Array.isArray(t)?t.flatMap(e=>zy(e&&e.type===R.Fragment?e.props.children:e)):[t],pS=({children:t,location:e})=>{const r=hn(),[s]=Wa(r);for(const n of zy(t)){let i=0;if(R.isValidElement(n)&&(i=Uf(r.parser,n.props.path,e||s,n.props.nest))[0])return R.cloneElement(n,{match:i})}return null},gl=t=>{const{to:e,href:r=e}=t,s=hn(),[,n]=Wa(s),i=Bf(()=>n(e||r,t)),{ssrContext:c}=s;return Iy(()=>{i()},[]),c&&(c.redirectTo=e),null};var wo=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},mS={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},Ls,Fh,lv,gS=(lv=class{constructor(){me(this,Ls,mS);me(this,Fh,!1)}setTimeoutProvider(t){re(this,Ls,t)}setTimeout(t,e){return M(this,Ls).setTimeout(t,e)}clearTimeout(t){M(this,Ls).clearTimeout(t)}setInterval(t,e){return M(this,Ls).setInterval(t,e)}clearInterval(t){M(this,Ls).clearInterval(t)}},Ls=new WeakMap,Fh=new WeakMap,lv),Rn=new gS;function vS(t){setTimeout(t,0)}var Gn=typeof window>"u"||"Deno"in globalThis;function Lt(){}function _S(t,e){return typeof t=="function"?t(e):t}function Gd(t){return typeof t=="number"&&t>=0&&t!==1/0}function Wy(t,e){return Math.max(t+(e||0)-Date.now(),0)}function tn(t,e){return typeof t=="function"?t(e):t}function hr(t,e){return typeof t=="function"?t(e):t}function Fm(t,e){const{type:r="all",exact:s,fetchStatus:n,predicate:i,queryKey:c,stale:o}=t;if(c){if(s){if(e.queryHash!==Hf(c,e.options))return!1}else if(!ba(e.queryKey,c))return!1}if(r!=="all"){const l=e.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof o=="boolean"&&e.isStale()!==o||n&&n!==e.state.fetchStatus||i&&!i(e))}function Um(t,e){const{exact:r,status:s,predicate:n,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(r){if(Vn(e.options.mutationKey)!==Vn(i))return!1}else if(!ba(e.options.mutationKey,i))return!1}return!(s&&e.state.status!==s||n&&!n(e))}function Hf(t,e){return((e==null?void 0:e.queryKeyHashFn)||Vn)(t)}function Vn(t){return JSON.stringify(t,(e,r)=>Vd(r)?Object.keys(r).sort().reduce((s,n)=>(s[n]=r[n],s),{}):r)}function ba(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(r=>ba(t[r],e[r])):!1}var yS=Object.prototype.hasOwnProperty;function qy(t,e,r=0){if(t===e)return t;if(r>500)return e;const s=Hm(t)&&Hm(e);if(!s&&!(Vd(t)&&Vd(e)))return e;const i=(s?t:Object.keys(t)).length,c=s?e:Object.keys(e),o=c.length,l=s?new Array(o):{};let d=0;for(let g=0;g<o;g++){const m=s?g:c[g],v=t[m],y=e[m];if(v===y){l[m]=v,(s?g<i:yS.call(t,m))&&d++;continue}if(v===null||y===null||typeof v!="object"||typeof y!="object"){l[m]=y;continue}const w=qy(v,y,r+1);l[m]=w,w===v&&d++}return i===o&&d===i?t:l}function vc(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function Hm(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Vd(t){if(!zm(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!zm(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function zm(t){return Object.prototype.toString.call(t)==="[object Object]"}function xS(t){return new Promise(e=>{Rn.setTimeout(e,t)})}function Kd(t,e,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?qy(t,e):e}function wS(t,e,r=0){const s=[...t,e];return r&&s.length>r?s.slice(1):s}function bS(t,e,r=0){const s=[e,...t];return r&&s.length>r?s.slice(0,-1):s}var zf=Symbol();function Gy(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===zf?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function Wf(t,e){return typeof t=="function"?t(...e):!!t}function SS(t,e,r){let s=!1,n;return Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(n??(n=e()),s||(s=!0,n.aborted?r():n.addEventListener("abort",r,{once:!0})),n)}),t}var Tn,Is,Hi,cv,CS=(cv=class extends wo{constructor(){super();me(this,Tn);me(this,Is);me(this,Hi);re(this,Hi,e=>{if(!Gn&&window.addEventListener){const r=()=>e();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){M(this,Is)||this.setEventListener(M(this,Hi))}onUnsubscribe(){var e;this.hasListeners()||((e=M(this,Is))==null||e.call(this),re(this,Is,void 0))}setEventListener(e){var r;re(this,Hi,e),(r=M(this,Is))==null||r.call(this),re(this,Is,e(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(e){M(this,Tn)!==e&&(re(this,Tn,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(r=>{r(e)})}isFocused(){var e;return typeof M(this,Tn)=="boolean"?M(this,Tn):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Tn=new WeakMap,Is=new WeakMap,Hi=new WeakMap,cv),qf=new CS;function Jd(){let t,e;const r=new Promise((n,i)=>{t=n,e=i});r.status="pending",r.catch(()=>{});function s(n){Object.assign(r,n),delete r.resolve,delete r.reject}return r.resolve=n=>{s({status:"fulfilled",value:n}),t(n)},r.reject=n=>{s({status:"rejected",reason:n}),e(n)},r}var kS=vS;function ES(){let t=[],e=0,r=o=>{o()},s=o=>{o()},n=kS;const i=o=>{e?t.push(o):n(()=>{r(o)})},c=()=>{const o=t;t=[],o.length&&n(()=>{s(()=>{o.forEach(l=>{r(l)})})})};return{batch:o=>{let l;e++;try{l=o()}finally{e--,e||c()}return l},batchCalls:o=>(...l)=>{i(()=>{o(...l)})},schedule:i,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{s=o},setScheduler:o=>{n=o}}}var it=ES(),zi,Ds,Wi,uv,jS=(uv=class extends wo{constructor(){super();me(this,zi,!0);me(this,Ds);me(this,Wi);re(this,Wi,e=>{if(!Gn&&window.addEventListener){const r=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",s)}}})}onSubscribe(){M(this,Ds)||this.setEventListener(M(this,Wi))}onUnsubscribe(){var e;this.hasListeners()||((e=M(this,Ds))==null||e.call(this),re(this,Ds,void 0))}setEventListener(e){var r;re(this,Wi,e),(r=M(this,Ds))==null||r.call(this),re(this,Ds,e(this.setOnline.bind(this)))}setOnline(e){M(this,zi)!==e&&(re(this,zi,e),this.listeners.forEach(s=>{s(e)}))}isOnline(){return M(this,zi)}},zi=new WeakMap,Ds=new WeakMap,Wi=new WeakMap,uv),_c=new jS;function RS(t){return Math.min(1e3*2**t,3e4)}function Vy(t){return(t??"online")==="online"?_c.isOnline():!0}var Qd=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function Ky(t){let e=!1,r=0,s;const n=Jd(),i=()=>n.status!=="pending",c=_=>{var p;if(!i()){const h=new Qd(_);v(h),(p=t.onCancel)==null||p.call(t,h)}},o=()=>{e=!0},l=()=>{e=!1},d=()=>qf.isFocused()&&(t.networkMode==="always"||_c.isOnline())&&t.canRun(),g=()=>Vy(t.networkMode)&&t.canRun(),m=_=>{i()||(s==null||s(),n.resolve(_))},v=_=>{i()||(s==null||s(),n.reject(_))},y=()=>new Promise(_=>{var p;s=h=>{(i()||d())&&_(h)},(p=t.onPause)==null||p.call(t)}).then(()=>{var _;s=void 0,i()||(_=t.onContinue)==null||_.call(t)}),w=()=>{if(i())return;let _;const p=r===0?t.initialPromise:void 0;try{_=p??t.fn()}catch(h){_=Promise.reject(h)}Promise.resolve(_).then(m).catch(h=>{var C;if(i())return;const u=t.retry??(Gn?0:3),f=t.retryDelay??RS,x=typeof f=="function"?f(r,h):f,k=u===!0||typeof u=="number"&&r<u||typeof u=="function"&&u(r,h);if(e||!k){v(h);return}r++,(C=t.onFail)==null||C.call(t,r,h),xS(x).then(()=>d()?void 0:y()).then(()=>{e?v(h):w()})})};return{promise:n,status:()=>n.status,cancel:c,continue:()=>(s==null||s(),n),cancelRetry:o,continueRetry:l,canStart:g,start:()=>(g()?w():y().then(w),n)}}var An,dv,Jy=(dv=class{constructor(){me(this,An)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Gd(this.gcTime)&&re(this,An,Rn.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Gn?1/0:5*60*1e3))}clearGcTimeout(){M(this,An)&&(Rn.clearTimeout(M(this,An)),re(this,An,void 0))}},An=new WeakMap,dv),On,qi,dr,Pn,ut,La,Ln,Cr,Xr,hv,NS=(hv=class extends Jy{constructor(e){super();me(this,Cr);me(this,On);me(this,qi);me(this,dr);me(this,Pn);me(this,ut);me(this,La);me(this,Ln);re(this,Ln,!1),re(this,La,e.defaultOptions),this.setOptions(e.options),this.observers=[],re(this,Pn,e.client),re(this,dr,M(this,Pn).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,re(this,On,qm(this.options)),this.state=e.state??M(this,On),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=M(this,ut))==null?void 0:e.promise}setOptions(e){if(this.options={...M(this,La),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=qm(this.options);r.data!==void 0&&(this.setState(Wm(r.data,r.dataUpdatedAt)),re(this,On,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&M(this,dr).remove(this)}setData(e,r){const s=Kd(this.state.data,e,this.options);return be(this,Cr,Xr).call(this,{data:s,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),s}setState(e,r){be(this,Cr,Xr).call(this,{type:"setState",state:e,setStateOptions:r})}cancel(e){var s,n;const r=(s=M(this,ut))==null?void 0:s.promise;return(n=M(this,ut))==null||n.cancel(e),r?r.then(Lt).catch(Lt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(M(this,On))}isActive(){return this.observers.some(e=>hr(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===zf||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>tn(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!Wy(this.state.dataUpdatedAt,e)}onFocus(){var r;const e=this.observers.find(s=>s.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(r=M(this,ut))==null||r.continue()}onOnline(){var r;const e=this.observers.find(s=>s.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(r=M(this,ut))==null||r.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),M(this,dr).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(r=>r!==e),this.observers.length||(M(this,ut)&&(M(this,Ln)?M(this,ut).cancel({revert:!0}):M(this,ut).cancelRetry()),this.scheduleGc()),M(this,dr).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||be(this,Cr,Xr).call(this,{type:"invalidate"})}async fetch(e,r){var l,d,g,m,v,y,w,_,p,h,u,f;if(this.state.fetchStatus!=="idle"&&((l=M(this,ut))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(M(this,ut))return M(this,ut).continueRetry(),M(this,ut).promise}if(e&&this.setOptions(e),!this.options.queryFn){const x=this.observers.find(k=>k.options.queryFn);x&&this.setOptions(x.options)}const s=new AbortController,n=x=>{Object.defineProperty(x,"signal",{enumerable:!0,get:()=>(re(this,Ln,!0),s.signal)})},i=()=>{const x=Gy(this.options,r),C=(()=>{const S={client:M(this,Pn),queryKey:this.queryKey,meta:this.meta};return n(S),S})();return re(this,Ln,!1),this.options.persister?this.options.persister(x,C,this):x(C)},o=(()=>{const x={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:M(this,Pn),state:this.state,fetchFn:i};return n(x),x})();(d=this.options.behavior)==null||d.onFetch(o,this),re(this,qi,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((g=o.fetchOptions)==null?void 0:g.meta))&&be(this,Cr,Xr).call(this,{type:"fetch",meta:(m=o.fetchOptions)==null?void 0:m.meta}),re(this,ut,Ky({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,onCancel:x=>{x instanceof Qd&&x.revert&&this.setState({...M(this,qi),fetchStatus:"idle"}),s.abort()},onFail:(x,k)=>{be(this,Cr,Xr).call(this,{type:"failed",failureCount:x,error:k})},onPause:()=>{be(this,Cr,Xr).call(this,{type:"pause"})},onContinue:()=>{be(this,Cr,Xr).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const x=await M(this,ut).start();if(x===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(x),(y=(v=M(this,dr).config).onSuccess)==null||y.call(v,x,this),(_=(w=M(this,dr).config).onSettled)==null||_.call(w,x,this.state.error,this),x}catch(x){if(x instanceof Qd){if(x.silent)return M(this,ut).promise;if(x.revert){if(this.state.data===void 0)throw x;return this.state.data}}throw be(this,Cr,Xr).call(this,{type:"error",error:x}),(h=(p=M(this,dr).config).onError)==null||h.call(p,x,this),(f=(u=M(this,dr).config).onSettled)==null||f.call(u,this.state.data,x,this),x}finally{this.scheduleGc()}}},On=new WeakMap,qi=new WeakMap,dr=new WeakMap,Pn=new WeakMap,ut=new WeakMap,La=new WeakMap,Ln=new WeakMap,Cr=new WeakSet,Xr=function(e){const r=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...Qy(s.data,this.options),fetchMeta:e.meta??null};case"success":const n={...s,...Wm(e.data,e.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return re(this,qi,e.manual?n:void 0),n;case"error":const i=e.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=r(this.state),it.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),M(this,dr).notify({query:this,type:"updated",action:e})})},hv);function Qy(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Vy(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Wm(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function qm(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=e!==void 0,s=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Ft,je,Ia,At,In,Gi,ss,Ms,Da,Vi,Ki,Dn,Mn,Bs,Ji,Oe,zo,Zd,Yd,Xd,eh,th,rh,sh,Zy,fv,TS=(fv=class extends wo{constructor(e,r){super();me(this,Oe);me(this,Ft);me(this,je);me(this,Ia);me(this,At);me(this,In);me(this,Gi);me(this,ss);me(this,Ms);me(this,Da);me(this,Vi);me(this,Ki);me(this,Dn);me(this,Mn);me(this,Bs);me(this,Ji,new Set);this.options=r,re(this,Ft,e),re(this,Ms,null),re(this,ss,Jd()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(M(this,je).addObserver(this),Gm(M(this,je),this.options)?be(this,Oe,zo).call(this):this.updateResult(),be(this,Oe,eh).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return nh(M(this,je),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return nh(M(this,je),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,be(this,Oe,th).call(this),be(this,Oe,rh).call(this),M(this,je).removeObserver(this)}setOptions(e){const r=this.options,s=M(this,je);if(this.options=M(this,Ft).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof hr(this.options.enabled,M(this,je))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");be(this,Oe,sh).call(this),M(this,je).setOptions(this.options),r._defaulted&&!vc(this.options,r)&&M(this,Ft).getQueryCache().notify({type:"observerOptionsUpdated",query:M(this,je),observer:this});const n=this.hasListeners();n&&Vm(M(this,je),s,this.options,r)&&be(this,Oe,zo).call(this),this.updateResult(),n&&(M(this,je)!==s||hr(this.options.enabled,M(this,je))!==hr(r.enabled,M(this,je))||tn(this.options.staleTime,M(this,je))!==tn(r.staleTime,M(this,je)))&&be(this,Oe,Zd).call(this);const i=be(this,Oe,Yd).call(this);n&&(M(this,je)!==s||hr(this.options.enabled,M(this,je))!==hr(r.enabled,M(this,je))||i!==M(this,Bs))&&be(this,Oe,Xd).call(this,i)}getOptimisticResult(e){const r=M(this,Ft).getQueryCache().build(M(this,Ft),e),s=this.createResult(r,e);return OS(this,s)&&(re(this,At,s),re(this,Gi,this.options),re(this,In,M(this,je).state)),s}getCurrentResult(){return M(this,At)}trackResult(e,r){return new Proxy(e,{get:(s,n)=>(this.trackProp(n),r==null||r(n),n==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&M(this,ss).status==="pending"&&M(this,ss).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(s,n))})}trackProp(e){M(this,Ji).add(e)}getCurrentQuery(){return M(this,je)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const r=M(this,Ft).defaultQueryOptions(e),s=M(this,Ft).getQueryCache().build(M(this,Ft),r);return s.fetch().then(()=>this.createResult(s,r))}fetch(e){return be(this,Oe,zo).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),M(this,At)))}createResult(e,r){var E;const s=M(this,je),n=this.options,i=M(this,At),c=M(this,In),o=M(this,Gi),d=e!==s?e.state:M(this,Ia),{state:g}=e;let m={...g},v=!1,y;if(r._optimisticResults){const N=this.hasListeners(),O=!N&&Gm(e,r),I=N&&Vm(e,s,r,n);(O||I)&&(m={...m,...Qy(g.data,e.options)}),r._optimisticResults==="isRestoring"&&(m.fetchStatus="idle")}let{error:w,errorUpdatedAt:_,status:p}=m;y=m.data;let h=!1;if(r.placeholderData!==void 0&&y===void 0&&p==="pending"){let N;i!=null&&i.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData)?(N=i.data,h=!0):N=typeof r.placeholderData=="function"?r.placeholderData((E=M(this,Ki))==null?void 0:E.state.data,M(this,Ki)):r.placeholderData,N!==void 0&&(p="success",y=Kd(i==null?void 0:i.data,N,r),v=!0)}if(r.select&&y!==void 0&&!h)if(i&&y===(c==null?void 0:c.data)&&r.select===M(this,Da))y=M(this,Vi);else try{re(this,Da,r.select),y=r.select(y),y=Kd(i==null?void 0:i.data,y,r),re(this,Vi,y),re(this,Ms,null)}catch(N){re(this,Ms,N)}M(this,Ms)&&(w=M(this,Ms),y=M(this,Vi),_=Date.now(),p="error");const u=m.fetchStatus==="fetching",f=p==="pending",x=p==="error",k=f&&u,C=y!==void 0,b={status:p,fetchStatus:m.fetchStatus,isPending:f,isSuccess:p==="success",isError:x,isInitialLoading:k,isLoading:k,data:y,dataUpdatedAt:m.dataUpdatedAt,error:w,errorUpdatedAt:_,failureCount:m.fetchFailureCount,failureReason:m.fetchFailureReason,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>d.dataUpdateCount||m.errorUpdateCount>d.errorUpdateCount,isFetching:u,isRefetching:u&&!f,isLoadingError:x&&!C,isPaused:m.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:x&&C,isStale:Gf(e,r),refetch:this.refetch,promise:M(this,ss),isEnabled:hr(r.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const N=b.data!==void 0,O=b.status==="error"&&!N,I=D=>{O?D.reject(b.error):N&&D.resolve(b.data)},P=()=>{const D=re(this,ss,b.promise=Jd());I(D)},U=M(this,ss);switch(U.status){case"pending":e.queryHash===s.queryHash&&I(U);break;case"fulfilled":(O||b.data!==U.value)&&P();break;case"rejected":(!O||b.error!==U.reason)&&P();break}}return b}updateResult(){const e=M(this,At),r=this.createResult(M(this,je),this.options);if(re(this,In,M(this,je).state),re(this,Gi,this.options),M(this,In).data!==void 0&&re(this,Ki,M(this,je)),vc(r,e))return;re(this,At,r);const s=()=>{if(!e)return!0;const{notifyOnChangeProps:n}=this.options,i=typeof n=="function"?n():n;if(i==="all"||!i&&!M(this,Ji).size)return!0;const c=new Set(i??M(this,Ji));return this.options.throwOnError&&c.add("error"),Object.keys(M(this,At)).some(o=>{const l=o;return M(this,At)[l]!==e[l]&&c.has(l)})};be(this,Oe,Zy).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&be(this,Oe,eh).call(this)}},Ft=new WeakMap,je=new WeakMap,Ia=new WeakMap,At=new WeakMap,In=new WeakMap,Gi=new WeakMap,ss=new WeakMap,Ms=new WeakMap,Da=new WeakMap,Vi=new WeakMap,Ki=new WeakMap,Dn=new WeakMap,Mn=new WeakMap,Bs=new WeakMap,Ji=new WeakMap,Oe=new WeakSet,zo=function(e){be(this,Oe,sh).call(this);let r=M(this,je).fetch(this.options,e);return e!=null&&e.throwOnError||(r=r.catch(Lt)),r},Zd=function(){be(this,Oe,th).call(this);const e=tn(this.options.staleTime,M(this,je));if(Gn||M(this,At).isStale||!Gd(e))return;const s=Wy(M(this,At).dataUpdatedAt,e)+1;re(this,Dn,Rn.setTimeout(()=>{M(this,At).isStale||this.updateResult()},s))},Yd=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(M(this,je)):this.options.refetchInterval)??!1},Xd=function(e){be(this,Oe,rh).call(this),re(this,Bs,e),!(Gn||hr(this.options.enabled,M(this,je))===!1||!Gd(M(this,Bs))||M(this,Bs)===0)&&re(this,Mn,Rn.setInterval(()=>{(this.options.refetchIntervalInBackground||qf.isFocused())&&be(this,Oe,zo).call(this)},M(this,Bs)))},eh=function(){be(this,Oe,Zd).call(this),be(this,Oe,Xd).call(this,be(this,Oe,Yd).call(this))},th=function(){M(this,Dn)&&(Rn.clearTimeout(M(this,Dn)),re(this,Dn,void 0))},rh=function(){M(this,Mn)&&(Rn.clearInterval(M(this,Mn)),re(this,Mn,void 0))},sh=function(){const e=M(this,Ft).getQueryCache().build(M(this,Ft),this.options);if(e===M(this,je))return;const r=M(this,je);re(this,je,e),re(this,Ia,e.state),this.hasListeners()&&(r==null||r.removeObserver(this),e.addObserver(this))},Zy=function(e){it.batch(()=>{e.listeners&&this.listeners.forEach(r=>{r(M(this,At))}),M(this,Ft).getQueryCache().notify({query:M(this,je),type:"observerResultsUpdated"})})},fv);function AS(t,e){return hr(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Gm(t,e){return AS(t,e)||t.state.data!==void 0&&nh(t,e,e.refetchOnMount)}function nh(t,e,r){if(hr(e.enabled,t)!==!1&&tn(e.staleTime,t)!=="static"){const s=typeof r=="function"?r(t):r;return s==="always"||s!==!1&&Gf(t,e)}return!1}function Vm(t,e,r,s){return(t!==e||hr(s.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&Gf(t,r)}function Gf(t,e){return hr(e.enabled,t)!==!1&&t.isStaleByTime(tn(e.staleTime,t))}function OS(t,e){return!vc(t.getCurrentResult(),e)}function Km(t){return{onFetch:(e,r)=>{var g,m,v,y,w;const s=e.options,n=(v=(m=(g=e.fetchOptions)==null?void 0:g.meta)==null?void 0:m.fetchMore)==null?void 0:v.direction,i=((y=e.state.data)==null?void 0:y.pages)||[],c=((w=e.state.data)==null?void 0:w.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const d=async()=>{let _=!1;const p=f=>{SS(f,()=>e.signal,()=>_=!0)},h=Gy(e.options,e.fetchOptions),u=async(f,x,k)=>{if(_)return Promise.reject();if(x==null&&f.pages.length)return Promise.resolve(f);const S=(()=>{const O={client:e.client,queryKey:e.queryKey,pageParam:x,direction:k?"backward":"forward",meta:e.options.meta};return p(O),O})(),b=await h(S),{maxPages:E}=e.options,N=k?bS:wS;return{pages:N(f.pages,b,E),pageParams:N(f.pageParams,x,E)}};if(n&&i.length){const f=n==="backward",x=f?PS:Jm,k={pages:i,pageParams:c},C=x(s,k);o=await u(k,C,f)}else{const f=t??i.length;do{const x=l===0?c[0]??s.initialPageParam:Jm(s,o);if(l>0&&x==null)break;o=await u(o,x),l++}while(l<f)}return o};e.options.persister?e.fetchFn=()=>{var _,p;return(p=(_=e.options).persister)==null?void 0:p.call(_,d,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r)}:e.fetchFn=d}}}function Jm(t,{pages:e,pageParams:r}){const s=e.length-1;return e.length>0?t.getNextPageParam(e[s],e,r[s],r):void 0}function PS(t,{pages:e,pageParams:r}){var s;return e.length>0?(s=t.getPreviousPageParam)==null?void 0:s.call(t,e[0],e,r[0],r):void 0}var Ma,Fr,Ot,Bn,Ur,ks,pv,LS=(pv=class extends Jy{constructor(e){super();me(this,Ur);me(this,Ma);me(this,Fr);me(this,Ot);me(this,Bn);re(this,Ma,e.client),this.mutationId=e.mutationId,re(this,Ot,e.mutationCache),re(this,Fr,[]),this.state=e.state||Yy(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){M(this,Fr).includes(e)||(M(this,Fr).push(e),this.clearGcTimeout(),M(this,Ot).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){re(this,Fr,M(this,Fr).filter(r=>r!==e)),this.scheduleGc(),M(this,Ot).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){M(this,Fr).length||(this.state.status==="pending"?this.scheduleGc():M(this,Ot).remove(this))}continue(){var e;return((e=M(this,Bn))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var c,o,l,d,g,m,v,y,w,_,p,h,u,f,x,k,C,S,b,E;const r=()=>{be(this,Ur,ks).call(this,{type:"continue"})},s={client:M(this,Ma),meta:this.options.meta,mutationKey:this.options.mutationKey};re(this,Bn,Ky({fn:()=>this.options.mutationFn?this.options.mutationFn(e,s):Promise.reject(new Error("No mutationFn found")),onFail:(N,O)=>{be(this,Ur,ks).call(this,{type:"failed",failureCount:N,error:O})},onPause:()=>{be(this,Ur,ks).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>M(this,Ot).canRun(this)}));const n=this.state.status==="pending",i=!M(this,Bn).canStart();try{if(n)r();else{be(this,Ur,ks).call(this,{type:"pending",variables:e,isPaused:i}),await((o=(c=M(this,Ot).config).onMutate)==null?void 0:o.call(c,e,this,s));const O=await((d=(l=this.options).onMutate)==null?void 0:d.call(l,e,s));O!==this.state.context&&be(this,Ur,ks).call(this,{type:"pending",context:O,variables:e,isPaused:i})}const N=await M(this,Bn).start();return await((m=(g=M(this,Ot).config).onSuccess)==null?void 0:m.call(g,N,e,this.state.context,this,s)),await((y=(v=this.options).onSuccess)==null?void 0:y.call(v,N,e,this.state.context,s)),await((_=(w=M(this,Ot).config).onSettled)==null?void 0:_.call(w,N,null,this.state.variables,this.state.context,this,s)),await((h=(p=this.options).onSettled)==null?void 0:h.call(p,N,null,e,this.state.context,s)),be(this,Ur,ks).call(this,{type:"success",data:N}),N}catch(N){try{await((f=(u=M(this,Ot).config).onError)==null?void 0:f.call(u,N,e,this.state.context,this,s))}catch(O){Promise.reject(O)}try{await((k=(x=this.options).onError)==null?void 0:k.call(x,N,e,this.state.context,s))}catch(O){Promise.reject(O)}try{await((S=(C=M(this,Ot).config).onSettled)==null?void 0:S.call(C,void 0,N,this.state.variables,this.state.context,this,s))}catch(O){Promise.reject(O)}try{await((E=(b=this.options).onSettled)==null?void 0:E.call(b,void 0,N,e,this.state.context,s))}catch(O){Promise.reject(O)}throw be(this,Ur,ks).call(this,{type:"error",error:N}),N}finally{M(this,Ot).runNext(this)}}},Ma=new WeakMap,Fr=new WeakMap,Ot=new WeakMap,Bn=new WeakMap,Ur=new WeakSet,ks=function(e){const r=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=r(this.state),it.batch(()=>{M(this,Fr).forEach(s=>{s.onMutationUpdate(e)}),M(this,Ot).notify({mutation:this,type:"updated",action:e})})},pv);function Yy(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ns,kr,Ba,mv,IS=(mv=class extends wo{constructor(e={}){super();me(this,ns);me(this,kr);me(this,Ba);this.config=e,re(this,ns,new Set),re(this,kr,new Map),re(this,Ba,0)}build(e,r,s){const n=new LS({client:e,mutationCache:this,mutationId:++Ya(this,Ba)._,options:e.defaultMutationOptions(r),state:s});return this.add(n),n}add(e){M(this,ns).add(e);const r=vl(e);if(typeof r=="string"){const s=M(this,kr).get(r);s?s.push(e):M(this,kr).set(r,[e])}this.notify({type:"added",mutation:e})}remove(e){if(M(this,ns).delete(e)){const r=vl(e);if(typeof r=="string"){const s=M(this,kr).get(r);if(s)if(s.length>1){const n=s.indexOf(e);n!==-1&&s.splice(n,1)}else s[0]===e&&M(this,kr).delete(r)}}this.notify({type:"removed",mutation:e})}canRun(e){const r=vl(e);if(typeof r=="string"){const s=M(this,kr).get(r),n=s==null?void 0:s.find(i=>i.state.status==="pending");return!n||n===e}else return!0}runNext(e){var s;const r=vl(e);if(typeof r=="string"){const n=(s=M(this,kr).get(r))==null?void 0:s.find(i=>i!==e&&i.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){it.batch(()=>{M(this,ns).forEach(e=>{this.notify({type:"removed",mutation:e})}),M(this,ns).clear(),M(this,kr).clear()})}getAll(){return Array.from(M(this,ns))}find(e){const r={exact:!0,...e};return this.getAll().find(s=>Um(r,s))}findAll(e={}){return this.getAll().filter(r=>Um(e,r))}notify(e){it.batch(()=>{this.listeners.forEach(r=>{r(e)})})}resumePausedMutations(){const e=this.getAll().filter(r=>r.state.isPaused);return it.batch(()=>Promise.all(e.map(r=>r.continue().catch(Lt))))}},ns=new WeakMap,kr=new WeakMap,Ba=new WeakMap,mv);function vl(t){var e;return(e=t.options.scope)==null?void 0:e.id}var is,$s,Ut,os,ds,zl,ih,gv,DS=(gv=class extends wo{constructor(r,s){super();me(this,ds);me(this,is);me(this,$s);me(this,Ut);me(this,os);re(this,is,r),this.setOptions(s),this.bindMethods(),be(this,ds,zl).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var n;const s=this.options;this.options=M(this,is).defaultMutationOptions(r),vc(this.options,s)||M(this,is).getMutationCache().notify({type:"observerOptionsUpdated",mutation:M(this,Ut),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&Vn(s.mutationKey)!==Vn(this.options.mutationKey)?this.reset():((n=M(this,Ut))==null?void 0:n.state.status)==="pending"&&M(this,Ut).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=M(this,Ut))==null||r.removeObserver(this)}onMutationUpdate(r){be(this,ds,zl).call(this),be(this,ds,ih).call(this,r)}getCurrentResult(){return M(this,$s)}reset(){var r;(r=M(this,Ut))==null||r.removeObserver(this),re(this,Ut,void 0),be(this,ds,zl).call(this),be(this,ds,ih).call(this)}mutate(r,s){var n;return re(this,os,s),(n=M(this,Ut))==null||n.removeObserver(this),re(this,Ut,M(this,is).getMutationCache().build(M(this,is),this.options)),M(this,Ut).addObserver(this),M(this,Ut).execute(r)}},is=new WeakMap,$s=new WeakMap,Ut=new WeakMap,os=new WeakMap,ds=new WeakSet,zl=function(){var s;const r=((s=M(this,Ut))==null?void 0:s.state)??Yy();re(this,$s,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},ih=function(r){it.batch(()=>{var s,n,i,c,o,l,d,g;if(M(this,os)&&this.hasListeners()){const m=M(this,$s).variables,v=M(this,$s).context,y={client:M(this,is),meta:this.options.meta,mutationKey:this.options.mutationKey};if((r==null?void 0:r.type)==="success"){try{(n=(s=M(this,os)).onSuccess)==null||n.call(s,r.data,m,v,y)}catch(w){Promise.reject(w)}try{(c=(i=M(this,os)).onSettled)==null||c.call(i,r.data,null,m,v,y)}catch(w){Promise.reject(w)}}else if((r==null?void 0:r.type)==="error"){try{(l=(o=M(this,os)).onError)==null||l.call(o,r.error,m,v,y)}catch(w){Promise.reject(w)}try{(g=(d=M(this,os)).onSettled)==null||g.call(d,void 0,r.error,m,v,y)}catch(w){Promise.reject(w)}}}this.listeners.forEach(m=>{m(M(this,$s))})})},gv),Hr,vv,MS=(vv=class extends wo{constructor(e={}){super();me(this,Hr);this.config=e,re(this,Hr,new Map)}build(e,r,s){const n=r.queryKey,i=r.queryHash??Hf(n,r);let c=this.get(i);return c||(c=new NS({client:e,queryKey:n,queryHash:i,options:e.defaultQueryOptions(r),state:s,defaultOptions:e.getQueryDefaults(n)}),this.add(c)),c}add(e){M(this,Hr).has(e.queryHash)||(M(this,Hr).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const r=M(this,Hr).get(e.queryHash);r&&(e.destroy(),r===e&&M(this,Hr).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){it.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return M(this,Hr).get(e)}getAll(){return[...M(this,Hr).values()]}find(e){const r={exact:!0,...e};return this.getAll().find(s=>Fm(r,s))}findAll(e={}){const r=this.getAll();return Object.keys(e).length>0?r.filter(s=>Fm(e,s)):r}notify(e){it.batch(()=>{this.listeners.forEach(r=>{r(e)})})}onFocus(){it.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){it.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Hr=new WeakMap,vv),Ke,Fs,Us,Qi,Zi,Hs,Yi,Xi,_v,BS=(_v=class{constructor(t={}){me(this,Ke);me(this,Fs);me(this,Us);me(this,Qi);me(this,Zi);me(this,Hs);me(this,Yi);me(this,Xi);re(this,Ke,t.queryCache||new MS),re(this,Fs,t.mutationCache||new IS),re(this,Us,t.defaultOptions||{}),re(this,Qi,new Map),re(this,Zi,new Map),re(this,Hs,0)}mount(){Ya(this,Hs)._++,M(this,Hs)===1&&(re(this,Yi,qf.subscribe(async t=>{t&&(await this.resumePausedMutations(),M(this,Ke).onFocus())})),re(this,Xi,_c.subscribe(async t=>{t&&(await this.resumePausedMutations(),M(this,Ke).onOnline())})))}unmount(){var t,e;Ya(this,Hs)._--,M(this,Hs)===0&&((t=M(this,Yi))==null||t.call(this),re(this,Yi,void 0),(e=M(this,Xi))==null||e.call(this),re(this,Xi,void 0))}isFetching(t){return M(this,Ke).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return M(this,Fs).findAll({...t,status:"pending"}).length}getQueryData(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=M(this,Ke).get(e.queryHash))==null?void 0:r.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),r=M(this,Ke).build(this,e),s=r.state.data;return s===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(tn(e.staleTime,r))&&this.prefetchQuery(e),Promise.resolve(s))}getQueriesData(t){return M(this,Ke).findAll(t).map(({queryKey:e,state:r})=>{const s=r.data;return[e,s]})}setQueryData(t,e,r){const s=this.defaultQueryOptions({queryKey:t}),n=M(this,Ke).get(s.queryHash),i=n==null?void 0:n.state.data,c=_S(e,i);if(c!==void 0)return M(this,Ke).build(this,s).setData(c,{...r,manual:!0})}setQueriesData(t,e,r){return it.batch(()=>M(this,Ke).findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,e,r)]))}getQueryState(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=M(this,Ke).get(e.queryHash))==null?void 0:r.state}removeQueries(t){const e=M(this,Ke);it.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=M(this,Ke);return it.batch(()=>(r.findAll(t).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const r={revert:!0,...e},s=it.batch(()=>M(this,Ke).findAll(t).map(n=>n.cancel(r)));return Promise.all(s).then(Lt).catch(Lt)}invalidateQueries(t,e={}){return it.batch(()=>(M(this,Ke).findAll(t).forEach(r=>{r.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const r={...e,cancelRefetch:e.cancelRefetch??!0},s=it.batch(()=>M(this,Ke).findAll(t).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let i=n.fetch(void 0,r);return r.throwOnError||(i=i.catch(Lt)),n.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(Lt)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=M(this,Ke).build(this,e);return r.isStaleByTime(tn(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Lt).catch(Lt)}fetchInfiniteQuery(t){return t.behavior=Km(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Lt).catch(Lt)}ensureInfiniteQueryData(t){return t.behavior=Km(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return _c.isOnline()?M(this,Fs).resumePausedMutations():Promise.resolve()}getQueryCache(){return M(this,Ke)}getMutationCache(){return M(this,Fs)}getDefaultOptions(){return M(this,Us)}setDefaultOptions(t){re(this,Us,t)}setQueryDefaults(t,e){M(this,Qi).set(Vn(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...M(this,Qi).values()],r={};return e.forEach(s=>{ba(t,s.queryKey)&&Object.assign(r,s.defaultOptions)}),r}setMutationDefaults(t,e){M(this,Zi).set(Vn(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...M(this,Zi).values()],r={};return e.forEach(s=>{ba(t,s.mutationKey)&&Object.assign(r,s.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={...M(this,Us).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Hf(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===zf&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...M(this,Us).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){M(this,Ke).clear(),M(this,Fs).clear()}},Ke=new WeakMap,Fs=new WeakMap,Us=new WeakMap,Qi=new WeakMap,Zi=new WeakMap,Hs=new WeakMap,Yi=new WeakMap,Xi=new WeakMap,_v),Xy=R.createContext(void 0),Jc=t=>{const e=R.useContext(Xy);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},$S=({client:t,children:e})=>(R.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),a.jsx(Xy.Provider,{value:t,children:e})),e0=R.createContext(!1),FS=()=>R.useContext(e0);e0.Provider;function US(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var HS=R.createContext(US()),zS=()=>R.useContext(HS),WS=(t,e,r)=>{const s=r!=null&&r.state.error&&typeof t.throwOnError=="function"?Wf(t.throwOnError,[r.state.error,r]):t.throwOnError;(t.suspense||t.experimental_prefetchInRender||s)&&(e.isReset()||(t.retryOnMount=!1))},qS=t=>{R.useEffect(()=>{t.clearReset()},[t])},GS=({result:t,errorResetBoundary:e,throwOnError:r,query:s,suspense:n})=>t.isError&&!e.isReset()&&!t.isFetching&&s&&(n&&t.data===void 0||Wf(r,[t.error,s])),VS=t=>{if(t.suspense){const r=n=>n==="static"?n:Math.max(n??1e3,1e3),s=t.staleTime;t.staleTime=typeof s=="function"?(...n)=>r(s(...n)):r(s),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},KS=(t,e)=>t.isLoading&&t.isFetching&&!e,JS=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Qm=(t,e,r)=>e.fetchOptimistic(t).catch(()=>{r.clearReset()});function QS(t,e,r){var v,y,w,_;const s=FS(),n=zS(),i=Jc(),c=i.defaultQueryOptions(t);(y=(v=i.getDefaultOptions().queries)==null?void 0:v._experimental_beforeQuery)==null||y.call(v,c);const o=i.getQueryCache().get(c.queryHash);c._optimisticResults=s?"isRestoring":"optimistic",VS(c),WS(c,n,o),qS(n);const l=!i.getQueryCache().get(c.queryHash),[d]=R.useState(()=>new e(i,c)),g=d.getOptimisticResult(c),m=!s&&t.subscribed!==!1;if(R.useSyncExternalStore(R.useCallback(p=>{const h=m?d.subscribe(it.batchCalls(p)):Lt;return d.updateResult(),h},[d,m]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),R.useEffect(()=>{d.setOptions(c)},[c,d]),JS(c,g))throw Qm(c,d,n);if(GS({result:g,errorResetBoundary:n,throwOnError:c.throwOnError,query:o,suspense:c.suspense}))throw g.error;if((_=(w=i.getDefaultOptions().queries)==null?void 0:w._experimental_afterQuery)==null||_.call(w,c,g),c.experimental_prefetchInRender&&!Gn&&KS(g,s)){const p=l?Qm(c,d,n):o==null?void 0:o.promise;p==null||p.catch(Lt).finally(()=>{d.updateResult()})}return c.notifyOnChangeProps?g:d.trackResult(g)}function Qc(t,e){return QS(t,TS)}function oh(t,e){const r=Jc(),[s]=R.useState(()=>new DS(r,t));R.useEffect(()=>{s.setOptions(t)},[s,t]);const n=R.useSyncExternalStore(R.useCallback(c=>s.subscribe(it.batchCalls(c)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=R.useCallback((c,o)=>{s.mutate(c,o).catch(Lt)},[s]);if(n.error&&Wf(s.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:i,mutateAsync:n.mutate}}var Wr=function(){return Wr=Object.assign||function(e){for(var r,s=1,n=arguments.length;s<n;s++){r=arguments[s];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Wr.apply(this,arguments)};function bo(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r}function ZS(t,e,r,s){function n(i){return i instanceof r?i:new r(function(c){c(i)})}return new(r||(r=Promise))(function(i,c){function o(g){try{d(s.next(g))}catch(m){c(m)}}function l(g){try{d(s.throw(g))}catch(m){c(m)}}function d(g){g.done?i(g.value):n(g.value).then(o,l)}d((s=s.apply(t,e||[])).next())})}function YS(t,e,r){if(r||arguments.length===2)for(var s=0,n=e.length,i;s<n;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}const XS=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Vf extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class eC extends Vf{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Zm extends Vf{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ym extends Vf{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ah;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ah||(ah={}));class tC{constructor(e,{headers:r={},customFetch:s,region:n=ah.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=XS(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return ZS(this,arguments,void 0,function*(r,s={}){var n;let i,c;try{const{headers:o,method:l,body:d,signal:g,timeout:m}=s;let v={},{region:y}=s;y||(y=this.region);const w=new URL(`${this.url}/${r}`);y&&y!=="any"&&(v["x-region"]=y,w.searchParams.set("forceFunctionRegion",y));let _;d&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(v["Content-Type"]="application/octet-stream",_=d):typeof d=="string"?(v["Content-Type"]="text/plain",_=d):typeof FormData<"u"&&d instanceof FormData?_=d:(v["Content-Type"]="application/json",_=JSON.stringify(d)):d&&typeof d!="string"&&!(typeof Blob<"u"&&d instanceof Blob)&&!(d instanceof ArrayBuffer)&&!(typeof FormData<"u"&&d instanceof FormData)?_=JSON.stringify(d):_=d;let p=g;m&&(c=new AbortController,i=setTimeout(()=>c.abort(),m),g?(p=c.signal,g.addEventListener("abort",()=>c.abort())):p=c.signal);const h=yield this.fetch(w.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},v),this.headers),o),body:_,signal:p}).catch(k=>{throw new eC(k)}),u=h.headers.get("x-relay-error");if(u&&u==="true")throw new Zm(h);if(!h.ok)throw new Ym(h);let f=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),x;return f==="application/json"?x=yield h.json():f==="application/octet-stream"||f==="application/pdf"?x=yield h.blob():f==="text/event-stream"?x=h:f==="multipart/form-data"?x=yield h.formData():x=yield h.text(),{data:x,error:null,response:h}}catch(o){return{data:null,error:o,response:o instanceof Ym||o instanceof Zm?o.context:void 0}}finally{i&&clearTimeout(i)}})}}var rC=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},sC=class{constructor(t){var e,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(r=t.isMaybeSingle)!==null&&r!==void 0?r:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let c=null,o=null,l=null,d=i.status,g=i.statusText;if(i.ok){var m,v;if(r.method!=="HEAD"){var y;const h=await i.text();h===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((y=r.headers.get("Accept"))===null||y===void 0)&&y.includes("application/vnd.pgrst.plan+text"))?o=h:o=JSON.parse(h))}const _=(m=r.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),p=(v=i.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");_&&p&&p.length>1&&(l=parseInt(p[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(c={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,d=406,g="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var w;const _=await i.text();try{c=JSON.parse(_),Array.isArray(c)&&i.status===404&&(o=[],c=null,d=200,g="OK")}catch{i.status===404&&_===""?(d=204,g="No Content"):c={message:_}}if(c&&r.isMaybeSingle&&(!(c==null||(w=c.details)===null||w===void 0)&&w.includes("0 rows"))&&(c=null,d=200,g="OK"),c&&r.shouldThrowOnError)throw new rC(c)}return{error:c,data:o,count:l,status:d,statusText:g}});return this.shouldThrowOnError||(n=n.catch(i=>{var c;let o="";const l=i==null?void 0:i.cause;if(l){var d,g,m,v;const w=(d=l==null?void 0:l.message)!==null&&d!==void 0?d:"",_=(g=l==null?void 0:l.code)!==null&&g!==void 0?g:"";o=`${(m=i==null?void 0:i.name)!==null&&m!==void 0?m:"FetchError"}: ${i==null?void 0:i.message}`,o+=`

Caused by: ${(v=l==null?void 0:l.name)!==null&&v!==void 0?v:"Error"}: ${w}`,_&&(o+=` (${_})`),l!=null&&l.stack&&(o+=`
${l.stack}`)}else{var y;o=(y=i==null?void 0:i.stack)!==null&&y!==void 0?y:""}return{error:{message:`${(c=i==null?void 0:i.name)!==null&&c!==void 0?c:"FetchError"}: ${i==null?void 0:i.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),n.then(t,e)}returns(){return this}overrideTypes(){return this}},nC=class extends sC{select(t){let e=!1;const r=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:s,referencedTable:n=s}={}){const i=n?`${n}.order`:"order",c=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${c?`${c},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:s=r}={}){const n=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${t}`),this.url.searchParams.set(i,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:s=!1,wal:n=!1,format:i="text"}={}){var c;const o=[t?"analyze":null,e?"verbose":null,r?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=(c=this.headers.get("Accept"))!==null&&c!==void 0?c:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${o};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Xm=new RegExp("[,()]");var pi=class extends nC{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const r=Array.from(new Set(e)).map(s=>typeof s=="string"&&Xm.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}notIn(t,e){const r=Array.from(new Set(e)).map(s=>typeof s=="string"&&Xm.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`not.in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:s}={}){let n="";s==="plain"?n="pl":s==="phrase"?n="ph":s==="websearch"&&(n="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${n}fts${i}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}},iC=class{constructor(t,{headers:e={},schema:r,fetch:s}){this.url=t,this.headers=new Headers(e),this.schema=r,this.fetch=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:r=!1,count:s}=e??{},n=r?"HEAD":"GET";let i=!1;const c=(t??"*").split("").map(d=>/\s/.test(d)&&!i?"":(d==='"'&&(i=!i),d)).join(""),{url:o,headers:l}=this.cloneRequestState();return o.searchParams.set("select",c),s&&l.append("Prefer",`count=${s}`),new pi({method:n,url:o,headers:l,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:r=!0}={}){var s;const n="POST",{url:i,headers:c}=this.cloneRequestState();if(e&&c.append("Prefer",`count=${e}`),r||c.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((l,d)=>l.concat(Object.keys(d)),[]);if(o.length>0){const l=[...new Set(o)].map(d=>`"${d}"`);i.searchParams.set("columns",l.join(","))}}return new pi({method:n,url:i,headers:c,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:s,defaultToNull:n=!0}={}){var i;const c="POST",{url:o,headers:l}=this.cloneRequestState();if(l.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),e!==void 0&&o.searchParams.set("on_conflict",e),s&&l.append("Prefer",`count=${s}`),n||l.append("Prefer","missing=default"),Array.isArray(t)){const d=t.reduce((g,m)=>g.concat(Object.keys(m)),[]);if(d.length>0){const g=[...new Set(d)].map(m=>`"${m}"`);o.searchParams.set("columns",g.join(","))}}return new pi({method:c,url:o,headers:l,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:e}={}){var r;const s="PATCH",{url:n,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new pi({method:s,url:n,headers:i,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:t}={}){var e;const r="DELETE",{url:s,headers:n}=this.cloneRequestState();return t&&n.append("Prefer",`count=${t}`),new pi({method:r,url:s,headers:n,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},oC=class t0{constructor(e,{headers:r={},schema:s,fetch:n}={}){this.url=e,this.headers=new Headers(r),this.schemaName=s,this.fetch=n}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new iC(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new t0(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:s=!1,get:n=!1,count:i}={}){var c;let o;const l=new URL(`${this.url}/rpc/${e}`);let d;const g=y=>y!==null&&typeof y=="object"&&(!Array.isArray(y)||y.some(g)),m=s&&Object.values(r).some(g);m?(o="POST",d=r):s||n?(o=s?"HEAD":"GET",Object.entries(r).filter(([y,w])=>w!==void 0).map(([y,w])=>[y,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([y,w])=>{l.searchParams.append(y,w)})):(o="POST",d=r);const v=new Headers(this.headers);return m?v.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&v.set("Prefer",`count=${i}`),new pi({method:o,url:l,headers:v,schema:this.schemaName,body:d,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}};class aC{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const s=r.versions;if(s&&s.node){const n=s.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const s=this.getWebSocketConstructor();return new s(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const lC="2.91.0",cC=`realtime-js/${lC}`,uC="1.0.0",r0="2.0.0",eg=r0,lh=1e4,dC=1e3,hC=100;var Ns;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ns||(Ns={}));var st;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(st||(st={}));var jr;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(jr||(jr={}));var ch;(function(t){t.websocket="websocket"})(ch||(ch={}));var Sn;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Sn||(Sn={}));class fC{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,s;const n=(s=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var r,s;const n=(s=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:{},c=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,c)}_encodeUserBroadcastPush(e,r,s){var n,i;const c=e.topic,o=(n=e.ref)!==null&&n!==void 0?n:"",l=(i=e.join_ref)!==null&&i!==void 0?i:"",d=e.payload.event,g=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},m=Object.keys(g).length===0?"":JSON.stringify(g);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`topic length ${c.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`metadata length ${m.length} exceeds maximum of 255`);const v=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+o.length+c.length+d.length+m.length,y=new ArrayBuffer(this.HEADER_LENGTH+v);let w=new DataView(y),_=0;w.setUint8(_++,this.KINDS.userBroadcastPush),w.setUint8(_++,l.length),w.setUint8(_++,o.length),w.setUint8(_++,c.length),w.setUint8(_++,d.length),w.setUint8(_++,m.length),w.setUint8(_++,r),Array.from(l,h=>w.setUint8(_++,h.charCodeAt(0))),Array.from(o,h=>w.setUint8(_++,h.charCodeAt(0))),Array.from(c,h=>w.setUint8(_++,h.charCodeAt(0))),Array.from(d,h=>w.setUint8(_++,h.charCodeAt(0))),Array.from(m,h=>w.setUint8(_++,h.charCodeAt(0)));var p=new Uint8Array(y.byteLength+s.byteLength);return p.set(new Uint8Array(y),0),p.set(new Uint8Array(s),y.byteLength),p.buffer}decode(e,r){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return r(s)}if(typeof e=="string"){const s=JSON.parse(e),[n,i,c,o,l]=s;return r({join_ref:n,ref:i,topic:c,event:o,payload:l})}return r({})}_binaryDecode(e){const r=new DataView(e),s=r.getUint8(0),n=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,n)}}_decodeUserBroadcast(e,r,s){const n=r.getUint8(1),i=r.getUint8(2),c=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+4;const d=s.decode(e.slice(l,l+n));l=l+n;const g=s.decode(e.slice(l,l+i));l=l+i;const m=s.decode(e.slice(l,l+c));l=l+c;const v=e.slice(l,e.byteLength),y=o===this.JSON_ENCODING?JSON.parse(s.decode(v)):v,w={type:this.BROADCAST_EVENT,event:g,payload:y};return c>0&&(w.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e==null?void 0:e.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>r.includes(s)))}}let s0=class{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var Me;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Me||(Me={}));const tg=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((i,c)=>(i[c]=pC(c,t,e,n),i),{}):{}},pC=(t,e,r,s)=>{const n=e.find(o=>o.name===t),i=n==null?void 0:n.type,c=r[t];return i&&!s.includes(i)?n0(i,c):uh(c)},n0=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return _C(e,r)}switch(t){case Me.bool:return mC(e);case Me.float4:case Me.float8:case Me.int2:case Me.int4:case Me.int8:case Me.numeric:case Me.oid:return gC(e);case Me.json:case Me.jsonb:return vC(e);case Me.timestamp:return yC(e);case Me.abstime:case Me.date:case Me.daterange:case Me.int4range:case Me.int8range:case Me.money:case Me.reltime:case Me.text:case Me.time:case Me.timestamptz:case Me.timetz:case Me.tsrange:case Me.tstzrange:return uh(e);default:return uh(e)}},uh=t=>t,mC=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},gC=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},vC=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},_C=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let i;const c=t.slice(1,r);try{i=JSON.parse("["+c+"]")}catch{i=c?c.split(","):[]}return i.map(o=>n0(e,o))}return t},yC=t=>typeof t=="string"?t.replace(" ","T"):t,i0=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Ou{constructor(e,r,s={},n=lh){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var rg;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(rg||(rg={}));class ra{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:c,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ra.syncState(this.state,n,i,c),this.pendingDiffs.forEach(l=>{this.state=ra.syncDiff(this.state,l,i,c)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:c,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=ra.syncDiff(this.state,n,i,c),o())}),this.onJoin((n,i,c)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:c})}),this.onLeave((n,i,c)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const i=this.cloneDeep(e),c=this.transformState(r),o={},l={};return this.map(i,(d,g)=>{c[d]||(l[d]=g)}),this.map(c,(d,g)=>{const m=i[d];if(m){const v=g.map(p=>p.presence_ref),y=m.map(p=>p.presence_ref),w=g.filter(p=>y.indexOf(p.presence_ref)<0),_=m.filter(p=>v.indexOf(p.presence_ref)<0);w.length>0&&(o[d]=w),_.length>0&&(l[d]=_)}else o[d]=g}),this.syncDiff(i,{joins:o,leaves:l},s,n)}static syncDiff(e,r,s,n){const{joins:i,leaves:c}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(o,l)=>{var d;const g=(d=e[o])!==null&&d!==void 0?d:[];if(e[o]=this.cloneDeep(l),g.length>0){const m=e[o].map(y=>y.presence_ref),v=g.filter(y=>m.indexOf(y.presence_ref)<0);e[o].unshift(...v)}s(o,g,l)}),this.map(c,(o,l)=>{let d=e[o];if(!d)return;const g=l.map(m=>m.presence_ref);d=d.filter(m=>g.indexOf(m.presence_ref)<0),e[o]=d,n(o,d,l),d.length===0&&delete e[o]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var sg;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(sg||(sg={}));var sa;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(sa||(sa={}));var ts;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(ts||(ts={}));class Ti{constructor(e,r={config:{}},s){var n,i;if(this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=st.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Ou(this,jr.join,this.params,this.timeout),this.rejoinTimer=new s0(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=st.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=st.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this._on(jr.reply,{},(c,o)=>{this._trigger(this._replyEventName(o),c)}),this.presence=new ra(this),this.broadcastEndpointURL=i0(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var s,n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==st.closed){const{config:{broadcast:c,presence:o,private:l}}=this.params,d=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(y=>y.filter))!==null&&n!==void 0?n:[],g=!!this.bindings[sa.PRESENCE]&&this.bindings[sa.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,m={},v={broadcast:c,presence:Object.assign(Object.assign({},o),{enabled:g}),postgres_changes:d,private:l};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(y=>e==null?void 0:e(ts.CHANNEL_ERROR,y)),this._onClose(()=>e==null?void 0:e(ts.CLOSED)),this.updateJoinPayload(Object.assign({config:v},m)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:y})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),y===void 0){e==null||e(ts.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,p=(w=_==null?void 0:_.length)!==null&&w!==void 0?w:0,h=[];for(let u=0;u<p;u++){const f=_[u],{filter:{event:x,schema:k,table:C,filter:S}}=f,b=y&&y[u];if(b&&b.event===x&&Ti.isFilterValueEqual(b.schema,k)&&Ti.isFilterValueEqual(b.table,C)&&Ti.isFilterValueEqual(b.filter,S))h.push(Object.assign(Object.assign({},f),{id:b.id}));else{this.unsubscribe(),this.state=st.errored,e==null||e(ts.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=h,e&&e(ts.SUBSCRIBED);return}}).receive("error",y=>{this.state=st.errored,e==null||e(ts.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ts.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this.state===st.joined&&e===sa.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,r,s)}async httpSend(e,r,s={}){var n;if(r==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const d=await o.json();l=d.error||d.message||l}catch{}return Promise.reject(new Error(l))}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:c}=e,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:c,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=d.body)===null||n===void 0?void 0:n.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var c,o,l;const d=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(c=this.params)===null||c===void 0?void 0:c.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=st.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(jr.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new Ou(this,jr.leave,{},e),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=st.closed,this.bindings={}}async _fetchWithTimeout(e,r,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),c=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),c}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Ou(this,e,r,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>hC){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,i;const c=e.toLocaleLowerCase(),{close:o,error:l,leave:d,join:g}=jr;if(s&&[o,l,d,g].indexOf(c)>=0&&s!==this._joinRef())return;let v=this._onMessage(c,r,s);if(r&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(y=>{var w,_,p;return((w=y.filter)===null||w===void 0?void 0:w.event)==="*"||((p=(_=y.filter)===null||_===void 0?void 0:_.event)===null||p===void 0?void 0:p.toLocaleLowerCase())===c}).map(y=>y.callback(v,s)):(i=this.bindings[c])===null||i===void 0||i.filter(y=>{var w,_,p,h,u,f,x,k;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in y){const C=y.id,S=(w=y.filter)===null||w===void 0?void 0:w.event;return C&&((_=r.ids)===null||_===void 0?void 0:_.includes(C))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((p=r.data)===null||p===void 0?void 0:p.type.toLocaleLowerCase()))&&(!(!((h=y.filter)===null||h===void 0)&&h.table)||y.filter.table===((u=r.data)===null||u===void 0?void 0:u.table))}else{const C=(x=(f=y==null?void 0:y.filter)===null||f===void 0?void 0:f.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return C==="*"||C===((k=r==null?void 0:r.event)===null||k===void 0?void 0:k.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===c}).map(y=>{if(typeof v=="object"&&"ids"in v){const w=v.data,{schema:_,table:p,commit_timestamp:h,type:u,errors:f}=w;v=Object.assign(Object.assign({},{schema:_,table:p,commit_timestamp:h,eventType:u,new:{},old:{},errors:f}),this._getPayloadRecords(w))}y.callback(v,s)})}_isClosed(){return this.state===st.closed}_isJoined(){return this.state===st.joined}_isJoining(){return this.state===st.joining}_isLeaving(){return this.state===st.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),i={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Ti.isEqual(n.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}static isFilterValueEqual(e,r){return(e??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(jr.close,{},e)}_onError(e){this._on(jr.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=st.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=tg(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=tg(e.columns,e.old_record)),r}}const Pu=()=>{},_l={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},xC=[1e3,2e3,5e3,1e4],wC=1e4,bC=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class SC{constructor(e,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=lh,this.transport=null,this.heartbeatIntervalMs=_l.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Pu,this.ref=0,this.reconnectTimer=null,this.vsn=eg,this.logger=Pu,this.conn=null,this.sendBuffer=[],this.serializer=new fC,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=n=>n?(...i)=>n(...i):(...i)=>fetch(...i),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${ch.websocket}`,this.httpEndpoint=i0(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=aC.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Ns.connecting:return Sn.Connecting;case Ns.open:return Sn.Open;case Ns.closing:return Sn.Closing;default:return Sn.Closed}}isConnected(){return this.connectionState()===Sn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===s);if(n)return n;{const i=new Ti(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:s,payload:n,ref:i}=e,c=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${s} (${i})`,n),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(dC,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},_l.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const d=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",d)}catch(g){this.log("error","error in heartbeat callback",g)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:n,payload:i,ref:c}=r,o=c?`(${c})`:"",l=i.status||"";this.log("receive",`${l} ${s} ${n} ${o}`.trim(),i),this.channels.filter(d=>d._isMember(s)).forEach(d=>d._trigger(n,i,c)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Ns.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ns.open||this.conn.readyState===Ns.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(jr.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([bC],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r,s=!1;if(e)r=e,s=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),r=this.accessTokenValue}else r=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:cC};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(jr.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(r)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new s0(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},_l.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,s,n,i,c,o,l,d,g,m,v,y;switch(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:lh,this.heartbeatIntervalMs=(n=e==null?void 0:e.heartbeatIntervalMs)!==null&&n!==void 0?n:_l.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(c=e==null?void 0:e.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(o=e==null?void 0:e.heartbeatCallback)!==null&&o!==void 0?o:Pu,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:eg,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e==null?void 0:e.reconnectAfterMs)!==null&&d!==void 0?d:w=>xC[w-1]||wC,this.vsn){case uC:this.encode=(g=e==null?void 0:e.encode)!==null&&g!==void 0?g:(w,_)=>_(JSON.stringify(w)),this.decode=(m=e==null?void 0:e.decode)!==null&&m!==void 0?m:(w,_)=>_(JSON.parse(w));break;case r0:this.encode=(v=e==null?void 0:e.encode)!==null&&v!==void 0?v:this.serializer.encode.bind(this.serializer),this.decode=(y=e==null?void 0:e.decode)!==null&&y!==void 0?y:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var Sa=class extends Error{constructor(t,e){var r;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((r=e.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function CC(t,e,r){const s=new URL(e,t);if(r)for(const[n,i]of Object.entries(r))i!==void 0&&s.searchParams.set(n,i);return s.toString()}async function kC(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function EC(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:n,body:i,headers:c}){const o=CC(t.baseUrl,s,n),l=await kC(t.auth),d=await e(o,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...l,...c},body:i?JSON.stringify(i):void 0}),g=await d.text(),m=(d.headers.get("content-type")||"").includes("application/json"),v=m&&g?JSON.parse(g):g;if(!d.ok){const y=m?v:void 0,w=y==null?void 0:y.error;throw new Sa((w==null?void 0:w.message)??`Request failed with status ${d.status}`,{status:d.status,icebergType:w==null?void 0:w.type,icebergCode:w==null?void 0:w.code,details:y})}return{status:d.status,headers:d.headers,data:v}}}}function yl(t){return t.join("")}var jC=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:yl(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${yl(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${yl(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${yl(t.namespace)}`}),!0}catch(e){if(e instanceof Sa&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof Sa&&r.status===409)return;throw r}}};function ii(t){return t.join("")}var RC=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ii(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ii(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ii(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ii(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ii(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ii(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof Sa&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof Sa&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},NC=class{constructor(t){var s;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=EC({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(s=t.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new jC(this.client,e),this.tableOps=new RC(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},Zc=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function We(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var TC=class extends Zc{constructor(t,e,r){super(t),this.name="StorageApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},dh=class extends Zc{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const Kf=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),AC=()=>Response,hh=t=>{if(Array.isArray(t))return t.map(r=>hh(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=hh(s)}),e},OC=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},PC=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Ca(t){"@babel/helpers - typeof";return Ca=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ca(t)}function LC(t,e){if(Ca(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(Ca(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IC(t){var e=LC(t,"string");return Ca(e)=="symbol"?e:e+""}function DC(t,e,r){return(e=IC(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ng(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function _e(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ng(Object(r),!0).forEach(function(s){DC(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ng(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}const Lu=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},MC=async(t,e,r)=>{t instanceof await AC()&&!(r!=null&&r.noResolveJson)?t.json().then(s=>{const n=t.status||500,i=(s==null?void 0:s.statusCode)||n+"";e(new TC(Lu(s),n,i))}).catch(s=>{e(new dh(Lu(s),s))}):e(new dh(Lu(t),t))},BC=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?n:(OC(s)?(n.headers=_e({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,e!=null&&e.duplex&&(n.duplex=e.duplex),_e(_e({},n),r))};async function qa(t,e,r,s,n,i){return new Promise((c,o)=>{t(r,BC(e,s,n,i)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>c(l)).catch(l=>MC(l,o,s))})}async function ka(t,e,r,s){return qa(t,"GET",e,r,s)}async function Sr(t,e,r,s,n){return qa(t,"POST",e,s,n,r)}async function fh(t,e,r,s,n){return qa(t,"PUT",e,s,n,r)}async function $C(t,e,r,s){return qa(t,"HEAD",e,_e(_e({},r),{},{noResolveJson:!0}),s)}async function Jf(t,e,r,s,n){return qa(t,"DELETE",e,s,n,r)}var FC=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(We(e))return{data:null,error:e};throw e}}};let o0;o0=Symbol.toStringTag;var UC=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[o0]="BlobDownloadBuilder",this.promise=null}asStream(){return new FC(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(We(e))return{data:null,error:e};throw e}}};const HC={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ig={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var zC=class{constructor(t,e={},r,s){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=r,this.fetch=Kf(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,r,s){var n=this;try{let i;const c=_e(_e({},ig),s);let o=_e(_e({},n.headers),t==="POST"&&{"x-upsert":String(c.upsert)});const l=c.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",c.cacheControl),l&&i.append("metadata",n.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",c.cacheControl),l&&!i.has("metadata")&&i.append("metadata",n.encodeMetadata(l))):(i=r,o["cache-control"]=`max-age=${c.cacheControl}`,o["content-type"]=c.contentType,l&&(o["x-metadata"]=n.toBase64(n.encodeMetadata(l))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!c.duplex&&(c.duplex="half")),s!=null&&s.headers&&(o=_e(_e({},o),s.headers));const d=n._removeEmptyFolders(e),g=n._getFinalPath(d),m=await(t=="PUT"?fh:Sr)(n.fetch,`${n.url}/object/${g}`,i,_e({headers:o},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{data:{path:d,id:m.Id,fullPath:m.Key},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(We(i))return{data:null,error:i};throw i}}async upload(t,e,r){return this.uploadOrUpdate("POST",t,e,r)}async uploadToSignedUrl(t,e,r,s){var n=this;const i=n._removeEmptyFolders(t),c=n._getFinalPath(i),o=new URL(n.url+`/object/upload/sign/${c}`);o.searchParams.set("token",e);try{let l;const d=_e({upsert:ig.upsert},s),g=_e(_e({},n.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",d.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",d.cacheControl)):(l=r,g["cache-control"]=`max-age=${d.cacheControl}`,g["content-type"]=d.contentType),{data:{path:i,fullPath:(await fh(n.fetch,o.toString(),l,{headers:g})).Key},error:null}}catch(l){if(n.shouldThrowOnError)throw l;if(We(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(t,e){var r=this;try{let s=r._getFinalPath(t);const n=_e({},r.headers);e!=null&&e.upsert&&(n["x-upsert"]="true");const i=await Sr(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:n}),c=new URL(r.url+i.url),o=c.searchParams.get("token");if(!o)throw new Zc("No token returned by API");return{data:{signedUrl:c.toString(),path:t,token:o},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(We(s))return{data:null,error:s};throw s}}async update(t,e,r){return this.uploadOrUpdate("PUT",t,e,r)}async move(t,e,r){var s=this;try{return{data:await Sr(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(We(n))return{data:null,error:n};throw n}}async copy(t,e,r){var s=this;try{return{data:{path:(await Sr(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers})).Key},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(We(n))return{data:null,error:n};throw n}}async createSignedUrl(t,e,r){var s=this;try{let n=s._getFinalPath(t),i=await Sr(s.fetch,`${s.url}/object/sign/${n}`,_e({expiresIn:e},r!=null&&r.transform?{transform:r.transform}:{}),{headers:s.headers});const c=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${s.url}${i.signedURL}${c}`)},{data:i,error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(We(n))return{data:null,error:n};throw n}}async createSignedUrls(t,e,r){var s=this;try{const n=await Sr(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:t},{headers:s.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(c=>_e(_e({},c),{},{signedUrl:c.signedURL?encodeURI(`${s.url}${c.signedURL}${i}`):null})),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(We(n))return{data:null,error:n};throw n}}download(t,e){const r=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),n=s?`?${s}`:"",i=this._getFinalPath(t),c=()=>ka(this.fetch,`${this.url}/${r}/${i}${n}`,{headers:this.headers,noResolveJson:!0});return new UC(c,this.shouldThrowOnError)}async info(t){var e=this;const r=e._getFinalPath(t);try{return{data:hh(await ka(e.fetch,`${e.url}/object/info/${r}`,{headers:e.headers})),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(We(s))return{data:null,error:s};throw s}}async exists(t){var e=this;const r=e._getFinalPath(t);try{return await $C(e.fetch,`${e.url}/object/${r}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(We(s)&&s instanceof dh){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}}getPublicUrl(t,e){const r=this._getFinalPath(t),s=[],n=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";n!==""&&s.push(n);const i=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});c!==""&&s.push(c);let o=s.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${o}`)}}}async remove(t){var e=this;try{return{data:await Jf(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(We(r))return{data:null,error:r};throw r}}async list(t,e,r){var s=this;try{const n=_e(_e(_e({},HC),e),{},{prefix:t||""});return{data:await Sr(s.fetch,`${s.url}/object/list/${s.bucketId}`,n,{headers:s.headers},r),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(We(n))return{data:null,error:n};throw n}}async listV2(t,e){var r=this;try{const s=_e({},t);return{data:await Sr(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},e),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(We(s))return{data:null,error:s};throw s}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const a0="2.91.0",l0={"X-Client-Info":`storage-js/${a0}`};var WC=class{constructor(t,e={},r,s){this.shouldThrowOnError=!1;const n=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),this.url=n.href.replace(/\/$/,""),this.headers=_e(_e({},l0),e),this.fetch=Kf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const r=e.listBucketOptionsToQueryString(t);return{data:await ka(e.fetch,`${e.url}/bucket${r}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(We(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await ka(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(We(r))return{data:null,error:r};throw r}}async createBucket(t,e={public:!1}){var r=this;try{return{data:await Sr(r.fetch,`${r.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(We(s))return{data:null,error:s};throw s}}async updateBucket(t,e){var r=this;try{return{data:await fh(r.fetch,`${r.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(We(s))return{data:null,error:s};throw s}}async emptyBucket(t){var e=this;try{return{data:await Sr(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(We(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await Jf(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(We(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},qC=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=_e(_e({},l0),e),this.fetch=Kf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await Sr(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(We(r))return{data:null,error:r};throw r}}async listBuckets(t){var e=this;try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const s=r.toString(),n=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return{data:await ka(e.fetch,n,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(We(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await Jf(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(We(r))return{data:null,error:r};throw r}}from(t){var e=this;if(!PC(t))throw new Zc("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new NC({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(n,i){const c=n[i];return typeof c!="function"?c:async(...o)=>{try{return{data:await c.apply(n,o),error:null}}catch(l){if(s)throw l;return{data:null,error:l}}}}})}};const Qf={"X-Client-Info":`storage-js/${a0}`,"Content-Type":"application/json"};var c0=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Xt(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var Iu=class extends c0{constructor(t,e,r){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},GC=class extends c0{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const Zf=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),VC=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},og=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),KC=async(t,e,r)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(r!=null&&r.noResolveJson)){const s=t.status||500,n=t;if(typeof n.json=="function")n.json().then(i=>{const c=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||s+"";e(new Iu(og(i),s,c))}).catch(()=>{const i=s+"";e(new Iu(n.statusText||`HTTP ${s} error`,s,i))});else{const i=s+"";e(new Iu(n.statusText||`HTTP ${s} error`,s,i))}}else e(new GC(og(t),t))},JC=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return s?(VC(s)?(n.headers=_e({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,_e(_e({},n),r)):n};async function QC(t,e,r,s,n,i){return new Promise((c,o)=>{t(r,JC(e,s,n,i)).then(l=>{if(!l.ok)throw l;if(s!=null&&s.noResolveJson)return l;const d=l.headers.get("content-type");return!d||!d.includes("application/json")?{}:l.json()}).then(l=>c(l)).catch(l=>KC(l,o,s))})}async function er(t,e,r,s,n){return QC(t,"POST",e,s,n,r)}var ZC=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=_e(_e({},Qf),e),this.fetch=Zf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await er(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Xt(r))return{data:null,error:r};throw r}}async getIndex(t,e){var r=this;try{return{data:await er(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Xt(s))return{data:null,error:s};throw s}}async listIndexes(t){var e=this;try{return{data:await er(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Xt(r))return{data:null,error:r};throw r}}async deleteIndex(t,e){var r=this;try{return{data:await er(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers})||{},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Xt(s))return{data:null,error:s};throw s}}},YC=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=_e(_e({},Qf),e),this.fetch=Zf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await er(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Xt(r))return{data:null,error:r};throw r}}async getVectors(t){var e=this;try{return{data:await er(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Xt(r))return{data:null,error:r};throw r}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await er(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Xt(r))return{data:null,error:r};throw r}}async queryVectors(t){var e=this;try{return{data:await er(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Xt(r))return{data:null,error:r};throw r}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await er(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Xt(r))return{data:null,error:r};throw r}}},XC=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=_e(_e({},Qf),e),this.fetch=Zf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await er(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Xt(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await er(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Xt(r))return{data:null,error:r};throw r}}async listBuckets(t={}){var e=this;try{return{data:await er(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Xt(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await er(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Xt(r))return{data:null,error:r};throw r}}},ek=class extends XC{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new tk(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,r=this;return e().call(r,t)}async getBucket(t){var e=()=>super.getBucket,r=this;return e().call(r,t)}async listBuckets(t={}){var e=()=>super.listBuckets,r=this;return e().call(r,t)}async deleteBucket(t){var e=()=>super.deleteBucket,r=this;return e().call(r,t)}},tk=class extends ZC{constructor(t,e,r,s){super(t,e,s),this.vectorBucketName=r}async createIndex(t){var e=()=>super.createIndex,r=this;return e().call(r,_e(_e({},t),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,r=this;return e().call(r,_e(_e({},t),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,r=this;return e().call(r,r.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,r=this;return e().call(r,r.vectorBucketName,t)}index(t){return new rk(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},rk=class extends YC{constructor(t,e,r,s,n){super(t,e,n),this.vectorBucketName=r,this.indexName=s}async putVectors(t){var e=()=>super.putVectors,r=this;return e().call(r,_e(_e({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(t){var e=()=>super.getVectors,r=this;return e().call(r,_e(_e({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,r=this;return e().call(r,_e(_e({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,r=this;return e().call(r,_e(_e({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,r=this;return e().call(r,_e(_e({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},sk=class extends WC{constructor(t,e={},r,s){super(t,e,r,s)}from(t){return new zC(this.url,this.headers,t,this.fetch)}get vectors(){return new ek(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new qC(this.url+"/iceberg",this.headers,this.fetch)}};const u0="2.91.0",mi=30*1e3,ph=3,Du=ph*mi,nk="http://localhost:9999",ik="supabase.auth.token",ok={"X-Client-Info":`gotrue-js/${u0}`},mh="X-Supabase-Api-Version",d0={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ak=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,lk=10*60*1e3;class Ea extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function pe(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class ck extends Ea{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function uk(t){return pe(t)&&t.name==="AuthApiError"}class Cn extends Ea{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class _s extends Ea{constructor(e,r,s,n){super(e,s,n),this.name=r,this.status=s}}class Zt extends _s{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function dk(t){return pe(t)&&t.name==="AuthSessionMissingError"}class oi extends _s{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class xl extends _s{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class wl extends _s{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function hk(t){return pe(t)&&t.name==="AuthImplicitGrantRedirectError"}class ag extends _s{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class fk extends _s{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class gh extends _s{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Mu(t){return pe(t)&&t.name==="AuthRetryableFetchError"}class lg extends _s{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class vh extends _s{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const yc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),cg=` 	
\r=`.split(""),pk=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<cg.length;e+=1)t[cg[e].charCodeAt(0)]=-2;for(let e=0;e<yc.length;e+=1)t[yc[e].charCodeAt(0)]=e;return t})();function ug(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(yc[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(yc[s]),e.queuedBits-=6}}function h0(t,e,r){const s=pk[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function dg(t){const e=[],r=c=>{e.push(String.fromCodePoint(c))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=c=>{vk(c,s,r)};for(let c=0;c<t.length;c+=1)h0(t.charCodeAt(c),n,i);return e.join("")}function mk(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function gk(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}mk(s,e)}}function vk(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function $i(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)h0(t.charCodeAt(n),r,s);return new Uint8Array(e)}function _k(t){const e=[];return gk(t,r=>e.push(r)),new Uint8Array(e)}function Nn(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};return t.forEach(n=>ug(n,r,s)),ug(null,r,s),e.join("")}function yk(t){return Math.round(Date.now()/1e3)+t}function xk(){return Symbol("auth-callback")}const _t=()=>typeof window<"u"&&typeof document<"u",vn={tested:!1,writable:!1},f0=()=>{if(!_t())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(vn.tested)return vn.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),vn.tested=!0,vn.writable=!0}catch{vn.tested=!0,vn.writable=!1}return vn.writable};function wk(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const p0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),bk=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",gi=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},_n=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},vt=async(t,e)=>{await t.removeItem(e)};class Yc{constructor(){this.promise=new Yc.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Yc.promiseConstructor=Promise;function Bu(t){const e=t.split(".");if(e.length!==3)throw new vh("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!ak.test(e[s]))throw new vh("JWT not in base64url format");return{header:JSON.parse(dg(e[0])),payload:JSON.parse(dg(e[1])),signature:$i(e[2]),raw:{header:e[0],payload:e[1]}}}async function Sk(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Ck(t,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const c=await t(i);if(!e(i,null,c)){s(c);return}}catch(c){if(!e(i,c)){n(c);return}}})()})}function kk(t){return("0"+t.toString(16)).substr(-2)}function Ek(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,kk).join("")}async function jk(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function Rk(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await jk(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ai(t,e,r=!1){const s=Ek();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await gi(t,`${e}-code-verifier`,n);const i=await Rk(s);return[i,s===i?"plain":"s256"]}const Nk=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Tk(t){const e=t.headers.get(mh);if(!e||!e.match(Nk))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Ak(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Ok(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Pk=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function li(t){if(!Pk.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function $u(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Lk(t,e){return new Proxy(t,{get:(r,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const i=s.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,n)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,s,n)}})}function hg(t){return JSON.parse(JSON.stringify(t))}const bn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Ik=[502,503,504];async function fg(t){var e;if(!bk(t))throw new gh(bn(t),0);if(Ik.includes(t.status))throw new gh(bn(t),t.status);let r;try{r=await t.json()}catch(i){throw new Cn(bn(i),i)}let s;const n=Tk(t);if(n&&n.getTime()>=d0["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new lg(bn(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Zt}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,c)=>i&&typeof c=="string",!0))throw new lg(bn(r),t.status,r.weak_password.reasons);throw new ck(bn(r),t.status||500,s)}const Dk=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function ve(t,e,r,s){var n;const i=Object.assign({},s==null?void 0:s.headers);i[mh]||(i[mh]=d0["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const c=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(c.redirect_to=s.redirectTo);const o=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",l=await Mk(t,e,r+o,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function Mk(t,e,r,s,n,i){const c=Dk(e,s,n,i);let o;try{o=await t(r,Object.assign({},c))}catch(l){throw console.error(l),new gh(bn(l),0)}if(o.ok||await fg(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(l){await fg(l)}}function wr(t){var e;let r=null;Fk(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=yk(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function pg(t){const e=wr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ps(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Bk(t){return{data:t,error:null}}function $k(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=t,c=bo(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},l=Object.assign({},c);return{data:{properties:o,user:l},error:null}}function mg(t){return t}function Fk(t){return t.access_token&&t.refresh_token&&t.expires_in}const Fu=["global","local","others"];class Uk{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=p0(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=Fu[0]){if(Fu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Fu.join(", ")}`);try{return await ve(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(pe(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await ve(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ps})}catch(s){if(pe(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=bo(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await ve(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:$k,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(pe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await ve(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ps})}catch(r){if(pe(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,i,c,o,l;try{const d={nextPage:null,lastPage:0,total:0},g=await ve(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:mg});if(g.error)throw g.error;const m=await g.json(),v=(c=g.headers.get("x-total-count"))!==null&&c!==void 0?c:0,y=(l=(o=g.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return y.length>0&&(y.forEach(w=>{const _=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),p=JSON.parse(w.split(";")[1].split("=")[1]);d[`${p}Page`]=_}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(pe(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){li(e);try{return await ve(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ps})}catch(r){if(pe(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){li(e);try{return await ve(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Ps})}catch(s){if(pe(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){li(e);try{return await ve(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ps})}catch(s){if(pe(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){li(e.userId);try{const{data:r,error:s}=await ve(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(pe(r))return{data:null,error:r};throw r}}async _deleteFactor(e){li(e.userId),li(e.id);try{return{data:await ve(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(pe(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,s,n,i,c,o,l;try{const d={nextPage:null,lastPage:0,total:0},g=await ve(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:mg});if(g.error)throw g.error;const m=await g.json(),v=(c=g.headers.get("x-total-count"))!==null&&c!==void 0?c:0,y=(l=(o=g.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return y.length>0&&(y.forEach(w=>{const _=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),p=JSON.parse(w.split(";")[1].split("=")[1]);d[`${p}Page`]=_}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(pe(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await ve(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(pe(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await ve(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(pe(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await ve(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(pe(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await ve(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(pe(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await ve(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(pe(r))return{data:null,error:r};throw r}}}function gg(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const ci={debug:!!(globalThis&&f0()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class m0 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Hk extends m0{}async function zk(t,e,r){ci.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),ci.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){ci.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{ci.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw ci.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Hk(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(ci.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Wk(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function g0(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function qk(t){return parseInt(t,16)}function Gk(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function Vk(t){var e;const{chainId:r,domain:s,expirationTime:n,issuedAt:i=new Date,nonce:c,notBefore:o,requestId:l,resources:d,scheme:g,uri:m,version:v}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(v!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${v}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const y=g0(t.address),w=g?`${g}://${s}`:s,_=t.statement?`${t.statement}
`:"",p=`${w} wants you to sign in with your Ethereum account:
${y}

${_}`;let h=`URI: ${m}
Version: ${v}
Chain ID: ${r}${c?`
Nonce: ${c}`:""}
Issued At: ${i.toISOString()}`;if(n&&(h+=`
Expiration Time: ${n.toISOString()}`),o&&(h+=`
Not Before: ${o.toISOString()}`),l&&(h+=`
Request ID: ${l}`),d){let u=`
Resources:`;for(const f of d){if(!f||typeof f!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${f}`);u+=`
- ${f}`}h+=u}return`${p}
${h}`}class et extends Error{constructor({message:e,code:r,cause:s,name:n}){var i;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(i=n??(s instanceof Error?s.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class xc extends et{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function Kk({error:t,options:e}){var r,s,n;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new et({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new et({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new et({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new et({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new et({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new et({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new et({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new et({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const c=window.location.hostname;if(v0(c)){if(i.rp.id!==c)return new et({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new et({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new et({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new et({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new et({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Jk({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new et({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new et({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(v0(s)){if(r.rpId!==s)return new et({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new et({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new et({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new et({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class Qk{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Zk=new Qk;function Yk(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:s}=t,n=bo(t,["challenge","user","excludeCredentials"]),i=$i(e).buffer,c=Object.assign(Object.assign({},r),{id:$i(r.id).buffer}),o=Object.assign(Object.assign({},n),{challenge:i,user:c});if(s&&s.length>0){o.excludeCredentials=new Array(s.length);for(let l=0;l<s.length;l++){const d=s[l];o.excludeCredentials[l]=Object.assign(Object.assign({},d),{id:$i(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return o}function Xk(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,s=bo(t,["challenge","allowCredentials"]),n=$i(e).buffer,i=Object.assign(Object.assign({},s),{challenge:n});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const o=r[c];i.allowCredentials[c]=Object.assign(Object.assign({},o),{id:$i(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return i}function eE(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:Nn(new Uint8Array(t.response.attestationObject)),clientDataJSON:Nn(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function tE(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,s=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Nn(new Uint8Array(n.authenticatorData)),clientDataJSON:Nn(new Uint8Array(n.clientDataJSON)),signature:Nn(new Uint8Array(n.signature)),userHandle:n.userHandle?Nn(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function v0(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function vg(){var t,e;return!!(_t()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function rE(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new xc("Browser returned unexpected credential type",e)}:{data:null,error:new xc("Empty credential response",e)}}catch(e){return{data:null,error:Kk({error:e,options:t})}}}async function sE(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new xc("Browser returned unexpected credential type",e)}:{data:null,error:new xc("Empty credential response",e)}}catch(e){return{data:null,error:Jk({error:e,options:t})}}}const nE={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},iE={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function wc(...t){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of t)if(n)for(const i in n){const c=n[i];if(c!==void 0)if(Array.isArray(c))s[i]=c;else if(r(c))s[i]=c;else if(e(c)){const o=s[i];e(o)?s[i]=wc(o,c):s[i]=wc(c)}else s[i]=c}return s}function oE(t,e){return wc(nE,t,e||{})}function aE(t,e){return wc(iE,t,e||{})}class lE{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:s,signal:n},i){try{const{data:c,error:o}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!c)return{data:null,error:o};const l=n??Zk.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:d}=c.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${s}`),d.displayName||(d.displayName=d.name)}switch(c.webauthn.type){case"create":{const d=oE(c.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:g,error:m}=await rE({publicKey:d,signal:l});return g?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:g}},error:null}:{data:null,error:m}}case"request":{const d=aE(c.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:g,error:m}=await sE(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:d,signal:l}));return g?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:g}},error:null}:{data:null,error:m}}}}catch(c){return pe(c)?{data:null,error:c}:{data:null,error:new Cn("Unexpected error in challenge",c)}}}async _verify({challengeId:e,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!r)return{data:null,error:new Ea("rpId is required for WebAuthn authentication")};try{if(!vg())return{data:null,error:new Cn("Browser does not support WebAuthn",null)};const{data:c,error:o}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:s},signal:n},{request:i});if(!c)return{data:null,error:o};const{webauthn:l}=c;return this._verify({factorId:e,challengeId:c.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:s,credential_response:l.credential_response}})}catch(c){return pe(c)?{data:null,error:c}:{data:null,error:new Cn("Unexpected error in authenticate",c)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!r)return{data:null,error:new Ea("rpId is required for WebAuthn registration")};try{if(!vg())return{data:null,error:new Cn("Browser does not support WebAuthn",null)};const{data:c,error:o}=await this._enroll({friendlyName:e});if(!c)return await this.client.mfa.listFactors().then(g=>{var m;return(m=g.data)===null||m===void 0?void 0:m.all.find(v=>v.factor_type==="webauthn"&&v.friendly_name===e&&v.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g==null?void 0:g.id}):void 0),{data:null,error:o};const{data:l,error:d}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:n},{create:i});return l?this._verify({factorId:c.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:s,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:d}}catch(c){return pe(c)?{data:null,error:c}:{data:null,error:new Cn("Unexpected error in register",c)}}}}Wk();const cE={url:nk,storageKey:ik,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ok,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function _g(t,e,r){return await r()}const ui={};class ja{get jwks(){var e,r;return(r=(e=ui[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){ui[this.storageKey]=Object.assign(Object.assign({},ui[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=ui[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ui[this.storageKey]=Object.assign(Object.assign({},ui[this.storageKey]),{cachedAt:e})}constructor(e){var r,s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},cE),e);if(this.storageKey=i.storageKey,this.instanceID=(r=ja.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,ja.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&_t()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Uk({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=p0(i.fetch),this.lock=i.lock||_g,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&_t()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=zk:this.lock=_g,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new lE(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:f0()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=gg(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=gg(this.memoryStorage)),_t()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${u0}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},s="none";if(_t()&&(r=wk(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),_t()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:i}=await this._getSessionFromURL(r,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),hk(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:c,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",c,"redirect type",o),await this._saveSession(c),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return pe(r)?this._returnResult({error:r}):this._returnResult({error:new Cn("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,n;try{const i=await ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:wr}),{data:c,error:o}=i;if(o||!c)return this._returnResult({data:{user:null,session:null},error:o});const l=c.session,d=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:d,session:l},error:null})}catch(i){if(pe(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var r,s,n;try{let i;if("email"in e){const{email:g,password:m,options:v}=e;let y=null,w=null;this.flowType==="pkce"&&([y,w]=await ai(this.storage,this.storageKey)),i=await ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v==null?void 0:v.emailRedirectTo,body:{email:g,password:m,data:(r=v==null?void 0:v.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:y,code_challenge_method:w},xform:wr})}else if("phone"in e){const{phone:g,password:m,options:v}=e;i=await ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:m,data:(s=v==null?void 0:v.data)!==null&&s!==void 0?s:{},channel:(n=v==null?void 0:v.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken}},xform:wr})}else throw new xl("You must provide either an email or phone number and a password");const{data:c,error:o}=i;if(o||!c)return await vt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const l=c.session,d=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:d,session:l},error:null})}catch(i){if(await vt(this.storage,`${this.storageKey}-code-verifier`),pe(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:c,options:o}=e;r=await ve(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:c,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:pg})}else if("phone"in e){const{phone:i,password:c,options:o}=e;r=await ve(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:c,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:pg})}else throw new xl("You must provide either an email or phone number and a password");const{data:s,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const i=new oi;return this._returnResult({data:{user:null,session:null},error:i})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,s,n,i,c,o,l,d,g,m,v;let y,w;if("message"in e)y=e.message,w=e.signature;else{const{chain:_,wallet:p,statement:h,options:u}=e;let f;if(_t())if(typeof p=="object")f=p;else{const E=window;if("ethereum"in E&&typeof E.ethereum=="object"&&"request"in E.ethereum&&typeof E.ethereum.request=="function")f=E.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof p!="object"||!(u!=null&&u.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");f=p}const x=new URL((r=u==null?void 0:u.url)!==null&&r!==void 0?r:window.location.href),k=await f.request({method:"eth_requestAccounts"}).then(E=>E).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!k||k.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const C=g0(k[0]);let S=(s=u==null?void 0:u.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!S){const E=await f.request({method:"eth_chainId"});S=qk(E)}const b={domain:x.host,address:C,statement:h,uri:x.href,version:"1",chainId:S,nonce:(n=u==null?void 0:u.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(c=(i=u==null?void 0:u.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(o=u==null?void 0:u.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=u==null?void 0:u.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(d=u==null?void 0:u.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(g=u==null?void 0:u.signInWithEthereum)===null||g===void 0?void 0:g.resources};y=Vk(b),w=await f.request({method:"personal_sign",params:[Gk(y),C]})}try{const{data:_,error:p}=await ve(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:y,signature:w},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:wr});if(p)throw p;if(!_||!_.session||!_.user){const h=new oi;return this._returnResult({data:{user:null,session:null},error:h})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:p})}catch(_){if(pe(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(e){var r,s,n,i,c,o,l,d,g,m,v,y;let w,_;if("message"in e)w=e.message,_=e.signature;else{const{chain:p,wallet:h,statement:u,options:f}=e;let x;if(_t())if(typeof h=="object")x=h;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))x=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof h!="object"||!(f!=null&&f.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=h}const k=new URL((r=f==null?void 0:f.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in x&&x.signIn){const C=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},f==null?void 0:f.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),u?{statement:u}:null));let S;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")S=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)S=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)w=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),_=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in x)||typeof x.signMessage!="function"||!("publicKey"in x)||typeof x!="object"||!x.publicKey||!("toBase58"in x.publicKey)||typeof x.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${k.host} wants you to sign in with your Solana account:`,x.publicKey.toBase58(),...u?["",u,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(n=(s=f==null?void 0:f.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=f==null?void 0:f.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${f.signInWithSolana.notBefore}`]:[],...!((c=f==null?void 0:f.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${f.signInWithSolana.expirationTime}`]:[],...!((o=f==null?void 0:f.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${f.signInWithSolana.chainId}`]:[],...!((l=f==null?void 0:f.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${f.signInWithSolana.nonce}`]:[],...!((d=f==null?void 0:f.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${f.signInWithSolana.requestId}`]:[],...!((m=(g=f==null?void 0:f.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||m===void 0)&&m.length?["Resources",...f.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const C=await x.signMessage(new TextEncoder().encode(w),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=C}}try{const{data:p,error:h}=await ve(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:Nn(_)},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:wr});if(h)throw h;if(!p||!p.session||!p.user){const u=new oi;return this._returnResult({data:{user:null,session:null},error:u})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:Object.assign({},p),error:h})}catch(p){if(pe(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async _exchangeCodeForSession(e){const r=await _n(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{if(!s&&this.flowType==="pkce")throw new fk;const{data:i,error:c}=await ve(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:wr});if(await vt(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!i||!i.session||!i.user){const o=new oi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return i.session&&(await this._saveSession(i.session),setTimeout(async()=>{await this._notifyAllSubscribers("SIGNED_IN",i.session)},0)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:c})}catch(i){if(await vt(this.storage,`${this.storageKey}-code-verifier`),pe(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:r,provider:s,token:n,access_token:i,nonce:c}=e,o=await ve(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:c,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:wr}),{data:l,error:d}=o;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!l||!l.session||!l.user){const g=new oi;return this._returnResult({data:{user:null,session:null},error:g})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:d})}catch(r){if(pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,s,n,i,c;try{if("email"in e){const{email:o,options:l}=e;let d=null,g=null;this.flowType==="pkce"&&([d,g]=await ai(this.storage,this.storageKey));const{error:m}=await ve(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:d,code_challenge_method:g},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in e){const{phone:o,options:l}=e,{data:d,error:g}=await ve(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(c=l==null?void 0:l.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:g})}throw new xl("You must provide either an email or phone number.")}catch(o){if(await vt(this.storage,`${this.storageKey}-code-verifier`),pe(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(e){var r,s;try{let n,i;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:c,error:o}=await ve(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:wr});if(o)throw o;if(!c)throw new Error("An error occurred on token verification.");const l=c.session,d=c.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:d,session:l},error:null})}catch(n){if(pe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var r,s,n,i,c;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await ai(this.storage,this.storageKey));const d=await ve(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:Bk});return!((i=d.data)===null||i===void 0)&&i.url&&_t()&&!(!((c=e.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(o){if(await vt(this.storage,`${this.storageKey}-code-verifier`),pe(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new Zt;const{error:n}=await ve(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(pe(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:c}=await ve(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:c,error:o}=await ve(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:o})}throw new xl("You must provide either an email or phone number and a type")}catch(r){if(pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await _n(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Du:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const c=await _n(this.userStorage,this.storageKey+"-user");c!=null&&c.user?e.user=c.user:e.user=$u()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};e.user=Lk(e.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(e){try{return e?await ve(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ps}):await this._useSession(async r=>{var s,n,i;const{data:c,error:o}=r;if(o)throw o;return!(!((s=c.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Zt}:await ve(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=c.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Ps})})}catch(r){if(pe(r))return dk(r)&&(await this._removeSession(),await vt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new Zt;const c=n.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await ai(this.storage,this.storageKey));const{data:d,error:g}=await ve(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:c.access_token,xform:Ps});if(g)throw g;return c.user=d.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(s){if(await vt(this.storage,`${this.storageKey}-code-verifier`),pe(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Zt;const r=Date.now()/1e3;let s=r,n=!0,i=null;const{payload:c}=Bu(e.access_token);if(c.exp&&(s=c.exp,n=s<=r),n){const{data:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(pe(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:c,error:o}=r;if(o)throw o;e=(s=c.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Zt;const{data:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!_t())throw new wl("No browser detected.");if(e.error||e.error_description||e.error_code)throw new wl(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new ag("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new wl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ag("No code detected.");const{data:u,error:f}=await this._exchangeCodeForSession(e.code);if(f)throw f;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:u.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:c,expires_in:o,expires_at:l,token_type:d}=e;if(!i||!o||!c||!d)throw new wl("No session defined in URL");const g=Math.round(Date.now()/1e3),m=parseInt(o);let v=g+m;l&&(v=parseInt(l));const y=v-g;y*1e3<=mi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${m}s`);const w=v-m;g-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,v,g):g-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,v,g);const{data:_,error:p}=await this._getUser(i);if(p)throw p;const h={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:m,expires_at:v,refresh_token:c,token_type:d,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:h,redirectType:e.type},error:null})}catch(s){if(pe(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await _n(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return this._returnResult({error:i});const c=(s=n.session)===null||s===void 0?void 0:s.access_token;if(c){const{error:o}=await this.admin.signOut(c,e);if(o&&!(uk(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return e!=="others"&&(await this._removeSession(),await vt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=xk(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:i},error:c}=r;if(c)throw c;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await ai(this.storage,this.storageKey,!0));try{return await ve(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await vt(this.storage,`${this.storageKey}-code-verifier`),pe(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:s,error:n}=await this._useSession(async i=>{var c,o,l,d,g;const{data:m,error:v}=i;if(v)throw v;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ve(this.fetch,"GET",y,{headers:this.headers,jwt:(g=(d=m.session)===null||d===void 0?void 0:d.access_token)!==null&&g!==void 0?g:void 0})});if(n)throw n;return _t()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(pe(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var s;try{const{error:n,data:{session:i}}=r;if(n)throw n;const{options:c,provider:o,token:l,access_token:d,nonce:g}=e,m=await ve(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=i==null?void 0:i.access_token)!==null&&s!==void 0?s:void 0,body:{provider:o,id_token:l,access_token:d,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:wr}),{data:v,error:y}=m;return y?this._returnResult({data:{user:null,session:null},error:y}):!v||!v.session||!v.user?this._returnResult({data:{user:null,session:null},error:new oi}):(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("USER_UPDATED",v.session)),this._returnResult({data:v,error:y}))}catch(n){if(await vt(this.storage,`${this.storageKey}-code-verifier`),pe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:c}=r;if(c)throw c;return await ve(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await Ck(async n=>(n>0&&await Sk(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await ve(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:wr})),(n,i)=>{const c=200*Math.pow(2,n);return i&&Mu(i)&&Date.now()+c-s<mi})}catch(s){if(this._debug(r,"error",s),pe(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),_t()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await _n(this.storage,this.storageKey);if(n&&this.userStorage){let c=await _n(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:n.user},await gi(this.userStorage,this.storageKey+"-user",c)),n.user=(e=c==null?void 0:c.user)!==null&&e!==void 0?e:$u()}else if(n&&!n.user&&!n.user){const c=await _n(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(n.user=c.user,await vt(this.storage,this.storageKey+"-user"),await gi(this.storage,this.storageKey,n)):n.user=$u()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const i=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Du;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${Du}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:c}=await this._callRefreshToken(n.refresh_token);c&&(console.error(c),Mu(c)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:o}=await this._getUser(n.access_token);!o&&(c!=null&&c.user)?(n.user=c.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(s,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new Zt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Yc;const{data:i,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!i.session)throw new Zt;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={data:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(n,"error",i),pe(i)){const c={data:null,error:i};return Mu(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(c),c}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],c=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,r)}catch(l){i.push(l)}});if(await Promise.all(c),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await vt(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await gi(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const i=hg(n);await gi(this.storage,this.storageKey,i)}else{const n=hg(r);await gi(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await vt(this.storage,this.storageKey),await vt(this.storage,this.storageKey+"-code-verifier"),await vt(this.storage,this.storageKey+"-user"),this.userStorage&&await vt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&_t()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),mi);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/mi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${mi}ms, refresh threshold is ${ph} ticks`),n<=ph&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof m0)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!_t()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,c]=await ai(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(c)}`});n.push(o.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?this._returnResult({data:null,error:i}):await ve(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:c}=r;if(c)return this._returnResult({data:null,error:c});const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:d}=await ve(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&l.type==="totp"&&(!((n=l==null?void 0:l.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return this._returnResult({data:null,error:i});const c=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?eE(e.webauthn.credential_response):tE(e.webauthn.credential_response)})}:{code:e.code}),{data:o,error:l}=await ve(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:c,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return this._returnResult({data:null,error:i});const c=await ve(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});if(c.error)return c;const{data:o}=c;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:Yk(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:Xk(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])n.all.push(i),i.status==="verified"&&n[i.factor_type].push(i);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:s},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Bu(s.access_token);let c=null;i.aal&&(c=i.aal);let o=c;((r=(e=s.user.factors)===null||e===void 0?void 0:e.filter(g=>g.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(o="aal2");const d=i.amr||[];return{data:{currentLevel:c,nextLevel:o,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await ve(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Zt})})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new Zt});const c=await ve(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return c.data&&c.data.redirect_url&&_t()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new Zt});const c=await ve(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return c.data&&c.data.redirect_url&&_t()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;return s?this._returnResult({data:null,error:s}):r?await ve(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new Zt})})}catch(e){if(pe(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?(await ve(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Zt})})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(o=>o.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(o=>o.kid===e),s&&this.jwks_cached_at+lk>n)return s;const{data:i,error:c}=await ve(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,s=i.keys.find(o=>o.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:y,error:w}=await this.getSession();if(w||!y.session)return this._returnResult({data:null,error:w});s=y.session.access_token}const{header:n,payload:i,signature:c,raw:{header:o,payload:l}}=Bu(s);r!=null&&r.allowExpired||Ak(i.exp);const d=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:y}=await this.getUser(s);if(y)throw y;return{data:{claims:i,header:n,signature:c},error:null}}const g=Ok(n.alg),m=await crypto.subtle.importKey("jwk",d,g,!0,["verify"]);if(!await crypto.subtle.verify(g,m,c,_k(`${o}.${l}`)))throw new vh("Invalid JWT signature");return{data:{claims:i,header:n,signature:c},error:null}}catch(s){if(pe(s))return this._returnResult({data:null,error:s});throw s}}}ja.nextInstanceID={};const uE=ja,dE="2.91.0";let Wo="";typeof Deno<"u"?Wo="deno":typeof document<"u"?Wo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Wo="react-native":Wo="node";const hE={"X-Client-Info":`supabase-js-${Wo}/${dE}`},fE={headers:hE},pE={schema:"public"},mE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},gE={};function Ra(t){"@babel/helpers - typeof";return Ra=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ra(t)}function vE(t,e){if(Ra(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(Ra(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _E(t){var e=vE(t,"string");return Ra(e)=="symbol"?e:e+""}function yE(t,e,r){return(e=_E(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function Je(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yg(Object(r),!0).forEach(function(s){yE(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yg(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}const xE=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),wE=()=>Headers,bE=(t,e,r)=>{const s=xE(r),n=wE();return async(i,c)=>{var o;const l=(o=await e())!==null&&o!==void 0?o:t;let d=new n(c==null?void 0:c.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${l}`),s(i,Je(Je({},c),{},{headers:d}))}};function SE(t){return t.endsWith("/")?t:t+"/"}function CE(t,e){var r,s;const{db:n,auth:i,realtime:c,global:o}=t,{db:l,auth:d,realtime:g,global:m}=e,v={db:Je(Je({},l),n),auth:Je(Je({},d),i),realtime:Je(Je({},g),c),storage:{},global:Je(Je(Je({},m),o),{},{headers:Je(Je({},(r=m==null?void 0:m.headers)!==null&&r!==void 0?r:{}),(s=o==null?void 0:o.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?v.accessToken=t.accessToken:delete v.accessToken,v}function kE(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(SE(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var EE=class extends uE{constructor(t){super(t)}},jE=class{constructor(t,e,r){var s,n;this.supabaseUrl=t,this.supabaseKey=e;const i=kE(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const c=`sb-${i.hostname.split(".")[0]}-auth-token`,o={db:pE,realtime:gE,auth:Je(Je({},mE),{},{storageKey:c}),global:fE},l=CE(r??{},o);if(this.storageKey=(s=l.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(n=l.global.headers)!==null&&n!==void 0?n:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(g,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=l.auth)!==null&&d!==void 0?d:{},this.headers,l.global.fetch)}this.fetch=bE(e,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Je({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(g=>this.realtime.setAuth(g)).catch(g=>console.warn("Failed to set initial Realtime auth token:",g)),this.rest=new oC(new URL("rest/v1",i).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new sk(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new tC(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,r;if(t.accessToken)return await t.accessToken();const{data:s}=await t.auth.getSession();return(e=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,userStorage:n,storageKey:i,flowType:c,lock:o,debug:l,throwOnError:d},g,m){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new EE({url:this.authUrl.href,headers:Je(Je({},v),g),storageKey:i,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,userStorage:n,flowType:c,lock:o,debug:l,throwOnError:d,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(y=>y.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new SC(this.realtimeUrl.href,Je(Je({},t),{},{params:Je(Je({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const RE=(t,e,r)=>new jE(t,e,r);function NE(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const r=e.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}NE()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const TE="https://placeholder.supabase.co",AE="placeholder-key",xs=RE(TE,AE),_0=R.createContext(void 0);function OE({children:t}){const[e,r]=R.useState(null),[s,n]=R.useState(null),[i,c]=R.useState(null),[o,l]=R.useState(!0),d=R.useCallback(async(C,S)=>{try{const b=await fetch("/api/profile",{headers:{Authorization:`Bearer ${S}`}});if(b.ok){const E=await b.json();c(E.profile)}else b.status===404||console.error("Failed to fetch profile:",b.statusText),c(null)}catch(b){console.error("Error fetching profile:",b),c(null)}},[]),g=R.useCallback(async()=>{s!=null&&s.access_token&&(e!=null&&e.id)&&await d(e.id,s.access_token)},[s,e,d]);R.useEffect(()=>{xs.auth.getSession().then(async({data:{session:S}})=>{n(S),r((S==null?void 0:S.user)??null),S!=null&&S.user&&S.access_token&&await d(S.user.id,S.access_token),l(!1)});const{data:{subscription:C}}=xs.auth.onAuthStateChange(async(S,b)=>{n(b),r((b==null?void 0:b.user)??null),b!=null&&b.user&&b.access_token?await d(b.user.id,b.access_token):c(null),l(!1)});return()=>C.unsubscribe()},[d]);const m=async(C,S,b)=>{const{data:E,error:N}=await xs.auth.signUp({email:C,password:S,options:{data:{name:b||""}}});if(N)throw new Error(N.message);if(!E.user)throw new Error("Sign up failed - no user returned")},v=async(C,S)=>{const{data:b,error:E}=await xs.auth.signInWithPassword({email:C,password:S});if(E)throw new Error(E.message);if(!b.user)throw new Error("Sign in failed - no user returned")},y=async C=>{const{error:S}=await xs.auth.signInWithOAuth({provider:C,options:{redirectTo:`${window.location.origin}/auth/callback`}});if(S)throw new Error(S.message)},w=async()=>{const{error:C}=await xs.auth.signOut();if(C)throw new Error(C.message);c(null)},_=async C=>{const{error:S}=await xs.auth.resetPasswordForEmail(C,{redirectTo:`${window.location.origin}/reset-password`});if(S)throw new Error(S.message)},p=async C=>{const{error:S}=await xs.auth.updateUser({password:C});if(S)throw new Error(S.message)},h=(i==null?void 0:i.status)==="approved",u=(i==null?void 0:i.status)==="pending_approval",f=(i==null?void 0:i.status)==="rejected",x=(i==null?void 0:i.status)==="suspended",k={user:e,session:s,profile:i,isAuthenticated:!!e,isLoading:o,isApproved:h,isPending:u,isRejected:f,isSuspended:x,creditsRemaining:(i==null?void 0:i.creditsRemaining)??0,signUp:m,signIn:v,signInWithOAuth:y,signOut:w,resetPassword:_,updatePassword:p,refreshProfile:g};return a.jsx(_0.Provider,{value:k,children:t})}function ft(){const t=R.useContext(_0);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function yn({children:t,redirectTo:e="/login",requireApproval:r=!0}){const{isAuthenticated:s,isLoading:n,isApproved:i,isPending:c,isRejected:o,isSuspended:l,profile:d}=ft();if(n)return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-leo-bg",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto mb-4"}),a.jsx("p",{className:"text-leo-text-secondary",children:"Loading..."})]})});if(!s)return a.jsx(gl,{to:e});if(r&&d){if(c)return a.jsx(gl,{to:"/pending-approval"});if(o||l)return a.jsx(gl,{to:"/account-inactive"});if(!i)return a.jsx(gl,{to:"/pending-approval"})}return a.jsx(a.Fragment,{children:t})}function y0(t){var e,r,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(r=y0(t[e]))&&(s&&(s+=" "),s+=r)}else for(r in t)t[r]&&(s&&(s+=" "),s+=r);return s}function x0(){for(var t,e,r=0,s="",n=arguments.length;r<n;r++)(t=arguments[r])&&(e=y0(t))&&(s&&(s+=" "),s+=e);return s}const xg=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,wg=x0,Yf=(t,e)=>r=>{var s;if((e==null?void 0:e.variants)==null)return wg(t,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:n,defaultVariants:i}=e,c=Object.keys(n).map(d=>{const g=r==null?void 0:r[d],m=i==null?void 0:i[d];if(g===null)return null;const v=xg(g)||xg(m);return n[d][v]}),o=r&&Object.entries(r).reduce((d,g)=>{let[m,v]=g;return v===void 0||(d[m]=v),d},{}),l=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((d,g)=>{let{class:m,className:v,...y}=g;return Object.entries(y).every(w=>{let[_,p]=w;return Array.isArray(p)?p.includes({...i,...o}[_]):{...i,...o}[_]===p})?[...d,m,v]:d},[]);return wg(t,c,l,r==null?void 0:r.class,r==null?void 0:r.className)},PE=(...t)=>t.filter(Boolean).join(" "),LE=Yf("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-lg shadow-primary/20 hover:bg-primary/90 hover:shadow-xl hover:shadow-primary/30",destructive:"bg-destructive text-destructive-foreground shadow-lg shadow-destructive/20 hover:bg-destructive/90 hover:shadow-xl hover:shadow-destructive/30",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground hover:border-primary/50",secondary:"bg-secondary text-secondary-foreground shadow-lg shadow-secondary/20 hover:bg-secondary/80 hover:shadow-xl hover:shadow-secondary/30",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),le=R.forwardRef(({className:t,variant:e,size:r,asChild:s=!1,...n},i)=>a.jsx("button",{className:PE(LE({variant:e,size:r,className:t})),ref:i,...n}));le.displayName="Button";/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var IE={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DE=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ie=(t,e)=>{const r=R.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:c,className:o="",children:l,...d},g)=>R.createElement("svg",{ref:g,...IE,width:n,height:n,stroke:s,strokeWidth:c?Number(i)*24/Number(n):i,className:["lucide",`lucide-${DE(t)}`,o].join(" "),...d},[...e.map(([m,v])=>R.createElement(m,v)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bg=ie("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=ie("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=ie("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=ie("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BE=ie("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=ie("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $E=ie("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _h=ie("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FE=ie("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UE=ie("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HE=ie("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=ie("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=ie("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zE=ie("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sg=ie("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cg=ie("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WE=ie("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=ie("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w0=ie("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qE=ie("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GE=ie("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xf=ie("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=ie("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VE=ie("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KE=ie("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JE=ie("FileCode",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m10 13-2 2 2 2",key:"17smn8"}],["path",{d:"m14 17 2-2-2-2",key:"14mezr"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QE=ie("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kg=ie("GitCommitHorizontal",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=ie("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eg=ie("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b0=ie("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZE=ie("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",key:"1kog09"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YE=ie("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XE=ie("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bc=ie("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e2=ie("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=ie("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=ie("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=ie("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=ie("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t2=ie("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r2=ie("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tp=ie("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s2=ie("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n2=ie("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i2=ie("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S0=ie("PauseCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o2=ie("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a2=ie("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sc=ie("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C0=ie("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xc=ie("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l2=ie("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wl=ie("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jg=ie("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yh=ie("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cc=ie("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=ie("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c2=ie("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kc=ie("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u2=ie("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k0=ie("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d2=ie("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rp=ie("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rg=ie("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=ie("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=ie("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.301.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=ie("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function xh(){var c,o;const{user:t,profile:e,creditsRemaining:r,signOut:s}=ft(),n=async()=>{await s(),window.location.href="/"},i=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="dev";return a.jsxs("div",{className:"flex items-center gap-3",children:[i&&a.jsx(Re,{href:"/settings",children:a.jsx(le,{variant:"ghost",size:"sm",className:"text-leo-text-tertiary hover:text-leo-text hover:bg-white/5",title:"Settings",children:a.jsx(Cc,{className:"h-4 w-4"})})}),i&&a.jsx(Re,{href:"/admin/analytics",children:a.jsx(le,{variant:"ghost",size:"sm",className:"text-purple-400 hover:text-purple-300 hover:bg-purple-500/10",children:a.jsx(_h,{className:"h-4 w-4"})})}),e&&a.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[a.jsx(w0,{className:"h-3.5 w-3.5 text-amber-400"}),a.jsx("span",{className:"text-sm font-medium text-amber-400",children:r})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm px-2",children:[a.jsx(rp,{className:"h-4 w-4 text-leo-text-tertiary"}),a.jsx("span",{className:"text-leo-text-secondary max-w-[120px] truncate",children:(e==null?void 0:e.name)||((c=t==null?void 0:t.user_metadata)==null?void 0:c.name)||((o=t==null?void 0:t.email)==null?void 0:o.split("@")[0])})]}),a.jsx(le,{variant:"ghost",size:"sm",onClick:n,className:"text-leo-text-tertiary hover:text-leo-text hover:bg-white/5",children:a.jsx(ep,{className:"h-4 w-4"})})]})}function E0({className:t="",size:e="md",showText:r=!0}){const s={sm:{mark:32,text:"text-xl"},md:{mark:40,text:"text-2xl md:text-3xl"},lg:{mark:56,text:"text-3xl md:text-4xl"}},{mark:n,text:i}=s[e];return a.jsxs("div",{className:`flex items-center gap-3 ${t}`,children:[a.jsx("div",{className:"relative flex-shrink-0",style:{width:n,height:n},children:a.jsxs("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-full h-full",children:[a.jsx("circle",{cx:"24",cy:"24",r:"22",fill:"url(#leo-gradient-bg)",className:"drop-shadow-md"}),a.jsx("circle",{cx:"24",cy:"24",r:"20",stroke:"url(#leo-gradient-ring)",strokeWidth:"1.5",fill:"none",opacity:"0.6"}),a.jsx("path",{d:"M16 12 L16 36 L32 36",stroke:"white",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"}),a.jsx("circle",{cx:"32",cy:"36",r:"3",fill:"white",opacity:"0.9"}),a.jsx("circle",{cx:"16",cy:"12",r:"4",stroke:"white",strokeWidth:"1.5",fill:"none",opacity:"0.4"}),a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:"leo-gradient-bg",x1:"0",y1:"0",x2:"48",y2:"48",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{offset:"0%",stopColor:"hsl(25 85% 45%)"}),a.jsx("stop",{offset:"100%",stopColor:"hsl(35 80% 50%)"})]}),a.jsxs("linearGradient",{id:"leo-gradient-ring",x1:"0",y1:"0",x2:"48",y2:"48",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{offset:"0%",stopColor:"white",stopOpacity:"0.6"}),a.jsx("stop",{offset:"100%",stopColor:"white",stopOpacity:"0.2"})]})]})]})}),r&&a.jsx("span",{className:`font-serif font-bold tracking-tight ${i}`,style:{color:"hsl(30 10% 15%)"},children:"Leo"})]})}function Ta({className:t="",size:e=32}){return a.jsx("div",{className:`flex-shrink-0 ${t}`,style:{width:e,height:e},children:a.jsxs("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-full h-full",children:[a.jsx("circle",{cx:"24",cy:"24",r:"22",fill:"url(#leo-mark-gradient)",className:"drop-shadow-md"}),a.jsx("circle",{cx:"24",cy:"24",r:"20",stroke:"white",strokeWidth:"1.5",fill:"none",opacity:"0.4"}),a.jsx("path",{d:"M16 12 L16 36 L32 36",stroke:"white",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"}),a.jsx("circle",{cx:"32",cy:"36",r:"3",fill:"white",opacity:"0.9"}),a.jsx("circle",{cx:"16",cy:"12",r:"4",stroke:"white",strokeWidth:"1.5",fill:"none",opacity:"0.4"}),a.jsx("defs",{children:a.jsxs("linearGradient",{id:"leo-mark-gradient",x1:"0",y1:"0",x2:"48",y2:"48",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{offset:"0%",stopColor:"hsl(25 85% 45%)"}),a.jsx("stop",{offset:"100%",stopColor:"hsl(35 80% 50%)"})]})})]})})}function lt({children:t}){const{isAuthenticated:e,profile:r}=ft(),[s]=Lr(),[n,i]=R.useState(!1),c=l=>s===l,o=(r==null?void 0:r.role)!=="user";return a.jsxs("div",{className:"min-h-screen bg-background relative",children:[a.jsx("div",{className:"fixed inset-0 leo-dots-pattern opacity-30 pointer-events-none"}),a.jsxs("nav",{className:"leo-nav",children:[a.jsxs("div",{className:"leo-nav-inner",children:[a.jsxs(Re,{href:"/",className:"group",children:[a.jsx("div",{className:"hidden sm:block",children:a.jsx(E0,{size:"md"})}),a.jsx("div",{className:"sm:hidden",children:a.jsx(Ta,{size:36})})]}),a.jsx("div",{className:"hidden md:flex items-center gap-2",children:e?a.jsxs(a.Fragment,{children:[a.jsx(Re,{href:"/apps",children:a.jsxs(le,{variant:"ghost",className:`flex items-center gap-2 text-sm font-medium transition-all duration-200 min-h-11 px-4 rounded-lg ${c("/apps")?"text-primary bg-primary/10":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}`,children:[a.jsx(bc,{className:"h-4 w-4"}),"My Apps"]})}),o&&a.jsx(Re,{href:"/console",children:a.jsxs(le,{variant:"ghost",className:`flex items-center gap-2 text-sm font-medium transition-all duration-200 min-h-11 px-4 rounded-lg ${c("/console")||s.startsWith("/console/")?"text-accent bg-accent/10":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}`,children:[a.jsx(kc,{className:"h-4 w-4"}),"Console"]})}),a.jsx("div",{className:"ml-2 pl-4 border-l border-border",children:a.jsx(xh,{})})]}):a.jsxs(a.Fragment,{children:[a.jsx(Re,{href:"/login",children:a.jsx(le,{variant:"ghost",className:"text-muted-foreground hover:text-foreground hover:bg-muted/50 font-medium min-h-11 px-4",children:"Login"})}),a.jsx(Re,{href:"/request-access",children:a.jsx(le,{className:"leo-btn-primary text-sm px-6 py-2.5",children:"Request Access"})})]})}),a.jsx(le,{variant:"ghost",className:"md:hidden min-h-11 min-w-11 p-0",onClick:()=>i(!n),"aria-label":"Toggle navigation menu",children:n?a.jsx(us,{className:"h-5 w-5"}):a.jsx(r2,{className:"h-5 w-5"})})]}),n&&a.jsx("div",{className:"md:hidden border-t border-border bg-background",children:a.jsx("div",{className:"px-4 py-4 space-y-2",children:e?a.jsxs(a.Fragment,{children:[a.jsx(Re,{href:"/apps",onClick:()=>i(!1),children:a.jsxs(le,{variant:"ghost",className:`w-full justify-start gap-3 min-h-12 text-base ${c("/apps")?"text-primary bg-primary/10":"text-muted-foreground"}`,children:[a.jsx(bc,{className:"h-5 w-5"}),"My Apps"]})}),o&&a.jsx(Re,{href:"/console",onClick:()=>i(!1),children:a.jsxs(le,{variant:"ghost",className:`w-full justify-start gap-3 min-h-12 text-base ${c("/console")?"text-accent bg-accent/10":"text-muted-foreground"}`,children:[a.jsx(kc,{className:"h-5 w-5"}),"Console"]})}),a.jsx("div",{className:"pt-2 border-t border-border",children:a.jsx(xh,{})})]}):a.jsxs(a.Fragment,{children:[a.jsx(Re,{href:"/login",onClick:()=>i(!1),children:a.jsx(le,{variant:"ghost",className:"w-full justify-start min-h-12 text-base text-muted-foreground",children:"Login"})}),a.jsx(Re,{href:"/request-access",onClick:()=>i(!1),children:a.jsx(le,{className:"w-full leo-btn-primary min-h-12 text-base",children:"Request Access"})})]})})})]}),a.jsx("main",{className:"pt-16 md:pt-20 min-h-screen",children:t}),a.jsx("footer",{className:"leo-footer",children:a.jsx("div",{className:"leo-footer-inner",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ta,{size:24}),a.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Leo  Where Engineering Meets Art"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:" 2025 Leo. Build production-ready apps with AI."})]})})})]})}function h2(){return a.jsxs(lt,{children:[a.jsxs("section",{className:"leo-hero relative",children:[a.jsx("div",{className:"absolute top-20 left-10 w-32 h-32 border border-leo-sketch/30 rounded-full opacity-40 animate-float"}),a.jsx("div",{className:"absolute bottom-32 right-20 w-48 h-48 border border-leo-sketch/20 rounded-full opacity-30 animate-float",style:{animationDelay:"2s"}}),a.jsx("div",{className:"absolute top-1/3 right-1/4 w-24 h-24 border border-leo-gold/20 opacity-40",style:{transform:"rotate(45deg)"}}),a.jsx("svg",{className:"absolute left-0 top-1/4 w-[500px] h-[500px] opacity-[0.04] pointer-events-none",viewBox:"0 0 200 200",children:a.jsx("path",{fill:"none",stroke:"currentColor",strokeWidth:"0.5",className:"text-leo-sienna",d:"M100,100 a50,50 0 0,1 50,50 a31,31 0 0,1 -31,31 a19,19 0 0,1 -19,-19 a12,12 0 0,1 12,-12 a7,7 0 0,1 7,7 a5,5 0 0,1 -5,5"})}),a.jsxs("div",{className:"leo-hero-content",children:[a.jsxs("div",{className:"leo-badge mb-8 animate-fade-in",children:[a.jsx(Co,{className:"h-4 w-4 text-leo-gold"}),a.jsx("span",{children:"Now in Private Beta"})]}),a.jsxs("h1",{className:"mb-8 animate-slide-in",children:[a.jsx("span",{className:"block text-foreground",children:"The Art & Science of"}),a.jsx("span",{className:"leo-gradient-text",children:"Building Apps"})]}),a.jsx("p",{className:"text-xl md:text-2xl text-muted-foreground max-w-2xl mx-auto mb-12 leading-relaxed animate-fade-in-up",style:{animationDelay:"0.2s"},children:"Describe your vision. Watch Leo engineer a production-ready application with the precision of a master craftsman."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 animate-fade-in-up",style:{animationDelay:"0.4s"},children:[a.jsx(Re,{href:"/request-access",children:a.jsxs(le,{className:"leo-btn-primary text-lg px-8 py-6 rounded-xl group",children:["Request Beta Access",a.jsx(Pr,{className:"ml-2 h-5 w-5 group-hover:translate-x-1 transition-transform"})]})}),a.jsx(Re,{href:"/login",children:a.jsxs(le,{className:"leo-btn-secondary text-lg px-8 py-6 rounded-xl group",children:[a.jsx(Sc,{className:"mr-2 h-5 w-5"}),"View Demo"]})})]}),a.jsxs("div",{className:"mt-16 flex flex-wrap items-center justify-center gap-6 md:gap-10 text-sm text-muted-foreground animate-fade-in-up",style:{animationDelay:"0.6s"},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ar,{className:"h-4 w-4 text-leo-verdigris"}),a.jsx("span",{children:"No credit card required"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ar,{className:"h-4 w-4 text-leo-verdigris"}),a.jsx("span",{children:"Deploy in seconds"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ar,{className:"h-4 w-4 text-leo-verdigris"}),a.jsx("span",{children:"Full source code ownership"})]})]})]})]}),a.jsx("div",{className:"leo-divider max-w-4xl mx-auto"}),a.jsx("section",{className:"leo-section-alt relative",children:a.jsxs("div",{className:"max-w-6xl mx-auto relative z-10",children:[a.jsxs("div",{className:"text-center mb-16",children:[a.jsx("h2",{className:"text-foreground mb-4",children:"Engineered for Excellence"}),a.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:"Every masterpiece requires the right tools. Leo provides everything you need, from concept to deployment."})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6 lg:gap-8 stagger-children",children:[a.jsxs("div",{className:"leo-feature-card group",children:[a.jsx("div",{className:"leo-feature-icon",style:{background:"linear-gradient(135deg, hsl(25 85% 45% / 0.15), hsl(35 80% 50% / 0.1))"},children:a.jsx(qE,{className:"h-7 w-7 text-leo-sienna"})}),a.jsx("h3",{className:"text-xl font-semibold text-foreground mb-3",children:"AI-Guided Design"}),a.jsx("p",{className:"text-muted-foreground leading-relaxed",children:"Describe your app in plain language. Our AI understands context, requirements, and best practices to engineer production-quality code."})]}),a.jsxs("div",{className:"leo-feature-card group",children:[a.jsx("div",{className:"leo-feature-icon",style:{background:"linear-gradient(135deg, hsl(220 60% 35% / 0.15), hsl(220 50% 45% / 0.1))"},children:a.jsx(XE,{className:"h-7 w-7 text-leo-ultramarine"})}),a.jsx("h3",{className:"text-xl font-semibold text-foreground mb-3",children:"Complete Architecture"}),a.jsx("p",{className:"text-muted-foreground leading-relaxed",children:"Every app includes React frontend, Express backend, PostgreSQL database, authentication, and TypeScript throughout."})]}),a.jsxs("div",{className:"leo-feature-card group",children:[a.jsx("div",{className:"leo-feature-icon",style:{background:"linear-gradient(135deg, hsl(150 40% 35% / 0.15), hsl(150 35% 45% / 0.1))"},children:a.jsx(Wl,{className:"h-7 w-7 text-leo-verdigris"})}),a.jsx("h3",{className:"text-xl font-semibold text-foreground mb-3",children:"Instant Deployment"}),a.jsx("p",{className:"text-muted-foreground leading-relaxed",children:"Deploy to Fly.io with a single click. Get a live URL in seconds with automatic SSL, scaling, and global edge network."})]})]})]})}),a.jsx("section",{className:"leo-section",children:a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-16",children:[a.jsx("h2",{className:"text-foreground mb-4",children:"The Creative Process"}),a.jsx("p",{className:"text-xl text-muted-foreground",children:"Three deliberate steps from vision to reality."})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-8 lg:gap-12",children:[a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"leo-step",children:[a.jsx("div",{className:"leo-step-number leo-step-number-1",children:"1"}),a.jsx("div",{className:"flex-1 h-[2px] bg-gradient-to-r from-leo-sienna/30 to-transparent hidden md:block"})]}),a.jsx("h3",{className:"text-xl font-semibold text-foreground mb-3",children:"Describe Your Vision"}),a.jsx("p",{className:"text-muted-foreground leading-relaxed",children:'Tell Leo what you want to build. "A task manager for creative teams" or "An invoice system for freelancers."'})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"leo-step",children:[a.jsx("div",{className:"leo-step-number leo-step-number-2",children:"2"}),a.jsx("div",{className:"flex-1 h-[2px] bg-gradient-to-r from-leo-ultramarine/30 to-transparent hidden md:block"})]}),a.jsx("h3",{className:"text-xl font-semibold text-foreground mb-3",children:"Watch It Materialize"}),a.jsx("p",{className:"text-muted-foreground leading-relaxed",children:"Leo plans the architecture, generates code, sets up the database, and creates a polished UI  all in real-time."})]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"leo-step",children:a.jsx("div",{className:"leo-step-number leo-step-number-3",children:"3"})}),a.jsx("h3",{className:"text-xl font-semibold text-foreground mb-3",children:"Deploy & Iterate"}),a.jsx("p",{className:"text-muted-foreground leading-relaxed",children:"Deploy with one click, get your live URL, and continue refining. Request changes anytime  Leo remembers your entire project."})]})]})]})}),a.jsx("div",{className:"leo-divider max-w-4xl mx-auto"}),a.jsxs("section",{className:"leo-section relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-muted/20 to-transparent"}),a.jsx("div",{className:"absolute top-8 left-8 w-20 h-20 border-l-2 border-t-2 border-leo-sketch/20 opacity-50"}),a.jsx("div",{className:"absolute bottom-8 right-8 w-20 h-20 border-r-2 border-b-2 border-leo-sketch/20 opacity-50"}),a.jsxs("div",{className:"relative z-10 max-w-3xl mx-auto text-center",children:[a.jsxs("div",{className:"leo-badge mb-8",children:[a.jsx(uo,{className:"h-4 w-4 text-leo-gold"}),a.jsx("span",{children:"Limited time: Free tier available"})]}),a.jsx("h2",{className:"mb-6",children:a.jsx("span",{className:"leo-gold-text",children:"Ready to Create?"})}),a.jsx("p",{className:"text-xl text-muted-foreground mb-10 max-w-xl mx-auto",children:"Join developers who are building faster with AI. Your next masterpiece is just one conversation away."}),a.jsx(Re,{href:"/request-access",children:a.jsxs(le,{className:"leo-btn-primary text-xl px-12 py-7 rounded-xl group shadow-sienna",children:[a.jsx(o2,{className:"mr-3 h-5 w-5"}),"Start Building",a.jsx(Pr,{className:"ml-3 h-5 w-5 group-hover:translate-x-1 transition-transform"})]})})]})]})]})}const f2=(...t)=>t.filter(Boolean).join(" "),Vt=R.forwardRef(({className:t,type:e,...r},s)=>a.jsx("input",{type:e,className:f2("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-300 hover:border-primary/50",t),ref:s,...r}));Vt.displayName="Input";const p2=(...t)=>t.filter(Boolean).join(" "),nr=R.forwardRef(({className:t,...e},r)=>a.jsx("label",{ref:r,className:p2("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t),...e}));nr.displayName="Label";function m2({className:t}){return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),a.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),a.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),a.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]})}function g2(){const[t,e]=R.useState(""),[r,s]=R.useState(""),[n,i]=R.useState(""),[c,o]=R.useState(""),[l,d]=R.useState(!1),[g,m]=R.useState(null),[v,y]=R.useState(!1),{signIn:w,signInWithOAuth:_,resetPassword:p,isAuthenticated:h,isApproved:u,isPending:f,isRejected:x,isSuspended:k}=ft(),[,C]=Lr();R.useEffect(()=>{h&&C(f?"/pending-approval":x||k?"/account-inactive":"/apps")},[h,u,f,x,k,C]);const S=async N=>{N.preventDefault(),i(""),o(""),d(!0);try{await w(t,r)}catch(O){i(O instanceof Error?O.message:"Login failed. Please try again.")}finally{d(!1)}},b=async N=>{m(N),i("");try{await _(N)}catch(O){i(O instanceof Error?O.message:`${N} sign-in failed. Please try again.`),m(null)}},E=async N=>{if(N.preventDefault(),i(""),o(""),!t){i("Please enter your email address");return}d(!0);try{await p(t),o("Password reset link sent! Check your email."),y(!1)}catch(O){i(O instanceof Error?O.message:"Failed to send reset link. Please try again.")}finally{d(!1)}};return a.jsx(lt,{children:a.jsxs("div",{className:"min-h-[calc(100vh-8rem)] flex items-center justify-center px-4 py-16 relative",children:[a.jsx("div",{className:"absolute top-20 left-10 w-32 h-32 border border-leo-sketch/20 rounded-full opacity-30"}),a.jsx("div",{className:"absolute bottom-20 right-10 w-24 h-24 border border-leo-gold/20 opacity-30",style:{transform:"rotate(45deg)"}}),a.jsxs("div",{className:"w-full max-w-md relative z-10 animate-fade-in-up",children:[a.jsx("div",{className:"flex justify-center mb-8",children:a.jsx(Ta,{size:64})}),a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("h1",{className:"text-3xl md:text-4xl font-serif font-bold text-foreground mb-2",children:"Welcome back"}),a.jsx("p",{className:"text-muted-foreground",children:"Sign in to continue building"})]}),a.jsxs("div",{className:"leo-card-elevated p-8",children:[a.jsxs("div",{className:"space-y-3 mb-6",children:[a.jsx(le,{type:"button",variant:"outline",onClick:()=>b("google"),disabled:l||g!==null,className:"w-full h-12 text-base rounded-lg border-border hover:bg-muted/50 hover:border-primary/30 transition-all",children:g==="google"?"Connecting...":a.jsxs(a.Fragment,{children:[a.jsx(m2,{className:"h-5 w-5 mr-3"}),"Continue with Google"]})}),a.jsx(le,{type:"button",variant:"outline",onClick:()=>b("github"),disabled:l||g!==null,className:"w-full h-12 text-base rounded-lg border-border hover:bg-muted/50 hover:border-primary/30 transition-all",children:g==="github"?"Connecting...":a.jsxs(a.Fragment,{children:[a.jsx(Ga,{className:"h-5 w-5 mr-3"}),"Continue with GitHub"]})})]}),a.jsxs("div",{className:"relative my-6",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-border"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"bg-card px-4 text-muted-foreground",children:"or continue with email"})})]}),v?a.jsxs("form",{onSubmit:E,className:"space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(nr,{htmlFor:"email",className:"text-sm font-medium text-foreground",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(co,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsx(Vt,{id:"email",name:"email",type:"email",placeholder:"you@example.com",value:t,onChange:N=>e(N.target.value),required:!0,disabled:l,className:"pl-11 h-12 rounded-lg"})]})]}),n&&a.jsx("div",{className:"p-4 rounded-lg bg-destructive/10 border border-destructive/30 animate-fade-in-up",children:a.jsx("p",{className:"text-sm text-destructive",children:n})}),a.jsx(le,{type:"submit",disabled:l,className:"w-full leo-btn-primary h-12 text-base rounded-lg",children:l?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",onClick:()=>y(!1),className:"w-full text-center text-sm text-muted-foreground hover:text-foreground transition-colors",children:"Back to login"})]}):a.jsxs("form",{onSubmit:S,className:"space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(nr,{htmlFor:"email",className:"text-sm font-medium text-foreground",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(co,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsx(Vt,{id:"email",name:"email",type:"email",placeholder:"you@example.com",value:t,onChange:N=>e(N.target.value),required:!0,disabled:l||g!==null,className:"pl-11 h-12 rounded-lg"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(nr,{htmlFor:"password",className:"text-sm font-medium text-foreground",children:"Password"}),a.jsx("button",{type:"button",onClick:()=>y(!0),className:"text-xs text-primary hover:text-primary/80 transition-colors",children:"Forgot password?"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Na,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsx(Vt,{id:"password",name:"password",type:"password",placeholder:"",value:r,onChange:N=>s(N.target.value),required:!0,disabled:l||g!==null,className:"pl-11 h-12 rounded-lg"})]})]}),c&&a.jsx("div",{className:"p-4 rounded-lg bg-leo-verdigris/10 border border-leo-verdigris/30 animate-fade-in-up",children:a.jsx("p",{className:"text-sm text-leo-verdigris",children:c})}),n&&a.jsx("div",{className:"p-4 rounded-lg bg-destructive/10 border border-destructive/30 animate-fade-in-up",children:a.jsx("p",{className:"text-sm text-destructive",children:n})}),a.jsx(le,{type:"submit",disabled:l||g!==null,className:"w-full leo-btn-primary h-12 text-base rounded-lg group",children:l?"Signing in...":a.jsxs(a.Fragment,{children:["Sign In",a.jsx(Pr,{className:"ml-2 h-4 w-4 group-hover:translate-x-1 transition-transform"})]})})]}),a.jsxs("div",{className:"relative my-8",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-border"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"bg-card px-4 text-muted-foreground",children:"new here?"})})]}),a.jsxs("p",{className:"text-center text-muted-foreground",children:["Don't have an account?"," ",a.jsx(Re,{href:"/request-access",className:"text-primary hover:text-primary/80 font-medium transition-colors",children:"Request beta access"})]})]})]})]})})}function v2(){const[t,e]=R.useState(""),[r,s]=R.useState(""),[n,i]=R.useState(""),[c,o]=R.useState(""),[l,d]=R.useState(!1),{signUp:g,isAuthenticated:m}=ft(),[,v]=Lr();R.useEffect(()=>{m&&v("/apps")},[m,v]);const y=async w=>{if(w.preventDefault(),o(""),n.length<8){o("Password must be at least 8 characters long");return}d(!0);try{await g(r,n,t),v("/apps")}catch(_){o(_ instanceof Error?_.message:"Registration failed. Please try again.")}finally{d(!1)}};return a.jsx(lt,{children:a.jsxs("div",{className:"min-h-[calc(100vh-8rem)] flex items-center justify-center px-4 py-16 relative",children:[a.jsx("div",{className:"absolute top-1/4 -right-32 w-80 h-80 bg-cyan-500/20 rounded-full blur-[120px]"}),a.jsx("div",{className:"absolute bottom-1/4 -left-32 w-64 h-64 bg-purple-500/15 rounded-full blur-[100px]"}),a.jsxs("div",{className:"w-full max-w-md relative z-10 animate-fade-in-up",children:[a.jsx("div",{className:"flex justify-center mb-8",children:a.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-cyan-500 to-purple-500 flex items-center justify-center shadow-glow-cyan",children:a.jsx(Co,{className:"h-8 w-8 text-white"})})}),a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-leo-text mb-2",children:"Create your account"}),a.jsx("p",{className:"text-leo-text-secondary",children:"Start building with AI in minutes"})]}),a.jsxs("div",{className:"leo-card p-8",children:[a.jsxs("form",{onSubmit:y,className:"space-y-5",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(nr,{htmlFor:"name",className:"text-sm font-medium text-leo-text",children:"Full Name"}),a.jsxs("div",{className:"relative",children:[a.jsx(rp,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-leo-text-tertiary"}),a.jsx(Vt,{id:"name",name:"name",type:"text",placeholder:"Jane Smith",value:t,onChange:w=>e(w.target.value),required:!0,disabled:l,className:"pl-11 h-12 bg-white/5 border-white/10 text-leo-text placeholder:text-leo-text-tertiary focus:border-cyan-500/50 focus:ring-cyan-500/20 rounded-xl"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(nr,{htmlFor:"email",className:"text-sm font-medium text-leo-text",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(co,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-leo-text-tertiary"}),a.jsx(Vt,{id:"email",name:"email",type:"email",placeholder:"you@example.com",value:r,onChange:w=>s(w.target.value),required:!0,disabled:l,className:"pl-11 h-12 bg-white/5 border-white/10 text-leo-text placeholder:text-leo-text-tertiary focus:border-cyan-500/50 focus:ring-cyan-500/20 rounded-xl"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(nr,{htmlFor:"password",className:"text-sm font-medium text-leo-text",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(Na,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-leo-text-tertiary"}),a.jsx(Vt,{id:"password",name:"password",type:"password",placeholder:"",value:n,onChange:w=>i(w.target.value),required:!0,minLength:8,disabled:l,className:"pl-11 h-12 bg-white/5 border-white/10 text-leo-text placeholder:text-leo-text-tertiary focus:border-cyan-500/50 focus:ring-cyan-500/20 rounded-xl"})]}),a.jsx("p",{className:"text-xs text-leo-text-tertiary",children:"At least 8 characters"})]}),c&&a.jsx("div",{className:"p-4 rounded-xl bg-red-500/10 border border-red-500/30 animate-fade-in-up",children:a.jsx("p",{className:"text-sm text-red-400",children:c})}),a.jsx(le,{type:"submit",disabled:l,className:"w-full h-12 text-base rounded-xl group bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-600 hover:to-purple-600 text-white font-semibold shadow-glow-cyan transition-all duration-300",children:l?"Creating account...":a.jsxs(a.Fragment,{children:["Get Started",a.jsx(Pr,{className:"ml-2 h-4 w-4 group-hover:translate-x-1 transition-transform"})]})})]}),a.jsx("div",{className:"mt-8 pt-6 border-t border-white/10",children:a.jsx("div",{className:"space-y-3",children:["Generate full-stack apps in minutes","One-click deployment to the cloud","Full source code ownership"].map((w,_)=>a.jsxs("div",{className:"flex items-center gap-3 text-sm text-leo-text-secondary",children:[a.jsx("div",{className:"w-5 h-5 rounded-full bg-emerald-500/20 flex items-center justify-center flex-shrink-0",children:a.jsx(Ar,{className:"h-3 w-3 text-emerald-400"})}),a.jsx("span",{children:w})]},_))})}),a.jsxs("p",{className:"text-center text-leo-text-secondary mt-6",children:["Already have an account?"," ",a.jsx(Re,{href:"/login",className:"text-cyan-400 hover:text-cyan-300 font-medium transition-colors",children:"Sign in"})]})]})]})]})})}function _2({className:t}){return a.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),a.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),a.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),a.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]})}function y2(){const[t,e]=R.useState(""),[r,s]=R.useState(""),[n,i]=R.useState(""),[c,o]=R.useState(""),[l,d]=R.useState(!1),[g,m]=R.useState(null),{signUp:v,signInWithOAuth:y,isAuthenticated:w,isPending:_}=ft(),[,p]=Lr();R.useEffect(()=>{w&&_?p("/pending-approval"):w&&p("/apps")},[w,_,p]);const h=async f=>{if(f.preventDefault(),o(""),n.length<8){o("Password must be at least 8 characters long");return}d(!0);try{await v(r,n,t)}catch(x){o(x instanceof Error?x.message:"Registration failed. Please try again.")}finally{d(!1)}},u=async f=>{m(f),o("");try{await y(f)}catch(x){o(x instanceof Error?x.message:`${f} sign-in failed. Please try again.`),m(null)}};return a.jsx(lt,{children:a.jsxs("div",{className:"min-h-[calc(100vh-8rem)] flex items-center justify-center px-4 py-16 relative",children:[a.jsx("div",{className:"absolute top-20 right-10 w-32 h-32 border border-leo-sketch/20 rounded-full opacity-30"}),a.jsx("div",{className:"absolute bottom-20 left-10 w-24 h-24 border border-leo-gold/20 opacity-30",style:{transform:"rotate(45deg)"}}),a.jsxs("div",{className:"w-full max-w-md relative z-10 animate-fade-in-up",children:[a.jsx("div",{className:"flex justify-center mb-8",children:a.jsx(Ta,{size:64})}),a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("h1",{className:"text-3xl md:text-4xl font-serif font-bold text-foreground mb-2",children:"Request Beta Access"}),a.jsx("p",{className:"text-muted-foreground",children:"Join our exclusive beta program"})]}),a.jsxs("div",{className:"leo-card-elevated p-8",children:[a.jsxs("div",{className:"space-y-3 mb-6",children:[a.jsx(le,{type:"button",variant:"outline",onClick:()=>u("google"),disabled:l||g!==null,className:"w-full h-12 text-base rounded-lg border-border hover:bg-muted/50 hover:border-primary/30 transition-all",children:g==="google"?"Connecting...":a.jsxs(a.Fragment,{children:[a.jsx(_2,{className:"h-5 w-5 mr-3"}),"Continue with Google"]})}),a.jsx(le,{type:"button",variant:"outline",onClick:()=>u("github"),disabled:l||g!==null,className:"w-full h-12 text-base rounded-lg border-border hover:bg-muted/50 hover:border-primary/30 transition-all",children:g==="github"?"Connecting...":a.jsxs(a.Fragment,{children:[a.jsx(Ga,{className:"h-5 w-5 mr-3"}),"Continue with GitHub"]})})]}),a.jsxs("div",{className:"relative my-6",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-border"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"bg-card px-4 text-muted-foreground",children:"or continue with email"})})]}),a.jsxs("form",{onSubmit:h,className:"space-y-5",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(nr,{htmlFor:"name",className:"text-sm font-medium text-foreground",children:"Full Name"}),a.jsxs("div",{className:"relative",children:[a.jsx(rp,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsx(Vt,{id:"name",name:"name",type:"text",placeholder:"Jane Smith",value:t,onChange:f=>e(f.target.value),required:!0,disabled:l||g!==null,className:"pl-11 h-12 rounded-lg"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(nr,{htmlFor:"email",className:"text-sm font-medium text-foreground",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(co,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsx(Vt,{id:"email",name:"email",type:"email",placeholder:"you@example.com",value:r,onChange:f=>s(f.target.value),required:!0,disabled:l||g!==null,className:"pl-11 h-12 rounded-lg"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(nr,{htmlFor:"password",className:"text-sm font-medium text-foreground",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(Na,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsx(Vt,{id:"password",name:"password",type:"password",placeholder:"",value:n,onChange:f=>i(f.target.value),required:!0,minLength:8,disabled:l||g!==null,className:"pl-11 h-12 rounded-lg"})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"At least 8 characters"})]}),c&&a.jsx("div",{className:"p-4 rounded-lg bg-destructive/10 border border-destructive/30 animate-fade-in-up",children:a.jsx("p",{className:"text-sm text-destructive",children:c})}),a.jsx(le,{type:"submit",disabled:l||g!==null,className:"w-full leo-btn-primary h-12 text-base rounded-lg group",children:l?"Requesting access...":a.jsxs(a.Fragment,{children:["Request Beta Access",a.jsx(Pr,{className:"ml-2 h-4 w-4 group-hover:translate-x-1 transition-transform"})]})})]}),a.jsx("div",{className:"mt-8 pt-6 border-t border-border",children:a.jsx("div",{className:"space-y-3",children:["Generate full-stack apps in minutes","One-click deployment to the cloud","Full source code ownership"].map((f,x)=>a.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[a.jsx("div",{className:"w-5 h-5 rounded-full bg-leo-verdigris/20 flex items-center justify-center flex-shrink-0",children:a.jsx(Ar,{className:"h-3 w-3 text-leo-verdigris"})}),a.jsx("span",{children:f})]},x))})}),a.jsxs("p",{className:"text-center text-muted-foreground mt-6",children:["Already have an account?"," ",a.jsx(Re,{href:"/login",className:"text-primary hover:text-primary/80 font-medium transition-colors",children:"Sign in"})]})]})]})]})})}function x2(){const{user:t,isAuthenticated:e,isApproved:r,isPending:s,signOut:n,refreshProfile:i}=ft(),[,c]=Lr();R.useEffect(()=>{if(!e){c("/request-access");return}r&&c("/apps")},[e,r,c]);const o=async()=>{await i()},l=async()=>{await n(),c("/")};return s?a.jsx(lt,{children:a.jsxs("div",{className:"min-h-[calc(100vh-8rem)] flex items-center justify-center px-4 py-16 relative",children:[a.jsx("div",{className:"absolute top-1/4 -left-32 w-80 h-80 bg-amber-500/20 rounded-full blur-[120px]"}),a.jsx("div",{className:"absolute bottom-1/4 -right-32 w-64 h-64 bg-purple-500/15 rounded-full blur-[100px]"}),a.jsxs("div",{className:"w-full max-w-md relative z-10 animate-fade-in-up",children:[a.jsx("div",{className:"flex justify-center mb-8",children:a.jsx("div",{className:"w-20 h-20 rounded-full bg-amber-500/20 flex items-center justify-center",children:a.jsx(Qn,{className:"h-10 w-10 text-amber-400"})})}),a.jsxs("div",{className:"leo-card p-8 text-center",children:[a.jsx("h1",{className:"text-2xl font-bold text-leo-text mb-3",children:"Access Request Pending"}),a.jsx("p",{className:"text-leo-text-secondary mb-6",children:"Thank you for your interest in Leo! Your request to join our beta program is being reviewed."}),a.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-xl p-4 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-amber-400",children:[a.jsx(co,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-medium",children:t==null?void 0:t.email})]}),a.jsx("p",{className:"text-xs text-amber-400/70 mt-2",children:"We'll notify you at this email when your access is approved."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(le,{onClick:o,variant:"outline",className:"w-full h-11 rounded-xl bg-white/5 border-white/10 text-leo-text hover:bg-white/10 hover:border-white/20",children:[a.jsx(Xc,{className:"h-4 w-4 mr-2"}),"Check Status"]}),a.jsxs(le,{onClick:l,variant:"ghost",className:"w-full h-11 rounded-xl text-leo-text-secondary hover:text-leo-text hover:bg-white/5",children:[a.jsx(ep,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]}),a.jsx("div",{className:"mt-8 pt-6 border-t border-white/10",children:a.jsxs("p",{className:"text-sm text-leo-text-tertiary",children:["Questions? Contact us at"," ",a.jsx("a",{href:"mailto:support@leo.ai",className:"text-cyan-400 hover:text-cyan-300",children:"support@leo.ai"})]})})]})]})]})}):null}function w2(){var x;const{user:t,profile:e,isAuthenticated:r,isApproved:s,isRejected:n,isSuspended:i,signOut:c,refreshProfile:o}=ft(),[,l]=Lr();R.useEffect(()=>{if(!r){l("/login");return}s&&l("/apps")},[r,s,l]);const d=async()=>{await o()},g=async()=>{await c(),l("/")},m=n||i,v=n?"Your access request was not approved":i?"Your account has been suspended":"Your account is inactive",y=n?"We appreciate your interest in Leo, but we're unable to approve your access request at this time.":i?"Your account has been temporarily suspended. Please contact support for more information.":"Your account is currently inactive.";if(!m)return null;const w=n?ti:$E,_=n?"bg-red-500/20":"bg-orange-500/20",p=n?"text-red-400":"text-orange-400",h=n?"border-red-500/30":"border-orange-500/30",u=n?"bg-red-500/10":"bg-orange-500/10",f=n?"text-red-400":"text-orange-400";return a.jsx(lt,{children:a.jsxs("div",{className:"min-h-[calc(100vh-8rem)] flex items-center justify-center px-4 py-16 relative",children:[a.jsx("div",{className:"absolute top-1/4 -left-32 w-80 h-80 bg-red-500/10 rounded-full blur-[120px]"}),a.jsx("div",{className:"absolute bottom-1/4 -right-32 w-64 h-64 bg-purple-500/10 rounded-full blur-[100px]"}),a.jsxs("div",{className:"w-full max-w-md relative z-10 animate-fade-in-up",children:[a.jsx("div",{className:"flex justify-center mb-8",children:a.jsx("div",{className:`w-20 h-20 rounded-full ${_} flex items-center justify-center`,children:a.jsx(w,{className:`h-10 w-10 ${p}`})})}),a.jsxs("div",{className:"leo-card p-8 text-center",children:[a.jsx("h1",{className:"text-2xl font-bold text-leo-text mb-3",children:v}),a.jsx("p",{className:"text-leo-text-secondary mb-6",children:y}),a.jsxs("div",{className:`${u} border ${h} rounded-xl p-4 mb-6`,children:[a.jsxs("div",{className:`flex items-center justify-center gap-2 ${f}`,children:[a.jsx(co,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-medium",children:t==null?void 0:t.email})]}),a.jsxs("p",{className:`text-xs ${f}/70 mt-2`,children:["Status: ",a.jsx("span",{className:"font-semibold capitalize",children:(x=e==null?void 0:e.status)==null?void 0:x.replace("_"," ")})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(le,{onClick:d,variant:"outline",className:"w-full h-11 rounded-xl bg-white/5 border-white/10 text-leo-text hover:bg-white/10 hover:border-white/20",children:[a.jsx(Xc,{className:"h-4 w-4 mr-2"}),"Check Status"]}),a.jsxs(le,{onClick:g,variant:"ghost",className:"w-full h-11 rounded-xl text-leo-text-secondary hover:text-leo-text hover:bg-white/5",children:[a.jsx(ep,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]}),a.jsx("div",{className:"mt-8 pt-6 border-t border-white/10",children:a.jsxs("p",{className:"text-sm text-leo-text-tertiary",children:["Need help? Contact us at"," ",a.jsx("a",{href:"mailto:support@leo.ai",className:"text-cyan-400 hover:text-cyan-300",children:"support@leo.ai"})]})})]})]})]})})}function b2(){const{isAuthenticated:t,isApproved:e,isPending:r,isRejected:s,isSuspended:n,isLoading:i}=ft(),[,c]=Lr(),[o,l]=R.useState("loading"),[d,g]=R.useState(null);return R.useEffect(()=>{const m=new URLSearchParams(window.location.search),v=m.get("error"),y=m.get("error_description");if(v){l("error"),g(y||v);return}i||(t?(l("success"),setTimeout(()=>{c(r?"/pending-approval":s||n?"/account-inactive":e?"/apps":"/pending-approval")},1e3)):(l("error"),g("Authentication failed. Please try again.")))},[t,e,r,s,n,i,c]),a.jsx(lt,{children:a.jsx("div",{className:"min-h-[calc(100vh-8rem)] flex items-center justify-center px-4 py-16",children:a.jsxs("div",{className:"text-center",children:[o==="loading"&&a.jsxs(a.Fragment,{children:[a.jsx(at,{className:"h-12 w-12 text-cyan-400 animate-spin mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-leo-text mb-2",children:"Completing sign in..."}),a.jsx("p",{className:"text-leo-text-secondary",children:"Please wait while we verify your account."})]}),o==="success"&&a.jsxs(a.Fragment,{children:[a.jsx(Jn,{className:"h-12 w-12 text-emerald-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-leo-text mb-2",children:"Sign in successful!"}),a.jsx("p",{className:"text-leo-text-secondary",children:"Redirecting you now..."})]}),o==="error"&&a.jsxs(a.Fragment,{children:[a.jsx(ti,{className:"h-12 w-12 text-red-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-leo-text mb-2",children:"Sign in failed"}),a.jsx("p",{className:"text-leo-text-secondary mb-4",children:d||"An unexpected error occurred."}),a.jsx("button",{onClick:()=>c("/request-access"),className:"text-cyan-400 hover:text-cyan-300 font-medium",children:"Try again"})]})]})})})}const S2=(...t)=>t.filter(Boolean).join(" "),C2=Yf("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow-lg shadow-primary/20 hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground shadow-lg shadow-secondary/20 hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow-lg shadow-destructive/20 hover:bg-destructive/80",outline:"text-foreground border-border hover:bg-accent"}},defaultVariants:{variant:"default"}});function qs({className:t,variant:e,...r}){return a.jsx("div",{className:S2(C2({variant:e}),t),...r})}const k2=(...t)=>t.filter(Boolean).join(" ");function tr({className:t,...e}){return a.jsx("div",{className:k2("animate-pulse rounded-md bg-muted/50 backdrop-blur-sm",t),...e})}function wt(t,e,{checkForDefaultPrevented:r=!0}={}){return function(n){if(t==null||t(n),r===!1||!n.defaultPrevented)return e==null?void 0:e(n)}}function Ng(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function j0(...t){return e=>{let r=!1;const s=t.map(n=>{const i=Ng(n,e);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let n=0;n<s.length;n++){const i=s[n];typeof i=="function"?i():Ng(t[n],null)}}}}function Kr(...t){return R.useCallback(j0(...t),t)}function E2(t,e){const r=R.createContext(e),s=i=>{const{children:c,...o}=i,l=R.useMemo(()=>o,Object.values(o));return a.jsx(r.Provider,{value:l,children:c})};s.displayName=t+"Provider";function n(i){const c=R.useContext(r);if(c)return c;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[s,n]}function eu(t,e=[]){let r=[];function s(i,c){const o=R.createContext(c),l=r.length;r=[...r,c];const d=m=>{var h;const{scope:v,children:y,...w}=m,_=((h=v==null?void 0:v[t])==null?void 0:h[l])||o,p=R.useMemo(()=>w,Object.values(w));return a.jsx(_.Provider,{value:p,children:y})};d.displayName=i+"Provider";function g(m,v){var _;const y=((_=v==null?void 0:v[t])==null?void 0:_[l])||o,w=R.useContext(y);if(w)return w;if(c!==void 0)return c;throw new Error(`\`${m}\` must be used within \`${i}\``)}return[d,g]}const n=()=>{const i=r.map(c=>R.createContext(c));return function(o){const l=(o==null?void 0:o[t])||i;return R.useMemo(()=>({[`__scope${t}`]:{...o,[t]:l}}),[o,l])}};return n.scopeName=t,[s,j2(n,...e)]}function j2(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const s=t.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(i){const c=s.reduce((o,{useScope:l,scopeName:d})=>{const m=l(i)[`__scope${d}`];return{...o,...m}},{});return R.useMemo(()=>({[`__scope${e.scopeName}`]:c}),[c])}};return r.scopeName=e.scopeName,r}var Aa=globalThis!=null&&globalThis.document?R.useLayoutEffect:()=>{},R2=qh[" useId ".trim().toString()]||(()=>{}),N2=0;function na(t){const[e,r]=R.useState(R2());return Aa(()=>{r(s=>s??String(N2++))},[t]),e?`radix-${e}`:""}var T2=qh[" useInsertionEffect ".trim().toString()]||Aa;function sp({prop:t,defaultProp:e,onChange:r=()=>{},caller:s}){const[n,i,c]=A2({defaultProp:e,onChange:r}),o=t!==void 0,l=o?t:n;{const g=R.useRef(t!==void 0);R.useEffect(()=>{const m=g.current;m!==o&&console.warn(`${s} is changing from ${m?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),g.current=o},[o,s])}const d=R.useCallback(g=>{var m;if(o){const v=O2(g)?g(t):g;v!==t&&((m=c.current)==null||m.call(c,v))}else i(g)},[o,t,i,c]);return[l,d]}function A2({defaultProp:t,onChange:e}){const[r,s]=R.useState(t),n=R.useRef(r),i=R.useRef(e);return T2(()=>{i.current=e},[e]),R.useEffect(()=>{var c;n.current!==r&&((c=i.current)==null||c.call(i,r),n.current=r)},[r,n]),[r,s,i]}function O2(t){return typeof t=="function"}function Ec(t){const e=P2(t),r=R.forwardRef((s,n)=>{const{children:i,...c}=s,o=R.Children.toArray(i),l=o.find(I2);if(l){const d=l.props.children,g=o.map(m=>m===l?R.Children.count(d)>1?R.Children.only(null):R.isValidElement(d)?d.props.children:null:m);return a.jsx(e,{...c,ref:n,children:R.isValidElement(d)?R.cloneElement(d,void 0,g):null})}return a.jsx(e,{...c,ref:n,children:i})});return r.displayName=`${t}.Slot`,r}function P2(t){const e=R.forwardRef((r,s)=>{const{children:n,...i}=r;if(R.isValidElement(n)){const c=M2(n),o=D2(i,n.props);return n.type!==R.Fragment&&(o.ref=s?j0(s,c):c),R.cloneElement(n,o)}return R.Children.count(n)>1?R.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var L2=Symbol("radix.slottable");function I2(t){return R.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===L2}function D2(t,e){const r={...e};for(const s in e){const n=t[s],i=e[s];/^on[A-Z]/.test(s)?n&&i?r[s]=(...o)=>{const l=i(...o);return n(...o),l}:n&&(r[s]=n):s==="style"?r[s]={...n,...i}:s==="className"&&(r[s]=[n,i].filter(Boolean).join(" "))}return{...t,...r}}function M2(t){var s,n;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(n=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var B2=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Bt=B2.reduce((t,e)=>{const r=Ec(`Primitive.${e}`),s=R.forwardRef((n,i)=>{const{asChild:c,...o}=n,l=c?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(l,{...o,ref:i})});return s.displayName=`Primitive.${e}`,{...t,[e]:s}},{});function $2(t,e){t&&Mf.flushSync(()=>t.dispatchEvent(e))}function ho(t){const e=R.useRef(t);return R.useEffect(()=>{e.current=t}),R.useMemo(()=>(...r)=>{var s;return(s=e.current)==null?void 0:s.call(e,...r)},[])}function F2(t,e=globalThis==null?void 0:globalThis.document){const r=ho(t);R.useEffect(()=>{const s=n=>{n.key==="Escape"&&r(n)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[r,e])}var U2="DismissableLayer",wh="dismissableLayer.update",H2="dismissableLayer.pointerDownOutside",z2="dismissableLayer.focusOutside",Tg,R0=R.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),N0=R.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:n,onFocusOutside:i,onInteractOutside:c,onDismiss:o,...l}=t,d=R.useContext(R0),[g,m]=R.useState(null),v=(g==null?void 0:g.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,y]=R.useState({}),w=Kr(e,S=>m(S)),_=Array.from(d.layers),[p]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),h=_.indexOf(p),u=g?_.indexOf(g):-1,f=d.layersWithOutsidePointerEventsDisabled.size>0,x=u>=h,k=G2(S=>{const b=S.target,E=[...d.branches].some(N=>N.contains(b));!x||E||(n==null||n(S),c==null||c(S),S.defaultPrevented||o==null||o())},v),C=V2(S=>{const b=S.target;[...d.branches].some(N=>N.contains(b))||(i==null||i(S),c==null||c(S),S.defaultPrevented||o==null||o())},v);return F2(S=>{u===d.layers.size-1&&(s==null||s(S),!S.defaultPrevented&&o&&(S.preventDefault(),o()))},v),R.useEffect(()=>{if(g)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(Tg=v.body.style.pointerEvents,v.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(g)),d.layers.add(g),Ag(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(v.body.style.pointerEvents=Tg)}},[g,v,r,d]),R.useEffect(()=>()=>{g&&(d.layers.delete(g),d.layersWithOutsidePointerEventsDisabled.delete(g),Ag())},[g,d]),R.useEffect(()=>{const S=()=>y({});return document.addEventListener(wh,S),()=>document.removeEventListener(wh,S)},[]),a.jsx(Bt.div,{...l,ref:w,style:{pointerEvents:f?x?"auto":"none":void 0,...t.style},onFocusCapture:wt(t.onFocusCapture,C.onFocusCapture),onBlurCapture:wt(t.onBlurCapture,C.onBlurCapture),onPointerDownCapture:wt(t.onPointerDownCapture,k.onPointerDownCapture)})});N0.displayName=U2;var W2="DismissableLayerBranch",q2=R.forwardRef((t,e)=>{const r=R.useContext(R0),s=R.useRef(null),n=Kr(e,s);return R.useEffect(()=>{const i=s.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),a.jsx(Bt.div,{...t,ref:n})});q2.displayName=W2;function G2(t,e=globalThis==null?void 0:globalThis.document){const r=ho(t),s=R.useRef(!1),n=R.useRef(()=>{});return R.useEffect(()=>{const i=o=>{if(o.target&&!s.current){let l=function(){T0(H2,r,d,{discrete:!0})};const d={originalEvent:o};o.pointerType==="touch"?(e.removeEventListener("click",n.current),n.current=l,e.addEventListener("click",n.current,{once:!0})):l()}else e.removeEventListener("click",n.current);s.current=!1},c=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(c),e.removeEventListener("pointerdown",i),e.removeEventListener("click",n.current)}},[e,r]),{onPointerDownCapture:()=>s.current=!0}}function V2(t,e=globalThis==null?void 0:globalThis.document){const r=ho(t),s=R.useRef(!1);return R.useEffect(()=>{const n=i=>{i.target&&!s.current&&T0(z2,r,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",n),()=>e.removeEventListener("focusin",n)},[e,r]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function Ag(){const t=new CustomEvent(wh);document.dispatchEvent(t)}function T0(t,e,r,{discrete:s}){const n=r.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&n.addEventListener(t,e,{once:!0}),s?$2(n,i):n.dispatchEvent(i)}var Uu="focusScope.autoFocusOnMount",Hu="focusScope.autoFocusOnUnmount",Og={bubbles:!1,cancelable:!0},K2="FocusScope",A0=R.forwardRef((t,e)=>{const{loop:r=!1,trapped:s=!1,onMountAutoFocus:n,onUnmountAutoFocus:i,...c}=t,[o,l]=R.useState(null),d=ho(n),g=ho(i),m=R.useRef(null),v=Kr(e,_=>l(_)),y=R.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;R.useEffect(()=>{if(s){let _=function(f){if(y.paused||!o)return;const x=f.target;o.contains(x)?m.current=x:Es(m.current,{select:!0})},p=function(f){if(y.paused||!o)return;const x=f.relatedTarget;x!==null&&(o.contains(x)||Es(m.current,{select:!0}))},h=function(f){if(document.activeElement===document.body)for(const k of f)k.removedNodes.length>0&&Es(o)};document.addEventListener("focusin",_),document.addEventListener("focusout",p);const u=new MutationObserver(h);return o&&u.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",_),document.removeEventListener("focusout",p),u.disconnect()}}},[s,o,y.paused]),R.useEffect(()=>{if(o){Lg.add(y);const _=document.activeElement;if(!o.contains(_)){const h=new CustomEvent(Uu,Og);o.addEventListener(Uu,d),o.dispatchEvent(h),h.defaultPrevented||(J2(ej(O0(o)),{select:!0}),document.activeElement===_&&Es(o))}return()=>{o.removeEventListener(Uu,d),setTimeout(()=>{const h=new CustomEvent(Hu,Og);o.addEventListener(Hu,g),o.dispatchEvent(h),h.defaultPrevented||Es(_??document.body,{select:!0}),o.removeEventListener(Hu,g),Lg.remove(y)},0)}}},[o,d,g,y]);const w=R.useCallback(_=>{if(!r&&!s||y.paused)return;const p=_.key==="Tab"&&!_.altKey&&!_.ctrlKey&&!_.metaKey,h=document.activeElement;if(p&&h){const u=_.currentTarget,[f,x]=Q2(u);f&&x?!_.shiftKey&&h===x?(_.preventDefault(),r&&Es(f,{select:!0})):_.shiftKey&&h===f&&(_.preventDefault(),r&&Es(x,{select:!0})):h===u&&_.preventDefault()}},[r,s,y.paused]);return a.jsx(Bt.div,{tabIndex:-1,...c,ref:v,onKeyDown:w})});A0.displayName=K2;function J2(t,{select:e=!1}={}){const r=document.activeElement;for(const s of t)if(Es(s,{select:e}),document.activeElement!==r)return}function Q2(t){const e=O0(t),r=Pg(e,t),s=Pg(e.reverse(),t);return[r,s]}function O0(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const n=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||n?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function Pg(t,e){for(const r of t)if(!Z2(r,{upTo:e}))return r}function Z2(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Y2(t){return t instanceof HTMLInputElement&&"select"in t}function Es(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&Y2(t)&&e&&t.select()}}var Lg=X2();function X2(){let t=[];return{add(e){const r=t[0];e!==r&&(r==null||r.pause()),t=Ig(t,e),t.unshift(e)},remove(e){var r;t=Ig(t,e),(r=t[0])==null||r.resume()}}}function Ig(t,e){const r=[...t],s=r.indexOf(e);return s!==-1&&r.splice(s,1),r}function ej(t){return t.filter(e=>e.tagName!=="A")}var tj="Portal",P0=R.forwardRef((t,e)=>{var o;const{container:r,...s}=t,[n,i]=R.useState(!1);Aa(()=>i(!0),[]);const c=r||n&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return c?M1.createPortal(a.jsx(Bt.div,{...s,ref:e}),c):null});P0.displayName=tj;function rj(t,e){return R.useReducer((r,s)=>e[r][s]??r,t)}var Va=t=>{const{present:e,children:r}=t,s=sj(e),n=typeof r=="function"?r({present:s.isPresent}):R.Children.only(r),i=Kr(s.ref,nj(n));return typeof r=="function"||s.isPresent?R.cloneElement(n,{ref:i}):null};Va.displayName="Presence";function sj(t){const[e,r]=R.useState(),s=R.useRef(null),n=R.useRef(t),i=R.useRef("none"),c=t?"mounted":"unmounted",[o,l]=rj(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return R.useEffect(()=>{const d=bl(s.current);i.current=o==="mounted"?d:"none"},[o]),Aa(()=>{const d=s.current,g=n.current;if(g!==t){const v=i.current,y=bl(d);t?l("MOUNT"):y==="none"||(d==null?void 0:d.display)==="none"?l("UNMOUNT"):l(g&&v!==y?"ANIMATION_OUT":"UNMOUNT"),n.current=t}},[t,l]),Aa(()=>{if(e){let d;const g=e.ownerDocument.defaultView??window,m=y=>{const _=bl(s.current).includes(CSS.escape(y.animationName));if(y.target===e&&_&&(l("ANIMATION_END"),!n.current)){const p=e.style.animationFillMode;e.style.animationFillMode="forwards",d=g.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=p)})}},v=y=>{y.target===e&&(i.current=bl(s.current))};return e.addEventListener("animationstart",v),e.addEventListener("animationcancel",m),e.addEventListener("animationend",m),()=>{g.clearTimeout(d),e.removeEventListener("animationstart",v),e.removeEventListener("animationcancel",m),e.removeEventListener("animationend",m)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:R.useCallback(d=>{s.current=d?getComputedStyle(d):null,r(d)},[])}}function bl(t){return(t==null?void 0:t.animationName)||"none"}function nj(t){var s,n;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(n=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var zu=0;function ij(){R.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Dg()),document.body.insertAdjacentElement("beforeend",t[1]??Dg()),zu++,()=>{zu===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),zu--}},[])}function Dg(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var ql="right-scroll-bar-position",Gl="width-before-scroll-bar",oj="with-scroll-bars-hidden",aj="--removed-body-scroll-bar-size";function Wu(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function lj(t,e){var r=R.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(s){var n=r.value;n!==s&&(r.value=s,r.callback(s,n))}}}})[0];return r.callback=e,r.facade}var cj=typeof window<"u"?R.useLayoutEffect:R.useEffect,Mg=new WeakMap;function uj(t,e){var r=lj(null,function(s){return t.forEach(function(n){return Wu(n,s)})});return cj(function(){var s=Mg.get(r);if(s){var n=new Set(s),i=new Set(t),c=r.current;n.forEach(function(o){i.has(o)||Wu(o,null)}),i.forEach(function(o){n.has(o)||Wu(o,c)})}Mg.set(r,t)},[t]),r}function dj(t){return t}function hj(t,e){e===void 0&&(e=dj);var r=[],s=!1,n={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(i){var c=e(i,s);return r.push(c),function(){r=r.filter(function(o){return o!==c})}},assignSyncMedium:function(i){for(s=!0;r.length;){var c=r;r=[],c.forEach(i)}r={push:function(o){return i(o)},filter:function(){return r}}},assignMedium:function(i){s=!0;var c=[];if(r.length){var o=r;r=[],o.forEach(i),c=r}var l=function(){var g=c;c=[],g.forEach(i)},d=function(){return Promise.resolve().then(l)};d(),r={push:function(g){c.push(g),d()},filter:function(g){return c=c.filter(g),r}}}};return n}function fj(t){t===void 0&&(t={});var e=hj(null);return e.options=Wr({async:!0,ssr:!1},t),e}var L0=function(t){var e=t.sideCar,r=bo(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=e.read();if(!s)throw new Error("Sidecar medium not found");return R.createElement(s,Wr({},r))};L0.isSideCarExport=!0;function pj(t,e){return t.useMedium(e),L0}var I0=fj(),qu=function(){},tu=R.forwardRef(function(t,e){var r=R.useRef(null),s=R.useState({onScrollCapture:qu,onWheelCapture:qu,onTouchMoveCapture:qu}),n=s[0],i=s[1],c=t.forwardProps,o=t.children,l=t.className,d=t.removeScrollBar,g=t.enabled,m=t.shards,v=t.sideCar,y=t.noRelative,w=t.noIsolation,_=t.inert,p=t.allowPinchZoom,h=t.as,u=h===void 0?"div":h,f=t.gapMode,x=bo(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),k=v,C=uj([r,e]),S=Wr(Wr({},x),n);return R.createElement(R.Fragment,null,g&&R.createElement(k,{sideCar:I0,removeScrollBar:d,shards:m,noRelative:y,noIsolation:w,inert:_,setCallbacks:i,allowPinchZoom:!!p,lockRef:r,gapMode:f}),c?R.cloneElement(R.Children.only(o),Wr(Wr({},S),{ref:C})):R.createElement(u,Wr({},S,{className:l,ref:C}),o))});tu.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};tu.classNames={fullWidth:Gl,zeroRight:ql};var mj=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function gj(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=mj();return e&&t.setAttribute("nonce",e),t}function vj(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function _j(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var yj=function(){var t=0,e=null;return{add:function(r){t==0&&(e=gj())&&(vj(e,r),_j(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},xj=function(){var t=yj();return function(e,r){R.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},D0=function(){var t=xj(),e=function(r){var s=r.styles,n=r.dynamic;return t(s,n),null};return e},wj={left:0,top:0,right:0,gap:0},Gu=function(t){return parseInt(t||"",10)||0},bj=function(t){var e=window.getComputedStyle(document.body),r=e[t==="padding"?"paddingLeft":"marginLeft"],s=e[t==="padding"?"paddingTop":"marginTop"],n=e[t==="padding"?"paddingRight":"marginRight"];return[Gu(r),Gu(s),Gu(n)]},Sj=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return wj;var e=bj(t),r=document.documentElement.clientWidth,s=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,s-r+e[2]-e[0])}},Cj=D0(),Fi="data-scroll-locked",kj=function(t,e,r,s){var n=t.left,i=t.top,c=t.right,o=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(oj,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(o,"px ").concat(s,`;
  }
  body[`).concat(Fi,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(s,";"),r==="margin"&&`
    padding-left: `.concat(n,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(c,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(s,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(ql,` {
    right: `).concat(o,"px ").concat(s,`;
  }
  
  .`).concat(Gl,` {
    margin-right: `).concat(o,"px ").concat(s,`;
  }
  
  .`).concat(ql," .").concat(ql,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(Gl," .").concat(Gl,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(Fi,`] {
    `).concat(aj,": ").concat(o,`px;
  }
`)},Bg=function(){var t=parseInt(document.body.getAttribute(Fi)||"0",10);return isFinite(t)?t:0},Ej=function(){R.useEffect(function(){return document.body.setAttribute(Fi,(Bg()+1).toString()),function(){var t=Bg()-1;t<=0?document.body.removeAttribute(Fi):document.body.setAttribute(Fi,t.toString())}},[])},jj=function(t){var e=t.noRelative,r=t.noImportant,s=t.gapMode,n=s===void 0?"margin":s;Ej();var i=R.useMemo(function(){return Sj(n)},[n]);return R.createElement(Cj,{styles:kj(i,!e,n,r?"":"!important")})},bh=!1;if(typeof window<"u")try{var Sl=Object.defineProperty({},"passive",{get:function(){return bh=!0,!0}});window.addEventListener("test",Sl,Sl),window.removeEventListener("test",Sl,Sl)}catch{bh=!1}var di=bh?{passive:!1}:!1,Rj=function(t){return t.tagName==="TEXTAREA"},M0=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!=="hidden"&&!(r.overflowY===r.overflowX&&!Rj(t)&&r[e]==="visible")},Nj=function(t){return M0(t,"overflowY")},Tj=function(t){return M0(t,"overflowX")},$g=function(t,e){var r=e.ownerDocument,s=e;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var n=B0(t,s);if(n){var i=$0(t,s),c=i[1],o=i[2];if(c>o)return!0}s=s.parentNode}while(s&&s!==r.body);return!1},Aj=function(t){var e=t.scrollTop,r=t.scrollHeight,s=t.clientHeight;return[e,r,s]},Oj=function(t){var e=t.scrollLeft,r=t.scrollWidth,s=t.clientWidth;return[e,r,s]},B0=function(t,e){return t==="v"?Nj(e):Tj(e)},$0=function(t,e){return t==="v"?Aj(e):Oj(e)},Pj=function(t,e){return t==="h"&&e==="rtl"?-1:1},Lj=function(t,e,r,s,n){var i=Pj(t,window.getComputedStyle(e).direction),c=i*s,o=r.target,l=e.contains(o),d=!1,g=c>0,m=0,v=0;do{if(!o)break;var y=$0(t,o),w=y[0],_=y[1],p=y[2],h=_-p-i*w;(w||h)&&B0(t,o)&&(m+=h,v+=w);var u=o.parentNode;o=u&&u.nodeType===Node.DOCUMENT_FRAGMENT_NODE?u.host:u}while(!l&&o!==document.body||l&&(e.contains(o)||e===o));return(g&&Math.abs(m)<1||!g&&Math.abs(v)<1)&&(d=!0),d},Cl=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Fg=function(t){return[t.deltaX,t.deltaY]},Ug=function(t){return t&&"current"in t?t.current:t},Ij=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Dj=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Mj=0,hi=[];function Bj(t){var e=R.useRef([]),r=R.useRef([0,0]),s=R.useRef(),n=R.useState(Mj++)[0],i=R.useState(D0)[0],c=R.useRef(t);R.useEffect(function(){c.current=t},[t]),R.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(n));var _=YS([t.lockRef.current],(t.shards||[]).map(Ug),!0).filter(Boolean);return _.forEach(function(p){return p.classList.add("allow-interactivity-".concat(n))}),function(){document.body.classList.remove("block-interactivity-".concat(n)),_.forEach(function(p){return p.classList.remove("allow-interactivity-".concat(n))})}}},[t.inert,t.lockRef.current,t.shards]);var o=R.useCallback(function(_,p){if("touches"in _&&_.touches.length===2||_.type==="wheel"&&_.ctrlKey)return!c.current.allowPinchZoom;var h=Cl(_),u=r.current,f="deltaX"in _?_.deltaX:u[0]-h[0],x="deltaY"in _?_.deltaY:u[1]-h[1],k,C=_.target,S=Math.abs(f)>Math.abs(x)?"h":"v";if("touches"in _&&S==="h"&&C.type==="range")return!1;var b=window.getSelection(),E=b&&b.anchorNode,N=E?E===C||E.contains(C):!1;if(N)return!1;var O=$g(S,C);if(!O)return!0;if(O?k=S:(k=S==="v"?"h":"v",O=$g(S,C)),!O)return!1;if(!s.current&&"changedTouches"in _&&(f||x)&&(s.current=k),!k)return!0;var I=s.current||k;return Lj(I,p,_,I==="h"?f:x)},[]),l=R.useCallback(function(_){var p=_;if(!(!hi.length||hi[hi.length-1]!==i)){var h="deltaY"in p?Fg(p):Cl(p),u=e.current.filter(function(k){return k.name===p.type&&(k.target===p.target||p.target===k.shadowParent)&&Ij(k.delta,h)})[0];if(u&&u.should){p.cancelable&&p.preventDefault();return}if(!u){var f=(c.current.shards||[]).map(Ug).filter(Boolean).filter(function(k){return k.contains(p.target)}),x=f.length>0?o(p,f[0]):!c.current.noIsolation;x&&p.cancelable&&p.preventDefault()}}},[]),d=R.useCallback(function(_,p,h,u){var f={name:_,delta:p,target:h,should:u,shadowParent:$j(h)};e.current.push(f),setTimeout(function(){e.current=e.current.filter(function(x){return x!==f})},1)},[]),g=R.useCallback(function(_){r.current=Cl(_),s.current=void 0},[]),m=R.useCallback(function(_){d(_.type,Fg(_),_.target,o(_,t.lockRef.current))},[]),v=R.useCallback(function(_){d(_.type,Cl(_),_.target,o(_,t.lockRef.current))},[]);R.useEffect(function(){return hi.push(i),t.setCallbacks({onScrollCapture:m,onWheelCapture:m,onTouchMoveCapture:v}),document.addEventListener("wheel",l,di),document.addEventListener("touchmove",l,di),document.addEventListener("touchstart",g,di),function(){hi=hi.filter(function(_){return _!==i}),document.removeEventListener("wheel",l,di),document.removeEventListener("touchmove",l,di),document.removeEventListener("touchstart",g,di)}},[]);var y=t.removeScrollBar,w=t.inert;return R.createElement(R.Fragment,null,w?R.createElement(i,{styles:Dj(n)}):null,y?R.createElement(jj,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function $j(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const Fj=pj(I0,Bj);var F0=R.forwardRef(function(t,e){return R.createElement(tu,Wr({},t,{ref:e,sideCar:Fj}))});F0.classNames=tu.classNames;var Uj=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},fi=new WeakMap,kl=new WeakMap,El={},Vu=0,U0=function(t){return t&&(t.host||U0(t.parentNode))},Hj=function(t,e){return e.map(function(r){if(t.contains(r))return r;var s=U0(r);return s&&t.contains(s)?s:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},zj=function(t,e,r,s){var n=Hj(e,Array.isArray(t)?t:[t]);El[r]||(El[r]=new WeakMap);var i=El[r],c=[],o=new Set,l=new Set(n),d=function(m){!m||o.has(m)||(o.add(m),d(m.parentNode))};n.forEach(d);var g=function(m){!m||l.has(m)||Array.prototype.forEach.call(m.children,function(v){if(o.has(v))g(v);else try{var y=v.getAttribute(s),w=y!==null&&y!=="false",_=(fi.get(v)||0)+1,p=(i.get(v)||0)+1;fi.set(v,_),i.set(v,p),c.push(v),_===1&&w&&kl.set(v,!0),p===1&&v.setAttribute(r,"true"),w||v.setAttribute(s,"true")}catch(h){console.error("aria-hidden: cannot operate on ",v,h)}})};return g(e),o.clear(),Vu++,function(){c.forEach(function(m){var v=fi.get(m)-1,y=i.get(m)-1;fi.set(m,v),i.set(m,y),v||(kl.has(m)||m.removeAttribute(s),kl.delete(m)),y||m.removeAttribute(r)}),Vu--,Vu||(fi=new WeakMap,fi=new WeakMap,kl=new WeakMap,El={})}},Wj=function(t,e,r){r===void 0&&(r="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),n=Uj(t);return n?(s.push.apply(s,Array.from(n.querySelectorAll("[aria-live], script"))),zj(s,n,r,"aria-hidden")):function(){return null}},ru="Dialog",[H0]=eu(ru),[qj,Ir]=H0(ru),z0=t=>{const{__scopeDialog:e,children:r,open:s,defaultOpen:n,onOpenChange:i,modal:c=!0}=t,o=R.useRef(null),l=R.useRef(null),[d,g]=sp({prop:s,defaultProp:n??!1,onChange:i,caller:ru});return a.jsx(qj,{scope:e,triggerRef:o,contentRef:l,contentId:na(),titleId:na(),descriptionId:na(),open:d,onOpenChange:g,onOpenToggle:R.useCallback(()=>g(m=>!m),[g]),modal:c,children:r})};z0.displayName=ru;var W0="DialogTrigger",Gj=R.forwardRef((t,e)=>{const{__scopeDialog:r,...s}=t,n=Ir(W0,r),i=Kr(e,n.triggerRef);return a.jsx(Bt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":op(n.open),...s,ref:i,onClick:wt(t.onClick,n.onOpenToggle)})});Gj.displayName=W0;var np="DialogPortal",[Vj,q0]=H0(np,{forceMount:void 0}),G0=t=>{const{__scopeDialog:e,forceMount:r,children:s,container:n}=t,i=Ir(np,e);return a.jsx(Vj,{scope:e,forceMount:r,children:R.Children.map(s,c=>a.jsx(Va,{present:r||i.open,children:a.jsx(P0,{asChild:!0,container:n,children:c})}))})};G0.displayName=np;var jc="DialogOverlay",V0=R.forwardRef((t,e)=>{const r=q0(jc,t.__scopeDialog),{forceMount:s=r.forceMount,...n}=t,i=Ir(jc,t.__scopeDialog);return i.modal?a.jsx(Va,{present:s||i.open,children:a.jsx(Jj,{...n,ref:e})}):null});V0.displayName=jc;var Kj=Ec("DialogOverlay.RemoveScroll"),Jj=R.forwardRef((t,e)=>{const{__scopeDialog:r,...s}=t,n=Ir(jc,r);return a.jsx(F0,{as:Kj,allowPinchZoom:!0,shards:[n.contentRef],children:a.jsx(Bt.div,{"data-state":op(n.open),...s,ref:e,style:{pointerEvents:"auto",...s.style}})})}),Zn="DialogContent",K0=R.forwardRef((t,e)=>{const r=q0(Zn,t.__scopeDialog),{forceMount:s=r.forceMount,...n}=t,i=Ir(Zn,t.__scopeDialog);return a.jsx(Va,{present:s||i.open,children:i.modal?a.jsx(Qj,{...n,ref:e}):a.jsx(Zj,{...n,ref:e})})});K0.displayName=Zn;var Qj=R.forwardRef((t,e)=>{const r=Ir(Zn,t.__scopeDialog),s=R.useRef(null),n=Kr(e,r.contentRef,s);return R.useEffect(()=>{const i=s.current;if(i)return Wj(i)},[]),a.jsx(J0,{...t,ref:n,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:wt(t.onCloseAutoFocus,i=>{var c;i.preventDefault(),(c=r.triggerRef.current)==null||c.focus()}),onPointerDownOutside:wt(t.onPointerDownOutside,i=>{const c=i.detail.originalEvent,o=c.button===0&&c.ctrlKey===!0;(c.button===2||o)&&i.preventDefault()}),onFocusOutside:wt(t.onFocusOutside,i=>i.preventDefault())})}),Zj=R.forwardRef((t,e)=>{const r=Ir(Zn,t.__scopeDialog),s=R.useRef(!1),n=R.useRef(!1);return a.jsx(J0,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var c,o;(c=t.onCloseAutoFocus)==null||c.call(t,i),i.defaultPrevented||(s.current||(o=r.triggerRef.current)==null||o.focus(),i.preventDefault()),s.current=!1,n.current=!1},onInteractOutside:i=>{var l,d;(l=t.onInteractOutside)==null||l.call(t,i),i.defaultPrevented||(s.current=!0,i.detail.originalEvent.type==="pointerdown"&&(n.current=!0));const c=i.target;((d=r.triggerRef.current)==null?void 0:d.contains(c))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&n.current&&i.preventDefault()}})}),J0=R.forwardRef((t,e)=>{const{__scopeDialog:r,trapFocus:s,onOpenAutoFocus:n,onCloseAutoFocus:i,...c}=t,o=Ir(Zn,r),l=R.useRef(null),d=Kr(e,l);return ij(),a.jsxs(a.Fragment,{children:[a.jsx(A0,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:n,onUnmountAutoFocus:i,children:a.jsx(N0,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":op(o.open),...c,ref:d,onDismiss:()=>o.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(Yj,{titleId:o.titleId}),a.jsx(eR,{contentRef:l,descriptionId:o.descriptionId})]})]})}),ip="DialogTitle",Q0=R.forwardRef((t,e)=>{const{__scopeDialog:r,...s}=t,n=Ir(ip,r);return a.jsx(Bt.h2,{id:n.titleId,...s,ref:e})});Q0.displayName=ip;var Z0="DialogDescription",Y0=R.forwardRef((t,e)=>{const{__scopeDialog:r,...s}=t,n=Ir(Z0,r);return a.jsx(Bt.p,{id:n.descriptionId,...s,ref:e})});Y0.displayName=Z0;var X0="DialogClose",ex=R.forwardRef((t,e)=>{const{__scopeDialog:r,...s}=t,n=Ir(X0,r);return a.jsx(Bt.button,{type:"button",...s,ref:e,onClick:wt(t.onClick,()=>n.onOpenChange(!1))})});ex.displayName=X0;function op(t){return t?"open":"closed"}var tx="DialogTitleWarning",[VT,rx]=E2(tx,{contentName:Zn,titleName:ip,docsSlug:"dialog"}),Yj=({titleId:t})=>{const e=rx(tx),r=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return R.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},Xj="DialogDescriptionWarning",eR=({contentRef:t,descriptionId:e})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${rx(Xj).contentName}}.`;return R.useEffect(()=>{var i;const n=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&n&&(document.getElementById(e)||console.warn(s))},[s,t,e]),null},tR=z0,rR=G0,sx=V0,nx=K0,ix=Q0,ox=Y0,sR=ex;const ap="-",nR=t=>{const e=oR(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:s}=t;return{getClassGroupId:c=>{const o=c.split(ap);return o[0]===""&&o.length!==1&&o.shift(),ax(o,e)||iR(c)},getConflictingClassGroupIds:(c,o)=>{const l=r[c]||[];return o&&s[c]?[...l,...s[c]]:l}}},ax=(t,e)=>{var c;if(t.length===0)return e.classGroupId;const r=t[0],s=e.nextPart.get(r),n=s?ax(t.slice(1),s):void 0;if(n)return n;if(e.validators.length===0)return;const i=t.join(ap);return(c=e.validators.find(({validator:o})=>o(i)))==null?void 0:c.classGroupId},Hg=/^\[(.+)\]$/,iR=t=>{if(Hg.test(t)){const e=Hg.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},oR=t=>{const{theme:e,prefix:r}=t,s={nextPart:new Map,validators:[]};return lR(Object.entries(t.classGroups),r).forEach(([i,c])=>{Sh(c,s,i,e)}),s},Sh=(t,e,r,s)=>{t.forEach(n=>{if(typeof n=="string"){const i=n===""?e:zg(e,n);i.classGroupId=r;return}if(typeof n=="function"){if(aR(n)){Sh(n(s),e,r,s);return}e.validators.push({validator:n,classGroupId:r});return}Object.entries(n).forEach(([i,c])=>{Sh(c,zg(e,i),r,s)})})},zg=(t,e)=>{let r=t;return e.split(ap).forEach(s=>{r.nextPart.has(s)||r.nextPart.set(s,{nextPart:new Map,validators:[]}),r=r.nextPart.get(s)}),r},aR=t=>t.isThemeGetter,lR=(t,e)=>e?t.map(([r,s])=>{const n=s.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([c,o])=>[e+c,o])):i);return[r,n]}):t,cR=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,s=new Map;const n=(i,c)=>{r.set(i,c),e++,e>t&&(e=0,s=r,r=new Map)};return{get(i){let c=r.get(i);if(c!==void 0)return c;if((c=s.get(i))!==void 0)return n(i,c),c},set(i,c){r.has(i)?r.set(i,c):n(i,c)}}},lx="!",uR=t=>{const{separator:e,experimentalParseClassName:r}=t,s=e.length===1,n=e[0],i=e.length,c=o=>{const l=[];let d=0,g=0,m;for(let p=0;p<o.length;p++){let h=o[p];if(d===0){if(h===n&&(s||o.slice(p,p+i)===e)){l.push(o.slice(g,p)),g=p+i;continue}if(h==="/"){m=p;continue}}h==="["?d++:h==="]"&&d--}const v=l.length===0?o:o.substring(g),y=v.startsWith(lx),w=y?v.substring(1):v,_=m&&m>g?m-g:void 0;return{modifiers:l,hasImportantModifier:y,baseClassName:w,maybePostfixModifierPosition:_}};return r?o=>r({className:o,parseClassName:c}):c},dR=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(s=>{s[0]==="["?(e.push(...r.sort(),s),r=[]):r.push(s)}),e.push(...r.sort()),e},hR=t=>({cache:cR(t.cacheSize),parseClassName:uR(t),...nR(t)}),fR=/\s+/,pR=(t,e)=>{const{parseClassName:r,getClassGroupId:s,getConflictingClassGroupIds:n}=e,i=[],c=t.trim().split(fR);let o="";for(let l=c.length-1;l>=0;l-=1){const d=c[l],{modifiers:g,hasImportantModifier:m,baseClassName:v,maybePostfixModifierPosition:y}=r(d);let w=!!y,_=s(w?v.substring(0,y):v);if(!_){if(!w){o=d+(o.length>0?" "+o:o);continue}if(_=s(v),!_){o=d+(o.length>0?" "+o:o);continue}w=!1}const p=dR(g).join(":"),h=m?p+lx:p,u=h+_;if(i.includes(u))continue;i.push(u);const f=n(_,w);for(let x=0;x<f.length;++x){const k=f[x];i.push(h+k)}o=d+(o.length>0?" "+o:o)}return o};function mR(){let t=0,e,r,s="";for(;t<arguments.length;)(e=arguments[t++])&&(r=cx(e))&&(s&&(s+=" "),s+=r);return s}const cx=t=>{if(typeof t=="string")return t;let e,r="";for(let s=0;s<t.length;s++)t[s]&&(e=cx(t[s]))&&(r&&(r+=" "),r+=e);return r};function gR(t,...e){let r,s,n,i=c;function c(l){const d=e.reduce((g,m)=>m(g),t());return r=hR(d),s=r.cache.get,n=r.cache.set,i=o,o(l)}function o(l){const d=s(l);if(d)return d;const g=pR(l,r);return n(l,g),g}return function(){return i(mR.apply(null,arguments))}}const $e=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},ux=/^\[(?:([a-z-]+):)?(.+)\]$/i,vR=/^\d+\/\d+$/,_R=new Set(["px","full","screen"]),yR=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,xR=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,wR=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,bR=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,SR=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Yr=t=>Ui(t)||_R.has(t)||vR.test(t),ws=t=>ko(t,"length",AR),Ui=t=>!!t&&!Number.isNaN(Number(t)),Ku=t=>ko(t,"number",Ui),Mo=t=>!!t&&Number.isInteger(Number(t)),CR=t=>t.endsWith("%")&&Ui(t.slice(0,-1)),we=t=>ux.test(t),bs=t=>yR.test(t),kR=new Set(["length","size","percentage"]),ER=t=>ko(t,kR,dx),jR=t=>ko(t,"position",dx),RR=new Set(["image","url"]),NR=t=>ko(t,RR,PR),TR=t=>ko(t,"",OR),Bo=()=>!0,ko=(t,e,r)=>{const s=ux.exec(t);return s?s[1]?typeof e=="string"?s[1]===e:e.has(s[1]):r(s[2]):!1},AR=t=>xR.test(t)&&!wR.test(t),dx=()=>!1,OR=t=>bR.test(t),PR=t=>SR.test(t),LR=()=>{const t=$e("colors"),e=$e("spacing"),r=$e("blur"),s=$e("brightness"),n=$e("borderColor"),i=$e("borderRadius"),c=$e("borderSpacing"),o=$e("borderWidth"),l=$e("contrast"),d=$e("grayscale"),g=$e("hueRotate"),m=$e("invert"),v=$e("gap"),y=$e("gradientColorStops"),w=$e("gradientColorStopPositions"),_=$e("inset"),p=$e("margin"),h=$e("opacity"),u=$e("padding"),f=$e("saturate"),x=$e("scale"),k=$e("sepia"),C=$e("skew"),S=$e("space"),b=$e("translate"),E=()=>["auto","contain","none"],N=()=>["auto","hidden","clip","visible","scroll"],O=()=>["auto",we,e],I=()=>[we,e],P=()=>["",Yr,ws],U=()=>["auto",Ui,we],D=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],H=()=>["solid","dashed","dotted","double","none"],z=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],B=()=>["start","end","center","between","around","evenly","stretch"],j=()=>["","0",we],T=()=>["auto","avoid","all","avoid-page","page","left","right","column"],L=()=>[Ui,we];return{cacheSize:500,separator:":",theme:{colors:[Bo],spacing:[Yr,ws],blur:["none","",bs,we],brightness:L(),borderColor:[t],borderRadius:["none","","full",bs,we],borderSpacing:I(),borderWidth:P(),contrast:L(),grayscale:j(),hueRotate:L(),invert:j(),gap:I(),gradientColorStops:[t],gradientColorStopPositions:[CR,ws],inset:O(),margin:O(),opacity:L(),padding:I(),saturate:L(),scale:L(),sepia:j(),skew:L(),space:I(),translate:I()},classGroups:{aspect:[{aspect:["auto","square","video",we]}],container:["container"],columns:[{columns:[bs]}],"break-after":[{"break-after":T()}],"break-before":[{"break-before":T()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...D(),we]}],overflow:[{overflow:N()}],"overflow-x":[{"overflow-x":N()}],"overflow-y":[{"overflow-y":N()}],overscroll:[{overscroll:E()}],"overscroll-x":[{"overscroll-x":E()}],"overscroll-y":[{"overscroll-y":E()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[_]}],"inset-x":[{"inset-x":[_]}],"inset-y":[{"inset-y":[_]}],start:[{start:[_]}],end:[{end:[_]}],top:[{top:[_]}],right:[{right:[_]}],bottom:[{bottom:[_]}],left:[{left:[_]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Mo,we]}],basis:[{basis:O()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",we]}],grow:[{grow:j()}],shrink:[{shrink:j()}],order:[{order:["first","last","none",Mo,we]}],"grid-cols":[{"grid-cols":[Bo]}],"col-start-end":[{col:["auto",{span:["full",Mo,we]},we]}],"col-start":[{"col-start":U()}],"col-end":[{"col-end":U()}],"grid-rows":[{"grid-rows":[Bo]}],"row-start-end":[{row:["auto",{span:[Mo,we]},we]}],"row-start":[{"row-start":U()}],"row-end":[{"row-end":U()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",we]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",we]}],gap:[{gap:[v]}],"gap-x":[{"gap-x":[v]}],"gap-y":[{"gap-y":[v]}],"justify-content":[{justify:["normal",...B()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...B(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...B(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[u]}],px:[{px:[u]}],py:[{py:[u]}],ps:[{ps:[u]}],pe:[{pe:[u]}],pt:[{pt:[u]}],pr:[{pr:[u]}],pb:[{pb:[u]}],pl:[{pl:[u]}],m:[{m:[p]}],mx:[{mx:[p]}],my:[{my:[p]}],ms:[{ms:[p]}],me:[{me:[p]}],mt:[{mt:[p]}],mr:[{mr:[p]}],mb:[{mb:[p]}],ml:[{ml:[p]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",we,e]}],"min-w":[{"min-w":[we,e,"min","max","fit"]}],"max-w":[{"max-w":[we,e,"none","full","min","max","fit","prose",{screen:[bs]},bs]}],h:[{h:[we,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[we,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[we,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[we,e,"auto","min","max","fit"]}],"font-size":[{text:["base",bs,ws]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ku]}],"font-family":[{font:[Bo]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",we]}],"line-clamp":[{"line-clamp":["none",Ui,Ku]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Yr,we]}],"list-image":[{"list-image":["none",we]}],"list-style-type":[{list:["none","disc","decimal",we]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[h]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[h]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...H(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Yr,ws]}],"underline-offset":[{"underline-offset":["auto",Yr,we]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:I()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",we]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",we]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[h]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...D(),jR]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",ER]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},NR]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[w]}],"gradient-via-pos":[{via:[w]}],"gradient-to-pos":[{to:[w]}],"gradient-from":[{from:[y]}],"gradient-via":[{via:[y]}],"gradient-to":[{to:[y]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[h]}],"border-style":[{border:[...H(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[h]}],"divide-style":[{divide:H()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...H()]}],"outline-offset":[{"outline-offset":[Yr,we]}],"outline-w":[{outline:[Yr,ws]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:P()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[h]}],"ring-offset-w":[{"ring-offset":[Yr,ws]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",bs,TR]}],"shadow-color":[{shadow:[Bo]}],opacity:[{opacity:[h]}],"mix-blend":[{"mix-blend":[...z(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":z()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[s]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",bs,we]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[g]}],invert:[{invert:[m]}],saturate:[{saturate:[f]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[g]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[h]}],"backdrop-saturate":[{"backdrop-saturate":[f]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",we]}],duration:[{duration:L()}],ease:[{ease:["linear","in","out","in-out",we]}],delay:[{delay:L()}],animate:[{animate:["none","spin","ping","pulse","bounce",we]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[x]}],"scale-x":[{"scale-x":[x]}],"scale-y":[{"scale-y":[x]}],rotate:[{rotate:[Mo,we]}],"translate-x":[{"translate-x":[b]}],"translate-y":[{"translate-y":[b]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",we]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",we]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":I()}],"scroll-mx":[{"scroll-mx":I()}],"scroll-my":[{"scroll-my":I()}],"scroll-ms":[{"scroll-ms":I()}],"scroll-me":[{"scroll-me":I()}],"scroll-mt":[{"scroll-mt":I()}],"scroll-mr":[{"scroll-mr":I()}],"scroll-mb":[{"scroll-mb":I()}],"scroll-ml":[{"scroll-ml":I()}],"scroll-p":[{"scroll-p":I()}],"scroll-px":[{"scroll-px":I()}],"scroll-py":[{"scroll-py":I()}],"scroll-ps":[{"scroll-ps":I()}],"scroll-pe":[{"scroll-pe":I()}],"scroll-pt":[{"scroll-pt":I()}],"scroll-pr":[{"scroll-pr":I()}],"scroll-pb":[{"scroll-pb":I()}],"scroll-pl":[{"scroll-pl":I()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",we]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Yr,ws,Ku]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},IR=gR(LR);function Xe(...t){return IR(x0(t))}const hx=tR,DR=rR,fx=R.forwardRef(({className:t,...e},r)=>a.jsx(sx,{ref:r,className:Xe("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));fx.displayName=sx.displayName;const lp=R.forwardRef(({className:t,children:e,...r},s)=>a.jsxs(DR,{children:[a.jsx(fx,{}),a.jsxs(nx,{ref:s,className:Xe("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-leo-border bg-leo-bg-secondary p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[e,a.jsxs(sR,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-leo-bg transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-leo-primary focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-leo-bg-tertiary data-[state=open]:text-leo-text-secondary",children:[a.jsx(us,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));lp.displayName=nx.displayName;const cp=({className:t,...e})=>a.jsx("div",{className:Xe("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});cp.displayName="DialogHeader";const up=({className:t,...e})=>a.jsx("div",{className:Xe("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});up.displayName="DialogFooter";const dp=R.forwardRef(({className:t,...e},r)=>a.jsx(ix,{ref:r,className:Xe("text-lg font-semibold leading-none tracking-tight text-leo-text",t),...e}));dp.displayName=ix.displayName;const hp=R.forwardRef(({className:t,...e},r)=>a.jsx(ox,{ref:r,className:Xe("text-sm text-leo-text-secondary",t),...e}));hp.displayName=ox.displayName;const MR=60;function px({onTranscription:t,onError:e,disabled:r=!1,className:s=""}){const{session:n}=ft(),[i,c]=R.useState("idle"),[o,l]=R.useState(0),[d,g]=R.useState(null),m=R.useRef(null),v=R.useRef([]),y=R.useRef(null),w=R.useRef(null),_=R.useCallback(()=>{y.current&&(clearInterval(y.current),y.current=null),w.current&&(w.current.getTracks().forEach(C=>C.stop()),w.current=null),m.current=null,v.current=[],l(0)},[]);R.useEffect(()=>_,[_]);const p=R.useCallback(async()=>{g(null);try{const C=await navigator.mediaDevices.getUserMedia({audio:{channelCount:1,sampleRate:16e3}});w.current=C;const S=new MediaRecorder(C,{mimeType:"audio/webm;codecs=opus"});m.current=S,v.current=[],S.ondataavailable=b=>{b.data.size>0&&v.current.push(b.data)},S.onstop=async()=>{const b=new Blob(v.current,{type:"audio/webm"});C.getTracks().forEach(E=>E.stop()),b.size>0&&await u(b),_()},S.start(1e3),c("recording"),l(0),y.current=setInterval(()=>{l(b=>{const E=b+1;return E>=MR&&h(),E})},1e3)}catch(C){console.error("[VoiceInput] Failed to start recording:",C);let S="Failed to access microphone";C instanceof DOMException&&(C.name==="NotAllowedError"?S="Microphone permission denied. Please allow microphone access.":C.name==="NotFoundError"&&(S="No microphone found. Please connect a microphone.")),g(S),e==null||e(S),_(),c("idle")}},[_,e]),h=R.useCallback(()=>{m.current&&m.current.state==="recording"&&(m.current.stop(),c("processing"))},[]),u=R.useCallback(async C=>{c("processing");try{const S=new FormData;S.append("audio",C,"recording.webm");const b=await fetch("/api/transcribe",{method:"POST",headers:{Authorization:`Bearer ${n==null?void 0:n.access_token}`},body:S});if(!b.ok){const N=await b.json().catch(()=>({}));throw new Error(N.error||`Transcription failed: ${b.status}`)}const E=await b.json();E.text&&E.text.trim()?t(E.text.trim()):(g("No speech detected. Please try again."),e==null||e("No speech detected"))}catch(S){console.error("[VoiceInput] Transcription error:",S);const b=S instanceof Error?S.message:"Transcription failed";g(b),e==null||e(b)}finally{c("idle")}},[n,t,e]),f=R.useCallback(()=>{r||(i==="idle"?p():i==="recording"&&h())},[i,r,p,h]),x=C=>{const S=Math.floor(C/60),b=C%60;return`${S}:${b.toString().padStart(2,"0")}`},k=()=>{const C="w-7 h-7 flex items-center justify-center rounded-lg transition-all duration-200";if(r)return`${C} bg-leo-bg-tertiary cursor-not-allowed opacity-50`;switch(i){case"recording":return`${C} bg-red-500 hover:bg-red-600 animate-pulse cursor-pointer`;case"processing":return`${C} bg-leo-bg-tertiary cursor-wait`;default:return`${C} bg-leo-bg-tertiary hover:bg-leo-bg-hover cursor-pointer`}};return a.jsxs("div",{className:`relative inline-flex items-center ${s}`,children:[i==="recording"&&a.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 px-2 py-0.5 bg-red-500 text-white text-xs rounded-full whitespace-nowrap",children:x(o)}),a.jsx("button",{type:"button",onClick:f,disabled:r||i==="processing",className:k(),title:i==="recording"?"Click to stop recording":i==="processing"?"Transcribing...":"Click to start voice input","aria-label":i==="recording"?`Recording: ${x(o)}. Click to stop.`:i==="processing"?"Processing audio...":"Start voice input",children:i==="processing"?a.jsx(at,{className:"w-4 h-4 text-leo-text-secondary animate-spin"}):a.jsx(n2,{className:`w-4 h-4 ${i==="recording"?"text-white":"text-leo-text-secondary"}`})}),d&&i==="idle"&&a.jsx("div",{className:"absolute -top-8 left-1/2 -translate-x-1/2 px-2 py-1 bg-red-500/90 text-white text-xs rounded whitespace-nowrap max-w-48 truncate",children:d})]})}const Ss=3,Wg=2*1024*1024,BR=["image/png","image/jpeg","image/gif","image/webp"];function mx({isOpen:t,onClose:e,sourcePage:r}){const{session:s}=ft(),[n,i]=R.useState("feature_request"),[c,o]=R.useState(""),[l,d]=R.useState([]),[g,m]=R.useState(!1),[v,y]=R.useState(!1),[w,_]=R.useState(null),[p,h]=R.useState(!1),u=R.useRef(null),f=R.useCallback(b=>{o(E=>E?`${E} ${b}`:b)},[]),x=R.useCallback(async b=>{const E=b.target.files;if(!E||E.length===0)return;if(l.length>=Ss){_(`Maximum ${Ss} images allowed`);return}const N=E[0];if(!BR.includes(N.type)){_("Only PNG, JPG, GIF, and WebP images are allowed");return}if(N.size>Wg){_(`Image must be less than ${Wg/1024/1024}MB`);return}_(null),y(!0);try{const O=new FormData;O.append("file",N);const I=await fetch("/api/feedback/upload",{method:"POST",headers:{Authorization:`Bearer ${s==null?void 0:s.access_token}`},body:O});if(!I.ok){const U=await I.json().catch(()=>({}));throw new Error(U.error||"Failed to upload image")}const P=await I.json();d(U=>[...U,P])}catch(O){console.error("[FeedbackModal] Upload error:",O),_(O instanceof Error?O.message:"Failed to upload image")}finally{y(!1),u.current&&(u.current.value="")}},[l.length,s==null?void 0:s.access_token]),k=R.useCallback(b=>{d(E=>E.filter((N,O)=>O!==b))},[]),C=R.useCallback(async()=>{if(!c.trim()||c.trim().length<10){_("Please enter at least 10 characters of feedback.");return}m(!0),_(null);try{const b=await fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s==null?void 0:s.access_token}`},body:JSON.stringify({type:n,content:c.trim(),sourcePage:r,attachments:l.length>0?l:void 0})});if(!b.ok){const E=await b.json().catch(()=>({}));throw new Error(E.error||"Failed to submit feedback")}h(!0),o(""),d([]),setTimeout(()=>{h(!1),e()},1500)}catch(b){console.error("[FeedbackModal] Submission error:",b),_(b instanceof Error?b.message:"Failed to submit feedback")}finally{m(!1)}},[c,n,r,l,s,e]),S=b=>{b||(o(""),d([]),_(null),h(!1),i("feature_request"),e())};return a.jsx(hx,{open:t,onOpenChange:S,children:a.jsxs(lp,{className:"sm:max-w-[500px]",children:[a.jsxs(cp,{children:[a.jsxs(dp,{className:"flex items-center gap-2",children:[a.jsx(tp,{className:"h-5 w-5 text-leo-primary"}),"Send Feedback"]}),a.jsx(hp,{children:"Help us improve Leo by sharing your thoughts. We read every submission."})]}),p?a.jsxs("div",{className:"py-8 text-center",children:[a.jsx("div",{className:"mx-auto w-12 h-12 rounded-full bg-green-500/20 flex items-center justify-center mb-3",children:a.jsx(yh,{className:"h-6 w-6 text-green-500"})}),a.jsx("p",{className:"text-leo-text font-medium",children:"Thank you for your feedback!"}),a.jsx("p",{className:"text-leo-text-secondary text-sm mt-1",children:"We appreciate you taking the time."})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{type:"button",onClick:()=>i("feature_request"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg border transition-all ${n==="feature_request"?"border-leo-primary bg-leo-primary/10 text-leo-primary":"border-leo-border bg-leo-bg-tertiary text-leo-text-secondary hover:border-leo-primary/50"}`,children:[a.jsx(e2,{className:"h-4 w-4"}),a.jsx("span",{className:"font-medium",children:"Feature Request"})]}),a.jsxs("button",{type:"button",onClick:()=>i("bug_report"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg border transition-all ${n==="bug_report"?"border-red-500 bg-red-500/10 text-red-500":"border-leo-border bg-leo-bg-tertiary text-leo-text-secondary hover:border-red-500/50"}`,children:[a.jsx(FE,{className:"h-4 w-4"}),a.jsx("span",{className:"font-medium",children:"Bug Report"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("textarea",{value:c,onChange:b=>o(b.target.value),placeholder:n==="feature_request"?"Describe the feature you would like to see...":"Describe the bug you encountered...",className:"w-full h-32 px-4 py-3 pr-24 rounded-lg border border-leo-border bg-leo-bg-tertiary text-leo-text placeholder:text-leo-text-tertiary focus:outline-none focus:ring-2 focus:ring-leo-primary focus:border-transparent resize-none",disabled:g}),a.jsxs("div",{className:"absolute right-3 bottom-3 flex items-center gap-2",children:[a.jsx("input",{ref:u,type:"file",accept:"image/png,image/jpeg,image/gif,image/webp",onChange:x,className:"hidden",disabled:g||v||l.length>=Ss}),a.jsx("button",{type:"button",onClick:()=>{var b;return(b=u.current)==null?void 0:b.click()},disabled:g||v||l.length>=Ss,className:"p-2 rounded-lg hover:bg-leo-bg-secondary text-leo-text-secondary hover:text-leo-text disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:l.length>=Ss?`Max ${Ss} images`:"Attach image",children:v?a.jsx(at,{className:"h-5 w-5 animate-spin"}):a.jsx(Eg,{className:"h-5 w-5"})}),a.jsx(px,{onTranscription:f,disabled:g})]})]}),l.length>0&&a.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.map((b,E)=>a.jsxs("div",{className:"relative group w-20 h-20 rounded-lg border border-leo-border overflow-hidden",children:[a.jsx("img",{src:b.url,alt:b.name,className:"w-full h-full object-cover"}),a.jsx("button",{type:"button",onClick:()=>k(E),className:"absolute top-1 right-1 p-1 rounded-full bg-black/60 text-white opacity-0 group-hover:opacity-100 transition-opacity hover:bg-black/80",title:"Remove image",children:a.jsx(us,{className:"h-3 w-3"})}),a.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[10px] px-1 truncate",children:b.name})]},E)),l.length<Ss&&a.jsx("button",{type:"button",onClick:()=>{var b;return(b=u.current)==null?void 0:b.click()},disabled:v,className:"w-20 h-20 rounded-lg border border-dashed border-leo-border hover:border-leo-primary flex items-center justify-center text-leo-text-tertiary hover:text-leo-primary transition-colors disabled:opacity-50",children:a.jsx(Eg,{className:"h-6 w-6"})})]}),a.jsxs("div",{className:"flex justify-between items-center text-xs text-leo-text-tertiary",children:[a.jsxs("span",{children:[c.length," / 5000 characters",l.length>0&&`  ${l.length}/${Ss} images`]}),a.jsx("span",{className:c.length<10?"text-red-500":"",children:c.length<10?`${10-c.length} more needed`:"Ready to submit"})]}),w&&a.jsx("div",{className:"px-3 py-2 rounded-lg bg-red-500/10 border border-red-500/30 text-red-500 text-sm",children:w}),a.jsxs(up,{children:[a.jsx(le,{variant:"outline",onClick:()=>S(!1),disabled:g,children:"Cancel"}),a.jsx(le,{onClick:C,disabled:g||c.trim().length<10,children:g?a.jsxs(a.Fragment,{children:[a.jsx(at,{className:"h-4 w-4 animate-spin"}),"Submitting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(yh,{className:"h-4 w-4"}),"Submit Feedback"]})})]})]})]})})}const $R="auth_token",rn=()=>{const t=Object.keys(localStorage).find(e=>e.startsWith("sb-")&&e.endsWith("-auth-token"));if(t)try{const e=JSON.parse(localStorage.getItem(t)||"{}");if(e.access_token)return e.access_token}catch{}return localStorage.getItem($R)};function FR(){const t=Jc(),{profile:e}=ft(),r=(e==null?void 0:e.role)!=="user",[s,n]=R.useState(""),[i,c]=R.useState("all"),[o,l]=R.useState(!1),[d,g]=R.useState(null),{data:m,isLoading:v,error:y,isFetching:w}=Qc({queryKey:["generations"],queryFn:async()=>{const S=rn(),b=await fetch("/api/generations",{credentials:"include",headers:S?{Authorization:`Bearer ${S}`}:{}});if(!b.ok)throw new Error("Failed to fetch generations");return b.json()},refetchInterval:S=>{const b=S.state.data;return!b||!Array.isArray(b)?!1:b.some(N=>N.status==="queued"||N.status==="generating"||N.status==="paused")?5e3:!1},retry:1,staleTime:2e3,throwOnError:!1}),_=oh({mutationFn:async S=>{const b=rn(),E=await fetch(`/api/apps/${S}`,{method:"DELETE",credentials:"include",headers:b?{Authorization:`Bearer ${b}`}:{}});if(!E.ok){const N=await E.json();throw new Error(N.error||"Failed to delete app")}return E.json()},onSuccess:()=>{t.invalidateQueries({queryKey:["generations"]}),t.invalidateQueries({queryKey:["apps"]}),g(null)},onError:()=>{g(null)}}),p=S=>{window.confirm(`Are you sure you want to delete "${S.appName}"?

This will permanently remove the app and all ${S.versionCount} version${S.versionCount!==1?"s":""}.`)&&(g(S.appRefId),_.mutate(S.appRefId))},h=R.useMemo(()=>{if(!m||!Array.isArray(m))return[];const S=new Map;for(const E of m){const N=S.get(E.appRefId)||[];N.push(E),S.set(E.appRefId,N)}const b=[];for(const[E,N]of S){N.sort((P,U)=>new Date(U.createdAt).getTime()-new Date(P.createdAt).getTime());const O=N[0],I=N.some(P=>P.status==="queued"||P.status==="generating"||P.status==="paused");b.push({appRefId:E,appName:O.appName,appUuid:O.appUuid,githubUrl:O.githubUrl,deploymentUrl:O.deploymentUrl,latestGeneration:O,versionCount:N.length,lastUpdated:O.updatedAt,hasActiveGeneration:I,cumulativeCost:O.cumulativeCost})}return b.sort((E,N)=>new Date(N.lastUpdated).getTime()-new Date(E.lastUpdated).getTime()),b},[m]),u=R.useMemo(()=>h.filter(S=>{const b=s.trim()===""||S.appName.toLowerCase().includes(s.toLowerCase())||S.latestGeneration.prompt.toLowerCase().includes(s.toLowerCase()),E=S.latestGeneration.status,N=i==="all"||(()=>{switch(i){case"generating":return E==="generating"||E==="queued"||E==="paused";case"completed":return E==="completed";case"failed":return E==="failed";default:return!0}})();return b&&N}),[h,s,i]),f=S=>{const b=new Date(S),N=new Date().getTime()-b.getTime(),O=Math.floor(N/6e4),I=Math.floor(N/36e5),P=Math.floor(N/864e5);return O<1?"just now":O<60?`${O}m ago`:I<24?`${I}h ago`:P<7?`${P}d ago`:b.toLocaleDateString("en-US",{month:"short",day:"numeric"})},x=S=>{switch(S){case"queued":return a.jsx(Qn,{className:"h-5 w-5 text-yellow-500"});case"generating":return a.jsx(at,{className:"h-5 w-5 text-purple-400 animate-spin"});case"completed":return a.jsx(Jn,{className:"h-5 w-5 text-emerald-400"});case"failed":return a.jsx(ti,{className:"h-5 w-5 text-red-400"});case"paused":return a.jsx(S0,{className:"h-5 w-5 text-cyan-400"})}},k=S=>{const b={queued:"bg-yellow-500/10 text-yellow-400 border-yellow-500/30",generating:"bg-purple-500/10 text-purple-400 border-purple-500/30",completed:"bg-emerald-500/10 text-emerald-400 border-emerald-500/30",failed:"bg-red-500/10 text-red-400 border-red-500/30",paused:"bg-cyan-500/10 text-cyan-400 border-cyan-500/30",cancelled:"bg-gray-500/10 text-gray-400 border-gray-500/30"};return a.jsx(qs,{className:`${b[S]} font-medium border text-xs`,children:S.toUpperCase()})},C=y&&!w&&!m;return a.jsxs(lt,{children:[a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[a.jsx("div",{className:"mb-10 animate-fade-in-up",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-purple-500/20 to-cyan-500/20 flex items-center justify-center",children:a.jsx(bc,{className:"h-5 w-5 text-purple-400"})}),a.jsx("h1",{className:"text-4xl font-bold text-leo-text",children:"My Apps"})]}),a.jsx("p",{className:"text-lg text-leo-text-secondary",children:"Your AI-generated applications"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs(le,{variant:"ghost",onClick:()=>l(!0),className:"text-leo-text-secondary hover:text-leo-text hover:bg-white/5",children:[a.jsx(tp,{className:"h-4 w-4 mr-2"}),"Feedback"]}),r&&a.jsx(Re,{href:"/console",children:a.jsxs(le,{className:"leo-btn-primary px-5 py-2.5 text-sm",children:[a.jsx(C0,{className:"h-4 w-4 mr-2"}),"New App"]})})]})]})}),!v&&!C&&h.length>0&&a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-8 animate-fade-in-up",style:{animationDelay:"0.1s"},children:[a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(jg,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-leo-text-tertiary"}),a.jsx(Vt,{type:"text",placeholder:"Search apps...",value:s,onChange:S=>n(S.target.value),className:"pl-11 h-11 bg-white/5 border-white/10 text-leo-text placeholder:text-leo-text-tertiary focus:border-purple-500/50 focus:ring-purple-500/20 rounded-xl"})]}),a.jsx("div",{className:"flex gap-2",children:["all","generating","completed","failed"].map(S=>a.jsx(le,{variant:"ghost",size:"sm",onClick:()=>c(S),className:`px-4 rounded-lg transition-all duration-200 ${i===S?"bg-purple-500/20 text-purple-400 border border-purple-500/30":"text-leo-text-secondary hover:text-leo-text hover:bg-white/5"}`,children:S==="all"?"All":S.charAt(0).toUpperCase()+S.slice(1)},S))})]}),v&&a.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(S=>a.jsxs("div",{className:"leo-card p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(tr,{className:"h-12 w-12 rounded-xl bg-white/5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx(tr,{className:"h-5 w-3/4 bg-white/5 mb-2"}),a.jsx(tr,{className:"h-4 w-1/2 bg-white/5"})]})]}),a.jsx(tr,{className:"h-4 w-full bg-white/5"}),a.jsx(tr,{className:"h-10 w-full bg-white/5"})]},S))}),C&&a.jsx("div",{className:"leo-card p-8 border-red-500/30 animate-fade-in-up",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-500/10 flex items-center justify-center flex-shrink-0",children:a.jsx(Kn,{className:"h-6 w-6 text-red-400"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-leo-text mb-1",children:"Unable to load apps"}),a.jsx("p",{className:"text-leo-text-secondary",children:y instanceof Error&&y.message.includes("401")?"Please log in to view your apps":y instanceof Error?y.message:"Please try refreshing the page"})]})]})}),!v&&!C&&h.length===0&&a.jsx("div",{className:"leo-card p-16 text-center border-dashed animate-fade-in-up",children:a.jsxs("div",{className:"flex flex-col items-center gap-6",children:[a.jsx("div",{className:"w-24 h-24 rounded-3xl bg-gradient-to-br from-purple-500/20 to-cyan-500/20 flex items-center justify-center shadow-glow-sm",children:a.jsx(JE,{className:"h-12 w-12 text-purple-400"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-2xl font-bold text-leo-text",children:"No apps yet"}),a.jsx("p",{className:"text-leo-text-secondary max-w-md",children:"Start by creating your first AI-generated app. Describe your idea and Leo will build it for you."})]}),a.jsx(Re,{href:"/console",children:a.jsxs(le,{className:"leo-btn-primary px-8 py-6 text-lg rounded-2xl group mt-4",children:[a.jsx(Co,{className:"h-5 w-5 mr-2"}),"Create Your First App",a.jsx(Pr,{className:"h-5 w-5 ml-2 group-hover:translate-x-1 transition-transform"})]})})]})}),!v&&!C&&h.length>0&&a.jsxs(a.Fragment,{children:[u.length===0&&a.jsxs("div",{className:"leo-card p-12 text-center animate-fade-in-up",children:[a.jsx(jg,{className:"h-12 w-12 text-leo-text-tertiary mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-leo-text mb-2",children:"No apps found"}),a.jsx("p",{className:"text-leo-text-secondary mb-4",children:"Try adjusting your search or filter"}),a.jsx(le,{variant:"ghost",onClick:()=>{n(""),c("all")},className:"text-purple-400 hover:text-purple-300 hover:bg-purple-500/10",children:"Clear filters"})]}),u.length>0&&a.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3 stagger-children",children:u.map(S=>a.jsx(Re,{href:`/apps/${S.appRefId}`,children:a.jsxs("div",{className:"leo-card group cursor-pointer h-full",children:[a.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-purple-500/20 to-cyan-500/10 flex items-center justify-center flex-shrink-0 group-hover:shadow-glow-sm transition-shadow",children:x(S.latestGeneration.status)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-leo-text truncate group-hover:text-purple-400 transition-colors",title:S.appName,children:S.appName}),a.jsx(le,{variant:"ghost",size:"sm",onClick:b=>{b.preventDefault(),b.stopPropagation(),p(S)},disabled:d===S.appRefId,className:"h-7 w-7 p-0 text-leo-text-tertiary hover:text-red-400 hover:bg-red-500/10 opacity-0 group-hover:opacity-100 transition-all flex-shrink-0",children:d===S.appRefId?a.jsx(at,{className:"h-4 w-4 animate-spin"}):a.jsx(k0,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[k(S.latestGeneration.status),a.jsxs("span",{className:"text-xs text-leo-text-tertiary",children:[S.versionCount," version",S.versionCount!==1?"s":""]}),S.hasActiveGeneration&&S.latestGeneration.currentIteration>0&&a.jsxs("span",{className:"text-xs text-purple-400",children:["(",S.latestGeneration.currentIteration,"/",S.latestGeneration.maxIterations,")"]})]})]})]}),a.jsxs("p",{className:"text-sm text-leo-text-secondary line-clamp-2 mb-4",title:S.latestGeneration.prompt,children:['"',S.latestGeneration.prompt,'"']}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-leo-text-tertiary mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{children:f(S.lastUpdated)}),S.cumulativeCost&&parseFloat(S.cumulativeCost)>0&&a.jsxs("span",{className:"flex items-center gap-0.5 text-cyan-400",title:"Total cost",children:[a.jsx(Xf,{className:"h-3 w-3"}),parseFloat(S.cumulativeCost).toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[S.githubUrl&&a.jsx("a",{href:S.githubUrl,target:"_blank",rel:"noopener noreferrer",onClick:b=>b.stopPropagation(),className:"flex items-center gap-1 px-2 py-1 rounded-md bg-white/5 hover:bg-white/10 transition-colors",children:a.jsx(Ga,{className:"h-3 w-3"})}),S.deploymentUrl&&a.jsx("a",{href:S.deploymentUrl,target:"_blank",rel:"noopener noreferrer",onClick:b=>b.stopPropagation(),className:"flex items-center gap-1 px-2 py-1 rounded-md bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500/20 transition-colors",children:a.jsx(So,{className:"h-3 w-3"})})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Re,{href:`/console/${S.appRefId}`,onClick:b=>b.stopPropagation(),children:a.jsxs(le,{variant:"ghost",className:"flex-1 justify-center text-emerald-400 hover:text-emerald-300 hover:bg-emerald-500/10 group/btn",children:[a.jsx(Sc,{className:"h-4 w-4 mr-1.5"}),a.jsx("span",{children:"Resume"})]})}),a.jsxs(le,{variant:"ghost",className:"flex-1 justify-between text-leo-text-secondary hover:text-purple-400 hover:bg-purple-500/10 group/btn",children:[a.jsx("span",{children:"View Details"}),a.jsx(Pr,{className:"h-4 w-4 group-hover/btn:translate-x-1 transition-transform"})]})]})]})},S.appRefId))})]})]}),a.jsx(mx,{isOpen:o,onClose:()=>l(!1),sourcePage:"apps"})]})}const Eo=(...t)=>t.filter(Boolean).join(" "),Ch=R.forwardRef(({className:t,...e},r)=>a.jsx("div",{ref:r,className:Eo("rounded-lg border border-border bg-card text-card-foreground shadow-lg transition-all duration-300 hover:shadow-xl",t),...e}));Ch.displayName="Card";const gx=R.forwardRef(({className:t,...e},r)=>a.jsx("div",{ref:r,className:Eo("flex flex-col space-y-1.5 p-6",t),...e}));gx.displayName="CardHeader";const vx=R.forwardRef(({className:t,...e},r)=>a.jsx("h3",{ref:r,className:Eo("text-2xl font-semibold leading-none tracking-tight",t),...e}));vx.displayName="CardTitle";const _x=R.forwardRef(({className:t,...e},r)=>a.jsx("p",{ref:r,className:Eo("text-sm text-muted-foreground",t),...e}));_x.displayName="CardDescription";const kh=R.forwardRef(({className:t,...e},r)=>a.jsx("div",{ref:r,className:Eo("p-6 pt-0",t),...e}));kh.displayName="CardContent";const UR=R.forwardRef(({className:t,...e},r)=>a.jsx("div",{ref:r,className:Eo("flex items-center p-6 pt-0",t),...e}));UR.displayName="CardFooter";const HR=Yf("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Ai=R.forwardRef(({className:t,variant:e,...r},s)=>a.jsx("div",{ref:s,role:"alert",className:Xe(HR({variant:e}),t),...r}));Ai.displayName="Alert";const Oi=R.forwardRef(({className:t,...e},r)=>a.jsx("div",{ref:r,className:Xe("text-sm [&_p]:leading-relaxed",t),...e}));Oi.displayName="AlertDescription";function zR({isOpen:t,onClose:e,githubUrl:r,generationId:s,deploymentUrl:n,onDeploy:i,isDeploying:c=!1,deployError:o,deploySuccess:l=!1}){return R.useEffect(()=>{const d=g=>{g.key==="Escape"&&e()};return t&&(document.addEventListener("keydown",d),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",d),document.body.style.overflow="unset"}},[t,e]),t?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 animate-in fade-in",onClick:e}),a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:a.jsxs(Ch,{className:"w-full max-w-4xl max-h-[90vh] overflow-y-auto animate-in fade-in zoom-in-95",children:[a.jsx(gx,{className:"sticky top-0 bg-background border-b z-10",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(vx,{className:"flex items-center gap-2 text-2xl",children:[a.jsx(Wl,{className:"h-6 w-6"}),"Deploy to Fly.io"]}),a.jsx(_x,{children:"Your app is ready to deploy! Follow the instructions below to launch it on Fly.io."})]}),a.jsx(le,{variant:"ghost",size:"icon",onClick:e,className:"shrink-0",children:a.jsx(us,{className:"h-4 w-4"})})]})}),a.jsxs(kh,{className:"space-y-6 pt-6",children:[i&&a.jsx(Ch,{className:"border-2 border-primary/20 bg-primary/5",children:a.jsxs(kh,{className:"pt-6 space-y-4",children:[a.jsx("div",{className:"flex items-start justify-between gap-4",children:a.jsxs("div",{className:"space-y-1 flex-1",children:[a.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(Wl,{className:"h-5 w-5"}),"Automated Deployment"]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Deploy your app to Fly.io with one click. The deployment typically takes 5-10 minutes."})]})}),n?a.jsxs(Ai,{className:"border-green-200 bg-green-50",children:[a.jsx(Jn,{className:"h-4 w-4 text-green-600"}),a.jsx(Oi,{className:"text-green-800",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"font-medium",children:"Your app is live!"}),a.jsxs("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-primary hover:underline font-mono text-sm",children:[n,a.jsx(So,{className:"h-3 w-3"})]})]})})]}):l?a.jsxs(Ai,{className:"border-green-200 bg-green-50",children:[a.jsx(Jn,{className:"h-4 w-4 text-green-600"}),a.jsx(Oi,{className:"text-green-800",children:"Deployment successful! Your app will be live shortly."})]}):o?a.jsxs(Ai,{className:"border-red-200 bg-red-50",children:[a.jsx(Kn,{className:"h-4 w-4 text-red-600"}),a.jsx(Oi,{className:"text-red-800",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"font-medium",children:"Deployment failed"}),a.jsx("p",{className:"text-sm",children:o})]})})]}):c?a.jsxs(Ai,{className:"border-blue-200 bg-blue-50",children:[a.jsx(at,{className:"h-4 w-4 text-blue-600 animate-spin"}),a.jsx(Oi,{className:"text-blue-800",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"font-medium",children:"Deploying your app..."}),a.jsx("p",{className:"text-sm",children:"This may take 5-10 minutes. Please keep this window open."})]})})]}):null,!n&&a.jsx(le,{onClick:i,disabled:c,size:"lg",className:"w-full gap-2",children:c?a.jsxs(a.Fragment,{children:[a.jsx(at,{className:"h-5 w-5 animate-spin"}),"Deploying..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Wl,{className:"h-5 w-5"}),"Deploy to Fly.io Now"]})})]})}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ga,{className:"h-5 w-5"}),a.jsx("h3",{className:"text-lg font-semibold",children:"GitHub Repository"}),a.jsxs(qs,{variant:"outline",className:"ml-auto",children:["Generation #",s]})]}),a.jsx("div",{className:"p-4 rounded-lg bg-muted border",children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Repository URL"}),a.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline font-mono text-sm truncate block",children:r})]}),a.jsx(le,{variant:"outline",size:"sm",onClick:()=>window.open(r,"_blank"),children:"Open in GitHub"})]})}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Your generated app has been pushed to GitHub with a pre-configured fly.toml file."})]})]})]})})]}):null}function WR(){const{id:t}=Hy(),[,e]=Lr(),r=Jc(),s=parseInt(t||"0",10),[n,i]=R.useState(!1),[c,o]=R.useState(null),[l,d]=R.useState(new Set),g=D=>{d(H=>{const z=new Set(H);return z.has(D)?z.delete(D):z.add(D),z})},{data:m,isLoading:v,error:y}=Qc({queryKey:["app-generations",s],queryFn:async()=>{const D=rn(),H=await fetch(`/api/apps/${s}/generations`,{credentials:"include",headers:D?{Authorization:`Bearer ${D}`}:{}});if(!H.ok)throw new Error("Failed to fetch app generations");return H.json()},enabled:s>0}),[w,_]=R.useState(null),p=oh({mutationFn:async D=>{const H=rn(),z=await fetch(`/api/generations/${D}/mark-failed`,{method:"POST",headers:{"Content-Type":"application/json",...H?{Authorization:`Bearer ${H}`}:{}},credentials:"include",body:JSON.stringify({reason:"Marked as failed by user (orphaned generation)"})});if(!z.ok){const B=await z.json();throw new Error(B.error||"Failed to mark as failed")}return z.json()},onSuccess:()=>{r.invalidateQueries({queryKey:["app-generations",s]}),r.invalidateQueries({queryKey:["apps"]}),_(null)},onError:()=>{_(null)}}),[h,u]=R.useState(null),f=oh({mutationFn:async D=>{const H=rn(),z=await fetch(`/api/generations/${D}/cancel`,{method:"POST",headers:{"Content-Type":"application/json",...H?{Authorization:`Bearer ${H}`}:{}},credentials:"include",body:JSON.stringify({})});if(!z.ok){const B=await z.json();throw new Error(B.error||"Failed to cancel generation")}return z.json()},onSuccess:()=>{r.invalidateQueries({queryKey:["app-generations",s]}),r.invalidateQueries({queryKey:["apps"]}),u(null)},onError:()=>{u(null)}}),x=D=>{window.confirm(`Mark this generation as failed?

This will clear the stuck "Generating" status.`)&&(_(D.id),p.mutate(D.id))},k=D=>{window.confirm("Are you sure you want to cancel this generation?")&&(u(D.id),f.mutate(D.id))},C=D=>{o(D),i(!0)},S=D=>{if(!D)return"N/A";const H=Math.round(D);if(H<60)return`${H}s`;if(H<3600){const j=Math.floor(H/60),T=H%60;return T>0?`${j}m ${T}s`:`${j}m`}if(H<86400){const j=Math.floor(H/3600),T=Math.floor(H%3600/60);return T>0?`${j}h ${T}m`:`${j}h`}const z=Math.floor(H/86400),B=Math.floor(H%86400/3600);return B>0?`${z}d ${B}h`:`${z}d`},b=D=>{if(D==null)return"N/A";const H=typeof D=="number"?D:parseFloat(D);return isNaN(H)?"N/A":`$${(Math.round(H*100)/100).toFixed(2)}`},E=D=>(Math.round(D*100)/100).toFixed(2),N=D=>{const H=new Date(D),B=new Date().getTime()-H.getTime(),j=Math.floor(B/6e4),T=Math.floor(B/36e5),L=Math.floor(B/864e5);return j<1?"just now":j<60?`${j}m ago`:T<24?`${T}h ago`:L<7?`${L}d ago`:H.toLocaleDateString("en-US",{month:"short",day:"numeric"})},O=D=>{switch(D){case"queued":return a.jsx(Qn,{className:"h-4 w-4 text-yellow-400"});case"generating":return a.jsx(at,{className:"h-4 w-4 text-purple-400 animate-spin"});case"completed":return a.jsx(Jn,{className:"h-4 w-4 text-emerald-400"});case"failed":return a.jsx(ti,{className:"h-4 w-4 text-red-400"});case"paused":return a.jsx(S0,{className:"h-4 w-4 text-cyan-400"})}},I=D=>{const H={queued:"bg-yellow-500/10 text-yellow-400 border-yellow-500/30",generating:"bg-purple-500/10 text-purple-400 border-purple-500/30",completed:"bg-emerald-500/10 text-emerald-400 border-emerald-500/30",failed:"bg-red-500/10 text-red-400 border-red-500/30",paused:"bg-cyan-500/10 text-cyan-400 border-cyan-500/30",cancelled:"bg-gray-500/10 text-gray-400 border-gray-500/30"};return a.jsx(qs,{className:`${H[D]} font-medium border text-xs`,children:D.toUpperCase()})},P=m==null?void 0:m[0],U=m==null?void 0:m[0];return a.jsxs(lt,{children:[a.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[a.jsx(Re,{href:"/apps",children:a.jsxs(le,{variant:"ghost",className:"text-leo-text-secondary hover:text-leo-text hover:bg-white/5 -ml-2 mb-6",children:[a.jsx(BE,{className:"h-4 w-4 mr-2"}),"Back to Apps"]})}),v&&a.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(tr,{className:"h-10 w-64 bg-white/5"}),a.jsx(tr,{className:"h-10 w-32 bg-white/5"})]}),a.jsx("div",{className:"space-y-4",children:[1,2,3].map(D=>a.jsx(tr,{className:"h-32 w-full bg-white/5 rounded-2xl"},D))})]}),!v&&y&&a.jsx("div",{className:"leo-card p-8 border-red-500/30 animate-fade-in-up",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-500/10 flex items-center justify-center flex-shrink-0",children:a.jsx(Kn,{className:"h-6 w-6 text-red-400"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"font-semibold text-leo-text text-lg",children:"Unable to load app"}),a.jsx("p",{className:"text-leo-text-secondary",children:y instanceof Error?y.message:"Please try refreshing the page"}),a.jsx(le,{variant:"ghost",size:"sm",onClick:()=>e("/apps"),className:"mt-4 text-purple-400 hover:text-purple-300 hover:bg-purple-500/10",children:"Back to Apps"})]})]})}),!v&&!y&&P&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4 mb-8 animate-fade-in-up",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h1",{className:"text-4xl font-bold tracking-tight leo-gradient-text",children:P.appName}),a.jsxs("p",{className:"text-lg text-leo-text-secondary",children:[(m==null?void 0:m.length)||0," version",(m==null?void 0:m.length)!==1?"s":""]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[P.githubUrl&&a.jsxs("a",{href:P.githubUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-2.5 rounded-xl bg-white/5 border border-white/10 text-leo-text-secondary hover:bg-white/10 hover:text-leo-text transition-all",children:[a.jsx(Ga,{className:"h-4 w-4"}),a.jsx("span",{children:"GitHub"})]}),P.deploymentUrl?a.jsx("a",{href:P.deploymentUrl,target:"_blank",rel:"noopener noreferrer",children:a.jsxs(le,{className:"bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 text-white shadow-glow-emerald rounded-xl px-5 py-2.5",children:[a.jsx(So,{className:"h-4 w-4 mr-2"}),"View Live"]})}):P.githubUrl&&(U==null?void 0:U.status)==="completed"?a.jsxs(le,{onClick:()=>C(U),className:"leo-btn-primary rounded-xl px-5 py-2.5",children:[a.jsx(a2,{className:"h-4 w-4 mr-2"}),"Deploy"]}):null]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-leo-text mb-4",children:"Version History"}),m==null?void 0:m.map((D,H)=>{var z,B;return a.jsx("div",{className:"leo-card group animate-fade-in-up",style:{animationDelay:`${H*.05}s`},children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-xl bg-gradient-to-br from-purple-500/20 to-cyan-500/10 flex items-center justify-center group-hover:shadow-glow-sm transition-shadow",children:a.jsxs("span",{className:"text-lg font-bold text-purple-400",children:["v",m.length-H]})}),a.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[O(D.status),a.jsxs("p",{className:"text-leo-text font-medium truncate",title:D.prompt,children:['"',D.prompt.length>80?`${D.prompt.substring(0,80)}...`:D.prompt,'"']})]}),a.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[I(D.status),a.jsx("span",{className:"text-sm text-leo-text-tertiary",children:N(D.createdAt)})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-leo-text-tertiary",children:[D.currentIteration>0&&a.jsxs("div",{className:"flex items-center gap-1.5",title:"Iterations",children:[a.jsx(l2,{className:"h-3.5 w-3.5"}),a.jsxs("span",{children:[D.currentIteration," iterations"]})]}),D.totalDuration&&a.jsxs("div",{className:"flex items-center gap-1.5",title:"Duration",children:[a.jsx(u2,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:S(D.totalDuration/1e3)})]}),(D.iterationData||D.totalCost)&&a.jsxs("div",{className:"flex items-center gap-1.5",title:"Cost",children:[a.jsx(Xf,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:b(D.iterationData&&Array.isArray(D.iterationData)&&D.iterationData.length>0?((z=D.iterationData[D.iterationData.length-1])==null?void 0:z.cost)??0:parseFloat(D.totalCost||"0"))})]}),D.githubCommit&&(D.githubUrl?a.jsxs("a",{href:`${D.githubUrl}/commit/${D.githubCommit}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 hover:text-leo-primary transition-colors",title:`View commit ${D.githubCommit}`,children:[a.jsx(kg,{className:"h-3.5 w-3.5"}),a.jsx("span",{className:"underline underline-offset-2",children:D.githubCommit.substring(0,8)})]}):a.jsxs("div",{className:"flex items-center gap-1.5",title:"Commit",children:[a.jsx(kg,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:D.githubCommit.substring(0,8)})]}))]}),D.warnings&&D.warnings.length>0&&a.jsx("div",{className:"space-y-2 mt-2",children:D.warnings.map((j,T)=>{var L;return a.jsxs("div",{className:"p-2 rounded-md bg-yellow-500/10 border border-yellow-500/20 flex items-start gap-2",children:[a.jsx(lo,{className:"h-4 w-4 text-yellow-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-xs text-yellow-400",children:j.message}),((L=j.details)==null?void 0:L.remediation_url)&&a.jsx("a",{href:j.details.remediation_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-yellow-500 hover:text-yellow-400 underline underline-offset-2 mt-1 inline-block",children:"Learn how to fix "})]})]},T)})}),D.iterationData&&Array.isArray(D.iterationData)&&D.iterationData.length>0&&a.jsxs("div",{className:"mt-3",children:[a.jsxs("button",{onClick:j=>{j.preventDefault(),j.stopPropagation(),g(D.id)},className:"flex items-center gap-2 text-xs text-leo-text-secondary hover:text-leo-text transition-colors",children:[l.has(D.id)?a.jsx(WE,{className:"h-3.5 w-3.5"}):a.jsx(zE,{className:"h-3.5 w-3.5"}),a.jsxs("span",{children:["Cost Breakdown (",D.iterationData.length," iterations)"]})]}),l.has(D.id)&&a.jsx("div",{className:"mt-2 p-3 rounded-lg bg-purple-500/5 border border-purple-500/20",children:a.jsxs("table",{className:"w-full text-xs",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-leo-text-secondary border-b border-purple-500/20",children:[a.jsx("th",{className:"text-left py-1.5 font-medium",children:"Iteration"}),a.jsx("th",{className:"text-right py-1.5 font-medium",children:"Cost"}),a.jsx("th",{className:"text-right py-1.5 font-medium",children:"Duration"})]})}),a.jsx("tbody",{children:D.iterationData.map((j,T,L)=>{const $=T===0?j.cost:j.cost-L[T-1].cost;return a.jsxs("tr",{className:"border-b border-purple-500/10 last:border-0",children:[a.jsx("td",{className:"py-1.5 text-leo-text",children:j.iteration}),a.jsxs("td",{className:"py-1.5 text-right text-cyan-400",children:["$",E($)]}),a.jsx("td",{className:"py-1.5 text-right text-leo-text-secondary",children:S(j.duration/1e3)})]},T)})}),a.jsx("tfoot",{children:a.jsxs("tr",{className:"border-t border-purple-500/30 font-medium",children:[a.jsx("td",{className:"py-2 text-leo-text",children:"Total"}),a.jsxs("td",{className:"py-2 text-right text-cyan-400",children:["$",E(((B=D.iterationData[D.iterationData.length-1])==null?void 0:B.cost)??0)]}),a.jsx("td",{className:"py-2 text-right text-leo-text-secondary",children:S(D.iterationData.reduce((j,T)=>j+T.duration,0)/1e3)})]})})]})})]}),D.status==="failed"&&D.errorMessage&&a.jsx("div",{className:"p-2 rounded-md bg-red-500/10 border border-red-500/20 mt-2",children:a.jsx("p",{className:"text-xs text-red-400 line-clamp-2",children:D.errorMessage})}),a.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[D.status==="completed"&&a.jsx(Re,{href:`/console/${D.appRefId}`,children:a.jsxs(le,{variant:"outline",size:"sm",className:"bg-leo-bg-tertiary border-leo-border text-leo-primary hover:bg-leo-bg-hover hover:border-leo-primary",children:[a.jsx(Sc,{className:"h-3.5 w-3.5 mr-1.5"}),"Resume"]})}),(D.status==="queued"||D.status==="generating"||D.status==="paused")&&a.jsxs(a.Fragment,{children:[a.jsx(Re,{href:`/console/${D.id}`,children:a.jsx(le,{variant:"outline",size:"sm",className:"bg-leo-bg-tertiary border-leo-border text-leo-primary hover:bg-leo-bg-hover hover:border-leo-primary",children:"View Live Logs"})}),(D.status==="generating"||D.status==="paused")&&a.jsxs(a.Fragment,{children:[a.jsx(le,{onClick:()=>k(D),disabled:h===D.id,size:"sm",variant:"outline",className:"bg-red-500/10 border-red-500/30 text-red-500 hover:bg-red-500/20",title:"Cancel",children:h===D.id?a.jsx(at,{className:"h-3.5 w-3.5 animate-spin"}):a.jsx(c2,{className:"h-3.5 w-3.5"})}),a.jsx(le,{onClick:()=>x(D),disabled:w===D.id,size:"sm",variant:"outline",className:"bg-yellow-500/10 border-yellow-500/30 text-yellow-500 hover:bg-yellow-500/20",title:"Mark as failed",children:w===D.id?a.jsx(at,{className:"h-3.5 w-3.5 animate-spin"}):a.jsx(lo,{className:"h-3.5 w-3.5"})})]})]}),D.status==="failed"&&D.githubUrl&&a.jsx(Re,{href:`/console/${D.appRefId}`,children:a.jsxs(le,{variant:"outline",size:"sm",className:"bg-leo-bg-tertiary border-leo-border text-leo-primary hover:bg-leo-bg-hover hover:border-leo-primary",children:[a.jsx(Sc,{className:"h-3.5 w-3.5 mr-1.5"}),"Retry"]})})]})]})]})},D.id)})]})]})]}),c&&c.githubUrl&&a.jsx(zR,{isOpen:n,onClose:()=>i(!1),githubUrl:c.githubUrl,generationId:c.id,deploymentUrl:c.deploymentUrl,onDeploy:()=>{},isDeploying:!1,deployError:void 0,deploySuccess:!1})]})}const qg="wsi_messages";class qR{constructor(){Zr(this,"ws",null);Zr(this,"listeners",new Map);Zr(this,"reconnectAttempts",0);Zr(this,"maxReconnectAttempts",5);Zr(this,"reconnectDelay",1e3);Zr(this,"isConnecting",!1);Zr(this,"url");Zr(this,"_messages",[]);const e=window.location.protocol==="https:"?"wss:":"ws:",r=window.location.host;this.url=`${e}//${r}/wsi`,this.loadMessages()}get messages(){return this._messages}clearMessages(){this._messages=[],this.saveMessages()}storeMessage(e){this._messages.push(e),this.saveMessages()}loadMessages(){try{const e=sessionStorage.getItem(qg);e&&(this._messages=JSON.parse(e))}catch(e){console.warn("[WSI] Failed to load messages from sessionStorage:",e)}}saveMessages(){try{sessionStorage.setItem(qg,JSON.stringify(this._messages))}catch(e){console.warn("[WSI] Failed to save messages to sessionStorage:",e)}}connect(){if(!this.isConnecting){if(this.ws){const e=this.ws.readyState;if(e===WebSocket.OPEN||e===WebSocket.CONNECTING)return}this.isConnecting=!0,console.log(`[WSI] Connecting to ${this.url}`);try{this.ws=new WebSocket(this.url),this.ws.onopen=()=>{this.isConnecting=!1,this.reconnectAttempts=0,console.log("[WSI] Connected"),this.send({type:"browser_connect"}),this.emit("connected",{type:"connected"})},this.ws.onmessage=e=>{try{const r=JSON.parse(e.data);console.log("[WSI] Received:",r.type,r),r.type!=="connection_status"&&r.type!=="connected"&&r.type!=="disconnected"&&this.storeMessage(r),this.emit(r.type,r),this.emit("message",r)}catch{console.error("[WSI] Failed to parse message:",e.data)}},this.ws.onerror=e=>{this.isConnecting=!1,console.error("[WSI] Error:",e),this.emit("error",{type:"error",message:"WebSocket error"})},this.ws.onclose=e=>{if(this.isConnecting=!1,console.log(`[WSI] Disconnected (code: ${e.code}, reason: ${e.reason})`),this.emit("disconnected",{type:"disconnected"}),e.code>=4001&&e.code<=4003){console.log(`[WSI] Auth failure (code: ${e.code}) - not reconnecting`),this.emit("error",{type:"error",message:"Authentication failed. Please log in again.",error_code:"AUTH_FAILED",fatal:!0});return}if(e.code>=4001&&e.code<=4099){console.log(`[WSI] Server closed connection with code ${e.code} - not reconnecting`);return}this.attemptReconnect()}}catch(e){this.isConnecting=!1,console.error("[WSI] Connection failed:",e)}}}disconnect(){this.reconnectAttempts=this.maxReconnectAttempts,this.ws&&(this.ws.close(),this.ws=null)}get isConnected(){var e;return((e=this.ws)==null?void 0:e.readyState)===WebSocket.OPEN}startGeneration(e){this.clearMessages(),this.send({type:"start_generation",request_id:e.requestId,prompt:e.prompt,mode:e.mode,app_name:e.appName,max_iterations:e.maxIterations,app_path:e.appPath,resume_session_id:e.resumeSessionId,enable_subagents:e.enableSubagents??!0,output_dir:e.outputDir,user_id:e.userId,app_id:e.appId,github_url:e.githubUrl,attachments:e.attachments})}sendDecisionResponse(e,r,s,n){this.send({type:"decision_response",id:e,choice:r,request_id:s,...n&&{input:n}})}sendCredentialResponse(e,r,s,n){this.send({type:"credential_response",id:e,credentials:r,cancelled:s,request_id:n})}sendControlCommand(e,r){this.send({type:"control_command",command:e,reason:r})}requestStop(e,r){this.send({type:"stop_request",request_id:e,reason:r||"User cancelled generation"})}on(e,r){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(r),()=>{var s;(s=this.listeners.get(e))==null||s.delete(r)}}send(e){var r;((r=this.ws)==null?void 0:r.readyState)===WebSocket.OPEN?(console.log("[WSI] Sending:",e.type,e),this.ws.send(JSON.stringify(e))):console.warn("[WSI] Cannot send - not connected")}emit(e,r){var s;(s=this.listeners.get(e))==null||s.forEach(n=>{try{n(r)}catch(i){console.error(`[WSI] Error in ${e} handler:`,i)}})}attemptReconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.error("[WSI] Max reconnection attempts reached");return}this.reconnectAttempts++;const e=this.reconnectDelay*Math.pow(2,this.reconnectAttempts-1);console.log(`[WSI] Reconnecting in ${e}ms (attempt ${this.reconnectAttempts})`),setTimeout(()=>{this.connect()},e)}}globalThis.__wsiClient||(globalThis.__wsiClient=new qR);const Le=globalThis.__wsiClient,jl={containerConnected:!1,isGenerating:!1,isCancelling:!1,currentPrompt:null,currentCredentialRequest:null,progress:null,lastError:null,completionInfo:null};function GR(t){const[e,r]=R.useState(Le.isConnected),[s,n]=R.useState(null),[i,c]=R.useState(new Map),[o,l]=R.useState(new Map),[d,g]=R.useState(new Map),[m,v]=R.useState(new Map),[y,w]=R.useState(new Map),_=R.useCallback(z=>y.get(z)||jl,[y]),p=R.useCallback((z,B)=>{w(j=>{const T=new Map(j),L=j.get(z)||jl;return T.set(z,{...L,...B}),T})},[]),h=R.useCallback((z,B)=>{c(j=>{const T=new Map(j),L=j.get(z)||[];return T.set(z,[...L,B]),T})},[]),u=R.useCallback((z,B)=>{l(j=>{const T=new Map(j),L=j.get(z)||[];return T.set(z,[...L,B]),T})},[]),f=R.useCallback((z,B)=>{g(j=>{const T=new Map(j),L=j.get(z)||[];return T.set(z,[...L,B]),T})},[]),x=R.useCallback((z,B)=>{v(j=>{const T=new Map(j),L=j.get(z)||[];return T.set(z,[...L,B]),T})},[]);R.useEffect(()=>{Le.connect();const z=Le.on("connected",()=>{r(!0)}),B=Le.on("disconnected",()=>{r(!1),w(G=>{const X=new Map(G);for(const[pt,Jr]of G)X.set(pt,{...Jr,containerConnected:!1});return X})}),j=Le.on("connection_status",G=>{const X=G.request_id;X!==void 0&&p(X,{containerConnected:G.container_connected})}),T=Le.on("ready",G=>{const X=G.request_id;X!==void 0&&(_(X).completionInfo?p(X,{containerConnected:!0}):p(X,{containerConnected:!0,isGenerating:!0,progress:{type:"progress",stage:"Generating",iteration:1,total_iterations:10}}),h(X,G))}),L=Le.on("log",G=>{const X=G.request_id;X!==void 0&&h(X,G)}),$=Le.on("progress",G=>{const X=G.request_id;X!==void 0&&(p(X,{progress:G}),h(X,G))}),V=Le.on("decision_prompt",G=>{const X=G.request_id;X!==void 0&&(p(X,{currentPrompt:G}),h(X,G))}),J=Le.on("credential_request",G=>{const X=G.request_id;X!==void 0&&(p(X,{currentCredentialRequest:G}),h(X,G))}),ue=Le.on("credential_timeout_warning",G=>{const X=G.request_id;X!==void 0&&h(X,G)}),he=Le.on("error",G=>{const X=G.request_id;if(G.error_code==="AUTH_FAILED"){n(G.message);return}if(X!==void 0){const pt=_(X);p(X,{lastError:G,isGenerating:G.fatal?!1:pt.isGenerating}),h(X,G)}}),F=Le.on("all_work_complete",G=>{const X=G.request_id;X!==void 0&&(p(X,{isGenerating:!1,isCancelling:!1,progress:null,completionInfo:G,currentPrompt:null}),h(X,G))}),A=Le.on("iteration_complete",G=>{const X=G.request_id;X!==void 0&&h(X,G)}),K=Le.on("conversation_log",G=>{const X=G.request_id;X!==void 0&&u(X,G)}),q=Le.on("screenshot",G=>{const X=G.request_id;X!==void 0&&f(X,G)}),ee=Le.on("friendly_log",G=>{const X=G.request_id;X!==void 0&&x(X,G)}),te=Le.on("shutdown_initiated",G=>{const X=G.request_id;X!==void 0&&(p(X,{isCancelling:!0}),h(X,{type:"log",line:` ${G.message}`,level:"info",request_id:X}))}),Se=Le.on("shutdown_ready",G=>{const X=G.request_id;if(X!==void 0){p(X,{isGenerating:!1,isCancelling:!1,progress:null,currentPrompt:null});const pt=G.pushed?` ${G.message} (commit: ${G.commit_hash}, pushed to GitHub)`:` ${G.message}${G.commit_hash?` (commit: ${G.commit_hash})`:""}`;h(X,{type:"log",line:pt,level:"info",request_id:X})}}),Ie=Le.on("shutdown_failed",G=>{const X=G.request_id;X!==void 0&&h(X,{type:"log",line:` Save failed: ${G.reason}`,level:"warn",request_id:X})}),Ee=Le.on("shutdown_timeout",G=>{const X=G.request_id;X!==void 0&&(p(X,{isGenerating:!1,isCancelling:!1,progress:null,currentPrompt:null}),h(X,{type:"log",line:` ${G.message}`,level:"warn",request_id:X}))}),ct=Le.on("generation_stopped",G=>{const X=G.request_id;X!==void 0&&(p(X,{isGenerating:!1,isCancelling:!1,progress:null,currentPrompt:null}),h(X,{type:"log",line:` ${G.message}`,level:"info",request_id:X}))});return()=>{z(),B(),j(),T(),L(),$(),V(),J(),ue(),he(),F(),A(),K(),q(),ee(),te(),Se(),Ie(),Ee(),ct()}},[p,_,h,u,f,x]);const k=R.useCallback(z=>{const B=z.requestId;p(B,{isGenerating:!0,currentPrompt:null,progress:null,lastError:null,completionInfo:null}),c(j=>{const T=new Map(j);return T.set(B,[]),T}),l(j=>{const T=new Map(j);return T.set(B,[]),T}),g(j=>{const T=new Map(j);return T.set(B,[]),T}),v(j=>{const T=new Map(j);return T.set(B,[]),T}),Le.startGeneration(z)},[p]),C=R.useCallback((z,B)=>{t!=null?(p(t,{currentPrompt:null}),Le.sendDecisionResponse(z,B,t)):Le.sendDecisionResponse(z,B)},[t,p]),S=R.useCallback((z,B,j)=>{t!=null&&(p(t,{currentCredentialRequest:null}),Le.sendCredentialResponse(z,B,j,t))},[t,p]),b=R.useCallback(z=>{Le.sendControlCommand(z)},[]),E=R.useCallback(()=>{t!=null&&Le.requestStop(t)},[t]),N=R.useCallback(()=>{t!=null&&(c(z=>{const B=new Map(z);return B.set(t,[]),B}),l(z=>{const B=new Map(z);return B.set(t,[]),B}),g(z=>{const B=new Map(z);return B.set(t,[]),B}),v(z=>{const B=new Map(z);return B.set(t,[]),B}))},[t]),O=R.useMemo(()=>t==null?[]:i.get(t)||[],[t,i]),I=R.useMemo(()=>t==null?[]:o.get(t)||[],[t,o]),P=R.useMemo(()=>t==null?[]:d.get(t)||[],[t,d]),U=R.useMemo(()=>t==null?[]:m.get(t)||[],[t,m]),D=R.useMemo(()=>t==null?jl:y.get(t)||jl,[t,y]),H=R.useCallback(()=>{n(null)},[]);return{isConnected:e,containerConnected:D.containerConnected,isGenerating:D.isGenerating,isCancelling:D.isCancelling,currentPrompt:D.currentPrompt,currentCredentialRequest:D.currentCredentialRequest,progress:D.progress,lastError:D.lastError,completionInfo:D.completionInfo,messages:O,conversationLogs:I,screenshots:P,friendlyLogs:U,globalAuthError:s,clearGlobalAuthError:H,startGeneration:k,sendResponse:C,sendCredentialResponse:S,sendControl:b,requestStop:E,clearMessages:N}}var Ae;(function(t){t.assertEqual=n=>{};function e(n){}t.assertIs=e;function r(n){throw new Error}t.assertNever=r,t.arrayToEnum=n=>{const i={};for(const c of n)i[c]=c;return i},t.getValidEnumValues=n=>{const i=t.objectKeys(n).filter(o=>typeof n[n[o]]!="number"),c={};for(const o of i)c[o]=n[o];return t.objectValues(c)},t.objectValues=n=>t.objectKeys(n).map(function(i){return n[i]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const i=[];for(const c in n)Object.prototype.hasOwnProperty.call(n,c)&&i.push(c);return i},t.find=(n,i)=>{for(const c of n)if(i(c))return c},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&Number.isFinite(n)&&Math.floor(n)===n;function s(n,i=" | "){return n.map(c=>typeof c=="string"?`'${c}'`:c).join(i)}t.joinValues=s,t.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(Ae||(Ae={}));var Gg;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(Gg||(Gg={}));const ce=Ae.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ts=t=>{switch(typeof t){case"undefined":return ce.undefined;case"string":return ce.string;case"number":return Number.isNaN(t)?ce.nan:ce.number;case"boolean":return ce.boolean;case"function":return ce.function;case"bigint":return ce.bigint;case"symbol":return ce.symbol;case"object":return Array.isArray(t)?ce.array:t===null?ce.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ce.promise:typeof Map<"u"&&t instanceof Map?ce.map:typeof Set<"u"&&t instanceof Set?ce.set:typeof Date<"u"&&t instanceof Date?ce.date:ce.object;default:return ce.unknown}},Z=Ae.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class gs extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(i){return i.message},s={_errors:[]},n=i=>{for(const c of i.issues)if(c.code==="invalid_union")c.unionErrors.map(n);else if(c.code==="invalid_return_type")n(c.returnTypeError);else if(c.code==="invalid_arguments")n(c.argumentsError);else if(c.path.length===0)s._errors.push(r(c));else{let o=s,l=0;for(;l<c.path.length;){const d=c.path[l];l===c.path.length-1?(o[d]=o[d]||{_errors:[]},o[d]._errors.push(r(c))):o[d]=o[d]||{_errors:[]},o=o[d],l++}}};return n(this),s}static assert(e){if(!(e instanceof gs))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ae.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},s=[];for(const n of this.issues)if(n.path.length>0){const i=n.path[0];r[i]=r[i]||[],r[i].push(e(n))}else s.push(e(n));return{formErrors:s,fieldErrors:r}}get formErrors(){return this.flatten()}}gs.create=t=>new gs(t);const Eh=(t,e)=>{let r;switch(t.code){case Z.invalid_type:t.received===ce.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case Z.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,Ae.jsonStringifyReplacer)}`;break;case Z.unrecognized_keys:r=`Unrecognized key(s) in object: ${Ae.joinValues(t.keys,", ")}`;break;case Z.invalid_union:r="Invalid input";break;case Z.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Ae.joinValues(t.options)}`;break;case Z.invalid_enum_value:r=`Invalid enum value. Expected ${Ae.joinValues(t.options)}, received '${t.received}'`;break;case Z.invalid_arguments:r="Invalid function arguments";break;case Z.invalid_return_type:r="Invalid function return type";break;case Z.invalid_date:r="Invalid date";break;case Z.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:Ae.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case Z.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case Z.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case Z.custom:r="Invalid input";break;case Z.invalid_intersection_types:r="Intersection results could not be merged";break;case Z.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case Z.not_finite:r="Number must be finite";break;default:r=e.defaultError,Ae.assertNever(t)}return{message:r}};let VR=Eh;function KR(){return VR}const JR=t=>{const{data:e,path:r,errorMaps:s,issueData:n}=t,i=[...r,...n.path||[]],c={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let o="";const l=s.filter(d=>!!d).slice().reverse();for(const d of l)o=d(c,{data:e,defaultError:o}).message;return{...n,path:i,message:o}};function se(t,e){const r=KR(),s=JR({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===Eh?void 0:Eh].filter(n=>!!n)});t.common.issues.push(s)}class or{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const s=[];for(const n of r){if(n.status==="aborted")return ye;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,r){const s=[];for(const n of r){const i=await n.key,c=await n.value;s.push({key:i,value:c})}return or.mergeObjectSync(e,s)}static mergeObjectSync(e,r){const s={};for(const n of r){const{key:i,value:c}=n;if(i.status==="aborted"||c.status==="aborted")return ye;i.status==="dirty"&&e.dirty(),c.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof c.value<"u"||n.alwaysSet)&&(s[i.value]=c.value)}return{status:e.value,value:s}}}const ye=Object.freeze({status:"aborted"}),qo=t=>({status:"dirty",value:t}),yr=t=>({status:"valid",value:t}),Vg=t=>t.status==="aborted",Kg=t=>t.status==="dirty",fo=t=>t.status==="valid",Rc=t=>typeof Promise<"u"&&t instanceof Promise;var fe;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(fe||(fe={}));class an{constructor(e,r,s,n){this._cachedPath=[],this.parent=e,this.data=r,this._path=s,this._key=n}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Jg=(t,e)=>{if(fo(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new gs(t.common.issues);return this._error=r,this._error}}};function Ce(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:s,description:n}=t;if(e&&(r||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(c,o)=>{const{message:l}=t;return c.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??s??o.defaultError}:c.code!=="invalid_type"?{message:o.defaultError}:{message:l??r??o.defaultError}},description:n}}class Te{get description(){return this._def.description}_getType(e){return Ts(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ts(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new or,ctx:{common:e.parent.common,data:e.data,parsedType:Ts(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(Rc(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const s=this.safeParse(e,r);if(s.success)return s.data;throw s.error}safeParse(e,r){const s={common:{issues:[],async:(r==null?void 0:r.async)??!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ts(e)},n=this._parseSync({data:e,path:s.path,parent:s});return Jg(s,n)}"~validate"(e){var s,n;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ts(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:r});return fo(i)?{value:i.value}:{issues:r.common.issues}}catch(i){(n=(s=i==null?void 0:i.message)==null?void 0:s.toLowerCase())!=null&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(i=>fo(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(e,r){const s=await this.safeParseAsync(e,r);if(s.success)return s.data;throw s.error}async safeParseAsync(e,r){const s={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ts(e)},n=this._parse({data:e,path:s.path,parent:s}),i=await(Rc(n)?n:Promise.resolve(n));return Jg(s,i)}refine(e,r){const s=n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r;return this._refinement((n,i)=>{const c=e(n),o=()=>i.addIssue({code:Z.custom,...s(n)});return typeof Promise<"u"&&c instanceof Promise?c.then(l=>l?!0:(o(),!1)):c?!0:(o(),!1)})}refinement(e,r){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof r=="function"?r(s,n):r),!1))}_refinement(e){return new go({schema:this,typeName:xe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return sn.create(this,this._def)}nullable(){return vo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Vr.create(this)}promise(){return Oc.create(this,this._def)}or(e){return Tc.create([this,e],this._def)}and(e){return Ac.create(this,e,this._def)}transform(e){return new go({...Ce(this._def),schema:this,typeName:xe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new Ph({...Ce(this._def),innerType:this,defaultValue:r,typeName:xe.ZodDefault})}brand(){return new _N({typeName:xe.ZodBranded,type:this,...Ce(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new Lh({...Ce(this._def),innerType:this,catchValue:r,typeName:xe.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return fp.create(this,e)}readonly(){return Ih.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const QR=/^c[^\s-]{8,}$/i,ZR=/^[0-9a-z]+$/,YR=/^[0-9A-HJKMNP-TV-Z]{26}$/i,XR=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,eN=/^[a-z0-9_-]{21}$/i,tN=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,rN=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,sN=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,nN="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Ju;const iN=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,oN=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,aN=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,lN=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,cN=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,uN=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,yx="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dN=new RegExp(`^${yx}$`);function xx(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function hN(t){return new RegExp(`^${xx(t)}$`)}function fN(t){let e=`${yx}T${xx(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function pN(t,e){return!!((e==="v4"||!e)&&iN.test(t)||(e==="v6"||!e)&&aN.test(t))}function mN(t,e){if(!tN.test(t))return!1;try{const[r]=t.split(".");if(!r)return!1;const s=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(s));return!(typeof n!="object"||n===null||"typ"in n&&(n==null?void 0:n.typ)!=="JWT"||!n.alg||e&&n.alg!==e)}catch{return!1}}function gN(t,e){return!!((e==="v4"||!e)&&oN.test(t)||(e==="v6"||!e)&&lN.test(t))}class Gs extends Te{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ce.string){const i=this._getOrReturnCtx(e);return se(i,{code:Z.invalid_type,expected:ce.string,received:i.parsedType}),ye}const s=new or;let n;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(n=this._getOrReturnCtx(e,n),se(n,{code:Z.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="max")e.data.length>i.value&&(n=this._getOrReturnCtx(e,n),se(n,{code:Z.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="length"){const c=e.data.length>i.value,o=e.data.length<i.value;(c||o)&&(n=this._getOrReturnCtx(e,n),c?se(n,{code:Z.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&se(n,{code:Z.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),s.dirty())}else if(i.kind==="email")sN.test(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{validation:"email",code:Z.invalid_string,message:i.message}),s.dirty());else if(i.kind==="emoji")Ju||(Ju=new RegExp(nN,"u")),Ju.test(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{validation:"emoji",code:Z.invalid_string,message:i.message}),s.dirty());else if(i.kind==="uuid")XR.test(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{validation:"uuid",code:Z.invalid_string,message:i.message}),s.dirty());else if(i.kind==="nanoid")eN.test(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{validation:"nanoid",code:Z.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid")QR.test(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{validation:"cuid",code:Z.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid2")ZR.test(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{validation:"cuid2",code:Z.invalid_string,message:i.message}),s.dirty());else if(i.kind==="ulid")YR.test(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{validation:"ulid",code:Z.invalid_string,message:i.message}),s.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),se(n,{validation:"url",code:Z.invalid_string,message:i.message}),s.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{validation:"regex",code:Z.invalid_string,message:i.message}),s.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(e,n),se(n,{code:Z.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),s.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(n=this._getOrReturnCtx(e,n),se(n,{code:Z.invalid_string,validation:{startsWith:i.value},message:i.message}),s.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(n=this._getOrReturnCtx(e,n),se(n,{code:Z.invalid_string,validation:{endsWith:i.value},message:i.message}),s.dirty()):i.kind==="datetime"?fN(i).test(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{code:Z.invalid_string,validation:"datetime",message:i.message}),s.dirty()):i.kind==="date"?dN.test(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{code:Z.invalid_string,validation:"date",message:i.message}),s.dirty()):i.kind==="time"?hN(i).test(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{code:Z.invalid_string,validation:"time",message:i.message}),s.dirty()):i.kind==="duration"?rN.test(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{validation:"duration",code:Z.invalid_string,message:i.message}),s.dirty()):i.kind==="ip"?pN(e.data,i.version)||(n=this._getOrReturnCtx(e,n),se(n,{validation:"ip",code:Z.invalid_string,message:i.message}),s.dirty()):i.kind==="jwt"?mN(e.data,i.alg)||(n=this._getOrReturnCtx(e,n),se(n,{validation:"jwt",code:Z.invalid_string,message:i.message}),s.dirty()):i.kind==="cidr"?gN(e.data,i.version)||(n=this._getOrReturnCtx(e,n),se(n,{validation:"cidr",code:Z.invalid_string,message:i.message}),s.dirty()):i.kind==="base64"?cN.test(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{validation:"base64",code:Z.invalid_string,message:i.message}),s.dirty()):i.kind==="base64url"?uN.test(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{validation:"base64url",code:Z.invalid_string,message:i.message}),s.dirty()):Ae.assertNever(i);return{status:s.value,value:e.data}}_regex(e,r,s){return this.refinement(n=>e.test(n),{validation:r,code:Z.invalid_string,...fe.errToObj(s)})}_addCheck(e){return new Gs({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...fe.errToObj(e)})}url(e){return this._addCheck({kind:"url",...fe.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...fe.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...fe.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...fe.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...fe.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...fe.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...fe.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...fe.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...fe.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...fe.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...fe.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...fe.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...fe.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...fe.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...fe.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...fe.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r==null?void 0:r.position,...fe.errToObj(r==null?void 0:r.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...fe.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...fe.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...fe.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...fe.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...fe.errToObj(r)})}nonempty(e){return this.min(1,fe.errToObj(e))}trim(){return new Gs({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Gs({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Gs({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Gs.create=t=>new Gs({checks:[],typeName:xe.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...Ce(t)});function vN(t,e){const r=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=r>s?r:s,i=Number.parseInt(t.toFixed(n).replace(".","")),c=Number.parseInt(e.toFixed(n).replace(".",""));return i%c/10**n}class po extends Te{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ce.number){const i=this._getOrReturnCtx(e);return se(i,{code:Z.invalid_type,expected:ce.number,received:i.parsedType}),ye}let s;const n=new or;for(const i of this._def.checks)i.kind==="int"?Ae.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),se(s,{code:Z.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),se(s,{code:Z.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),se(s,{code:Z.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="multipleOf"?vN(e.data,i.value)!==0&&(s=this._getOrReturnCtx(e,s),se(s,{code:Z.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),se(s,{code:Z.not_finite,message:i.message}),n.dirty()):Ae.assertNever(i);return{status:n.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,fe.toString(r))}gt(e,r){return this.setLimit("min",e,!1,fe.toString(r))}lte(e,r){return this.setLimit("max",e,!0,fe.toString(r))}lt(e,r){return this.setLimit("max",e,!1,fe.toString(r))}setLimit(e,r,s,n){return new po({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:s,message:fe.toString(n)}]})}_addCheck(e){return new po({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:fe.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:fe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:fe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:fe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:fe.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:fe.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:fe.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:fe.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:fe.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ae.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(r===null||s.value>r)&&(r=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(r)&&Number.isFinite(e)}}po.create=t=>new po({checks:[],typeName:xe.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ce(t)});class Oa extends Te{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ce.bigint)return this._getInvalidInput(e);let s;const n=new or;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),se(s,{code:Z.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),se(s,{code:Z.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),se(s,{code:Z.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):Ae.assertNever(i);return{status:n.value,value:e.data}}_getInvalidInput(e){const r=this._getOrReturnCtx(e);return se(r,{code:Z.invalid_type,expected:ce.bigint,received:r.parsedType}),ye}gte(e,r){return this.setLimit("min",e,!0,fe.toString(r))}gt(e,r){return this.setLimit("min",e,!1,fe.toString(r))}lte(e,r){return this.setLimit("max",e,!0,fe.toString(r))}lt(e,r){return this.setLimit("max",e,!1,fe.toString(r))}setLimit(e,r,s,n){return new Oa({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:s,message:fe.toString(n)}]})}_addCheck(e){return new Oa({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:fe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:fe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:fe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:fe.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:fe.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Oa.create=t=>new Oa({checks:[],typeName:xe.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...Ce(t)});class jh extends Te{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ce.boolean){const s=this._getOrReturnCtx(e);return se(s,{code:Z.invalid_type,expected:ce.boolean,received:s.parsedType}),ye}return yr(e.data)}}jh.create=t=>new jh({typeName:xe.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ce(t)});class Nc extends Te{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ce.date){const i=this._getOrReturnCtx(e);return se(i,{code:Z.invalid_type,expected:ce.date,received:i.parsedType}),ye}if(Number.isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return se(i,{code:Z.invalid_date}),ye}const s=new or;let n;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(n=this._getOrReturnCtx(e,n),se(n,{code:Z.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),s.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(n=this._getOrReturnCtx(e,n),se(n,{code:Z.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),s.dirty()):Ae.assertNever(i);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Nc({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:fe.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:fe.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}Nc.create=t=>new Nc({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:xe.ZodDate,...Ce(t)});class Qg extends Te{_parse(e){if(this._getType(e)!==ce.symbol){const s=this._getOrReturnCtx(e);return se(s,{code:Z.invalid_type,expected:ce.symbol,received:s.parsedType}),ye}return yr(e.data)}}Qg.create=t=>new Qg({typeName:xe.ZodSymbol,...Ce(t)});class Zg extends Te{_parse(e){if(this._getType(e)!==ce.undefined){const s=this._getOrReturnCtx(e);return se(s,{code:Z.invalid_type,expected:ce.undefined,received:s.parsedType}),ye}return yr(e.data)}}Zg.create=t=>new Zg({typeName:xe.ZodUndefined,...Ce(t)});class Yg extends Te{_parse(e){if(this._getType(e)!==ce.null){const s=this._getOrReturnCtx(e);return se(s,{code:Z.invalid_type,expected:ce.null,received:s.parsedType}),ye}return yr(e.data)}}Yg.create=t=>new Yg({typeName:xe.ZodNull,...Ce(t)});class Rh extends Te{constructor(){super(...arguments),this._any=!0}_parse(e){return yr(e.data)}}Rh.create=t=>new Rh({typeName:xe.ZodAny,...Ce(t)});class Nh extends Te{constructor(){super(...arguments),this._unknown=!0}_parse(e){return yr(e.data)}}Nh.create=t=>new Nh({typeName:xe.ZodUnknown,...Ce(t)});class ln extends Te{_parse(e){const r=this._getOrReturnCtx(e);return se(r,{code:Z.invalid_type,expected:ce.never,received:r.parsedType}),ye}}ln.create=t=>new ln({typeName:xe.ZodNever,...Ce(t)});class Xg extends Te{_parse(e){if(this._getType(e)!==ce.undefined){const s=this._getOrReturnCtx(e);return se(s,{code:Z.invalid_type,expected:ce.void,received:s.parsedType}),ye}return yr(e.data)}}Xg.create=t=>new Xg({typeName:xe.ZodVoid,...Ce(t)});class Vr extends Te{_parse(e){const{ctx:r,status:s}=this._processInputParams(e),n=this._def;if(r.parsedType!==ce.array)return se(r,{code:Z.invalid_type,expected:ce.array,received:r.parsedType}),ye;if(n.exactLength!==null){const c=r.data.length>n.exactLength.value,o=r.data.length<n.exactLength.value;(c||o)&&(se(r,{code:c?Z.too_big:Z.too_small,minimum:o?n.exactLength.value:void 0,maximum:c?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&r.data.length<n.minLength.value&&(se(r,{code:Z.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&r.data.length>n.maxLength.value&&(se(r,{code:Z.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),r.common.async)return Promise.all([...r.data].map((c,o)=>n.type._parseAsync(new an(r,c,r.path,o)))).then(c=>or.mergeArray(s,c));const i=[...r.data].map((c,o)=>n.type._parseSync(new an(r,c,r.path,o)));return or.mergeArray(s,i)}get element(){return this._def.type}min(e,r){return new Vr({...this._def,minLength:{value:e,message:fe.toString(r)}})}max(e,r){return new Vr({...this._def,maxLength:{value:e,message:fe.toString(r)}})}length(e,r){return new Vr({...this._def,exactLength:{value:e,message:fe.toString(r)}})}nonempty(e){return this.min(1,e)}}Vr.create=(t,e)=>new Vr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:xe.ZodArray,...Ce(e)});function vi(t){if(t instanceof tt){const e={};for(const r in t.shape){const s=t.shape[r];e[r]=sn.create(vi(s))}return new tt({...t._def,shape:()=>e})}else return t instanceof Vr?new Vr({...t._def,type:vi(t.element)}):t instanceof sn?sn.create(vi(t.unwrap())):t instanceof vo?vo.create(vi(t.unwrap())):t instanceof Yn?Yn.create(t.items.map(e=>vi(e))):t}class tt extends Te{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=Ae.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==ce.object){const d=this._getOrReturnCtx(e);return se(d,{code:Z.invalid_type,expected:ce.object,received:d.parsedType}),ye}const{status:s,ctx:n}=this._processInputParams(e),{shape:i,keys:c}=this._getCached(),o=[];if(!(this._def.catchall instanceof ln&&this._def.unknownKeys==="strip"))for(const d in n.data)c.includes(d)||o.push(d);const l=[];for(const d of c){const g=i[d],m=n.data[d];l.push({key:{status:"valid",value:d},value:g._parse(new an(n,m,n.path,d)),alwaysSet:d in n.data})}if(this._def.catchall instanceof ln){const d=this._def.unknownKeys;if(d==="passthrough")for(const g of o)l.push({key:{status:"valid",value:g},value:{status:"valid",value:n.data[g]}});else if(d==="strict")o.length>0&&(se(n,{code:Z.unrecognized_keys,keys:o}),s.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const g of o){const m=n.data[g];l.push({key:{status:"valid",value:g},value:d._parse(new an(n,m,n.path,g)),alwaysSet:g in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const d=[];for(const g of l){const m=await g.key,v=await g.value;d.push({key:m,value:v,alwaysSet:g.alwaysSet})}return d}).then(d=>or.mergeObjectSync(s,d)):or.mergeObjectSync(s,l)}get shape(){return this._def.shape()}strict(e){return fe.errToObj,new tt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,s)=>{var i,c;const n=((c=(i=this._def).errorMap)==null?void 0:c.call(i,r,s).message)??s.defaultError;return r.code==="unrecognized_keys"?{message:fe.errToObj(e).message??n}:{message:n}}}:{}})}strip(){return new tt({...this._def,unknownKeys:"strip"})}passthrough(){return new tt({...this._def,unknownKeys:"passthrough"})}extend(e){return new tt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new tt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:xe.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new tt({...this._def,catchall:e})}pick(e){const r={};for(const s of Ae.objectKeys(e))e[s]&&this.shape[s]&&(r[s]=this.shape[s]);return new tt({...this._def,shape:()=>r})}omit(e){const r={};for(const s of Ae.objectKeys(this.shape))e[s]||(r[s]=this.shape[s]);return new tt({...this._def,shape:()=>r})}deepPartial(){return vi(this)}partial(e){const r={};for(const s of Ae.objectKeys(this.shape)){const n=this.shape[s];e&&!e[s]?r[s]=n:r[s]=n.optional()}return new tt({...this._def,shape:()=>r})}required(e){const r={};for(const s of Ae.objectKeys(this.shape))if(e&&!e[s])r[s]=this.shape[s];else{let i=this.shape[s];for(;i instanceof sn;)i=i._def.innerType;r[s]=i}return new tt({...this._def,shape:()=>r})}keyof(){return wx(Ae.objectKeys(this.shape))}}tt.create=(t,e)=>new tt({shape:()=>t,unknownKeys:"strip",catchall:ln.create(),typeName:xe.ZodObject,...Ce(e)});tt.strictCreate=(t,e)=>new tt({shape:()=>t,unknownKeys:"strict",catchall:ln.create(),typeName:xe.ZodObject,...Ce(e)});tt.lazycreate=(t,e)=>new tt({shape:t,unknownKeys:"strip",catchall:ln.create(),typeName:xe.ZodObject,...Ce(e)});class Tc extends Te{_parse(e){const{ctx:r}=this._processInputParams(e),s=this._def.options;function n(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const c=i.map(o=>new gs(o.ctx.common.issues));return se(r,{code:Z.invalid_union,unionErrors:c}),ye}if(r.common.async)return Promise.all(s.map(async i=>{const c={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:c}),ctx:c}})).then(n);{let i;const c=[];for(const l of s){const d={...r,common:{...r.common,issues:[]},parent:null},g=l._parseSync({data:r.data,path:r.path,parent:d});if(g.status==="valid")return g;g.status==="dirty"&&!i&&(i={result:g,ctx:d}),d.common.issues.length&&c.push(d.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const o=c.map(l=>new gs(l));return se(r,{code:Z.invalid_union,unionErrors:o}),ye}}get options(){return this._def.options}}Tc.create=(t,e)=>new Tc({options:t,typeName:xe.ZodUnion,...Ce(e)});function Th(t,e){const r=Ts(t),s=Ts(e);if(t===e)return{valid:!0,data:t};if(r===ce.object&&s===ce.object){const n=Ae.objectKeys(e),i=Ae.objectKeys(t).filter(o=>n.indexOf(o)!==-1),c={...t,...e};for(const o of i){const l=Th(t[o],e[o]);if(!l.valid)return{valid:!1};c[o]=l.data}return{valid:!0,data:c}}else if(r===ce.array&&s===ce.array){if(t.length!==e.length)return{valid:!1};const n=[];for(let i=0;i<t.length;i++){const c=t[i],o=e[i],l=Th(c,o);if(!l.valid)return{valid:!1};n.push(l.data)}return{valid:!0,data:n}}else return r===ce.date&&s===ce.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Ac extends Te{_parse(e){const{status:r,ctx:s}=this._processInputParams(e),n=(i,c)=>{if(Vg(i)||Vg(c))return ye;const o=Th(i.value,c.value);return o.valid?((Kg(i)||Kg(c))&&r.dirty(),{status:r.value,value:o.data}):(se(s,{code:Z.invalid_intersection_types}),ye)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,c])=>n(i,c)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}Ac.create=(t,e,r)=>new Ac({left:t,right:e,typeName:xe.ZodIntersection,...Ce(r)});class Yn extends Te{_parse(e){const{status:r,ctx:s}=this._processInputParams(e);if(s.parsedType!==ce.array)return se(s,{code:Z.invalid_type,expected:ce.array,received:s.parsedType}),ye;if(s.data.length<this._def.items.length)return se(s,{code:Z.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ye;!this._def.rest&&s.data.length>this._def.items.length&&(se(s,{code:Z.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...s.data].map((c,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new an(s,c,s.path,o)):null}).filter(c=>!!c);return s.common.async?Promise.all(i).then(c=>or.mergeArray(r,c)):or.mergeArray(r,i)}get items(){return this._def.items}rest(e){return new Yn({...this._def,rest:e})}}Yn.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Yn({items:t,typeName:xe.ZodTuple,rest:null,...Ce(e)})};class ev extends Te{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:s}=this._processInputParams(e);if(s.parsedType!==ce.map)return se(s,{code:Z.invalid_type,expected:ce.map,received:s.parsedType}),ye;const n=this._def.keyType,i=this._def.valueType,c=[...s.data.entries()].map(([o,l],d)=>({key:n._parse(new an(s,o,s.path,[d,"key"])),value:i._parse(new an(s,l,s.path,[d,"value"]))}));if(s.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of c){const d=await l.key,g=await l.value;if(d.status==="aborted"||g.status==="aborted")return ye;(d.status==="dirty"||g.status==="dirty")&&r.dirty(),o.set(d.value,g.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const l of c){const d=l.key,g=l.value;if(d.status==="aborted"||g.status==="aborted")return ye;(d.status==="dirty"||g.status==="dirty")&&r.dirty(),o.set(d.value,g.value)}return{status:r.value,value:o}}}}ev.create=(t,e,r)=>new ev({valueType:e,keyType:t,typeName:xe.ZodMap,...Ce(r)});class Pa extends Te{_parse(e){const{status:r,ctx:s}=this._processInputParams(e);if(s.parsedType!==ce.set)return se(s,{code:Z.invalid_type,expected:ce.set,received:s.parsedType}),ye;const n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(se(s,{code:Z.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),r.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(se(s,{code:Z.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),r.dirty());const i=this._def.valueType;function c(l){const d=new Set;for(const g of l){if(g.status==="aborted")return ye;g.status==="dirty"&&r.dirty(),d.add(g.value)}return{status:r.value,value:d}}const o=[...s.data.values()].map((l,d)=>i._parse(new an(s,l,s.path,d)));return s.common.async?Promise.all(o).then(l=>c(l)):c(o)}min(e,r){return new Pa({...this._def,minSize:{value:e,message:fe.toString(r)}})}max(e,r){return new Pa({...this._def,maxSize:{value:e,message:fe.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}Pa.create=(t,e)=>new Pa({valueType:t,minSize:null,maxSize:null,typeName:xe.ZodSet,...Ce(e)});class tv extends Te{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}tv.create=(t,e)=>new tv({getter:t,typeName:xe.ZodLazy,...Ce(e)});class Ah extends Te{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return se(r,{received:r.data,code:Z.invalid_literal,expected:this._def.value}),ye}return{status:"valid",value:e.data}}get value(){return this._def.value}}Ah.create=(t,e)=>new Ah({value:t,typeName:xe.ZodLiteral,...Ce(e)});function wx(t,e){return new mo({values:t,typeName:xe.ZodEnum,...Ce(e)})}class mo extends Te{_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),s=this._def.values;return se(r,{expected:Ae.joinValues(s),received:r.parsedType,code:Z.invalid_type}),ye}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const r=this._getOrReturnCtx(e),s=this._def.values;return se(r,{received:r.data,code:Z.invalid_enum_value,options:s}),ye}return yr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return mo.create(e,{...this._def,...r})}exclude(e,r=this._def){return mo.create(this.options.filter(s=>!e.includes(s)),{...this._def,...r})}}mo.create=wx;class Oh extends Te{_parse(e){const r=Ae.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==ce.string&&s.parsedType!==ce.number){const n=Ae.objectValues(r);return se(s,{expected:Ae.joinValues(n),received:s.parsedType,code:Z.invalid_type}),ye}if(this._cache||(this._cache=new Set(Ae.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const n=Ae.objectValues(r);return se(s,{received:s.data,code:Z.invalid_enum_value,options:n}),ye}return yr(e.data)}get enum(){return this._def.values}}Oh.create=(t,e)=>new Oh({values:t,typeName:xe.ZodNativeEnum,...Ce(e)});class Oc extends Te{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==ce.promise&&r.common.async===!1)return se(r,{code:Z.invalid_type,expected:ce.promise,received:r.parsedType}),ye;const s=r.parsedType===ce.promise?r.data:Promise.resolve(r.data);return yr(s.then(n=>this._def.type.parseAsync(n,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Oc.create=(t,e)=>new Oc({type:t,typeName:xe.ZodPromise,...Ce(e)});class go extends Te{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===xe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:s}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:c=>{se(s,c),c.fatal?r.abort():r.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){const c=n.transform(s.data,i);if(s.common.async)return Promise.resolve(c).then(async o=>{if(r.value==="aborted")return ye;const l=await this._def.schema._parseAsync({data:o,path:s.path,parent:s});return l.status==="aborted"?ye:l.status==="dirty"||r.value==="dirty"?qo(l.value):l});{if(r.value==="aborted")return ye;const o=this._def.schema._parseSync({data:c,path:s.path,parent:s});return o.status==="aborted"?ye:o.status==="dirty"||r.value==="dirty"?qo(o.value):o}}if(n.type==="refinement"){const c=o=>{const l=n.refinement(o,i);if(s.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return o.status==="aborted"?ye:(o.status==="dirty"&&r.dirty(),c(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>o.status==="aborted"?ye:(o.status==="dirty"&&r.dirty(),c(o.value).then(()=>({status:r.value,value:o.value}))))}if(n.type==="transform")if(s.common.async===!1){const c=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!fo(c))return ye;const o=n.transform(c.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(c=>fo(c)?Promise.resolve(n.transform(c.value,i)).then(o=>({status:r.value,value:o})):ye);Ae.assertNever(n)}}go.create=(t,e,r)=>new go({schema:t,typeName:xe.ZodEffects,effect:e,...Ce(r)});go.createWithPreprocess=(t,e,r)=>new go({schema:e,effect:{type:"preprocess",transform:t},typeName:xe.ZodEffects,...Ce(r)});class sn extends Te{_parse(e){return this._getType(e)===ce.undefined?yr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}sn.create=(t,e)=>new sn({innerType:t,typeName:xe.ZodOptional,...Ce(e)});class vo extends Te{_parse(e){return this._getType(e)===ce.null?yr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}vo.create=(t,e)=>new vo({innerType:t,typeName:xe.ZodNullable,...Ce(e)});class Ph extends Te{_parse(e){const{ctx:r}=this._processInputParams(e);let s=r.data;return r.parsedType===ce.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}Ph.create=(t,e)=>new Ph({innerType:t,typeName:xe.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ce(e)});class Lh extends Te{_parse(e){const{ctx:r}=this._processInputParams(e),s={...r,common:{...r.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return Rc(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new gs(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new gs(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}Lh.create=(t,e)=>new Lh({innerType:t,typeName:xe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ce(e)});class rv extends Te{_parse(e){if(this._getType(e)!==ce.nan){const s=this._getOrReturnCtx(e);return se(s,{code:Z.invalid_type,expected:ce.nan,received:s.parsedType}),ye}return{status:"valid",value:e.data}}}rv.create=t=>new rv({typeName:xe.ZodNaN,...Ce(t)});class _N extends Te{_parse(e){const{ctx:r}=this._processInputParams(e),s=r.data;return this._def.type._parse({data:s,path:r.path,parent:r})}unwrap(){return this._def.type}}class fp extends Te{_parse(e){const{status:r,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?ye:i.status==="dirty"?(r.dirty(),qo(i.value)):this._def.out._parseAsync({data:i.value,path:s.path,parent:s})})();{const n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?ye:n.status==="dirty"?(r.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,r){return new fp({in:e,out:r,typeName:xe.ZodPipeline})}}class Ih extends Te{_parse(e){const r=this._def.innerType._parse(e),s=n=>(fo(n)&&(n.value=Object.freeze(n.value)),n);return Rc(r)?r.then(n=>s(n)):s(r)}unwrap(){return this._def.innerType}}Ih.create=(t,e)=>new Ih({innerType:t,typeName:xe.ZodReadonly,...Ce(e)});var xe;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(xe||(xe={}));const W=Gs.create,ge=po.create,Ka=jh.create,yN=Rh.create,bx=Nh.create;ln.create;const Kt=Vr.create,ae=tt.create,xN=Tc.create;Ac.create;Yn.create;const wN=Ah.create,Dr=mo.create,bN=Oh.create;Oc.create;sn.create;vo.create;const SN=t=>typeof(t==null?void 0:t.safeParse)=="function",Qu=t=>typeof(t==null?void 0:t.passthrough)=="function",CN=(t,e)=>Qu(t)?Qu(e)?t.merge(e):t:Qu(e)?e:Object.assign({},t,e);ae({name:wN("ZodError"),issues:Kt(ae({path:Kt(xN([W(),ge()])),message:W().optional(),code:bN(Z)}).catchall(yN()))});const kN=Symbol("ContractNoBody"),Sx=t=>"method"in t&&"path"in t,Cx=(t,e)=>Object.fromEntries(Object.entries(t).map(([r,s])=>{var n,i,c;return Sx(s)?[r,{...s,path:e!=null&&e.pathPrefix?e.pathPrefix+s.path:s.path,headers:CN(e==null?void 0:e.baseHeaders,s.headers),strictStatusCodes:(n=s.strictStatusCodes)!==null&&n!==void 0?n:e==null?void 0:e.strictStatusCodes,validateResponseOnClient:(i=s.validateResponseOnClient)!==null&&i!==void 0?i:e==null?void 0:e.validateResponseOnClient,responses:{...e==null?void 0:e.commonResponses,...s.responses},metadata:e!=null&&e.metadata?{...e==null?void 0:e.metadata,...(c=s.metadata)!==null&&c!==void 0?c:{}}:s.metadata}]:[r,Cx(s,e)]})),Zu=Symbol("ContractPlainType"),Ja=()=>({router:(t,e)=>Cx(t,e),query:t=>t,mutation:t=>t,responses:t=>t,response:()=>Zu,body:()=>Zu,type:()=>Zu,otherResponse:({contentType:t,body:e})=>({contentType:t,body:e}),noBody:()=>kN}),EN=({path:t,params:e})=>{const r=e;return t.replace(/\/?:([^/?]+)\??/g,(s,n)=>r[n]?`${s.startsWith("/")?"/":""}${r[n]}`:"")},jN=(t,e=!1)=>{const r=e?RN(t):NN(t);return(r==null?void 0:r.length)>0?"?"+r:""},RN=t=>t?Object.entries(t).filter(([,e])=>e!==void 0).map(([e,r])=>{let s;return typeof r=="string"&&!["true","false","null"].includes(r.trim())&&isNaN(Number(r))?s=r:s=JSON.stringify(r),`${encodeURIComponent(e)}=${encodeURIComponent(s)}`}).join("&"):"",NN=t=>t?Object.keys(t).flatMap(e=>Dh(e,t[e])).map(([e,r])=>`${encodeURIComponent(e)}=${encodeURIComponent(r)}`).join("&"):"",Dh=(t,e)=>Array.isArray(e)?e.flatMap((r,s)=>Dh(`${t}[${s}]`,r)):e instanceof Date?[[`${t}`,e.toISOString()]]:e===null?[[`${t}`,""]]:e===void 0?[]:typeof e=="object"?Object.keys(e).flatMap(r=>Dh(`${t}[${r}]`,e[r])):[[`${t}`,`${e}`]];class TN extends Error{constructor(e,r){const s=r.join(",");super(`Server returned unexpected response. Expected one of: ${s} got: ${e.status}`),this.response=e}}const AN=async({route:t,path:e,method:r,headers:s,body:n,validateResponse:i,fetchOptions:c})=>{const o=await fetch(e,{...c,method:r,headers:s,body:n}),l=o.headers.get("content-type");if(l!=null&&l.includes("application/")&&(l!=null&&l.includes("json"))){const d={status:o.status,body:await o.json(),headers:o.headers},g=t.responses[d.status];return(i??t.validateResponseOnClient)&&SN(g)?{...d,body:g.parse(d.body)}:d}return l!=null&&l.includes("text/")?{status:o.status,body:await o.text(),headers:o.headers}:{status:o.status,body:await o.blob(),headers:o.headers}},ON=t=>{const e=new FormData,r=(s,n)=>{n instanceof File?e.append(s,n):e.append(s,JSON.stringify(n))};return Object.entries(t).forEach(([s,n])=>{if(Array.isArray(n))for(const i of n)r(s,i);else r(s,n)}),e},sv=t=>Object.fromEntries(Object.entries(t).map(([e,r])=>[e.toLowerCase(),r])),PN=t=>{const{path:e,clientArgs:r,route:s,body:n,query:i,extraInputArgs:c,headers:o,fetchOptions:l}=t,d=r.api||AN,g=r.baseHeaders&&Object.fromEntries(Object.entries(r.baseHeaders).map(([y,w])=>typeof w=="function"?[y,w(t)]:[y,w])),m={...g&&sv(g),...sv(o)};Object.keys(m).forEach(y=>{m[y]===void 0&&delete m[y]});let v={route:s,path:e,method:s.method,headers:m,body:void 0,rawBody:n,rawQuery:i,contentType:void 0,validateResponse:r.validateResponse,fetchOptions:{...r.credentials&&{credentials:r.credentials},...l},...(l==null?void 0:l.signal)&&{signal:l.signal},...(l==null?void 0:l.cache)&&{cache:l.cache},...l&&"next"in l&&!!(l!=null&&l.next)&&{next:l.next}};return s.method!=="GET"&&("contentType"in s&&s.contentType==="multipart/form-data"?v={...v,contentType:"multipart/form-data",body:n instanceof FormData?n:ON(n)}:"contentType"in s&&s.contentType==="application/x-www-form-urlencoded"?v={...v,contentType:"application/x-www-form-urlencoded",headers:{"content-type":"application/x-www-form-urlencoded",...v.headers},body:typeof n=="string"?n:new URLSearchParams(n)}:n!=null&&(v={...v,contentType:"application/json",headers:{"content-type":"application/json",...v.headers},body:JSON.stringify(n)})),d({...v,...c})},LN=(t,e,r)=>{const{query:s,params:n,body:i,headers:c,extraHeaders:o,overrideClientOptions:l,fetchOptions:d,cache:g,next:m,...v}=r||{},y={...e,...l};return{path:IN(s,y.baseUrl,n,t,!!y.jsonQuery),clientArgs:y,route:t,body:i,query:s,extraInputArgs:v,fetchOptions:{...g&&{cache:g},...m&&{next:m},...d},headers:{...o,...c}}},IN=(t,e,r,s,n)=>{const i=EN({path:s.path,params:r}),c=jN(t,n);return`${e}${i}${c}`},DN=(t,e)=>{const r=Object.keys(t.responses);return async s=>{const n=LN(t,e,s),i=await PN(n);if(!e.throwOnUnknownStatus||r.includes(i.status.toString()))return i;throw new TN(i,r)}},kx=(t,e)=>Object.fromEntries(Object.entries(t).map(([r,s])=>Sx(s)?[r,DN(s,e)]:[r,kx(s,e)])),pp=Dr(["user","user_plus","dev","admin"]),mp=Dr(["pending_approval","approved","rejected","suspended"]),MN=Dr(["grant","deduction","refund","adjustment"]),BN=Dr(["free","pro","enterprise"]),$N=ae({id:W().uuid(),email:W().email(),name:W().nullable(),role:pp,status:mp,creditsRemaining:ge().int().min(0),creditsUsed:ge().int().min(0),stripeCustomerId:W().nullable().optional(),currentTier:BN.default("free"),hasClaudeToken:Ka().optional(),createdAt:W().datetime(),updatedAt:W().datetime()});$N.omit({createdAt:!0,updatedAt:!0}).extend({creditsRemaining:ge().int().min(0).default(0),creditsUsed:ge().int().min(0).default(0),status:mp.default("pending_approval"),role:pp.default("user")});ae({name:W().min(1).max(100).optional(),role:pp.optional(),status:mp.optional(),creditsRemaining:ge().int().min(0).optional(),creditsUsed:ge().int().min(0).optional(),updatedAt:W().datetime().optional()});const FN=ae({id:ge(),key:W().min(1),value:bx(),description:W().nullable(),createdAt:W().datetime(),updatedAt:W().datetime()});FN.omit({id:!0,createdAt:!0,updatedAt:!0});ae({value:bx(),description:W().optional(),updatedAt:W().datetime().optional()});ae({creditsPerGeneration:ge().int().min(1).default(1),defaultCreditsForNewUsers:ge().int().min(0).default(0),maxCreditsPerUser:ge().int().min(0).default(100)});const UN=ae({id:ge(),userId:W().uuid(),type:MN,amount:ge().int(),balanceBefore:ge().int(),balanceAfter:ge().int(),description:W().nullable(),generationRequestId:ge().int().nullable(),createdAt:W().datetime(),createdBy:W().uuid().nullable()});UN.omit({id:!0,createdAt:!0});const Ex=ae({id:ge(),email:W().email(),name:W().min(1,"Name is required"),password:W(),role:Dr(["user","admin"]),createdAt:W().datetime()});Ex.omit({id:!0,createdAt:!0});ae({email:W().email("Invalid email address"),password:W().min(8,"Password must be at least 8 characters"),name:W().min(1,"Name is required").optional()});ae({email:W().email("Invalid email address"),password:W().min(1,"Password is required")});ae({email:W().email("Invalid email address")});ae({password:W().min(8,"Password must be at least 8 characters")});const HN=Ex.omit({password:!0}),zN=ae({id:ge(),appUuid:W().uuid(),userId:W().uuid(),appName:W().min(1,"App name is required"),githubUrl:W().url().nullable(),deploymentUrl:W().url().nullable(),createdAt:W().datetime(),updatedAt:W().datetime(),cumulativeCost:W().nullable()});zN.omit({id:!0,appUuid:!0,createdAt:!0,updatedAt:!0}).extend({appUuid:W().uuid().optional()});ae({appName:W().min(1).max(50).optional(),githubUrl:W().url().nullable().optional(),deploymentUrl:W().url().nullable().optional(),updatedAt:W().datetime().optional(),cumulativeCost:W().nullable().optional()});const WN=ae({id:ge(),appUuid:W().uuid(),appName:W(),githubUrl:W().url().nullable(),deploymentUrl:W().url().nullable(),updatedAt:W().datetime(),generationCount:ge().optional(),lastStatus:W().optional(),cumulativeCost:W().nullable().optional()}),qN=ae({id:ge(),appId:ge(),userId:W().uuid(),assignedBy:W().uuid().nullable(),canResume:Ka(),assignedAt:W().datetime()});qN.omit({id:!0,assignedAt:!0}).extend({canResume:Ka().default(!1)});ae({canResume:Ka().optional()});const gp=Dr(["queued","generating","completed","failed","paused","cancelled"]),vp=Dr(["single-shot","autonomous","confirm_first"]),_p=Dr(["new","resume"]),yp=ae({id:ge(),appRefId:ge(),prompt:W().min(10,"Prompt must be at least 10 characters").max(15e3,"Prompt must not exceed 15000 characters"),status:gp,generationType:_p,createdAt:W().datetime(),updatedAt:W().datetime(),completedAt:W().datetime().nullable(),errorMessage:W().nullable(),mode:vp,initialPrompt:W(),maxIterations:ge().int().min(1).max(20),currentIteration:ge().int().min(0),lastSessionId:W().nullable(),githubCommit:W().nullable(),totalCost:W().nullable(),totalDuration:ge().int().nullable(),warnings:Kt(ae({code:W(),message:W(),details:ae({remediation_url:W().optional()}).optional()})).nullable(),iterationData:Kt(ae({iteration:ge(),cost:ge(),duration:ge()})).nullable(),poolIndex:ge().int().nullable(),attachments:Kt(ae({name:W(),storagePath:W(),size:ge(),mimeType:W()})).nullable()});yp.omit({id:!0,createdAt:!0,updatedAt:!0,completedAt:!0,errorMessage:!0,lastSessionId:!0,githubCommit:!0,totalCost:!0,totalDuration:!0,warnings:!0,iterationData:!0,poolIndex:!0,attachments:!0}).extend({status:gp.default("queued"),generationType:_p.default("new"),mode:vp.default("single-shot"),initialPrompt:W(),maxIterations:ge().int().min(1).max(20).default(10),currentIteration:ge().int().min(0).default(0)});const GN=ae({appName:W().min(1,"App name is required").max(50,"App name must not exceed 50 characters"),prompt:W().min(10,"Prompt must be at least 10 characters").max(15e3,"Prompt must not exceed 15000 characters"),mode:vp.optional(),maxIterations:ge().int().min(1).max(20).optional(),generationType:_p.optional(),appId:W().uuid().optional()});ae({status:gp.optional(),updatedAt:W().datetime().optional(),completedAt:W().datetime().optional(),errorMessage:W().optional(),currentIteration:ge().int().min(0).optional(),lastSessionId:W().optional(),githubCommit:W().optional(),totalCost:W().optional(),totalDuration:ge().int().optional(),warnings:Kt(ae({code:W(),message:W(),details:ae({remediation_url:W().optional()}).optional()})).optional(),iterationData:Kt(ae({iteration:ge(),cost:ge(),duration:ge()})).optional(),poolIndex:ge().int().nullable().optional(),attachments:Kt(ae({name:W(),storagePath:W(),size:ge(),mimeType:W()})).optional()});ae({name:W().min(1).max(255),storagePath:W(),size:ge().min(1).max(5*1024*1024),mimeType:W()});const Br={MAX_FILE_SIZE:5*1024*1024,MAX_FILES:10,MAX_TOTAL_SIZE:20*1024*1024,ALLOWED_EXTENSIONS:[".ts",".tsx",".js",".jsx",".json",".md",".txt",".py",".css",".html",".png",".jpg",".jpeg",".gif",".svg"]};yp.extend({user:HN});const Go=yp.extend({userId:W().uuid(),appName:W(),appUuid:W().uuid(),githubUrl:W().url().nullable(),deploymentUrl:W().url().nullable(),cumulativeCost:W().nullable()}),jx=Dr(["feature_request","bug_report"]),Rx=Dr(["new","reviewed","in_progress","resolved","closed"]),Nx=ae({name:W(),url:W().url(),size:ge(),mimeType:W()}),nv=ae({id:ge(),userId:W().uuid(),type:jx,content:W().min(10,"Feedback must be at least 10 characters").max(5e3),status:Rx,sourcePage:W().max(100),attachments:Kt(Nx).nullable().optional(),createdAt:W().datetime(),updatedAt:W().datetime()}),VN=ae({type:jx,content:W().min(10,"Feedback must be at least 10 characters").max(5e3),sourcePage:W().max(100),attachments:Kt(Nx).max(3).optional()});ae({status:Rx.optional(),updatedAt:W().datetime().optional()});const KN=Ja(),JN=ae({available:ge(),total:ge(),mode:Dr(["pooled","per-app"])}),QN=ae({active:Kt(Go),activeCount:ge(),maxConcurrent:ge(),canStartNew:Ka(),poolInfo:JN}),ZN=KN.router({create:{method:"POST",path:"/api/generations",body:GN,responses:{201:Go,400:ae({error:W()}),401:ae({error:W()}),429:ae({error:W(),activeCount:ge(),maxConcurrent:ge()})},summary:"Create a new generation request"},getActive:{method:"GET",path:"/api/generations/active",responses:{200:QN,401:ae({error:W()})},summary:"Get active generations and concurrency limits"},list:{method:"GET",path:"/api/generations",responses:{200:Kt(Go),401:ae({error:W()})},summary:"List all generation requests for authenticated user"},getById:{method:"GET",path:"/api/generations/:id",pathParams:ae({id:W()}),responses:{200:Go,401:ae({error:W()}),404:ae({error:W()})},summary:"Get a specific generation request"},getDownloadUrl:{method:"GET",path:"/api/generations/:id/download",pathParams:ae({id:W()}),responses:{200:ae({downloadUrl:W().url()}),401:ae({error:W()}),404:ae({error:W()}),400:ae({error:W()})},summary:"Get download URL for completed generation"},cancel:{method:"POST",path:"/api/generations/:id/cancel",pathParams:ae({id:W()}),body:ae({}).optional(),responses:{200:Go,400:ae({error:W()}),401:ae({error:W()}),404:ae({error:W()})},summary:"Cancel an active or paused generation"}}),YN=Ja(),Rl=ae({error:W(),message:W()}),XN=YN.router({listByGeneration:{method:"GET",path:"/api/generations/:id/iterations",pathParams:ae({id:W()}),responses:{501:Rl},summary:"[DEPRECATED] List iteration snapshots for a generation"},getById:{method:"GET",path:"/api/iterations/:snapshotId",pathParams:ae({snapshotId:W()}),responses:{501:Rl},summary:"[DEPRECATED] Get a specific iteration snapshot"},rollback:{method:"POST",path:"/api/generations/:id/rollback",pathParams:ae({id:W()}),body:ae({snapshotId:ge()}),responses:{501:Rl},summary:"[DEPRECATED] Rollback generation to a specific iteration"},delete:{method:"DELETE",path:"/api/iterations/:snapshotId",pathParams:ae({snapshotId:W()}),responses:{501:Rl},summary:"[DEPRECATED] Delete an iteration snapshot"}}),eT=Ja(),tT=eT.router({list:{method:"GET",path:"/api/apps",responses:{200:Kt(WN),401:ae({error:W()})},summary:"List all apps for authenticated user (for Resume dropdown)"}}),rT=Ja(),sT=rT.router({create:{method:"POST",path:"/api/feedback",body:VN,responses:{201:nv,400:ae({error:W()}),401:ae({error:W()})},summary:"Submit user feedback (feature request or bug report)"},list:{method:"GET",path:"/api/feedback",responses:{200:Kt(nv),401:ae({error:W()})},summary:"List all feedback for authenticated user"}}),nT=Ja(),iT=nT.router({generations:ZN,iterations:XN,apps:tT,feedback:sT}),Mh=kx(iT,{baseUrl:"",baseHeaders:{"Content-Type":"application/json",get Authorization(){const t=rn();return t?`Bearer ${t}`:""}}});function oT(){const[t,e]=R.useState(null),r=R.useRef(new Set),{data:s,isLoading:n,error:i,refetch:c}=Qc({queryKey:["generations","active"],queryFn:async()=>{const g=await Mh.generations.getActive();if(g.status===200)return g.body;throw new Error("Failed to fetch active generations")},refetchInterval:5e3,retry:1}),o=(s==null?void 0:s.active)||[],l=s?{activeCount:s.activeCount,maxConcurrent:s.maxConcurrent,canStartNew:s.canStartNew,poolInfo:s.poolInfo}:null;R.useEffect(()=>{const g=new Set(o.map(m=>m.id));for(const m of o)if(!r.current.has(m.id)){e(m.id);break}t!==null&&!g.has(t)&&e(o.length>0?o[0].id:null),t===null&&o.length>0&&e(o[0].id),r.current=g},[o,t]);const d=R.useCallback(()=>{c()},[c]);return{activeGenerations:o,activeTabId:t,setActiveTabId:e,concurrencyInfo:l,isLoading:n,error:i instanceof Error?i.message:null,refreshActiveGenerations:d}}var Tx={exports:{}};(function(t,e){(function(r,s){t.exports=s()})(globalThis,()=>(()=>{var r={4567:function(c,o,l){var d=this&&this.__decorate||function(u,f,x,k){var C,S=arguments.length,b=S<3?f:k===null?k=Object.getOwnPropertyDescriptor(f,x):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(u,f,x,k);else for(var E=u.length-1;E>=0;E--)(C=u[E])&&(b=(S<3?C(b):S>3?C(f,x,b):C(f,x))||b);return S>3&&b&&Object.defineProperty(f,x,b),b},g=this&&this.__param||function(u,f){return function(x,k){f(x,k,u)}};Object.defineProperty(o,"__esModule",{value:!0}),o.AccessibilityManager=void 0;const m=l(9042),v=l(9924),y=l(844),w=l(4725),_=l(2585),p=l(3656);let h=o.AccessibilityManager=class extends y.Disposable{constructor(u,f,x,k){super(),this._terminal=u,this._coreBrowserService=x,this._renderService=k,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let C=0;C<this._terminal.rows;C++)this._rowElements[C]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[C]);if(this._topBoundaryFocusListener=C=>this._handleBoundaryFocus(C,0),this._bottomBoundaryFocusListener=C=>this._handleBoundaryFocus(C,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new v.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(C=>this._handleResize(C.rows))),this.register(this._terminal.onRender(C=>this._refreshRows(C.start,C.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(C=>this._handleChar(C))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(C=>this._handleTab(C))),this.register(this._terminal.onKey(C=>this._handleKey(C.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this.register((0,p.addDisposableDomListener)(document,"selectionchange",()=>this._handleSelectionChange())),this.register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,y.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(u){for(let f=0;f<u;f++)this._handleChar(" ")}_handleChar(u){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==u&&(this._charsToAnnounce+=u):this._charsToAnnounce+=u,u===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=m.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(u){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(u)||this._charsToConsume.push(u)}_refreshRows(u,f){this._liveRegionDebouncer.refresh(u,f,this._terminal.rows)}_renderRows(u,f){const x=this._terminal.buffer,k=x.lines.length.toString();for(let C=u;C<=f;C++){const S=x.lines.get(x.ydisp+C),b=[],E=(S==null?void 0:S.translateToString(!0,void 0,void 0,b))||"",N=(x.ydisp+C+1).toString(),O=this._rowElements[C];O&&(E.length===0?(O.innerText="",this._rowColumns.set(O,[0,1])):(O.textContent=E,this._rowColumns.set(O,b)),O.setAttribute("aria-posinset",N),O.setAttribute("aria-setsize",k))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(u,f){const x=u.target,k=this._rowElements[f===0?1:this._rowElements.length-2];if(x.getAttribute("aria-posinset")===(f===0?"1":`${this._terminal.buffer.lines.length}`)||u.relatedTarget!==k)return;let C,S;if(f===0?(C=x,S=this._rowElements.pop(),this._rowContainer.removeChild(S)):(C=this._rowElements.shift(),S=x,this._rowContainer.removeChild(C)),C.removeEventListener("focus",this._topBoundaryFocusListener),S.removeEventListener("focus",this._bottomBoundaryFocusListener),f===0){const b=this._createAccessibilityTreeNode();this._rowElements.unshift(b),this._rowContainer.insertAdjacentElement("afterbegin",b)}else{const b=this._createAccessibilityTreeNode();this._rowElements.push(b),this._rowContainer.appendChild(b)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(f===0?-1:1),this._rowElements[f===0?1:this._rowElements.length-2].focus(),u.preventDefault(),u.stopImmediatePropagation()}_handleSelectionChange(){var E;if(this._rowElements.length===0)return;const u=document.getSelection();if(!u)return;if(u.isCollapsed)return void(this._rowContainer.contains(u.anchorNode)&&this._terminal.clearSelection());if(!u.anchorNode||!u.focusNode)return void console.error("anchorNode and/or focusNode are null");let f={node:u.anchorNode,offset:u.anchorOffset},x={node:u.focusNode,offset:u.focusOffset};if((f.node.compareDocumentPosition(x.node)&Node.DOCUMENT_POSITION_PRECEDING||f.node===x.node&&f.offset>x.offset)&&([f,x]=[x,f]),f.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(f={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(f.node))return;const k=this._rowElements.slice(-1)[0];if(x.node.compareDocumentPosition(k)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(x={node:k,offset:((E=k.textContent)==null?void 0:E.length)??0}),!this._rowContainer.contains(x.node))return;const C=({node:N,offset:O})=>{const I=N instanceof Text?N.parentNode:N;let P=parseInt(I==null?void 0:I.getAttribute("aria-posinset"),10)-1;if(isNaN(P))return console.warn("row is invalid. Race condition?"),null;const U=this._rowColumns.get(I);if(!U)return console.warn("columns is null. Race condition?"),null;let D=O<U.length?U[O]:U.slice(-1)[0]+1;return D>=this._terminal.cols&&(++P,D=0),{row:P,column:D}},S=C(f),b=C(x);if(S&&b){if(S.row>b.row||S.row===b.row&&S.column>=b.column)throw new Error("invalid range");this._terminal.select(S.column,S.row,(b.row-S.row)*this._terminal.cols-S.column+b.column)}}_handleResize(u){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let f=this._rowContainer.children.length;f<this._terminal.rows;f++)this._rowElements[f]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[f]);for(;this._rowElements.length>u;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const u=this._coreBrowserService.mainDocument.createElement("div");return u.setAttribute("role","listitem"),u.tabIndex=-1,this._refreshRowDimensions(u),u}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let u=0;u<this._terminal.rows;u++)this._refreshRowDimensions(this._rowElements[u])}}_refreshRowDimensions(u){u.style.height=`${this._renderService.dimensions.css.cell.height}px`}};o.AccessibilityManager=h=d([g(1,_.IInstantiationService),g(2,w.ICoreBrowserService),g(3,w.IRenderService)],h)},3614:(c,o)=>{function l(v){return v.replace(/\r?\n/g,"\r")}function d(v,y){return y?"\x1B[200~"+v+"\x1B[201~":v}function g(v,y,w,_){v=d(v=l(v),w.decPrivateModes.bracketedPasteMode&&_.rawOptions.ignoreBracketedPasteMode!==!0),w.triggerDataEvent(v,!0),y.value=""}function m(v,y,w){const _=w.getBoundingClientRect(),p=v.clientX-_.left-10,h=v.clientY-_.top-10;y.style.width="20px",y.style.height="20px",y.style.left=`${p}px`,y.style.top=`${h}px`,y.style.zIndex="1000",y.focus()}Object.defineProperty(o,"__esModule",{value:!0}),o.rightClickHandler=o.moveTextAreaUnderMouseCursor=o.paste=o.handlePasteEvent=o.copyHandler=o.bracketTextForPaste=o.prepareTextForTerminal=void 0,o.prepareTextForTerminal=l,o.bracketTextForPaste=d,o.copyHandler=function(v,y){v.clipboardData&&v.clipboardData.setData("text/plain",y.selectionText),v.preventDefault()},o.handlePasteEvent=function(v,y,w,_){v.stopPropagation(),v.clipboardData&&g(v.clipboardData.getData("text/plain"),y,w,_)},o.paste=g,o.moveTextAreaUnderMouseCursor=m,o.rightClickHandler=function(v,y,w,_,p){m(v,y,w),p&&_.rightClickSelect(v),y.value=_.selectionText,y.select()}},7239:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ColorContrastCache=void 0;const d=l(1505);o.ColorContrastCache=class{constructor(){this._color=new d.TwoKeyMap,this._css=new d.TwoKeyMap}setCss(g,m,v){this._css.set(g,m,v)}getCss(g,m){return this._css.get(g,m)}setColor(g,m,v){this._color.set(g,m,v)}getColor(g,m){return this._color.get(g,m)}clear(){this._color.clear(),this._css.clear()}}},3656:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.addDisposableDomListener=void 0,o.addDisposableDomListener=function(l,d,g,m){l.addEventListener(d,g,m);let v=!1;return{dispose:()=>{v||(v=!0,l.removeEventListener(d,g,m))}}}},3551:function(c,o,l){var d=this&&this.__decorate||function(h,u,f,x){var k,C=arguments.length,S=C<3?u:x===null?x=Object.getOwnPropertyDescriptor(u,f):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(h,u,f,x);else for(var b=h.length-1;b>=0;b--)(k=h[b])&&(S=(C<3?k(S):C>3?k(u,f,S):k(u,f))||S);return C>3&&S&&Object.defineProperty(u,f,S),S},g=this&&this.__param||function(h,u){return function(f,x){u(f,x,h)}};Object.defineProperty(o,"__esModule",{value:!0}),o.Linkifier=void 0;const m=l(3656),v=l(8460),y=l(844),w=l(2585),_=l(4725);let p=o.Linkifier=class extends y.Disposable{get currentLink(){return this._currentLink}constructor(h,u,f,x,k){super(),this._element=h,this._mouseService=u,this._renderService=f,this._bufferService=x,this._linkProviderService=k,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new v.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new v.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,y.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,y.toDisposable)(()=>{var C;this._lastMouseEvent=void 0,(C=this._activeProviderReplies)==null||C.clear()})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this.register((0,m.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,m.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,m.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,m.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(h){this._lastMouseEvent=h;const u=this._positionFromMouseEvent(h,this._element,this._mouseService);if(!u)return;this._isMouseOut=!1;const f=h.composedPath();for(let x=0;x<f.length;x++){const k=f[x];if(k.classList.contains("xterm"))break;if(k.classList.contains("xterm-hover"))return}this._lastBufferCell&&u.x===this._lastBufferCell.x&&u.y===this._lastBufferCell.y||(this._handleHover(u),this._lastBufferCell=u)}_handleHover(h){if(this._activeLine!==h.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(h,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,h)||(this._clearCurrentLink(),this._askForLink(h,!0))}_askForLink(h,u){var x,k;this._activeProviderReplies&&u||((x=this._activeProviderReplies)==null||x.forEach(C=>{C==null||C.forEach(S=>{S.link.dispose&&S.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=h.y);let f=!1;for(const[C,S]of this._linkProviderService.linkProviders.entries())u?(k=this._activeProviderReplies)!=null&&k.get(C)&&(f=this._checkLinkProviderResult(C,h,f)):S.provideLinks(h.y,b=>{var N,O;if(this._isMouseOut)return;const E=b==null?void 0:b.map(I=>({link:I}));(N=this._activeProviderReplies)==null||N.set(C,E),f=this._checkLinkProviderResult(C,h,f),((O=this._activeProviderReplies)==null?void 0:O.size)===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(h.y,this._activeProviderReplies)})}_removeIntersectingLinks(h,u){const f=new Set;for(let x=0;x<u.size;x++){const k=u.get(x);if(k)for(let C=0;C<k.length;C++){const S=k[C],b=S.link.range.start.y<h?0:S.link.range.start.x,E=S.link.range.end.y>h?this._bufferService.cols:S.link.range.end.x;for(let N=b;N<=E;N++){if(f.has(N)){k.splice(C--,1);break}f.add(N)}}}}_checkLinkProviderResult(h,u,f){var C;if(!this._activeProviderReplies)return f;const x=this._activeProviderReplies.get(h);let k=!1;for(let S=0;S<h;S++)this._activeProviderReplies.has(S)&&!this._activeProviderReplies.get(S)||(k=!0);if(!k&&x){const S=x.find(b=>this._linkAtPosition(b.link,u));S&&(f=!0,this._handleNewLink(S))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!f)for(let S=0;S<this._activeProviderReplies.size;S++){const b=(C=this._activeProviderReplies.get(S))==null?void 0:C.find(E=>this._linkAtPosition(E.link,u));if(b){f=!0,this._handleNewLink(b);break}}return f}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(h){if(!this._currentLink)return;const u=this._positionFromMouseEvent(h,this._element,this._mouseService);u&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,u)&&this._currentLink.link.activate(h,this._currentLink.link.text)}_clearCurrentLink(h,u){this._currentLink&&this._lastMouseEvent&&(!h||!u||this._currentLink.link.range.start.y>=h&&this._currentLink.link.range.end.y<=u)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,y.disposeArray)(this._linkCacheDisposables))}_handleNewLink(h){if(!this._lastMouseEvent)return;const u=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);u&&this._linkAtPosition(h.link,u)&&(this._currentLink=h,this._currentLink.state={decorations:{underline:h.link.decorations===void 0||h.link.decorations.underline,pointerCursor:h.link.decorations===void 0||h.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,h.link,this._lastMouseEvent),h.link.decorations={},Object.defineProperties(h.link.decorations,{pointerCursor:{get:()=>{var f,x;return(x=(f=this._currentLink)==null?void 0:f.state)==null?void 0:x.decorations.pointerCursor},set:f=>{var x;(x=this._currentLink)!=null&&x.state&&this._currentLink.state.decorations.pointerCursor!==f&&(this._currentLink.state.decorations.pointerCursor=f,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",f))}},underline:{get:()=>{var f,x;return(x=(f=this._currentLink)==null?void 0:f.state)==null?void 0:x.decorations.underline},set:f=>{var x,k,C;(x=this._currentLink)!=null&&x.state&&((C=(k=this._currentLink)==null?void 0:k.state)==null?void 0:C.decorations.underline)!==f&&(this._currentLink.state.decorations.underline=f,this._currentLink.state.isHovered&&this._fireUnderlineEvent(h.link,f))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(f=>{if(!this._currentLink)return;const x=f.start===0?0:f.start+1+this._bufferService.buffer.ydisp,k=this._bufferService.buffer.ydisp+1+f.end;if(this._currentLink.link.range.start.y>=x&&this._currentLink.link.range.end.y<=k&&(this._clearCurrentLink(x,k),this._lastMouseEvent)){const C=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);C&&this._askForLink(C,!1)}})))}_linkHover(h,u,f){var x;(x=this._currentLink)!=null&&x.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(u,!0),this._currentLink.state.decorations.pointerCursor&&h.classList.add("xterm-cursor-pointer")),u.hover&&u.hover(f,u.text)}_fireUnderlineEvent(h,u){const f=h.range,x=this._bufferService.buffer.ydisp,k=this._createLinkUnderlineEvent(f.start.x-1,f.start.y-x-1,f.end.x,f.end.y-x-1,void 0);(u?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(k)}_linkLeave(h,u,f){var x;(x=this._currentLink)!=null&&x.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(u,!1),this._currentLink.state.decorations.pointerCursor&&h.classList.remove("xterm-cursor-pointer")),u.leave&&u.leave(f,u.text)}_linkAtPosition(h,u){const f=h.range.start.y*this._bufferService.cols+h.range.start.x,x=h.range.end.y*this._bufferService.cols+h.range.end.x,k=u.y*this._bufferService.cols+u.x;return f<=k&&k<=x}_positionFromMouseEvent(h,u,f){const x=f.getCoords(h,u,this._bufferService.cols,this._bufferService.rows);if(x)return{x:x[0],y:x[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(h,u,f,x,k){return{x1:h,y1:u,x2:f,y2:x,cols:this._bufferService.cols,fg:k}}};o.Linkifier=p=d([g(1,_.IMouseService),g(2,_.IRenderService),g(3,w.IBufferService),g(4,_.ILinkProviderService)],p)},9042:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.tooMuchOutput=o.promptLabel=void 0,o.promptLabel="Terminal input",o.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(c,o,l){var d=this&&this.__decorate||function(_,p,h,u){var f,x=arguments.length,k=x<3?p:u===null?u=Object.getOwnPropertyDescriptor(p,h):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(_,p,h,u);else for(var C=_.length-1;C>=0;C--)(f=_[C])&&(k=(x<3?f(k):x>3?f(p,h,k):f(p,h))||k);return x>3&&k&&Object.defineProperty(p,h,k),k},g=this&&this.__param||function(_,p){return function(h,u){p(h,u,_)}};Object.defineProperty(o,"__esModule",{value:!0}),o.OscLinkProvider=void 0;const m=l(511),v=l(2585);let y=o.OscLinkProvider=class{constructor(_,p,h){this._bufferService=_,this._optionsService=p,this._oscLinkService=h}provideLinks(_,p){var E;const h=this._bufferService.buffer.lines.get(_-1);if(!h)return void p(void 0);const u=[],f=this._optionsService.rawOptions.linkHandler,x=new m.CellData,k=h.getTrimmedLength();let C=-1,S=-1,b=!1;for(let N=0;N<k;N++)if(S!==-1||h.hasContent(N)){if(h.loadCell(N,x),x.hasExtendedAttrs()&&x.extended.urlId){if(S===-1){S=N,C=x.extended.urlId;continue}b=x.extended.urlId!==C}else S!==-1&&(b=!0);if(b||S!==-1&&N===k-1){const O=(E=this._oscLinkService.getLinkData(C))==null?void 0:E.uri;if(O){const I={start:{x:S+1,y:_},end:{x:N+(b||N!==k-1?0:1),y:_}};let P=!1;if(!(f!=null&&f.allowNonHttpProtocols))try{const U=new URL(O);["http:","https:"].includes(U.protocol)||(P=!0)}catch{P=!0}P||u.push({text:O,range:I,activate:(U,D)=>f?f.activate(U,D,I):w(0,D),hover:(U,D)=>{var H;return(H=f==null?void 0:f.hover)==null?void 0:H.call(f,U,D,I)},leave:(U,D)=>{var H;return(H=f==null?void 0:f.leave)==null?void 0:H.call(f,U,D,I)}})}b=!1,x.hasExtendedAttrs()&&x.extended.urlId?(S=N,C=x.extended.urlId):(S=-1,C=-1)}}p(u)}};function w(_,p){if(confirm(`Do you want to navigate to ${p}?

WARNING: This link could potentially be dangerous`)){const h=window.open();if(h){try{h.opener=null}catch{}h.location.href=p}else console.warn("Opening link blocked as opener could not be cleared")}}o.OscLinkProvider=y=d([g(0,v.IBufferService),g(1,v.IOptionsService),g(2,v.IOscLinkService)],y)},6193:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.RenderDebouncer=void 0,o.RenderDebouncer=class{constructor(l,d){this._renderCallback=l,this._coreBrowserService=d,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(l){return this._refreshCallbacks.push(l),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(l,d,g){this._rowCount=g,l=l!==void 0?l:0,d=d!==void 0?d:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,d):d,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const l=Math.max(this._rowStart,0),d=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,d),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const l of this._refreshCallbacks)l(0);this._refreshCallbacks=[]}}},3236:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Terminal=void 0;const d=l(3614),g=l(3656),m=l(3551),v=l(9042),y=l(3730),w=l(1680),_=l(3107),p=l(5744),h=l(2950),u=l(1296),f=l(428),x=l(4269),k=l(5114),C=l(8934),S=l(3230),b=l(9312),E=l(4725),N=l(6731),O=l(8055),I=l(8969),P=l(8460),U=l(844),D=l(6114),H=l(8437),z=l(2584),B=l(7399),j=l(5941),T=l(9074),L=l(2585),$=l(5435),V=l(4567),J=l(779);class ue extends I.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(F={}){super(F),this.browser=D,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new U.MutableDisposable),this._onCursorMove=this.register(new P.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new P.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new P.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new P.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new P.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new P.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new P.EventEmitter),this._onBlur=this.register(new P.EventEmitter),this._onA11yCharEmitter=this.register(new P.EventEmitter),this._onA11yTabEmitter=this.register(new P.EventEmitter),this._onWillOpen=this.register(new P.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(T.DecorationService),this._instantiationService.setService(L.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(J.LinkProviderService),this._instantiationService.setService(E.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(y.OscLinkProvider)),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((A,K)=>this.refresh(A,K))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(A=>this._reportWindowsOptions(A))),this.register(this._inputHandler.onColor(A=>this._handleColorEvent(A))),this.register((0,P.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,P.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,P.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,P.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(A=>this._afterResize(A.cols,A.rows))),this.register((0,U.toDisposable)(()=>{var A,K;this._customKeyEventHandler=void 0,(K=(A=this.element)==null?void 0:A.parentNode)==null||K.removeChild(this.element)}))}_handleColorEvent(F){if(this._themeService)for(const A of F){let K,q="";switch(A.index){case 256:K="foreground",q="10";break;case 257:K="background",q="11";break;case 258:K="cursor",q="12";break;default:K="ansi",q="4;"+A.index}switch(A.type){case 0:const ee=O.color.toColorRGB(K==="ansi"?this._themeService.colors.ansi[A.index]:this._themeService.colors[K]);this.coreService.triggerDataEvent(`${z.C0.ESC}]${q};${(0,j.toRgbString)(ee)}${z.C1_ESCAPED.ST}`);break;case 1:if(K==="ansi")this._themeService.modifyColors(te=>te.ansi[A.index]=O.channels.toColor(...A.color));else{const te=K;this._themeService.modifyColors(Se=>Se[te]=O.channels.toColor(...A.color))}break;case 2:this._themeService.restoreColor(A.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(F){F?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(V.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(F){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(z.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var F;return(F=this.textarea)==null?void 0:F.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(z.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const F=this.buffer.ybase+this.buffer.y,A=this.buffer.lines.get(F);if(!A)return;const K=Math.min(this.buffer.x,this.cols-1),q=this._renderService.dimensions.css.cell.height,ee=A.getWidth(K),te=this._renderService.dimensions.css.cell.width*ee,Se=this.buffer.y*this._renderService.dimensions.css.cell.height,Ie=K*this._renderService.dimensions.css.cell.width;this.textarea.style.left=Ie+"px",this.textarea.style.top=Se+"px",this.textarea.style.width=te+"px",this.textarea.style.height=q+"px",this.textarea.style.lineHeight=q+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,g.addDisposableDomListener)(this.element,"copy",A=>{this.hasSelection()&&(0,d.copyHandler)(A,this._selectionService)}));const F=A=>(0,d.handlePasteEvent)(A,this.textarea,this.coreService,this.optionsService);this.register((0,g.addDisposableDomListener)(this.textarea,"paste",F)),this.register((0,g.addDisposableDomListener)(this.element,"paste",F)),D.isFirefox?this.register((0,g.addDisposableDomListener)(this.element,"mousedown",A=>{A.button===2&&(0,d.rightClickHandler)(A,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,g.addDisposableDomListener)(this.element,"contextmenu",A=>{(0,d.rightClickHandler)(A,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),D.isLinux&&this.register((0,g.addDisposableDomListener)(this.element,"auxclick",A=>{A.button===1&&(0,d.moveTextAreaUnderMouseCursor)(A,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,g.addDisposableDomListener)(this.textarea,"keyup",F=>this._keyUp(F),!0)),this.register((0,g.addDisposableDomListener)(this.textarea,"keydown",F=>this._keyDown(F),!0)),this.register((0,g.addDisposableDomListener)(this.textarea,"keypress",F=>this._keyPress(F),!0)),this.register((0,g.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,g.addDisposableDomListener)(this.textarea,"compositionupdate",F=>this._compositionHelper.compositionupdate(F))),this.register((0,g.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,g.addDisposableDomListener)(this.textarea,"input",F=>this._inputEvent(F),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(F){var K;if(!F)throw new Error("Terminal requires a parent element.");if(F.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),((K=this.element)==null?void 0:K.ownerDocument.defaultView)&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=F.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),F.appendChild(this.element);const A=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),A.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,g.addDisposableDomListener)(this.screenElement,"mousemove",q=>this.updateCursorStyle(q))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),A.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",v.promptLabel),D.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(k.CoreBrowserService,this.textarea,F.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(E.ICoreBrowserService,this._coreBrowserService),this.register((0,g.addDisposableDomListener)(this.textarea,"focus",q=>this._handleTextAreaFocus(q))),this.register((0,g.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(f.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(E.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(N.ThemeService),this._instantiationService.setService(E.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(x.CharacterJoinerService),this._instantiationService.setService(E.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(S.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(E.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(q=>this._onRender.fire(q))),this.onResize(q=>this._renderService.resize(q.cols,q.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(h.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(C.MouseService),this._instantiationService.setService(E.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(m.Linkifier,this.screenElement)),this.element.appendChild(A);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(w.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(q=>this.scrollLines(q.amount,q.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(b.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(E.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(q=>this.scrollLines(q.amount,q.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(q=>this._renderService.handleSelectionChanged(q.start,q.end,q.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(q=>{this.textarea.value=q,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(q=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,g.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.register(this._instantiationService.createInstance(_.BufferDecorationRenderer,this.screenElement)),this.register((0,g.addDisposableDomListener)(this.element,"mousedown",q=>this._selectionService.handleMouseDown(q))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(V.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",q=>this._handleScreenReaderModeOptionChange(q))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(p.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",q=>{!this._overviewRulerRenderer&&q&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(p.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(u.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const F=this,A=this.element;function K(te){const Se=F._mouseService.getMouseReportCoords(te,F.screenElement);if(!Se)return!1;let Ie,Ee;switch(te.overrideType||te.type){case"mousemove":Ee=32,te.buttons===void 0?(Ie=3,te.button!==void 0&&(Ie=te.button<3?te.button:3)):Ie=1&te.buttons?0:4&te.buttons?1:2&te.buttons?2:3;break;case"mouseup":Ee=0,Ie=te.button<3?te.button:3;break;case"mousedown":Ee=1,Ie=te.button<3?te.button:3;break;case"wheel":if(F._customWheelEventHandler&&F._customWheelEventHandler(te)===!1||F.viewport.getLinesScrolled(te)===0)return!1;Ee=te.deltaY<0?0:1,Ie=4;break;default:return!1}return!(Ee===void 0||Ie===void 0||Ie>4)&&F.coreMouseService.triggerMouseEvent({col:Se.col,row:Se.row,x:Se.x,y:Se.y,button:Ie,action:Ee,ctrl:te.ctrlKey,alt:te.altKey,shift:te.shiftKey})}const q={mouseup:null,wheel:null,mousedrag:null,mousemove:null},ee={mouseup:te=>(K(te),te.buttons||(this._document.removeEventListener("mouseup",q.mouseup),q.mousedrag&&this._document.removeEventListener("mousemove",q.mousedrag)),this.cancel(te)),wheel:te=>(K(te),this.cancel(te,!0)),mousedrag:te=>{te.buttons&&K(te)},mousemove:te=>{te.buttons||K(te)}};this.register(this.coreMouseService.onProtocolChange(te=>{te?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(te)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&te?q.mousemove||(A.addEventListener("mousemove",ee.mousemove),q.mousemove=ee.mousemove):(A.removeEventListener("mousemove",q.mousemove),q.mousemove=null),16&te?q.wheel||(A.addEventListener("wheel",ee.wheel,{passive:!1}),q.wheel=ee.wheel):(A.removeEventListener("wheel",q.wheel),q.wheel=null),2&te?q.mouseup||(q.mouseup=ee.mouseup):(this._document.removeEventListener("mouseup",q.mouseup),q.mouseup=null),4&te?q.mousedrag||(q.mousedrag=ee.mousedrag):(this._document.removeEventListener("mousemove",q.mousedrag),q.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,g.addDisposableDomListener)(A,"mousedown",te=>{if(te.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(te))return K(te),q.mouseup&&this._document.addEventListener("mouseup",q.mouseup),q.mousedrag&&this._document.addEventListener("mousemove",q.mousedrag),this.cancel(te)})),this.register((0,g.addDisposableDomListener)(A,"wheel",te=>{if(!q.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(te)===!1)return!1;if(!this.buffer.hasScrollback){const Se=this.viewport.getLinesScrolled(te);if(Se===0)return;const Ie=z.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(te.deltaY<0?"A":"B");let Ee="";for(let ct=0;ct<Math.abs(Se);ct++)Ee+=Ie;return this.coreService.triggerDataEvent(Ee,!0),this.cancel(te,!0)}return this.viewport.handleWheel(te)?this.cancel(te):void 0}},{passive:!1})),this.register((0,g.addDisposableDomListener)(A,"touchstart",te=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(te),this.cancel(te)},{passive:!0})),this.register((0,g.addDisposableDomListener)(A,"touchmove",te=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(te)?void 0:this.cancel(te)},{passive:!1}))}refresh(F,A){var K;(K=this._renderService)==null||K.refreshRows(F,A)}updateCursorStyle(F){var A;(A=this._selectionService)!=null&&A.shouldColumnSelect(F)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(F,A,K=0){var q;K===1?(super.scrollLines(F,A,K),this.refresh(0,this.rows-1)):(q=this.viewport)==null||q.scrollLines(F)}paste(F){(0,d.paste)(F,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(F){this._customKeyEventHandler=F}attachCustomWheelEventHandler(F){this._customWheelEventHandler=F}registerLinkProvider(F){return this._linkProviderService.registerLinkProvider(F)}registerCharacterJoiner(F){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const A=this._characterJoinerService.register(F);return this.refresh(0,this.rows-1),A}deregisterCharacterJoiner(F){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(F)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(F){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+F)}registerDecoration(F){return this._decorationService.registerDecoration(F)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(F,A,K){this._selectionService.setSelection(F,A,K)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var F;(F=this._selectionService)==null||F.clearSelection()}selectAll(){var F;(F=this._selectionService)==null||F.selectAll()}selectLines(F,A){var K;(K=this._selectionService)==null||K.selectLines(F,A)}_keyDown(F){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(F)===!1)return!1;const A=this.browser.isMac&&this.options.macOptionIsMeta&&F.altKey;if(!A&&!this._compositionHelper.keydown(F))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;A||F.key!=="Dead"&&F.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const K=(0,B.evaluateKeyboardEvent)(F,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(F),K.type===3||K.type===2){const q=this.rows-1;return this.scrollLines(K.type===2?-q:q),this.cancel(F,!0)}return K.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,F)||(K.cancel&&this.cancel(F,!0),!K.key||!!(F.key&&!F.ctrlKey&&!F.altKey&&!F.metaKey&&F.key.length===1&&F.key.charCodeAt(0)>=65&&F.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(K.key!==z.C0.ETX&&K.key!==z.C0.CR||(this.textarea.value=""),this._onKey.fire({key:K.key,domEvent:F}),this._showCursor(),this.coreService.triggerDataEvent(K.key,!0),!this.optionsService.rawOptions.screenReaderMode||F.altKey||F.ctrlKey?this.cancel(F,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(F,A){const K=F.isMac&&!this.options.macOptionIsMeta&&A.altKey&&!A.ctrlKey&&!A.metaKey||F.isWindows&&A.altKey&&A.ctrlKey&&!A.metaKey||F.isWindows&&A.getModifierState("AltGraph");return A.type==="keypress"?K:K&&(!A.keyCode||A.keyCode>47)}_keyUp(F){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(F)===!1||(function(A){return A.keyCode===16||A.keyCode===17||A.keyCode===18}(F)||this.focus(),this.updateCursorStyle(F),this._keyPressHandled=!1)}_keyPress(F){let A;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(F)===!1)return!1;if(this.cancel(F),F.charCode)A=F.charCode;else if(F.which===null||F.which===void 0)A=F.keyCode;else{if(F.which===0||F.charCode===0)return!1;A=F.which}return!(!A||(F.altKey||F.ctrlKey||F.metaKey)&&!this._isThirdLevelShift(this.browser,F)||(A=String.fromCharCode(A),this._onKey.fire({key:A,domEvent:F}),this._showCursor(),this.coreService.triggerDataEvent(A,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(F){if(F.data&&F.inputType==="insertText"&&(!F.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const A=F.data;return this.coreService.triggerDataEvent(A,!0),this.cancel(F),!0}return!1}resize(F,A){F!==this.cols||A!==this.rows?super.resize(F,A):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(F,A){var K,q;(K=this._charSizeService)==null||K.measure(),(q=this.viewport)==null||q.syncScrollArea(!0)}clear(){var F;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let A=1;A<this.rows;A++)this.buffer.lines.push(this.buffer.getBlankLine(H.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(F=this.viewport)==null||F.reset(),this.refresh(0,this.rows-1)}}reset(){var A,K;this.options.rows=this.rows,this.options.cols=this.cols;const F=this._customKeyEventHandler;this._setup(),super.reset(),(A=this._selectionService)==null||A.reset(),this._decorationService.reset(),(K=this.viewport)==null||K.reset(),this._customKeyEventHandler=F,this.refresh(0,this.rows-1)}clearTextureAtlas(){var F;(F=this._renderService)==null||F.clearTextureAtlas()}_reportFocus(){var F;(F=this.element)!=null&&F.classList.contains("focus")?this.coreService.triggerDataEvent(z.C0.ESC+"[I"):this.coreService.triggerDataEvent(z.C0.ESC+"[O")}_reportWindowsOptions(F){if(this._renderService)switch(F){case $.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const A=this._renderService.dimensions.css.canvas.width.toFixed(0),K=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${z.C0.ESC}[4;${K};${A}t`);break;case $.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const q=this._renderService.dimensions.css.cell.width.toFixed(0),ee=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${z.C0.ESC}[6;${ee};${q}t`)}}cancel(F,A){if(this.options.cancelEvents||A)return F.preventDefault(),F.stopPropagation(),!1}}o.Terminal=ue},9924:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TimeBasedDebouncer=void 0,o.TimeBasedDebouncer=class{constructor(l,d=1e3){this._renderCallback=l,this._debounceThresholdMS=d,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(l,d,g){this._rowCount=g,l=l!==void 0?l:0,d=d!==void 0?d:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,d):d;const m=Date.now();if(m-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=m,this._innerRefresh();else if(!this._additionalRefreshRequested){const v=m-this._lastRefreshMs,y=this._debounceThresholdMS-v;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},y)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const l=Math.max(this._rowStart,0),d=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,d)}}},1680:function(c,o,l){var d=this&&this.__decorate||function(h,u,f,x){var k,C=arguments.length,S=C<3?u:x===null?x=Object.getOwnPropertyDescriptor(u,f):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(h,u,f,x);else for(var b=h.length-1;b>=0;b--)(k=h[b])&&(S=(C<3?k(S):C>3?k(u,f,S):k(u,f))||S);return C>3&&S&&Object.defineProperty(u,f,S),S},g=this&&this.__param||function(h,u){return function(f,x){u(f,x,h)}};Object.defineProperty(o,"__esModule",{value:!0}),o.Viewport=void 0;const m=l(3656),v=l(4725),y=l(8460),w=l(844),_=l(2585);let p=o.Viewport=class extends w.Disposable{constructor(h,u,f,x,k,C,S,b){super(),this._viewportElement=h,this._scrollArea=u,this._bufferService=f,this._optionsService=x,this._charSizeService=k,this._renderService=C,this._coreBrowserService=S,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new y.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,m.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(E=>this._activeBuffer=E.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(E=>this._renderDimensions=E)),this._handleThemeChange(b.colors),this.register(b.onChangeColors(E=>this._handleThemeChange(E))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(h){this._viewportElement.style.backgroundColor=h.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(h){if(h)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const u=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==u&&(this._lastRecordedBufferHeight=u,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const h=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==h&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=h),this._refreshAnimationFrame=null}syncScrollArea(h=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(h);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(h)}_handleScroll(h){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const u=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:u,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const h=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(h*(this._smoothScrollState.target-this._smoothScrollState.origin)),h<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(h,u){const f=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(u<0&&this._viewportElement.scrollTop!==0||u>0&&f<this._lastRecordedBufferHeight)||(h.cancelable&&h.preventDefault(),!1)}handleWheel(h){const u=this._getPixelsScrolled(h);return u!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+u:this._smoothScrollState.target+=u,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=u,this._bubbleScroll(h,u))}scrollLines(h){if(h!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const u=h*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+u,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:h,suppressScrollEvent:!1})}_getPixelsScrolled(h){if(h.deltaY===0||h.shiftKey)return 0;let u=this._applyScrollModifier(h.deltaY,h);return h.deltaMode===WheelEvent.DOM_DELTA_LINE?u*=this._currentRowHeight:h.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(u*=this._currentRowHeight*this._bufferService.rows),u}getBufferElements(h,u){var b;let f,x="";const k=[],C=u??this._bufferService.buffer.lines.length,S=this._bufferService.buffer.lines;for(let E=h;E<C;E++){const N=S.get(E);if(!N)continue;const O=(b=S.get(E+1))==null?void 0:b.isWrapped;if(x+=N.translateToString(!O),!O||E===S.length-1){const I=document.createElement("div");I.textContent=x,k.push(I),x.length>0&&(f=I),x=""}}return{bufferElements:k,cursorElement:f}}getLinesScrolled(h){if(h.deltaY===0||h.shiftKey)return 0;let u=this._applyScrollModifier(h.deltaY,h);return h.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(u/=this._currentRowHeight+0,this._wheelPartialScroll+=u,u=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):h.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(u*=this._bufferService.rows),u}_applyScrollModifier(h,u){const f=this._optionsService.rawOptions.fastScrollModifier;return f==="alt"&&u.altKey||f==="ctrl"&&u.ctrlKey||f==="shift"&&u.shiftKey?h*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:h*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(h){this._lastTouchY=h.touches[0].pageY}handleTouchMove(h){const u=this._lastTouchY-h.touches[0].pageY;return this._lastTouchY=h.touches[0].pageY,u!==0&&(this._viewportElement.scrollTop+=u,this._bubbleScroll(h,u))}};o.Viewport=p=d([g(2,_.IBufferService),g(3,_.IOptionsService),g(4,v.ICharSizeService),g(5,v.IRenderService),g(6,v.ICoreBrowserService),g(7,v.IThemeService)],p)},3107:function(c,o,l){var d=this&&this.__decorate||function(_,p,h,u){var f,x=arguments.length,k=x<3?p:u===null?u=Object.getOwnPropertyDescriptor(p,h):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(_,p,h,u);else for(var C=_.length-1;C>=0;C--)(f=_[C])&&(k=(x<3?f(k):x>3?f(p,h,k):f(p,h))||k);return x>3&&k&&Object.defineProperty(p,h,k),k},g=this&&this.__param||function(_,p){return function(h,u){p(h,u,_)}};Object.defineProperty(o,"__esModule",{value:!0}),o.BufferDecorationRenderer=void 0;const m=l(4725),v=l(844),y=l(2585);let w=o.BufferDecorationRenderer=class extends v.Disposable{constructor(_,p,h,u,f){super(),this._screenElement=_,this._bufferService=p,this._coreBrowserService=h,this._decorationService=u,this._renderService=f,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(x=>this._removeDecoration(x))),this.register((0,v.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const _ of this._decorationService.decorations)this._renderDecoration(_);this._dimensionsChanged=!1}_renderDecoration(_){this._refreshStyle(_),this._dimensionsChanged&&this._refreshXPosition(_)}_createElement(_){var u;const p=this._coreBrowserService.mainDocument.createElement("div");p.classList.add("xterm-decoration"),p.classList.toggle("xterm-decoration-top-layer",((u=_==null?void 0:_.options)==null?void 0:u.layer)==="top"),p.style.width=`${Math.round((_.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,p.style.height=(_.options.height||1)*this._renderService.dimensions.css.cell.height+"px",p.style.top=(_.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",p.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const h=_.options.x??0;return h&&h>this._bufferService.cols&&(p.style.display="none"),this._refreshXPosition(_,p),p}_refreshStyle(_){const p=_.marker.line-this._bufferService.buffers.active.ydisp;if(p<0||p>=this._bufferService.rows)_.element&&(_.element.style.display="none",_.onRenderEmitter.fire(_.element));else{let h=this._decorationElements.get(_);h||(h=this._createElement(_),_.element=h,this._decorationElements.set(_,h),this._container.appendChild(h),_.onDispose(()=>{this._decorationElements.delete(_),h.remove()})),h.style.top=p*this._renderService.dimensions.css.cell.height+"px",h.style.display=this._altBufferIsActive?"none":"block",_.onRenderEmitter.fire(h)}}_refreshXPosition(_,p=_.element){if(!p)return;const h=_.options.x??0;(_.options.anchor||"left")==="right"?p.style.right=h?h*this._renderService.dimensions.css.cell.width+"px":"":p.style.left=h?h*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(_){var p;(p=this._decorationElements.get(_))==null||p.remove(),this._decorationElements.delete(_),_.dispose()}};o.BufferDecorationRenderer=w=d([g(1,y.IBufferService),g(2,m.ICoreBrowserService),g(3,y.IDecorationService),g(4,m.IRenderService)],w)},5871:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ColorZoneStore=void 0,o.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(l){if(l.options.overviewRulerOptions){for(const d of this._zones)if(d.color===l.options.overviewRulerOptions.color&&d.position===l.options.overviewRulerOptions.position){if(this._lineIntersectsZone(d,l.marker.line))return;if(this._lineAdjacentToZone(d,l.marker.line,l.options.overviewRulerOptions.position))return void this._addLineToZone(d,l.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=l.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=l.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=l.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=l.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:l.options.overviewRulerOptions.color,position:l.options.overviewRulerOptions.position,startBufferLine:l.marker.line,endBufferLine:l.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(l){this._linePadding=l}_lineIntersectsZone(l,d){return d>=l.startBufferLine&&d<=l.endBufferLine}_lineAdjacentToZone(l,d,g){return d>=l.startBufferLine-this._linePadding[g||"full"]&&d<=l.endBufferLine+this._linePadding[g||"full"]}_addLineToZone(l,d){l.startBufferLine=Math.min(l.startBufferLine,d),l.endBufferLine=Math.max(l.endBufferLine,d)}}},5744:function(c,o,l){var d=this&&this.__decorate||function(f,x,k,C){var S,b=arguments.length,E=b<3?x:C===null?C=Object.getOwnPropertyDescriptor(x,k):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(f,x,k,C);else for(var N=f.length-1;N>=0;N--)(S=f[N])&&(E=(b<3?S(E):b>3?S(x,k,E):S(x,k))||E);return b>3&&E&&Object.defineProperty(x,k,E),E},g=this&&this.__param||function(f,x){return function(k,C){x(k,C,f)}};Object.defineProperty(o,"__esModule",{value:!0}),o.OverviewRulerRenderer=void 0;const m=l(5871),v=l(4725),y=l(844),w=l(2585),_={full:0,left:0,center:0,right:0},p={full:0,left:0,center:0,right:0},h={full:0,left:0,center:0,right:0};let u=o.OverviewRulerRenderer=class extends y.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(f,x,k,C,S,b,E){var O;super(),this._viewportElement=f,this._screenElement=x,this._bufferService=k,this._decorationService=C,this._renderService=S,this._optionsService=b,this._coreBrowserService=E,this._colorZoneStore=new m.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(O=this._viewportElement.parentElement)==null||O.insertBefore(this._canvas,this._viewportElement);const N=this._canvas.getContext("2d");if(!N)throw new Error("Ctx cannot be null");this._ctx=N,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,y.toDisposable)(()=>{var I;(I=this._canvas)==null||I.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const f=Math.floor(this._canvas.width/3),x=Math.ceil(this._canvas.width/3);p.full=this._canvas.width,p.left=f,p.center=x,p.right=f,this._refreshDrawHeightConstants(),h.full=0,h.left=0,h.center=p.left,h.right=p.left+p.center}_refreshDrawHeightConstants(){_.full=Math.round(2*this._coreBrowserService.dpr);const f=this._canvas.height/this._bufferService.buffer.lines.length,x=Math.round(Math.max(Math.min(f,12),6)*this._coreBrowserService.dpr);_.left=x,_.center=x,_.right=x}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const x of this._decorationService.decorations)this._colorZoneStore.addDecoration(x);this._ctx.lineWidth=1;const f=this._colorZoneStore.zones;for(const x of f)x.position!=="full"&&this._renderColorZone(x);for(const x of f)x.position==="full"&&this._renderColorZone(x);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(f){this._ctx.fillStyle=f.color,this._ctx.fillRect(h[f.position||"full"],Math.round((this._canvas.height-1)*(f.startBufferLine/this._bufferService.buffers.active.lines.length)-_[f.position||"full"]/2),p[f.position||"full"],Math.round((this._canvas.height-1)*((f.endBufferLine-f.startBufferLine)/this._bufferService.buffers.active.lines.length)+_[f.position||"full"]))}_queueRefresh(f,x){this._shouldUpdateDimensions=f||this._shouldUpdateDimensions,this._shouldUpdateAnchor=x||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};o.OverviewRulerRenderer=u=d([g(2,w.IBufferService),g(3,w.IDecorationService),g(4,v.IRenderService),g(5,w.IOptionsService),g(6,v.ICoreBrowserService)],u)},2950:function(c,o,l){var d=this&&this.__decorate||function(_,p,h,u){var f,x=arguments.length,k=x<3?p:u===null?u=Object.getOwnPropertyDescriptor(p,h):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(_,p,h,u);else for(var C=_.length-1;C>=0;C--)(f=_[C])&&(k=(x<3?f(k):x>3?f(p,h,k):f(p,h))||k);return x>3&&k&&Object.defineProperty(p,h,k),k},g=this&&this.__param||function(_,p){return function(h,u){p(h,u,_)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CompositionHelper=void 0;const m=l(4725),v=l(2585),y=l(2584);let w=o.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(_,p,h,u,f,x){this._textarea=_,this._compositionView=p,this._bufferService=h,this._optionsService=u,this._coreService=f,this._renderService=x,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(_){this._compositionView.textContent=_.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(_){if(this._isComposing||this._isSendingComposition){if(_.keyCode===229||_.keyCode===16||_.keyCode===17||_.keyCode===18)return!1;this._finalizeComposition(!1)}return _.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(_){if(this._compositionView.classList.remove("active"),this._isComposing=!1,_){const p={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let h;this._isSendingComposition=!1,p.start+=this._dataAlreadySent.length,h=this._isComposing?this._textarea.value.substring(p.start,p.end):this._textarea.value.substring(p.start),h.length>0&&this._coreService.triggerDataEvent(h,!0)}},0)}else{this._isSendingComposition=!1;const p=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(p,!0)}}_handleAnyTextareaChanges(){const _=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const p=this._textarea.value,h=p.replace(_,"");this._dataAlreadySent=h,p.length>_.length?this._coreService.triggerDataEvent(h,!0):p.length<_.length?this._coreService.triggerDataEvent(`${y.C0.DEL}`,!0):p.length===_.length&&p!==_&&this._coreService.triggerDataEvent(p,!0)}},0)}updateCompositionElements(_){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const p=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),h=this._renderService.dimensions.css.cell.height,u=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,f=p*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=f+"px",this._compositionView.style.top=u+"px",this._compositionView.style.height=h+"px",this._compositionView.style.lineHeight=h+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const x=this._compositionView.getBoundingClientRect();this._textarea.style.left=f+"px",this._textarea.style.top=u+"px",this._textarea.style.width=Math.max(x.width,1)+"px",this._textarea.style.height=Math.max(x.height,1)+"px",this._textarea.style.lineHeight=x.height+"px"}_||setTimeout(()=>this.updateCompositionElements(!0),0)}}};o.CompositionHelper=w=d([g(2,v.IBufferService),g(3,v.IOptionsService),g(4,v.ICoreService),g(5,m.IRenderService)],w)},9806:(c,o)=>{function l(d,g,m){const v=m.getBoundingClientRect(),y=d.getComputedStyle(m),w=parseInt(y.getPropertyValue("padding-left")),_=parseInt(y.getPropertyValue("padding-top"));return[g.clientX-v.left-w,g.clientY-v.top-_]}Object.defineProperty(o,"__esModule",{value:!0}),o.getCoords=o.getCoordsRelativeToElement=void 0,o.getCoordsRelativeToElement=l,o.getCoords=function(d,g,m,v,y,w,_,p,h){if(!w)return;const u=l(d,g,m);return u?(u[0]=Math.ceil((u[0]+(h?_/2:0))/_),u[1]=Math.ceil(u[1]/p),u[0]=Math.min(Math.max(u[0],1),v+(h?1:0)),u[1]=Math.min(Math.max(u[1],1),y),u):void 0}},9504:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.moveToCellSequence=void 0;const d=l(2584);function g(p,h,u,f){const x=p-m(p,u),k=h-m(h,u),C=Math.abs(x-k)-function(S,b,E){let N=0;const O=S-m(S,E),I=b-m(b,E);for(let P=0;P<Math.abs(O-I);P++){const U=v(S,b)==="A"?-1:1,D=E.buffer.lines.get(O+U*P);D!=null&&D.isWrapped&&N++}return N}(p,h,u);return _(C,w(v(p,h),f))}function m(p,h){let u=0,f=h.buffer.lines.get(p),x=f==null?void 0:f.isWrapped;for(;x&&p>=0&&p<h.rows;)u++,f=h.buffer.lines.get(--p),x=f==null?void 0:f.isWrapped;return u}function v(p,h){return p>h?"A":"B"}function y(p,h,u,f,x,k){let C=p,S=h,b="";for(;C!==u||S!==f;)C+=x?1:-1,x&&C>k.cols-1?(b+=k.buffer.translateBufferLineToString(S,!1,p,C),C=0,p=0,S++):!x&&C<0&&(b+=k.buffer.translateBufferLineToString(S,!1,0,p+1),C=k.cols-1,p=C,S--);return b+k.buffer.translateBufferLineToString(S,!1,p,C)}function w(p,h){const u=h?"O":"[";return d.C0.ESC+u+p}function _(p,h){p=Math.floor(p);let u="";for(let f=0;f<p;f++)u+=h;return u}o.moveToCellSequence=function(p,h,u,f){const x=u.buffer.x,k=u.buffer.y;if(!u.buffer.hasScrollback)return function(b,E,N,O,I,P){return g(E,O,I,P).length===0?"":_(y(b,E,b,E-m(E,I),!1,I).length,w("D",P))}(x,k,0,h,u,f)+g(k,h,u,f)+function(b,E,N,O,I,P){let U;U=g(E,O,I,P).length>0?O-m(O,I):E;const D=O,H=function(z,B,j,T,L,$){let V;return V=g(j,T,L,$).length>0?T-m(T,L):B,z<j&&V<=T||z>=j&&V<T?"C":"D"}(b,E,N,O,I,P);return _(y(b,U,N,D,H==="C",I).length,w(H,P))}(x,k,p,h,u,f);let C;if(k===h)return C=x>p?"D":"C",_(Math.abs(x-p),w(C,f));C=k>h?"D":"C";const S=Math.abs(k-h);return _(function(b,E){return E.cols-b}(k>h?p:x,u)+(S-1)*u.cols+1+((k>h?x:p)-1),w(C,f))}},1296:function(c,o,l){var d=this&&this.__decorate||function(P,U,D,H){var z,B=arguments.length,j=B<3?U:H===null?H=Object.getOwnPropertyDescriptor(U,D):H;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")j=Reflect.decorate(P,U,D,H);else for(var T=P.length-1;T>=0;T--)(z=P[T])&&(j=(B<3?z(j):B>3?z(U,D,j):z(U,D))||j);return B>3&&j&&Object.defineProperty(U,D,j),j},g=this&&this.__param||function(P,U){return function(D,H){U(D,H,P)}};Object.defineProperty(o,"__esModule",{value:!0}),o.DomRenderer=void 0;const m=l(3787),v=l(2550),y=l(2223),w=l(6171),_=l(6052),p=l(4725),h=l(8055),u=l(8460),f=l(844),x=l(2585),k="xterm-dom-renderer-owner-",C="xterm-rows",S="xterm-fg-",b="xterm-bg-",E="xterm-focus",N="xterm-selection";let O=1,I=o.DomRenderer=class extends f.Disposable{constructor(P,U,D,H,z,B,j,T,L,$,V,J,ue){super(),this._terminal=P,this._document=U,this._element=D,this._screenElement=H,this._viewportElement=z,this._helperContainer=B,this._linkifier2=j,this._charSizeService=L,this._optionsService=$,this._bufferService=V,this._coreBrowserService=J,this._themeService=ue,this._terminalClass=O++,this._rowElements=[],this._selectionRenderModel=(0,_.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new u.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(C),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(N),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,w.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(he=>this._injectCss(he))),this._injectCss(this._themeService.colors),this._rowFactory=T.createInstance(m.DomRendererRowFactory,document),this._element.classList.add(k+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(he=>this._handleLinkHover(he))),this.register(this._linkifier2.onHideLinkUnderline(he=>this._handleLinkLeave(he))),this.register((0,f.toDisposable)(()=>{this._element.classList.remove(k+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new v.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const P=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*P,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*P),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/P),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/P),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const D of this._rowElements)D.style.width=`${this.dimensions.css.canvas.width}px`,D.style.height=`${this.dimensions.css.cell.height}px`,D.style.lineHeight=`${this.dimensions.css.cell.height}px`,D.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const U=`${this._terminalSelector} .${C} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=U,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(P){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let U=`${this._terminalSelector} .${C} { color: ${P.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;U+=`${this._terminalSelector} .${C} .xterm-dim { color: ${h.color.multiplyOpacity(P.foreground,.5).css};}`,U+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const D=`blink_underline_${this._terminalClass}`,H=`blink_bar_${this._terminalClass}`,z=`blink_block_${this._terminalClass}`;U+=`@keyframes ${D} { 50% {  border-bottom-style: hidden; }}`,U+=`@keyframes ${H} { 50% {  box-shadow: none; }}`,U+=`@keyframes ${z} { 0% {  background-color: ${P.cursor.css};  color: ${P.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${P.cursor.css}; }}`,U+=`${this._terminalSelector} .${C}.${E} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${D} 1s step-end infinite;}${this._terminalSelector} .${C}.${E} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${H} 1s step-end infinite;}${this._terminalSelector} .${C}.${E} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${z} 1s step-end infinite;}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-block { background-color: ${P.cursor.css}; color: ${P.cursorAccent.css};}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${P.cursor.css} !important; color: ${P.cursorAccent.css} !important;}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${P.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${P.cursor.css} inset;}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${P.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,U+=`${this._terminalSelector} .${N} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${N} div { position: absolute; background-color: ${P.selectionBackgroundOpaque.css};}${this._terminalSelector} .${N} div { position: absolute; background-color: ${P.selectionInactiveBackgroundOpaque.css};}`;for(const[B,j]of P.ansi.entries())U+=`${this._terminalSelector} .${S}${B} { color: ${j.css}; }${this._terminalSelector} .${S}${B}.xterm-dim { color: ${h.color.multiplyOpacity(j,.5).css}; }${this._terminalSelector} .${b}${B} { background-color: ${j.css}; }`;U+=`${this._terminalSelector} .${S}${y.INVERTED_DEFAULT_COLOR} { color: ${h.color.opaque(P.background).css}; }${this._terminalSelector} .${S}${y.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${h.color.multiplyOpacity(h.color.opaque(P.background),.5).css}; }${this._terminalSelector} .${b}${y.INVERTED_DEFAULT_COLOR} { background-color: ${P.foreground.css}; }`,this._themeStyleElement.textContent=U}_setDefaultSpacing(){const P=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${P}px`,this._rowFactory.defaultSpacing=P}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(P,U){for(let D=this._rowElements.length;D<=U;D++){const H=this._document.createElement("div");this._rowContainer.appendChild(H),this._rowElements.push(H)}for(;this._rowElements.length>U;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(P,U){this._refreshRowElements(P,U),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(E),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(E),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(P,U,D){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(P,U,D),this.renderRows(0,this._bufferService.rows-1),!P||!U)return;this._selectionRenderModel.update(this._terminal,P,U,D);const H=this._selectionRenderModel.viewportStartRow,z=this._selectionRenderModel.viewportEndRow,B=this._selectionRenderModel.viewportCappedStartRow,j=this._selectionRenderModel.viewportCappedEndRow;if(B>=this._bufferService.rows||j<0)return;const T=this._document.createDocumentFragment();if(D){const L=P[0]>U[0];T.appendChild(this._createSelectionElement(B,L?U[0]:P[0],L?P[0]:U[0],j-B+1))}else{const L=H===B?P[0]:0,$=B===z?U[0]:this._bufferService.cols;T.appendChild(this._createSelectionElement(B,L,$));const V=j-B-1;if(T.appendChild(this._createSelectionElement(B+1,0,this._bufferService.cols,V)),B!==j){const J=z===j?U[0]:this._bufferService.cols;T.appendChild(this._createSelectionElement(j,0,J))}}this._selectionContainer.appendChild(T)}_createSelectionElement(P,U,D,H=1){const z=this._document.createElement("div"),B=U*this.dimensions.css.cell.width;let j=this.dimensions.css.cell.width*(D-U);return B+j>this.dimensions.css.canvas.width&&(j=this.dimensions.css.canvas.width-B),z.style.height=H*this.dimensions.css.cell.height+"px",z.style.top=P*this.dimensions.css.cell.height+"px",z.style.left=`${B}px`,z.style.width=`${j}px`,z}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const P of this._rowElements)P.replaceChildren()}renderRows(P,U){const D=this._bufferService.buffer,H=D.ybase+D.y,z=Math.min(D.x,this._bufferService.cols-1),B=this._optionsService.rawOptions.cursorBlink,j=this._optionsService.rawOptions.cursorStyle,T=this._optionsService.rawOptions.cursorInactiveStyle;for(let L=P;L<=U;L++){const $=L+D.ydisp,V=this._rowElements[L],J=D.lines.get($);if(!V||!J)break;V.replaceChildren(...this._rowFactory.createRow(J,$,$===H,j,T,z,B,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${k}${this._terminalClass}`}_handleLinkHover(P){this._setCellUnderline(P.x1,P.x2,P.y1,P.y2,P.cols,!0)}_handleLinkLeave(P){this._setCellUnderline(P.x1,P.x2,P.y1,P.y2,P.cols,!1)}_setCellUnderline(P,U,D,H,z,B){D<0&&(P=0),H<0&&(U=0);const j=this._bufferService.rows-1;D=Math.max(Math.min(D,j),0),H=Math.max(Math.min(H,j),0),z=Math.min(z,this._bufferService.cols);const T=this._bufferService.buffer,L=T.ybase+T.y,$=Math.min(T.x,z-1),V=this._optionsService.rawOptions.cursorBlink,J=this._optionsService.rawOptions.cursorStyle,ue=this._optionsService.rawOptions.cursorInactiveStyle;for(let he=D;he<=H;++he){const F=he+T.ydisp,A=this._rowElements[he],K=T.lines.get(F);if(!A||!K)break;A.replaceChildren(...this._rowFactory.createRow(K,F,F===L,J,ue,$,V,this.dimensions.css.cell.width,this._widthCache,B?he===D?P:0:-1,B?(he===H?U:z)-1:-1))}}};o.DomRenderer=I=d([g(7,x.IInstantiationService),g(8,p.ICharSizeService),g(9,x.IOptionsService),g(10,x.IBufferService),g(11,p.ICoreBrowserService),g(12,p.IThemeService)],I)},3787:function(c,o,l){var d=this&&this.__decorate||function(C,S,b,E){var N,O=arguments.length,I=O<3?S:E===null?E=Object.getOwnPropertyDescriptor(S,b):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(C,S,b,E);else for(var P=C.length-1;P>=0;P--)(N=C[P])&&(I=(O<3?N(I):O>3?N(S,b,I):N(S,b))||I);return O>3&&I&&Object.defineProperty(S,b,I),I},g=this&&this.__param||function(C,S){return function(b,E){S(b,E,C)}};Object.defineProperty(o,"__esModule",{value:!0}),o.DomRendererRowFactory=void 0;const m=l(2223),v=l(643),y=l(511),w=l(2585),_=l(8055),p=l(4725),h=l(4269),u=l(6171),f=l(3734);let x=o.DomRendererRowFactory=class{constructor(C,S,b,E,N,O,I){this._document=C,this._characterJoinerService=S,this._optionsService=b,this._coreBrowserService=E,this._coreService=N,this._decorationService=O,this._themeService=I,this._workCell=new y.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(C,S,b){this._selectionStart=C,this._selectionEnd=S,this._columnSelectMode=b}createRow(C,S,b,E,N,O,I,P,U,D,H){const z=[],B=this._characterJoinerService.getJoinedCharacters(S),j=this._themeService.colors;let T,L=C.getNoBgTrimmedLength();b&&L<O+1&&(L=O+1);let $=0,V="",J=0,ue=0,he=0,F=!1,A=0,K=!1,q=0;const ee=[],te=D!==-1&&H!==-1;for(let Se=0;Se<L;Se++){C.loadCell(Se,this._workCell);let Ie=this._workCell.getWidth();if(Ie===0)continue;let Ee=!1,ct=Se,G=this._workCell;if(B.length>0&&Se===B[0][0]){Ee=!0;const De=B.shift();G=new h.JoinedCellData(this._workCell,C.translateToString(!0,De[0],De[1]),De[1]-De[0]),ct=De[1]-1,Ie=G.getWidth()}const X=this._isCellInSelection(Se,S),pt=b&&Se===O,Jr=te&&Se>=D&&Se<=H;let ri=!1;this._decorationService.forEachDecorationAtCell(Se,S,void 0,De=>{ri=!0});let $t=G.getChars()||v.WHITESPACE_CELL_CHAR;if($t===" "&&(G.isUnderline()||G.isOverline())&&($t=""),q=Ie*P-U.get($t,G.isBold(),G.isItalic()),T){if($&&(X&&K||!X&&!K&&G.bg===J)&&(X&&K&&j.selectionForeground||G.fg===ue)&&G.extended.ext===he&&Jr===F&&q===A&&!pt&&!Ee&&!ri){G.isInvisible()?V+=v.WHITESPACE_CELL_CHAR:V+=$t,$++;continue}$&&(T.textContent=V),T=this._document.createElement("span"),$=0,V=""}else T=this._document.createElement("span");if(J=G.bg,ue=G.fg,he=G.extended.ext,F=Jr,A=q,K=X,Ee&&O>=Se&&O<=ct&&(O=Se),!this._coreService.isCursorHidden&&pt&&this._coreService.isCursorInitialized){if(ee.push("xterm-cursor"),this._coreBrowserService.isFocused)I&&ee.push("xterm-cursor-blink"),ee.push(E==="bar"?"xterm-cursor-bar":E==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(N)switch(N){case"outline":ee.push("xterm-cursor-outline");break;case"block":ee.push("xterm-cursor-block");break;case"bar":ee.push("xterm-cursor-bar");break;case"underline":ee.push("xterm-cursor-underline")}}if(G.isBold()&&ee.push("xterm-bold"),G.isItalic()&&ee.push("xterm-italic"),G.isDim()&&ee.push("xterm-dim"),V=G.isInvisible()?v.WHITESPACE_CELL_CHAR:G.getChars()||v.WHITESPACE_CELL_CHAR,G.isUnderline()&&(ee.push(`xterm-underline-${G.extended.underlineStyle}`),V===" "&&(V=""),!G.isUnderlineColorDefault()))if(G.isUnderlineColorRGB())T.style.textDecorationColor=`rgb(${f.AttributeData.toColorRGB(G.getUnderlineColor()).join(",")})`;else{let De=G.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&G.isBold()&&De<8&&(De+=8),T.style.textDecorationColor=j.ansi[De].css}G.isOverline()&&(ee.push("xterm-overline"),V===" "&&(V="")),G.isStrikethrough()&&ee.push("xterm-strikethrough"),Jr&&(T.style.textDecoration="underline");let Nt=G.getFgColor(),Qr=G.getFgColorMode(),cr=G.getBgColor(),fn=G.getBgColorMode();const si=!!G.isInverse();if(si){const De=Nt;Nt=cr,cr=De;const jo=Qr;Qr=fn,fn=jo}let St,pn,ur,mn=!1;switch(this._decorationService.forEachDecorationAtCell(Se,S,void 0,De=>{De.options.layer!=="top"&&mn||(De.backgroundColorRGB&&(fn=50331648,cr=De.backgroundColorRGB.rgba>>8&16777215,St=De.backgroundColorRGB),De.foregroundColorRGB&&(Qr=50331648,Nt=De.foregroundColorRGB.rgba>>8&16777215,pn=De.foregroundColorRGB),mn=De.options.layer==="top")}),!mn&&X&&(St=this._coreBrowserService.isFocused?j.selectionBackgroundOpaque:j.selectionInactiveBackgroundOpaque,cr=St.rgba>>8&16777215,fn=50331648,mn=!0,j.selectionForeground&&(Qr=50331648,Nt=j.selectionForeground.rgba>>8&16777215,pn=j.selectionForeground)),mn&&ee.push("xterm-decoration-top"),fn){case 16777216:case 33554432:ur=j.ansi[cr],ee.push(`xterm-bg-${cr}`);break;case 50331648:ur=_.channels.toColor(cr>>16,cr>>8&255,255&cr),this._addStyle(T,`background-color:#${k((cr>>>0).toString(16),"0",6)}`);break;default:si?(ur=j.foreground,ee.push(`xterm-bg-${m.INVERTED_DEFAULT_COLOR}`)):ur=j.background}switch(St||G.isDim()&&(St=_.color.multiplyOpacity(ur,.5)),Qr){case 16777216:case 33554432:G.isBold()&&Nt<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(Nt+=8),this._applyMinimumContrast(T,ur,j.ansi[Nt],G,St,void 0)||ee.push(`xterm-fg-${Nt}`);break;case 50331648:const De=_.channels.toColor(Nt>>16&255,Nt>>8&255,255&Nt);this._applyMinimumContrast(T,ur,De,G,St,pn)||this._addStyle(T,`color:#${k(Nt.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(T,ur,j.foreground,G,St,pn)||si&&ee.push(`xterm-fg-${m.INVERTED_DEFAULT_COLOR}`)}ee.length&&(T.className=ee.join(" "),ee.length=0),pt||Ee||ri?T.textContent=V:$++,q!==this.defaultSpacing&&(T.style.letterSpacing=`${q}px`),z.push(T),Se=ct}return T&&$&&(T.textContent=V),z}_applyMinimumContrast(C,S,b,E,N,O){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,u.treatGlyphAsBackgroundColor)(E.getCode()))return!1;const I=this._getContrastCache(E);let P;if(N||O||(P=I.getColor(S.rgba,b.rgba)),P===void 0){const U=this._optionsService.rawOptions.minimumContrastRatio/(E.isDim()?2:1);P=_.color.ensureContrastRatio(N||S,O||b,U),I.setColor((N||S).rgba,(O||b).rgba,P??null)}return!!P&&(this._addStyle(C,`color:${P.css}`),!0)}_getContrastCache(C){return C.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(C,S){C.setAttribute("style",`${C.getAttribute("style")||""}${S};`)}_isCellInSelection(C,S){const b=this._selectionStart,E=this._selectionEnd;return!(!b||!E)&&(this._columnSelectMode?b[0]<=E[0]?C>=b[0]&&S>=b[1]&&C<E[0]&&S<=E[1]:C<b[0]&&S>=b[1]&&C>=E[0]&&S<=E[1]:S>b[1]&&S<E[1]||b[1]===E[1]&&S===b[1]&&C>=b[0]&&C<E[0]||b[1]<E[1]&&S===E[1]&&C<E[0]||b[1]<E[1]&&S===b[1]&&C>=b[0])}};function k(C,S,b){for(;C.length<b;)C=S+C;return C}o.DomRendererRowFactory=x=d([g(1,p.ICharacterJoinerService),g(2,w.IOptionsService),g(3,p.ICoreBrowserService),g(4,w.ICoreService),g(5,w.IDecorationService),g(6,p.IThemeService)],x)},2550:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.WidthCache=void 0,o.WidthCache=class{constructor(l,d){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=l.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const g=l.createElement("span");g.classList.add("xterm-char-measure-element");const m=l.createElement("span");m.classList.add("xterm-char-measure-element"),m.style.fontWeight="bold";const v=l.createElement("span");v.classList.add("xterm-char-measure-element"),v.style.fontStyle="italic";const y=l.createElement("span");y.classList.add("xterm-char-measure-element"),y.style.fontWeight="bold",y.style.fontStyle="italic",this._measureElements=[g,m,v,y],this._container.appendChild(g),this._container.appendChild(m),this._container.appendChild(v),this._container.appendChild(y),d.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(l,d,g,m){l===this._font&&d===this._fontSize&&g===this._weight&&m===this._weightBold||(this._font=l,this._fontSize=d,this._weight=g,this._weightBold=m,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${g}`,this._measureElements[1].style.fontWeight=`${m}`,this._measureElements[2].style.fontWeight=`${g}`,this._measureElements[3].style.fontWeight=`${m}`,this.clear())}get(l,d,g){let m=0;if(!d&&!g&&l.length===1&&(m=l.charCodeAt(0))<256){if(this._flat[m]!==-9999)return this._flat[m];const w=this._measure(l,0);return w>0&&(this._flat[m]=w),w}let v=l;d&&(v+="B"),g&&(v+="I");let y=this._holey.get(v);if(y===void 0){let w=0;d&&(w|=1),g&&(w|=2),y=this._measure(l,w),y>0&&this._holey.set(v,y)}return y}_measure(l,d){const g=this._measureElements[d];return g.textContent=l.repeat(32),g.offsetWidth/32}}},2223:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TEXT_BASELINE=o.DIM_OPACITY=o.INVERTED_DEFAULT_COLOR=void 0;const d=l(6114);o.INVERTED_DEFAULT_COLOR=257,o.DIM_OPACITY=.5,o.TEXT_BASELINE=d.isFirefox||d.isLegacyEdge?"bottom":"ideographic"},6171:(c,o)=>{function l(g){return 57508<=g&&g<=57558}function d(g){return g>=128512&&g<=128591||g>=127744&&g<=128511||g>=128640&&g<=128767||g>=9728&&g<=9983||g>=9984&&g<=10175||g>=65024&&g<=65039||g>=129280&&g<=129535||g>=127462&&g<=127487}Object.defineProperty(o,"__esModule",{value:!0}),o.computeNextVariantOffset=o.createRenderDimensions=o.treatGlyphAsBackgroundColor=o.allowRescaling=o.isEmoji=o.isRestrictedPowerlineGlyph=o.isPowerlineGlyph=o.throwIfFalsy=void 0,o.throwIfFalsy=function(g){if(!g)throw new Error("value must not be falsy");return g},o.isPowerlineGlyph=l,o.isRestrictedPowerlineGlyph=function(g){return 57520<=g&&g<=57527},o.isEmoji=d,o.allowRescaling=function(g,m,v,y){return m===1&&v>Math.ceil(1.5*y)&&g!==void 0&&g>255&&!d(g)&&!l(g)&&!function(w){return 57344<=w&&w<=63743}(g)},o.treatGlyphAsBackgroundColor=function(g){return l(g)||function(m){return 9472<=m&&m<=9631}(g)},o.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},o.computeNextVariantOffset=function(g,m,v=0){return(g-(2*Math.round(m)-v))%(2*Math.round(m))}},6052:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.createSelectionRenderModel=void 0;class l{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(g,m,v,y=!1){if(this.selectionStart=m,this.selectionEnd=v,!m||!v||m[0]===v[0]&&m[1]===v[1])return void this.clear();const w=g.buffers.active.ydisp,_=m[1]-w,p=v[1]-w,h=Math.max(_,0),u=Math.min(p,g.rows-1);h>=g.rows||u<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=y,this.viewportStartRow=_,this.viewportEndRow=p,this.viewportCappedStartRow=h,this.viewportCappedEndRow=u,this.startCol=m[0],this.endCol=v[0])}isCellSelected(g,m,v){return!!this.hasSelection&&(v-=g.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?m>=this.startCol&&v>=this.viewportCappedStartRow&&m<this.endCol&&v<=this.viewportCappedEndRow:m<this.startCol&&v>=this.viewportCappedStartRow&&m>=this.endCol&&v<=this.viewportCappedEndRow:v>this.viewportStartRow&&v<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&v===this.viewportStartRow&&m>=this.startCol&&m<this.endCol||this.viewportStartRow<this.viewportEndRow&&v===this.viewportEndRow&&m<this.endCol||this.viewportStartRow<this.viewportEndRow&&v===this.viewportStartRow&&m>=this.startCol)}}o.createSelectionRenderModel=function(){return new l}},456:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.SelectionModel=void 0,o.SelectionModel=class{constructor(l){this._bufferService=l,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?l%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)-1]:[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[l,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[Math.max(l,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const l=this.selectionStart,d=this.selectionEnd;return!(!l||!d)&&(l[1]>d[1]||l[1]===d[1]&&l[0]>d[0])}handleTrim(l){return this.selectionStart&&(this.selectionStart[1]-=l),this.selectionEnd&&(this.selectionEnd[1]-=l),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(c,o,l){var d=this&&this.__decorate||function(u,f,x,k){var C,S=arguments.length,b=S<3?f:k===null?k=Object.getOwnPropertyDescriptor(f,x):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(u,f,x,k);else for(var E=u.length-1;E>=0;E--)(C=u[E])&&(b=(S<3?C(b):S>3?C(f,x,b):C(f,x))||b);return S>3&&b&&Object.defineProperty(f,x,b),b},g=this&&this.__param||function(u,f){return function(x,k){f(x,k,u)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CharSizeService=void 0;const m=l(2585),v=l(8460),y=l(844);let w=o.CharSizeService=class extends y.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(u,f,x){super(),this._optionsService=x,this.width=0,this.height=0,this._onCharSizeChange=this.register(new v.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new h(this._optionsService))}catch{this._measureStrategy=this.register(new p(u,f,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const u=this._measureStrategy.measure();u.width===this.width&&u.height===this.height||(this.width=u.width,this.height=u.height,this._onCharSizeChange.fire())}};o.CharSizeService=w=d([g(2,m.IOptionsService)],w);class _ extends y.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(f,x){f!==void 0&&f>0&&x!==void 0&&x>0&&(this._result.width=f,this._result.height=x)}}class p extends _{constructor(f,x,k){super(),this._document=f,this._parentElement=x,this._optionsService=k,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class h extends _{constructor(f){super(),this._optionsService=f,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const x=this._ctx.measureText("W");if(!("width"in x&&"fontBoundingBoxAscent"in x&&"fontBoundingBoxDescent"in x))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const f=this._ctx.measureText("W");return this._validateAndSet(f.width,f.fontBoundingBoxAscent+f.fontBoundingBoxDescent),this._result}}},4269:function(c,o,l){var d=this&&this.__decorate||function(h,u,f,x){var k,C=arguments.length,S=C<3?u:x===null?x=Object.getOwnPropertyDescriptor(u,f):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(h,u,f,x);else for(var b=h.length-1;b>=0;b--)(k=h[b])&&(S=(C<3?k(S):C>3?k(u,f,S):k(u,f))||S);return C>3&&S&&Object.defineProperty(u,f,S),S},g=this&&this.__param||function(h,u){return function(f,x){u(f,x,h)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CharacterJoinerService=o.JoinedCellData=void 0;const m=l(3734),v=l(643),y=l(511),w=l(2585);class _ extends m.AttributeData{constructor(u,f,x){super(),this.content=0,this.combinedData="",this.fg=u.fg,this.bg=u.bg,this.combinedData=f,this._width=x}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(u){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}o.JoinedCellData=_;let p=o.CharacterJoinerService=class Ax{constructor(u){this._bufferService=u,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new y.CellData}register(u){const f={id:this._nextCharacterJoinerId++,handler:u};return this._characterJoiners.push(f),f.id}deregister(u){for(let f=0;f<this._characterJoiners.length;f++)if(this._characterJoiners[f].id===u)return this._characterJoiners.splice(f,1),!0;return!1}getJoinedCharacters(u){if(this._characterJoiners.length===0)return[];const f=this._bufferService.buffer.lines.get(u);if(!f||f.length===0)return[];const x=[],k=f.translateToString(!0);let C=0,S=0,b=0,E=f.getFg(0),N=f.getBg(0);for(let O=0;O<f.getTrimmedLength();O++)if(f.loadCell(O,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==E||this._workCell.bg!==N){if(O-C>1){const I=this._getJoinedRanges(k,b,S,f,C);for(let P=0;P<I.length;P++)x.push(I[P])}C=O,b=S,E=this._workCell.fg,N=this._workCell.bg}S+=this._workCell.getChars().length||v.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-C>1){const O=this._getJoinedRanges(k,b,S,f,C);for(let I=0;I<O.length;I++)x.push(O[I])}return x}_getJoinedRanges(u,f,x,k,C){const S=u.substring(f,x);let b=[];try{b=this._characterJoiners[0].handler(S)}catch(E){console.error(E)}for(let E=1;E<this._characterJoiners.length;E++)try{const N=this._characterJoiners[E].handler(S);for(let O=0;O<N.length;O++)Ax._mergeRanges(b,N[O])}catch(N){console.error(N)}return this._stringRangesToCellRanges(b,k,C),b}_stringRangesToCellRanges(u,f,x){let k=0,C=!1,S=0,b=u[k];if(b){for(let E=x;E<this._bufferService.cols;E++){const N=f.getWidth(E),O=f.getString(E).length||v.WHITESPACE_CELL_CHAR.length;if(N!==0){if(!C&&b[0]<=S&&(b[0]=E,C=!0),b[1]<=S){if(b[1]=E,b=u[++k],!b)break;b[0]<=S?(b[0]=E,C=!0):C=!1}S+=O}}b&&(b[1]=this._bufferService.cols)}}static _mergeRanges(u,f){let x=!1;for(let k=0;k<u.length;k++){const C=u[k];if(x){if(f[1]<=C[0])return u[k-1][1]=f[1],u;if(f[1]<=C[1])return u[k-1][1]=Math.max(f[1],C[1]),u.splice(k,1),u;u.splice(k,1),k--}else{if(f[1]<=C[0])return u.splice(k,0,f),u;if(f[1]<=C[1])return C[0]=Math.min(f[0],C[0]),u;f[0]<C[1]&&(C[0]=Math.min(f[0],C[0]),x=!0)}}return x?u[u.length-1][1]=f[1]:u.push(f),u}};o.CharacterJoinerService=p=d([g(0,w.IBufferService)],p)},5114:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CoreBrowserService=void 0;const d=l(844),g=l(8460),m=l(3656);class v extends d.Disposable{constructor(_,p,h){super(),this._textarea=_,this._window=p,this.mainDocument=h,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new y(this._window),this._onDprChange=this.register(new g.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new g.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange(u=>this._screenDprMonitor.setWindow(u))),this.register((0,g.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get window(){return this._window}set window(_){this._window!==_&&(this._window=_,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}o.CoreBrowserService=v;class y extends d.Disposable{constructor(_){super(),this._parentWindow=_,this._windowResizeListener=this.register(new d.MutableDisposable),this._onDprChange=this.register(new g.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,d.toDisposable)(()=>this.clearListener()))}setWindow(_){this._parentWindow=_,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,m.addDisposableDomListener)(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){var _;this._outerListener&&((_=this._resolutionMediaMatchList)==null||_.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.LinkProviderService=void 0;const d=l(844);class g extends d.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,d.toDisposable)(()=>this.linkProviders.length=0))}registerLinkProvider(v){return this.linkProviders.push(v),{dispose:()=>{const y=this.linkProviders.indexOf(v);y!==-1&&this.linkProviders.splice(y,1)}}}}o.LinkProviderService=g},8934:function(c,o,l){var d=this&&this.__decorate||function(w,_,p,h){var u,f=arguments.length,x=f<3?_:h===null?h=Object.getOwnPropertyDescriptor(_,p):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(w,_,p,h);else for(var k=w.length-1;k>=0;k--)(u=w[k])&&(x=(f<3?u(x):f>3?u(_,p,x):u(_,p))||x);return f>3&&x&&Object.defineProperty(_,p,x),x},g=this&&this.__param||function(w,_){return function(p,h){_(p,h,w)}};Object.defineProperty(o,"__esModule",{value:!0}),o.MouseService=void 0;const m=l(4725),v=l(9806);let y=o.MouseService=class{constructor(w,_){this._renderService=w,this._charSizeService=_}getCoords(w,_,p,h,u){return(0,v.getCoords)(window,w,_,p,h,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,u)}getMouseReportCoords(w,_){const p=(0,v.getCoordsRelativeToElement)(window,w,_);if(this._charSizeService.hasValidSize)return p[0]=Math.min(Math.max(p[0],0),this._renderService.dimensions.css.canvas.width-1),p[1]=Math.min(Math.max(p[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(p[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(p[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(p[0]),y:Math.floor(p[1])}}};o.MouseService=y=d([g(0,m.IRenderService),g(1,m.ICharSizeService)],y)},3230:function(c,o,l){var d=this&&this.__decorate||function(u,f,x,k){var C,S=arguments.length,b=S<3?f:k===null?k=Object.getOwnPropertyDescriptor(f,x):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(u,f,x,k);else for(var E=u.length-1;E>=0;E--)(C=u[E])&&(b=(S<3?C(b):S>3?C(f,x,b):C(f,x))||b);return S>3&&b&&Object.defineProperty(f,x,b),b},g=this&&this.__param||function(u,f){return function(x,k){f(x,k,u)}};Object.defineProperty(o,"__esModule",{value:!0}),o.RenderService=void 0;const m=l(6193),v=l(4725),y=l(8460),w=l(844),_=l(7226),p=l(2585);let h=o.RenderService=class extends w.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(u,f,x,k,C,S,b,E){super(),this._rowCount=u,this._charSizeService=k,this._renderer=this.register(new w.MutableDisposable),this._pausedResizeTask=new _.DebouncedIdleTask,this._observerDisposable=this.register(new w.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new y.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new y.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new y.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new y.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new m.RenderDebouncer((N,O)=>this._renderRows(N,O),b),this.register(this._renderDebouncer),this.register(b.onDprChange(()=>this.handleDevicePixelRatioChange())),this.register(S.onResize(()=>this._fullRefresh())),this.register(S.buffers.onBufferActivate(()=>{var N;return(N=this._renderer.value)==null?void 0:N.clear()})),this.register(x.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(C.onDecorationRegistered(()=>this._fullRefresh())),this.register(C.onDecorationRemoved(()=>this._fullRefresh())),this.register(x.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(S.cols,S.rows),this._fullRefresh()})),this.register(x.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(S.buffer.y,S.buffer.y,!0))),this.register(E.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(b.window,f),this.register(b.onWindowChange(N=>this._registerIntersectionObserver(N,f)))}_registerIntersectionObserver(u,f){if("IntersectionObserver"in u){const x=new u.IntersectionObserver(k=>this._handleIntersectionChange(k[k.length-1]),{threshold:0});x.observe(f),this._observerDisposable.value=(0,w.toDisposable)(()=>x.disconnect())}}_handleIntersectionChange(u){this._isPaused=u.isIntersecting===void 0?u.intersectionRatio===0:!u.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(u,f,x=!1){this._isPaused?this._needsFullRefresh=!0:(x||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(u,f,this._rowCount))}_renderRows(u,f){this._renderer.value&&(u=Math.min(u,this._rowCount-1),f=Math.min(f,this._rowCount-1),this._renderer.value.renderRows(u,f),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:u,end:f}),this._onRender.fire({start:u,end:f}),this._isNextRenderRedrawOnly=!0)}resize(u,f){this._rowCount=f,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(u){this._renderer.value=u,this._renderer.value&&(this._renderer.value.onRequestRedraw(f=>this.refreshRows(f.start,f.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(u){return this._renderDebouncer.addRefreshCallback(u)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var u,f;this._renderer.value&&((f=(u=this._renderer.value).clearTextureAtlas)==null||f.call(u),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(u,f){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>{var x;return(x=this._renderer.value)==null?void 0:x.handleResize(u,f)}):this._renderer.value.handleResize(u,f),this._fullRefresh())}handleCharSizeChanged(){var u;(u=this._renderer.value)==null||u.handleCharSizeChanged()}handleBlur(){var u;(u=this._renderer.value)==null||u.handleBlur()}handleFocus(){var u;(u=this._renderer.value)==null||u.handleFocus()}handleSelectionChanged(u,f,x){var k;this._selectionState.start=u,this._selectionState.end=f,this._selectionState.columnSelectMode=x,(k=this._renderer.value)==null||k.handleSelectionChanged(u,f,x)}handleCursorMove(){var u;(u=this._renderer.value)==null||u.handleCursorMove()}clear(){var u;(u=this._renderer.value)==null||u.clear()}};o.RenderService=h=d([g(2,p.IOptionsService),g(3,v.ICharSizeService),g(4,p.IDecorationService),g(5,p.IBufferService),g(6,v.ICoreBrowserService),g(7,v.IThemeService)],h)},9312:function(c,o,l){var d=this&&this.__decorate||function(b,E,N,O){var I,P=arguments.length,U=P<3?E:O===null?O=Object.getOwnPropertyDescriptor(E,N):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(b,E,N,O);else for(var D=b.length-1;D>=0;D--)(I=b[D])&&(U=(P<3?I(U):P>3?I(E,N,U):I(E,N))||U);return P>3&&U&&Object.defineProperty(E,N,U),U},g=this&&this.__param||function(b,E){return function(N,O){E(N,O,b)}};Object.defineProperty(o,"__esModule",{value:!0}),o.SelectionService=void 0;const m=l(9806),v=l(9504),y=l(456),w=l(4725),_=l(8460),p=l(844),h=l(6114),u=l(4841),f=l(511),x=l(2585),k="",C=new RegExp(k,"g");let S=o.SelectionService=class extends p.Disposable{constructor(b,E,N,O,I,P,U,D,H){super(),this._element=b,this._screenElement=E,this._linkifier=N,this._bufferService=O,this._coreService=I,this._mouseService=P,this._optionsService=U,this._renderService=D,this._coreBrowserService=H,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new f.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new _.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new _.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new _.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new _.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=z=>this._handleMouseMove(z),this._mouseUpListener=z=>this._handleMouseUp(z),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(z=>this._handleTrim(z)),this.register(this._bufferService.buffers.onBufferActivate(z=>this._handleBufferActivate(z))),this.enable(),this._model=new y.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,p.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const b=this._model.finalSelectionStart,E=this._model.finalSelectionEnd;return!(!b||!E||b[0]===E[0]&&b[1]===E[1])}get selectionText(){const b=this._model.finalSelectionStart,E=this._model.finalSelectionEnd;if(!b||!E)return"";const N=this._bufferService.buffer,O=[];if(this._activeSelectionMode===3){if(b[0]===E[0])return"";const I=b[0]<E[0]?b[0]:E[0],P=b[0]<E[0]?E[0]:b[0];for(let U=b[1];U<=E[1];U++){const D=N.translateBufferLineToString(U,!0,I,P);O.push(D)}}else{const I=b[1]===E[1]?E[0]:void 0;O.push(N.translateBufferLineToString(b[1],!0,b[0],I));for(let P=b[1]+1;P<=E[1]-1;P++){const U=N.lines.get(P),D=N.translateBufferLineToString(P,!0);U!=null&&U.isWrapped?O[O.length-1]+=D:O.push(D)}if(b[1]!==E[1]){const P=N.lines.get(E[1]),U=N.translateBufferLineToString(E[1],!0,0,E[0]);P&&P.isWrapped?O[O.length-1]+=U:O.push(U)}}return O.map(I=>I.replace(C," ")).join(h.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(b){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),h.isLinux&&b&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(b){const E=this._getMouseBufferCoords(b),N=this._model.finalSelectionStart,O=this._model.finalSelectionEnd;return!!(N&&O&&E)&&this._areCoordsInSelection(E,N,O)}isCellInSelection(b,E){const N=this._model.finalSelectionStart,O=this._model.finalSelectionEnd;return!(!N||!O)&&this._areCoordsInSelection([b,E],N,O)}_areCoordsInSelection(b,E,N){return b[1]>E[1]&&b[1]<N[1]||E[1]===N[1]&&b[1]===E[1]&&b[0]>=E[0]&&b[0]<N[0]||E[1]<N[1]&&b[1]===N[1]&&b[0]<N[0]||E[1]<N[1]&&b[1]===E[1]&&b[0]>=E[0]}_selectWordAtCursor(b,E){var I,P;const N=(P=(I=this._linkifier.currentLink)==null?void 0:I.link)==null?void 0:P.range;if(N)return this._model.selectionStart=[N.start.x-1,N.start.y-1],this._model.selectionStartLength=(0,u.getRangeLength)(N,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const O=this._getMouseBufferCoords(b);return!!O&&(this._selectWordAt(O,E),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(b,E){this._model.clearSelection(),b=Math.max(b,0),E=Math.min(E,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,b],this._model.selectionEnd=[this._bufferService.cols,E],this.refresh(),this._onSelectionChange.fire()}_handleTrim(b){this._model.handleTrim(b)&&this.refresh()}_getMouseBufferCoords(b){const E=this._mouseService.getCoords(b,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(E)return E[0]--,E[1]--,E[1]+=this._bufferService.buffer.ydisp,E}_getMouseEventScrollAmount(b){let E=(0,m.getCoordsRelativeToElement)(this._coreBrowserService.window,b,this._screenElement)[1];const N=this._renderService.dimensions.css.canvas.height;return E>=0&&E<=N?0:(E>N&&(E-=N),E=Math.min(Math.max(E,-50),50),E/=50,E/Math.abs(E)+Math.round(14*E))}shouldForceSelection(b){return h.isMac?b.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:b.shiftKey}handleMouseDown(b){if(this._mouseDownTimeStamp=b.timeStamp,(b.button!==2||!this.hasSelection)&&b.button===0){if(!this._enabled){if(!this.shouldForceSelection(b))return;b.stopPropagation()}b.preventDefault(),this._dragScrollAmount=0,this._enabled&&b.shiftKey?this._handleIncrementalClick(b):b.detail===1?this._handleSingleClick(b):b.detail===2?this._handleDoubleClick(b):b.detail===3&&this._handleTripleClick(b),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(b){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(b))}_handleSingleClick(b){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(b)?3:0,this._model.selectionStart=this._getMouseBufferCoords(b),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const E=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);E&&E.length!==this._model.selectionStart[0]&&E.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(b){this._selectWordAtCursor(b,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(b){const E=this._getMouseBufferCoords(b);E&&(this._activeSelectionMode=2,this._selectLineAt(E[1]))}shouldColumnSelect(b){return b.altKey&&!(h.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(b){if(b.stopImmediatePropagation(),!this._model.selectionStart)return;const E=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(b),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(b),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const N=this._bufferService.buffer;if(this._model.selectionEnd[1]<N.lines.length){const O=N.lines.get(this._model.selectionEnd[1]);O&&O.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}E&&E[0]===this._model.selectionEnd[0]&&E[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const b=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(b.ydisp+this._bufferService.rows,b.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=b.ydisp),this.refresh()}}_handleMouseUp(b){const E=b.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&E<500&&b.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const N=this._mouseService.getCoords(b,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(N&&N[0]!==void 0&&N[1]!==void 0){const O=(0,v.moveToCellSequence)(N[0]-1,N[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(O,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const b=this._model.finalSelectionStart,E=this._model.finalSelectionEnd,N=!(!b||!E||b[0]===E[0]&&b[1]===E[1]);N?b&&E&&(this._oldSelectionStart&&this._oldSelectionEnd&&b[0]===this._oldSelectionStart[0]&&b[1]===this._oldSelectionStart[1]&&E[0]===this._oldSelectionEnd[0]&&E[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(b,E,N)):this._oldHasSelection&&this._fireOnSelectionChange(b,E,N)}_fireOnSelectionChange(b,E,N){this._oldSelectionStart=b,this._oldSelectionEnd=E,this._oldHasSelection=N,this._onSelectionChange.fire()}_handleBufferActivate(b){this.clearSelection(),this._trimListener.dispose(),this._trimListener=b.activeBuffer.lines.onTrim(E=>this._handleTrim(E))}_convertViewportColToCharacterIndex(b,E){let N=E;for(let O=0;E>=O;O++){const I=b.loadCell(O,this._workCell).getChars().length;this._workCell.getWidth()===0?N--:I>1&&E!==O&&(N+=I-1)}return N}setSelection(b,E,N){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[b,E],this._model.selectionStartLength=N,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(b){this._isClickInSelection(b)||(this._selectWordAtCursor(b,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(b,E,N=!0,O=!0){if(b[0]>=this._bufferService.cols)return;const I=this._bufferService.buffer,P=I.lines.get(b[1]);if(!P)return;const U=I.translateBufferLineToString(b[1],!1);let D=this._convertViewportColToCharacterIndex(P,b[0]),H=D;const z=b[0]-D;let B=0,j=0,T=0,L=0;if(U.charAt(D)===" "){for(;D>0&&U.charAt(D-1)===" ";)D--;for(;H<U.length&&U.charAt(H+1)===" ";)H++}else{let J=b[0],ue=b[0];P.getWidth(J)===0&&(B++,J--),P.getWidth(ue)===2&&(j++,ue++);const he=P.getString(ue).length;for(he>1&&(L+=he-1,H+=he-1);J>0&&D>0&&!this._isCharWordSeparator(P.loadCell(J-1,this._workCell));){P.loadCell(J-1,this._workCell);const F=this._workCell.getChars().length;this._workCell.getWidth()===0?(B++,J--):F>1&&(T+=F-1,D-=F-1),D--,J--}for(;ue<P.length&&H+1<U.length&&!this._isCharWordSeparator(P.loadCell(ue+1,this._workCell));){P.loadCell(ue+1,this._workCell);const F=this._workCell.getChars().length;this._workCell.getWidth()===2?(j++,ue++):F>1&&(L+=F-1,H+=F-1),H++,ue++}}H++;let $=D+z-B+T,V=Math.min(this._bufferService.cols,H-D+B+j-T-L);if(E||U.slice(D,H).trim()!==""){if(N&&$===0&&P.getCodePoint(0)!==32){const J=I.lines.get(b[1]-1);if(J&&P.isWrapped&&J.getCodePoint(this._bufferService.cols-1)!==32){const ue=this._getWordAt([this._bufferService.cols-1,b[1]-1],!1,!0,!1);if(ue){const he=this._bufferService.cols-ue.start;$-=he,V+=he}}}if(O&&$+V===this._bufferService.cols&&P.getCodePoint(this._bufferService.cols-1)!==32){const J=I.lines.get(b[1]+1);if(J!=null&&J.isWrapped&&J.getCodePoint(0)!==32){const ue=this._getWordAt([0,b[1]+1],!1,!1,!0);ue&&(V+=ue.length)}}return{start:$,length:V}}}_selectWordAt(b,E){const N=this._getWordAt(b,E);if(N){for(;N.start<0;)N.start+=this._bufferService.cols,b[1]--;this._model.selectionStart=[N.start,b[1]],this._model.selectionStartLength=N.length}}_selectToWordAt(b){const E=this._getWordAt(b,!0);if(E){let N=b[1];for(;E.start<0;)E.start+=this._bufferService.cols,N--;if(!this._model.areSelectionValuesReversed())for(;E.start+E.length>this._bufferService.cols;)E.length-=this._bufferService.cols,N++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?E.start:E.start+E.length,N]}}_isCharWordSeparator(b){return b.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(b.getChars())>=0}_selectLineAt(b){const E=this._bufferService.buffer.getWrappedRangeForLine(b),N={start:{x:0,y:E.first},end:{x:this._bufferService.cols-1,y:E.last}};this._model.selectionStart=[0,E.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,u.getRangeLength)(N,this._bufferService.cols)}};o.SelectionService=S=d([g(3,x.IBufferService),g(4,x.ICoreService),g(5,w.IMouseService),g(6,x.IOptionsService),g(7,w.IRenderService),g(8,w.ICoreBrowserService)],S)},4725:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ILinkProviderService=o.IThemeService=o.ICharacterJoinerService=o.ISelectionService=o.IRenderService=o.IMouseService=o.ICoreBrowserService=o.ICharSizeService=void 0;const d=l(8343);o.ICharSizeService=(0,d.createDecorator)("CharSizeService"),o.ICoreBrowserService=(0,d.createDecorator)("CoreBrowserService"),o.IMouseService=(0,d.createDecorator)("MouseService"),o.IRenderService=(0,d.createDecorator)("RenderService"),o.ISelectionService=(0,d.createDecorator)("SelectionService"),o.ICharacterJoinerService=(0,d.createDecorator)("CharacterJoinerService"),o.IThemeService=(0,d.createDecorator)("ThemeService"),o.ILinkProviderService=(0,d.createDecorator)("LinkProviderService")},6731:function(c,o,l){var d=this&&this.__decorate||function(S,b,E,N){var O,I=arguments.length,P=I<3?b:N===null?N=Object.getOwnPropertyDescriptor(b,E):N;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(S,b,E,N);else for(var U=S.length-1;U>=0;U--)(O=S[U])&&(P=(I<3?O(P):I>3?O(b,E,P):O(b,E))||P);return I>3&&P&&Object.defineProperty(b,E,P),P},g=this&&this.__param||function(S,b){return function(E,N){b(E,N,S)}};Object.defineProperty(o,"__esModule",{value:!0}),o.ThemeService=o.DEFAULT_ANSI_COLORS=void 0;const m=l(7239),v=l(8055),y=l(8460),w=l(844),_=l(2585),p=v.css.toColor("#ffffff"),h=v.css.toColor("#000000"),u=v.css.toColor("#ffffff"),f=v.css.toColor("#000000"),x={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};o.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const S=[v.css.toColor("#2e3436"),v.css.toColor("#cc0000"),v.css.toColor("#4e9a06"),v.css.toColor("#c4a000"),v.css.toColor("#3465a4"),v.css.toColor("#75507b"),v.css.toColor("#06989a"),v.css.toColor("#d3d7cf"),v.css.toColor("#555753"),v.css.toColor("#ef2929"),v.css.toColor("#8ae234"),v.css.toColor("#fce94f"),v.css.toColor("#729fcf"),v.css.toColor("#ad7fa8"),v.css.toColor("#34e2e2"),v.css.toColor("#eeeeec")],b=[0,95,135,175,215,255];for(let E=0;E<216;E++){const N=b[E/36%6|0],O=b[E/6%6|0],I=b[E%6];S.push({css:v.channels.toCss(N,O,I),rgba:v.channels.toRgba(N,O,I)})}for(let E=0;E<24;E++){const N=8+10*E;S.push({css:v.channels.toCss(N,N,N),rgba:v.channels.toRgba(N,N,N)})}return S})());let k=o.ThemeService=class extends w.Disposable{get colors(){return this._colors}constructor(S){super(),this._optionsService=S,this._contrastCache=new m.ColorContrastCache,this._halfContrastCache=new m.ColorContrastCache,this._onChangeColors=this.register(new y.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:p,background:h,cursor:u,cursorAccent:f,selectionForeground:void 0,selectionBackgroundTransparent:x,selectionBackgroundOpaque:v.color.blend(h,x),selectionInactiveBackgroundTransparent:x,selectionInactiveBackgroundOpaque:v.color.blend(h,x),ansi:o.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(S={}){const b=this._colors;if(b.foreground=C(S.foreground,p),b.background=C(S.background,h),b.cursor=C(S.cursor,u),b.cursorAccent=C(S.cursorAccent,f),b.selectionBackgroundTransparent=C(S.selectionBackground,x),b.selectionBackgroundOpaque=v.color.blend(b.background,b.selectionBackgroundTransparent),b.selectionInactiveBackgroundTransparent=C(S.selectionInactiveBackground,b.selectionBackgroundTransparent),b.selectionInactiveBackgroundOpaque=v.color.blend(b.background,b.selectionInactiveBackgroundTransparent),b.selectionForeground=S.selectionForeground?C(S.selectionForeground,v.NULL_COLOR):void 0,b.selectionForeground===v.NULL_COLOR&&(b.selectionForeground=void 0),v.color.isOpaque(b.selectionBackgroundTransparent)&&(b.selectionBackgroundTransparent=v.color.opacity(b.selectionBackgroundTransparent,.3)),v.color.isOpaque(b.selectionInactiveBackgroundTransparent)&&(b.selectionInactiveBackgroundTransparent=v.color.opacity(b.selectionInactiveBackgroundTransparent,.3)),b.ansi=o.DEFAULT_ANSI_COLORS.slice(),b.ansi[0]=C(S.black,o.DEFAULT_ANSI_COLORS[0]),b.ansi[1]=C(S.red,o.DEFAULT_ANSI_COLORS[1]),b.ansi[2]=C(S.green,o.DEFAULT_ANSI_COLORS[2]),b.ansi[3]=C(S.yellow,o.DEFAULT_ANSI_COLORS[3]),b.ansi[4]=C(S.blue,o.DEFAULT_ANSI_COLORS[4]),b.ansi[5]=C(S.magenta,o.DEFAULT_ANSI_COLORS[5]),b.ansi[6]=C(S.cyan,o.DEFAULT_ANSI_COLORS[6]),b.ansi[7]=C(S.white,o.DEFAULT_ANSI_COLORS[7]),b.ansi[8]=C(S.brightBlack,o.DEFAULT_ANSI_COLORS[8]),b.ansi[9]=C(S.brightRed,o.DEFAULT_ANSI_COLORS[9]),b.ansi[10]=C(S.brightGreen,o.DEFAULT_ANSI_COLORS[10]),b.ansi[11]=C(S.brightYellow,o.DEFAULT_ANSI_COLORS[11]),b.ansi[12]=C(S.brightBlue,o.DEFAULT_ANSI_COLORS[12]),b.ansi[13]=C(S.brightMagenta,o.DEFAULT_ANSI_COLORS[13]),b.ansi[14]=C(S.brightCyan,o.DEFAULT_ANSI_COLORS[14]),b.ansi[15]=C(S.brightWhite,o.DEFAULT_ANSI_COLORS[15]),S.extendedAnsi){const E=Math.min(b.ansi.length-16,S.extendedAnsi.length);for(let N=0;N<E;N++)b.ansi[N+16]=C(S.extendedAnsi[N],o.DEFAULT_ANSI_COLORS[N+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(S){this._restoreColor(S),this._onChangeColors.fire(this.colors)}_restoreColor(S){if(S!==void 0)switch(S){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[S]=this._restoreColors.ansi[S]}else for(let b=0;b<this._restoreColors.ansi.length;++b)this._colors.ansi[b]=this._restoreColors.ansi[b]}modifyColors(S){S(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function C(S,b){if(S!==void 0)try{return v.css.toColor(S)}catch{}return b}o.ThemeService=k=d([g(0,_.IOptionsService)],k)},6349:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CircularList=void 0;const d=l(8460),g=l(844);class m extends g.Disposable{constructor(y){super(),this._maxLength=y,this.onDeleteEmitter=this.register(new d.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new d.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new d.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(y){if(this._maxLength===y)return;const w=new Array(y);for(let _=0;_<Math.min(y,this.length);_++)w[_]=this._array[this._getCyclicIndex(_)];this._array=w,this._maxLength=y,this._startIndex=0}get length(){return this._length}set length(y){if(y>this._length)for(let w=this._length;w<y;w++)this._array[w]=void 0;this._length=y}get(y){return this._array[this._getCyclicIndex(y)]}set(y,w){this._array[this._getCyclicIndex(y)]=w}push(y){this._array[this._getCyclicIndex(this._length)]=y,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(y,w,..._){if(w){for(let p=y;p<this._length-w;p++)this._array[this._getCyclicIndex(p)]=this._array[this._getCyclicIndex(p+w)];this._length-=w,this.onDeleteEmitter.fire({index:y,amount:w})}for(let p=this._length-1;p>=y;p--)this._array[this._getCyclicIndex(p+_.length)]=this._array[this._getCyclicIndex(p)];for(let p=0;p<_.length;p++)this._array[this._getCyclicIndex(y+p)]=_[p];if(_.length&&this.onInsertEmitter.fire({index:y,amount:_.length}),this._length+_.length>this._maxLength){const p=this._length+_.length-this._maxLength;this._startIndex+=p,this._length=this._maxLength,this.onTrimEmitter.fire(p)}else this._length+=_.length}trimStart(y){y>this._length&&(y=this._length),this._startIndex+=y,this._length-=y,this.onTrimEmitter.fire(y)}shiftElements(y,w,_){if(!(w<=0)){if(y<0||y>=this._length)throw new Error("start argument out of range");if(y+_<0)throw new Error("Cannot shift elements in list beyond index 0");if(_>0){for(let h=w-1;h>=0;h--)this.set(y+h+_,this.get(y+h));const p=y+w+_-this._length;if(p>0)for(this._length+=p;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let p=0;p<w;p++)this.set(y+p+_,this.get(y+p))}}_getCyclicIndex(y){return(this._startIndex+y)%this._maxLength}}o.CircularList=m},1439:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.clone=void 0,o.clone=function l(d,g=5){if(typeof d!="object")return d;const m=Array.isArray(d)?[]:{};for(const v in d)m[v]=g<=1?d[v]:d[v]&&l(d[v],g-1);return m}},8055:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.contrastRatio=o.toPaddedHex=o.rgba=o.rgb=o.css=o.color=o.channels=o.NULL_COLOR=void 0;let l=0,d=0,g=0,m=0;var v,y,w,_,p;function h(f){const x=f.toString(16);return x.length<2?"0"+x:x}function u(f,x){return f<x?(x+.05)/(f+.05):(f+.05)/(x+.05)}o.NULL_COLOR={css:"#00000000",rgba:0},function(f){f.toCss=function(x,k,C,S){return S!==void 0?`#${h(x)}${h(k)}${h(C)}${h(S)}`:`#${h(x)}${h(k)}${h(C)}`},f.toRgba=function(x,k,C,S=255){return(x<<24|k<<16|C<<8|S)>>>0},f.toColor=function(x,k,C,S){return{css:f.toCss(x,k,C,S),rgba:f.toRgba(x,k,C,S)}}}(v||(o.channels=v={})),function(f){function x(k,C){return m=Math.round(255*C),[l,d,g]=p.toChannels(k.rgba),{css:v.toCss(l,d,g,m),rgba:v.toRgba(l,d,g,m)}}f.blend=function(k,C){if(m=(255&C.rgba)/255,m===1)return{css:C.css,rgba:C.rgba};const S=C.rgba>>24&255,b=C.rgba>>16&255,E=C.rgba>>8&255,N=k.rgba>>24&255,O=k.rgba>>16&255,I=k.rgba>>8&255;return l=N+Math.round((S-N)*m),d=O+Math.round((b-O)*m),g=I+Math.round((E-I)*m),{css:v.toCss(l,d,g),rgba:v.toRgba(l,d,g)}},f.isOpaque=function(k){return(255&k.rgba)==255},f.ensureContrastRatio=function(k,C,S){const b=p.ensureContrastRatio(k.rgba,C.rgba,S);if(b)return v.toColor(b>>24&255,b>>16&255,b>>8&255)},f.opaque=function(k){const C=(255|k.rgba)>>>0;return[l,d,g]=p.toChannels(C),{css:v.toCss(l,d,g),rgba:C}},f.opacity=x,f.multiplyOpacity=function(k,C){return m=255&k.rgba,x(k,m*C/255)},f.toColorRGB=function(k){return[k.rgba>>24&255,k.rgba>>16&255,k.rgba>>8&255]}}(y||(o.color=y={})),function(f){let x,k;try{const C=document.createElement("canvas");C.width=1,C.height=1;const S=C.getContext("2d",{willReadFrequently:!0});S&&(x=S,x.globalCompositeOperation="copy",k=x.createLinearGradient(0,0,1,1))}catch{}f.toColor=function(C){if(C.match(/#[\da-f]{3,8}/i))switch(C.length){case 4:return l=parseInt(C.slice(1,2).repeat(2),16),d=parseInt(C.slice(2,3).repeat(2),16),g=parseInt(C.slice(3,4).repeat(2),16),v.toColor(l,d,g);case 5:return l=parseInt(C.slice(1,2).repeat(2),16),d=parseInt(C.slice(2,3).repeat(2),16),g=parseInt(C.slice(3,4).repeat(2),16),m=parseInt(C.slice(4,5).repeat(2),16),v.toColor(l,d,g,m);case 7:return{css:C,rgba:(parseInt(C.slice(1),16)<<8|255)>>>0};case 9:return{css:C,rgba:parseInt(C.slice(1),16)>>>0}}const S=C.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(S)return l=parseInt(S[1]),d=parseInt(S[2]),g=parseInt(S[3]),m=Math.round(255*(S[5]===void 0?1:parseFloat(S[5]))),v.toColor(l,d,g,m);if(!x||!k)throw new Error("css.toColor: Unsupported css format");if(x.fillStyle=k,x.fillStyle=C,typeof x.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(x.fillRect(0,0,1,1),[l,d,g,m]=x.getImageData(0,0,1,1).data,m!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:v.toRgba(l,d,g,m),css:C}}}(w||(o.css=w={})),function(f){function x(k,C,S){const b=k/255,E=C/255,N=S/255;return .2126*(b<=.03928?b/12.92:Math.pow((b+.055)/1.055,2.4))+.7152*(E<=.03928?E/12.92:Math.pow((E+.055)/1.055,2.4))+.0722*(N<=.03928?N/12.92:Math.pow((N+.055)/1.055,2.4))}f.relativeLuminance=function(k){return x(k>>16&255,k>>8&255,255&k)},f.relativeLuminance2=x}(_||(o.rgb=_={})),function(f){function x(C,S,b){const E=C>>24&255,N=C>>16&255,O=C>>8&255;let I=S>>24&255,P=S>>16&255,U=S>>8&255,D=u(_.relativeLuminance2(I,P,U),_.relativeLuminance2(E,N,O));for(;D<b&&(I>0||P>0||U>0);)I-=Math.max(0,Math.ceil(.1*I)),P-=Math.max(0,Math.ceil(.1*P)),U-=Math.max(0,Math.ceil(.1*U)),D=u(_.relativeLuminance2(I,P,U),_.relativeLuminance2(E,N,O));return(I<<24|P<<16|U<<8|255)>>>0}function k(C,S,b){const E=C>>24&255,N=C>>16&255,O=C>>8&255;let I=S>>24&255,P=S>>16&255,U=S>>8&255,D=u(_.relativeLuminance2(I,P,U),_.relativeLuminance2(E,N,O));for(;D<b&&(I<255||P<255||U<255);)I=Math.min(255,I+Math.ceil(.1*(255-I))),P=Math.min(255,P+Math.ceil(.1*(255-P))),U=Math.min(255,U+Math.ceil(.1*(255-U))),D=u(_.relativeLuminance2(I,P,U),_.relativeLuminance2(E,N,O));return(I<<24|P<<16|U<<8|255)>>>0}f.blend=function(C,S){if(m=(255&S)/255,m===1)return S;const b=S>>24&255,E=S>>16&255,N=S>>8&255,O=C>>24&255,I=C>>16&255,P=C>>8&255;return l=O+Math.round((b-O)*m),d=I+Math.round((E-I)*m),g=P+Math.round((N-P)*m),v.toRgba(l,d,g)},f.ensureContrastRatio=function(C,S,b){const E=_.relativeLuminance(C>>8),N=_.relativeLuminance(S>>8);if(u(E,N)<b){if(N<E){const P=x(C,S,b),U=u(E,_.relativeLuminance(P>>8));if(U<b){const D=k(C,S,b);return U>u(E,_.relativeLuminance(D>>8))?P:D}return P}const O=k(C,S,b),I=u(E,_.relativeLuminance(O>>8));if(I<b){const P=x(C,S,b);return I>u(E,_.relativeLuminance(P>>8))?O:P}return O}},f.reduceLuminance=x,f.increaseLuminance=k,f.toChannels=function(C){return[C>>24&255,C>>16&255,C>>8&255,255&C]}}(p||(o.rgba=p={})),o.toPaddedHex=h,o.contrastRatio=u},8969:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CoreTerminal=void 0;const d=l(844),g=l(2585),m=l(4348),v=l(7866),y=l(744),w=l(7302),_=l(6975),p=l(8460),h=l(1753),u=l(1480),f=l(7994),x=l(9282),k=l(5435),C=l(5981),S=l(2660);let b=!1;class E extends d.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new p.EventEmitter),this._onScroll.event(O=>{var I;(I=this._onScrollApi)==null||I.fire(O.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(O){for(const I in O)this.optionsService.options[I]=O[I]}constructor(O){super(),this._windowsWrappingHeuristics=this.register(new d.MutableDisposable),this._onBinary=this.register(new p.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new p.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new p.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new p.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new p.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new p.EventEmitter),this._instantiationService=new m.InstantiationService,this.optionsService=this.register(new w.OptionsService(O)),this._instantiationService.setService(g.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(y.BufferService)),this._instantiationService.setService(g.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(v.LogService)),this._instantiationService.setService(g.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(_.CoreService)),this._instantiationService.setService(g.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(h.CoreMouseService)),this._instantiationService.setService(g.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(u.UnicodeService)),this._instantiationService.setService(g.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(f.CharsetService),this._instantiationService.setService(g.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(S.OscLinkService),this._instantiationService.setService(g.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new k.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,p.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,p.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,p.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,p.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(I=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(I=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new C.WriteBuffer((I,P)=>this._inputHandler.parse(I,P))),this.register((0,p.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(O,I){this._writeBuffer.write(O,I)}writeSync(O,I){this._logService.logLevel<=g.LogLevelEnum.WARN&&!b&&(this._logService.warn("writeSync is unreliable and will be removed soon."),b=!0),this._writeBuffer.writeSync(O,I)}input(O,I=!0){this.coreService.triggerDataEvent(O,I)}resize(O,I){isNaN(O)||isNaN(I)||(O=Math.max(O,y.MINIMUM_COLS),I=Math.max(I,y.MINIMUM_ROWS),this._bufferService.resize(O,I))}scroll(O,I=!1){this._bufferService.scroll(O,I)}scrollLines(O,I,P){this._bufferService.scrollLines(O,I,P)}scrollPages(O){this.scrollLines(O*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(O){const I=O-this._bufferService.buffer.ydisp;I!==0&&this.scrollLines(I)}registerEscHandler(O,I){return this._inputHandler.registerEscHandler(O,I)}registerDcsHandler(O,I){return this._inputHandler.registerDcsHandler(O,I)}registerCsiHandler(O,I){return this._inputHandler.registerCsiHandler(O,I)}registerOscHandler(O,I){return this._inputHandler.registerOscHandler(O,I)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let O=!1;const I=this.optionsService.rawOptions.windowsPty;I&&I.buildNumber!==void 0&&I.buildNumber!==void 0?O=I.backend==="conpty"&&I.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(O=!0),O?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const O=[];O.push(this.onLineFeed(x.updateWindowsModeWrappedState.bind(null,this._bufferService))),O.push(this.registerCsiHandler({final:"H"},()=>((0,x.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,d.toDisposable)(()=>{for(const I of O)I.dispose()})}}}o.CoreTerminal=E},8460:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.runAndSubscribe=o.forwardEvent=o.EventEmitter=void 0,o.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=l=>(this._listeners.push(l),{dispose:()=>{if(!this._disposed){for(let d=0;d<this._listeners.length;d++)if(this._listeners[d]===l)return void this._listeners.splice(d,1)}}})),this._event}fire(l,d){const g=[];for(let m=0;m<this._listeners.length;m++)g.push(this._listeners[m]);for(let m=0;m<g.length;m++)g[m].call(void 0,l,d)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},o.forwardEvent=function(l,d){return l(g=>d.fire(g))},o.runAndSubscribe=function(l,d){return d(void 0),l(g=>d(g))}},5435:function(c,o,l){var d=this&&this.__decorate||function(B,j,T,L){var $,V=arguments.length,J=V<3?j:L===null?L=Object.getOwnPropertyDescriptor(j,T):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")J=Reflect.decorate(B,j,T,L);else for(var ue=B.length-1;ue>=0;ue--)($=B[ue])&&(J=(V<3?$(J):V>3?$(j,T,J):$(j,T))||J);return V>3&&J&&Object.defineProperty(j,T,J),J},g=this&&this.__param||function(B,j){return function(T,L){j(T,L,B)}};Object.defineProperty(o,"__esModule",{value:!0}),o.InputHandler=o.WindowsOptionsReportType=void 0;const m=l(2584),v=l(7116),y=l(2015),w=l(844),_=l(482),p=l(8437),h=l(8460),u=l(643),f=l(511),x=l(3734),k=l(2585),C=l(1480),S=l(6242),b=l(6351),E=l(5941),N={"(":0,")":1,"*":2,"+":3,"-":1,".":2},O=131072;function I(B,j){if(B>24)return j.setWinLines||!1;switch(B){case 1:return!!j.restoreWin;case 2:return!!j.minimizeWin;case 3:return!!j.setWinPosition;case 4:return!!j.setWinSizePixels;case 5:return!!j.raiseWin;case 6:return!!j.lowerWin;case 7:return!!j.refreshWin;case 8:return!!j.setWinSizeChars;case 9:return!!j.maximizeWin;case 10:return!!j.fullscreenWin;case 11:return!!j.getWinState;case 13:return!!j.getWinPosition;case 14:return!!j.getWinSizePixels;case 15:return!!j.getScreenSizePixels;case 16:return!!j.getCellSizePixels;case 18:return!!j.getWinSizeChars;case 19:return!!j.getScreenSizeChars;case 20:return!!j.getIconTitle;case 21:return!!j.getWinTitle;case 22:return!!j.pushTitle;case 23:return!!j.popTitle;case 24:return!!j.setWinLines}return!1}var P;(function(B){B[B.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",B[B.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(P||(o.WindowsOptionsReportType=P={}));let U=0;class D extends w.Disposable{getAttrData(){return this._curAttrData}constructor(j,T,L,$,V,J,ue,he,F=new y.EscapeSequenceParser){super(),this._bufferService=j,this._charsetService=T,this._coreService=L,this._logService=$,this._optionsService=V,this._oscLinkService=J,this._coreMouseService=ue,this._unicodeService=he,this._parser=F,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new _.StringToUtf32,this._utf8Decoder=new _.Utf8ToUtf32,this._workCell=new f.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=p.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=p.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new h.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new h.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new h.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new h.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new h.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new h.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new h.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new h.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new h.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new h.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new h.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new h.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new h.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new H(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(A=>this._activeBuffer=A.activeBuffer)),this._parser.setCsiHandlerFallback((A,K)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(A),params:K.toArray()})}),this._parser.setEscHandlerFallback(A=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(A)})}),this._parser.setExecuteHandlerFallback(A=>{this._logService.debug("Unknown EXECUTE code: ",{code:A})}),this._parser.setOscHandlerFallback((A,K,q)=>{this._logService.debug("Unknown OSC code: ",{identifier:A,action:K,data:q})}),this._parser.setDcsHandlerFallback((A,K,q)=>{K==="HOOK"&&(q=q.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(A),action:K,payload:q})}),this._parser.setPrintHandler((A,K,q)=>this.print(A,K,q)),this._parser.registerCsiHandler({final:"@"},A=>this.insertChars(A)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},A=>this.scrollLeft(A)),this._parser.registerCsiHandler({final:"A"},A=>this.cursorUp(A)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},A=>this.scrollRight(A)),this._parser.registerCsiHandler({final:"B"},A=>this.cursorDown(A)),this._parser.registerCsiHandler({final:"C"},A=>this.cursorForward(A)),this._parser.registerCsiHandler({final:"D"},A=>this.cursorBackward(A)),this._parser.registerCsiHandler({final:"E"},A=>this.cursorNextLine(A)),this._parser.registerCsiHandler({final:"F"},A=>this.cursorPrecedingLine(A)),this._parser.registerCsiHandler({final:"G"},A=>this.cursorCharAbsolute(A)),this._parser.registerCsiHandler({final:"H"},A=>this.cursorPosition(A)),this._parser.registerCsiHandler({final:"I"},A=>this.cursorForwardTab(A)),this._parser.registerCsiHandler({final:"J"},A=>this.eraseInDisplay(A,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},A=>this.eraseInDisplay(A,!0)),this._parser.registerCsiHandler({final:"K"},A=>this.eraseInLine(A,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},A=>this.eraseInLine(A,!0)),this._parser.registerCsiHandler({final:"L"},A=>this.insertLines(A)),this._parser.registerCsiHandler({final:"M"},A=>this.deleteLines(A)),this._parser.registerCsiHandler({final:"P"},A=>this.deleteChars(A)),this._parser.registerCsiHandler({final:"S"},A=>this.scrollUp(A)),this._parser.registerCsiHandler({final:"T"},A=>this.scrollDown(A)),this._parser.registerCsiHandler({final:"X"},A=>this.eraseChars(A)),this._parser.registerCsiHandler({final:"Z"},A=>this.cursorBackwardTab(A)),this._parser.registerCsiHandler({final:"`"},A=>this.charPosAbsolute(A)),this._parser.registerCsiHandler({final:"a"},A=>this.hPositionRelative(A)),this._parser.registerCsiHandler({final:"b"},A=>this.repeatPrecedingCharacter(A)),this._parser.registerCsiHandler({final:"c"},A=>this.sendDeviceAttributesPrimary(A)),this._parser.registerCsiHandler({prefix:">",final:"c"},A=>this.sendDeviceAttributesSecondary(A)),this._parser.registerCsiHandler({final:"d"},A=>this.linePosAbsolute(A)),this._parser.registerCsiHandler({final:"e"},A=>this.vPositionRelative(A)),this._parser.registerCsiHandler({final:"f"},A=>this.hVPosition(A)),this._parser.registerCsiHandler({final:"g"},A=>this.tabClear(A)),this._parser.registerCsiHandler({final:"h"},A=>this.setMode(A)),this._parser.registerCsiHandler({prefix:"?",final:"h"},A=>this.setModePrivate(A)),this._parser.registerCsiHandler({final:"l"},A=>this.resetMode(A)),this._parser.registerCsiHandler({prefix:"?",final:"l"},A=>this.resetModePrivate(A)),this._parser.registerCsiHandler({final:"m"},A=>this.charAttributes(A)),this._parser.registerCsiHandler({final:"n"},A=>this.deviceStatus(A)),this._parser.registerCsiHandler({prefix:"?",final:"n"},A=>this.deviceStatusPrivate(A)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},A=>this.softReset(A)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},A=>this.setCursorStyle(A)),this._parser.registerCsiHandler({final:"r"},A=>this.setScrollRegion(A)),this._parser.registerCsiHandler({final:"s"},A=>this.saveCursor(A)),this._parser.registerCsiHandler({final:"t"},A=>this.windowOptions(A)),this._parser.registerCsiHandler({final:"u"},A=>this.restoreCursor(A)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},A=>this.insertColumns(A)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},A=>this.deleteColumns(A)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},A=>this.selectProtected(A)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},A=>this.requestMode(A,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},A=>this.requestMode(A,!1)),this._parser.setExecuteHandler(m.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(m.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(m.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(m.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(m.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(m.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(m.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(m.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(m.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(m.C1.IND,()=>this.index()),this._parser.setExecuteHandler(m.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(m.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new S.OscHandler(A=>(this.setTitle(A),this.setIconName(A),!0))),this._parser.registerOscHandler(1,new S.OscHandler(A=>this.setIconName(A))),this._parser.registerOscHandler(2,new S.OscHandler(A=>this.setTitle(A))),this._parser.registerOscHandler(4,new S.OscHandler(A=>this.setOrReportIndexedColor(A))),this._parser.registerOscHandler(8,new S.OscHandler(A=>this.setHyperlink(A))),this._parser.registerOscHandler(10,new S.OscHandler(A=>this.setOrReportFgColor(A))),this._parser.registerOscHandler(11,new S.OscHandler(A=>this.setOrReportBgColor(A))),this._parser.registerOscHandler(12,new S.OscHandler(A=>this.setOrReportCursorColor(A))),this._parser.registerOscHandler(104,new S.OscHandler(A=>this.restoreIndexedColor(A))),this._parser.registerOscHandler(110,new S.OscHandler(A=>this.restoreFgColor(A))),this._parser.registerOscHandler(111,new S.OscHandler(A=>this.restoreBgColor(A))),this._parser.registerOscHandler(112,new S.OscHandler(A=>this.restoreCursorColor(A))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const A in v.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:A},()=>this.selectCharset("("+A)),this._parser.registerEscHandler({intermediates:")",final:A},()=>this.selectCharset(")"+A)),this._parser.registerEscHandler({intermediates:"*",final:A},()=>this.selectCharset("*"+A)),this._parser.registerEscHandler({intermediates:"+",final:A},()=>this.selectCharset("+"+A)),this._parser.registerEscHandler({intermediates:"-",final:A},()=>this.selectCharset("-"+A)),this._parser.registerEscHandler({intermediates:".",final:A},()=>this.selectCharset("."+A)),this._parser.registerEscHandler({intermediates:"/",final:A},()=>this.selectCharset("/"+A));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(A=>(this._logService.error("Parsing error: ",A),A)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new b.DcsHandler((A,K)=>this.requestStatusString(A,K)))}_preserveStack(j,T,L,$){this._parseStack.paused=!0,this._parseStack.cursorStartX=j,this._parseStack.cursorStartY=T,this._parseStack.decodedLength=L,this._parseStack.position=$}_logSlowResolvingAsync(j){this._logService.logLevel<=k.LogLevelEnum.WARN&&Promise.race([j,new Promise((T,L)=>setTimeout(()=>L("#SLOW_TIMEOUT"),5e3))]).catch(T=>{if(T!=="#SLOW_TIMEOUT")throw T;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(j,T){let L,$=this._activeBuffer.x,V=this._activeBuffer.y,J=0;const ue=this._parseStack.paused;if(ue){if(L=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,T))return this._logSlowResolvingAsync(L),L;$=this._parseStack.cursorStartX,V=this._parseStack.cursorStartY,this._parseStack.paused=!1,j.length>O&&(J=this._parseStack.position+O)}if(this._logService.logLevel<=k.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof j=="string"?` "${j}"`:` "${Array.prototype.map.call(j,A=>String.fromCharCode(A)).join("")}"`),typeof j=="string"?j.split("").map(A=>A.charCodeAt(0)):j),this._parseBuffer.length<j.length&&this._parseBuffer.length<O&&(this._parseBuffer=new Uint32Array(Math.min(j.length,O))),ue||this._dirtyRowTracker.clearRange(),j.length>O)for(let A=J;A<j.length;A+=O){const K=A+O<j.length?A+O:j.length,q=typeof j=="string"?this._stringDecoder.decode(j.substring(A,K),this._parseBuffer):this._utf8Decoder.decode(j.subarray(A,K),this._parseBuffer);if(L=this._parser.parse(this._parseBuffer,q))return this._preserveStack($,V,q,A),this._logSlowResolvingAsync(L),L}else if(!ue){const A=typeof j=="string"?this._stringDecoder.decode(j,this._parseBuffer):this._utf8Decoder.decode(j,this._parseBuffer);if(L=this._parser.parse(this._parseBuffer,A))return this._preserveStack($,V,A,0),this._logSlowResolvingAsync(L),L}this._activeBuffer.x===$&&this._activeBuffer.y===V||this._onCursorMove.fire();const he=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),F=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);F<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(F,this._bufferService.rows-1),Math.min(he,this._bufferService.rows-1))}print(j,T,L){let $,V;const J=this._charsetService.charset,ue=this._optionsService.rawOptions.screenReaderMode,he=this._bufferService.cols,F=this._coreService.decPrivateModes.wraparound,A=this._coreService.modes.insertMode,K=this._curAttrData;let q=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&L-T>0&&q.getWidth(this._activeBuffer.x-1)===2&&q.setCellFromCodepoint(this._activeBuffer.x-1,0,1,K);let ee=this._parser.precedingJoinState;for(let te=T;te<L;++te){if($=j[te],$<127&&J){const ct=J[String.fromCharCode($)];ct&&($=ct.charCodeAt(0))}const Se=this._unicodeService.charProperties($,ee);V=C.UnicodeService.extractWidth(Se);const Ie=C.UnicodeService.extractShouldJoin(Se),Ee=Ie?C.UnicodeService.extractWidth(ee):0;if(ee=Se,ue&&this._onA11yChar.fire((0,_.stringFromCodePoint)($)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+V-Ee>he){if(F){const ct=q;let G=this._activeBuffer.x-Ee;for(this._activeBuffer.x=Ee,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),q=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),Ee>0&&q instanceof p.BufferLine&&q.copyCellsFrom(ct,G,0,Ee,!1);G<he;)ct.setCellFromCodepoint(G++,0,1,K)}else if(this._activeBuffer.x=he-1,V===2)continue}if(Ie&&this._activeBuffer.x){const ct=q.getWidth(this._activeBuffer.x-1)?1:2;q.addCodepointToCell(this._activeBuffer.x-ct,$,V);for(let G=V-Ee;--G>=0;)q.setCellFromCodepoint(this._activeBuffer.x++,0,0,K)}else if(A&&(q.insertCells(this._activeBuffer.x,V-Ee,this._activeBuffer.getNullCell(K)),q.getWidth(he-1)===2&&q.setCellFromCodepoint(he-1,u.NULL_CELL_CODE,u.NULL_CELL_WIDTH,K)),q.setCellFromCodepoint(this._activeBuffer.x++,$,V,K),V>0)for(;--V;)q.setCellFromCodepoint(this._activeBuffer.x++,0,0,K)}this._parser.precedingJoinState=ee,this._activeBuffer.x<he&&L-T>0&&q.getWidth(this._activeBuffer.x)===0&&!q.hasContent(this._activeBuffer.x)&&q.setCellFromCodepoint(this._activeBuffer.x,0,1,K),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(j,T){return j.final!=="t"||j.prefix||j.intermediates?this._parser.registerCsiHandler(j,T):this._parser.registerCsiHandler(j,L=>!I(L.params[0],this._optionsService.rawOptions.windowOptions)||T(L))}registerDcsHandler(j,T){return this._parser.registerDcsHandler(j,new b.DcsHandler(T))}registerEscHandler(j,T){return this._parser.registerEscHandler(j,T)}registerOscHandler(j,T){return this._parser.registerOscHandler(j,new S.OscHandler(T))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var j;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&((j=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))!=null&&j.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);T.hasWidth(this._activeBuffer.x)&&!T.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const j=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-j),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(j=this._bufferService.cols-1){this._activeBuffer.x=Math.min(j,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(j,T){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=j,this._activeBuffer.y=this._activeBuffer.scrollTop+T):(this._activeBuffer.x=j,this._activeBuffer.y=T),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(j,T){this._restrictCursor(),this._setCursor(this._activeBuffer.x+j,this._activeBuffer.y+T)}cursorUp(j){const T=this._activeBuffer.y-this._activeBuffer.scrollTop;return T>=0?this._moveCursor(0,-Math.min(T,j.params[0]||1)):this._moveCursor(0,-(j.params[0]||1)),!0}cursorDown(j){const T=this._activeBuffer.scrollBottom-this._activeBuffer.y;return T>=0?this._moveCursor(0,Math.min(T,j.params[0]||1)):this._moveCursor(0,j.params[0]||1),!0}cursorForward(j){return this._moveCursor(j.params[0]||1,0),!0}cursorBackward(j){return this._moveCursor(-(j.params[0]||1),0),!0}cursorNextLine(j){return this.cursorDown(j),this._activeBuffer.x=0,!0}cursorPrecedingLine(j){return this.cursorUp(j),this._activeBuffer.x=0,!0}cursorCharAbsolute(j){return this._setCursor((j.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(j){return this._setCursor(j.length>=2?(j.params[1]||1)-1:0,(j.params[0]||1)-1),!0}charPosAbsolute(j){return this._setCursor((j.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(j){return this._moveCursor(j.params[0]||1,0),!0}linePosAbsolute(j){return this._setCursor(this._activeBuffer.x,(j.params[0]||1)-1),!0}vPositionRelative(j){return this._moveCursor(0,j.params[0]||1),!0}hVPosition(j){return this.cursorPosition(j),!0}tabClear(j){const T=j.params[0];return T===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:T===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(j){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let T=j.params[0]||1;for(;T--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(j){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let T=j.params[0]||1;for(;T--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(j){const T=j.params[0];return T===1&&(this._curAttrData.bg|=536870912),T!==2&&T!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(j,T,L,$=!1,V=!1){const J=this._activeBuffer.lines.get(this._activeBuffer.ybase+j);J.replaceCells(T,L,this._activeBuffer.getNullCell(this._eraseAttrData()),V),$&&(J.isWrapped=!1)}_resetBufferLine(j,T=!1){const L=this._activeBuffer.lines.get(this._activeBuffer.ybase+j);L&&(L.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),T),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+j),L.isWrapped=!1)}eraseInDisplay(j,T=!1){let L;switch(this._restrictCursor(this._bufferService.cols),j.params[0]){case 0:for(L=this._activeBuffer.y,this._dirtyRowTracker.markDirty(L),this._eraseInBufferLine(L++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,T);L<this._bufferService.rows;L++)this._resetBufferLine(L,T);this._dirtyRowTracker.markDirty(L);break;case 1:for(L=this._activeBuffer.y,this._dirtyRowTracker.markDirty(L),this._eraseInBufferLine(L,0,this._activeBuffer.x+1,!0,T),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(L+1).isWrapped=!1);L--;)this._resetBufferLine(L,T);this._dirtyRowTracker.markDirty(0);break;case 2:for(L=this._bufferService.rows,this._dirtyRowTracker.markDirty(L-1);L--;)this._resetBufferLine(L,T);this._dirtyRowTracker.markDirty(0);break;case 3:const $=this._activeBuffer.lines.length-this._bufferService.rows;$>0&&(this._activeBuffer.lines.trimStart($),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-$,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-$,0),this._onScroll.fire(0))}return!0}eraseInLine(j,T=!1){switch(this._restrictCursor(this._bufferService.cols),j.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,T);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,T);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,T)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(j){this._restrictCursor();let T=j.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const L=this._activeBuffer.ybase+this._activeBuffer.y,$=this._bufferService.rows-1-this._activeBuffer.scrollBottom,V=this._bufferService.rows-1+this._activeBuffer.ybase-$+1;for(;T--;)this._activeBuffer.lines.splice(V-1,1),this._activeBuffer.lines.splice(L,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(j){this._restrictCursor();let T=j.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const L=this._activeBuffer.ybase+this._activeBuffer.y;let $;for($=this._bufferService.rows-1-this._activeBuffer.scrollBottom,$=this._bufferService.rows-1+this._activeBuffer.ybase-$;T--;)this._activeBuffer.lines.splice(L,1),this._activeBuffer.lines.splice($,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(j){this._restrictCursor();const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return T&&(T.insertCells(this._activeBuffer.x,j.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(j){this._restrictCursor();const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return T&&(T.deleteCells(this._activeBuffer.x,j.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(j){let T=j.params[0]||1;for(;T--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(j){let T=j.params[0]||1;for(;T--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(p.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(j){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=j.params[0]||1;for(let L=this._activeBuffer.scrollTop;L<=this._activeBuffer.scrollBottom;++L){const $=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);$.deleteCells(0,T,this._activeBuffer.getNullCell(this._eraseAttrData())),$.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(j){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=j.params[0]||1;for(let L=this._activeBuffer.scrollTop;L<=this._activeBuffer.scrollBottom;++L){const $=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);$.insertCells(0,T,this._activeBuffer.getNullCell(this._eraseAttrData())),$.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(j){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=j.params[0]||1;for(let L=this._activeBuffer.scrollTop;L<=this._activeBuffer.scrollBottom;++L){const $=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);$.insertCells(this._activeBuffer.x,T,this._activeBuffer.getNullCell(this._eraseAttrData())),$.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(j){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=j.params[0]||1;for(let L=this._activeBuffer.scrollTop;L<=this._activeBuffer.scrollBottom;++L){const $=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);$.deleteCells(this._activeBuffer.x,T,this._activeBuffer.getNullCell(this._eraseAttrData())),$.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(j){this._restrictCursor();const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return T&&(T.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(j.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(j){const T=this._parser.precedingJoinState;if(!T)return!0;const L=j.params[0]||1,$=C.UnicodeService.extractWidth(T),V=this._activeBuffer.x-$,J=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(V),ue=new Uint32Array(J.length*L);let he=0;for(let A=0;A<J.length;){const K=J.codePointAt(A)||0;ue[he++]=K,A+=K>65535?2:1}let F=he;for(let A=1;A<L;++A)ue.copyWithin(F,0,he),F+=he;return this.print(ue,0,F),!0}sendDeviceAttributesPrimary(j){return j.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(m.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(m.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(j){return j.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(m.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(m.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(j.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(m.C0.ESC+"[>83;40003;0c")),!0}_is(j){return(this._optionsService.rawOptions.termName+"").indexOf(j)===0}setMode(j){for(let T=0;T<j.length;T++)switch(j.params[T]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(j){for(let T=0;T<j.length;T++)switch(j.params[T]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,v.DEFAULT_CHARSET),this._charsetService.setgCharset(1,v.DEFAULT_CHARSET),this._charsetService.setgCharset(2,v.DEFAULT_CHARSET),this._charsetService.setgCharset(3,v.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(j){for(let T=0;T<j.length;T++)switch(j.params[T]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(j){for(let T=0;T<j.length;T++)switch(j.params[T]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),j.params[T]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(j,T){const L=this._coreService.decPrivateModes,{activeProtocol:$,activeEncoding:V}=this._coreMouseService,J=this._coreService,{buffers:ue,cols:he}=this._bufferService,{active:F,alt:A}=ue,K=this._optionsService.rawOptions,q=Ie=>Ie?1:2,ee=j.params[0];return te=ee,Se=T?ee===2?4:ee===4?q(J.modes.insertMode):ee===12?3:ee===20?q(K.convertEol):0:ee===1?q(L.applicationCursorKeys):ee===3?K.windowOptions.setWinLines?he===80?2:he===132?1:0:0:ee===6?q(L.origin):ee===7?q(L.wraparound):ee===8?3:ee===9?q($==="X10"):ee===12?q(K.cursorBlink):ee===25?q(!J.isCursorHidden):ee===45?q(L.reverseWraparound):ee===66?q(L.applicationKeypad):ee===67?4:ee===1e3?q($==="VT200"):ee===1002?q($==="DRAG"):ee===1003?q($==="ANY"):ee===1004?q(L.sendFocus):ee===1005?4:ee===1006?q(V==="SGR"):ee===1015?4:ee===1016?q(V==="SGR_PIXELS"):ee===1048?1:ee===47||ee===1047||ee===1049?q(F===A):ee===2004?q(L.bracketedPasteMode):0,J.triggerDataEvent(`${m.C0.ESC}[${T?"":"?"}${te};${Se}$y`),!0;var te,Se}_updateAttrColor(j,T,L,$,V){return T===2?(j|=50331648,j&=-16777216,j|=x.AttributeData.fromColorRGB([L,$,V])):T===5&&(j&=-50331904,j|=33554432|255&L),j}_extractColor(j,T,L){const $=[0,0,-1,0,0,0];let V=0,J=0;do{if($[J+V]=j.params[T+J],j.hasSubParams(T+J)){const ue=j.getSubParams(T+J);let he=0;do $[1]===5&&(V=1),$[J+he+1+V]=ue[he];while(++he<ue.length&&he+J+1+V<$.length);break}if($[1]===5&&J+V>=2||$[1]===2&&J+V>=5)break;$[1]&&(V=1)}while(++J+T<j.length&&J+V<$.length);for(let ue=2;ue<$.length;++ue)$[ue]===-1&&($[ue]=0);switch($[0]){case 38:L.fg=this._updateAttrColor(L.fg,$[1],$[3],$[4],$[5]);break;case 48:L.bg=this._updateAttrColor(L.bg,$[1],$[3],$[4],$[5]);break;case 58:L.extended=L.extended.clone(),L.extended.underlineColor=this._updateAttrColor(L.extended.underlineColor,$[1],$[3],$[4],$[5])}return J}_processUnderline(j,T){T.extended=T.extended.clone(),(!~j||j>5)&&(j=1),T.extended.underlineStyle=j,T.fg|=268435456,j===0&&(T.fg&=-268435457),T.updateExtended()}_processSGR0(j){j.fg=p.DEFAULT_ATTR_DATA.fg,j.bg=p.DEFAULT_ATTR_DATA.bg,j.extended=j.extended.clone(),j.extended.underlineStyle=0,j.extended.underlineColor&=-67108864,j.updateExtended()}charAttributes(j){if(j.length===1&&j.params[0]===0)return this._processSGR0(this._curAttrData),!0;const T=j.length;let L;const $=this._curAttrData;for(let V=0;V<T;V++)L=j.params[V],L>=30&&L<=37?($.fg&=-50331904,$.fg|=16777216|L-30):L>=40&&L<=47?($.bg&=-50331904,$.bg|=16777216|L-40):L>=90&&L<=97?($.fg&=-50331904,$.fg|=16777224|L-90):L>=100&&L<=107?($.bg&=-50331904,$.bg|=16777224|L-100):L===0?this._processSGR0($):L===1?$.fg|=134217728:L===3?$.bg|=67108864:L===4?($.fg|=268435456,this._processUnderline(j.hasSubParams(V)?j.getSubParams(V)[0]:1,$)):L===5?$.fg|=536870912:L===7?$.fg|=67108864:L===8?$.fg|=1073741824:L===9?$.fg|=2147483648:L===2?$.bg|=134217728:L===21?this._processUnderline(2,$):L===22?($.fg&=-134217729,$.bg&=-134217729):L===23?$.bg&=-67108865:L===24?($.fg&=-268435457,this._processUnderline(0,$)):L===25?$.fg&=-536870913:L===27?$.fg&=-67108865:L===28?$.fg&=-1073741825:L===29?$.fg&=2147483647:L===39?($.fg&=-67108864,$.fg|=16777215&p.DEFAULT_ATTR_DATA.fg):L===49?($.bg&=-67108864,$.bg|=16777215&p.DEFAULT_ATTR_DATA.bg):L===38||L===48||L===58?V+=this._extractColor(j,V,$):L===53?$.bg|=1073741824:L===55?$.bg&=-1073741825:L===59?($.extended=$.extended.clone(),$.extended.underlineColor=-1,$.updateExtended()):L===100?($.fg&=-67108864,$.fg|=16777215&p.DEFAULT_ATTR_DATA.fg,$.bg&=-67108864,$.bg|=16777215&p.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",L);return!0}deviceStatus(j){switch(j.params[0]){case 5:this._coreService.triggerDataEvent(`${m.C0.ESC}[0n`);break;case 6:const T=this._activeBuffer.y+1,L=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${m.C0.ESC}[${T};${L}R`)}return!0}deviceStatusPrivate(j){if(j.params[0]===6){const T=this._activeBuffer.y+1,L=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${m.C0.ESC}[?${T};${L}R`)}return!0}softReset(j){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=p.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(j){const T=j.params[0]||1;switch(T){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const L=T%2==1;return this._optionsService.options.cursorBlink=L,!0}setScrollRegion(j){const T=j.params[0]||1;let L;return(j.length<2||(L=j.params[1])>this._bufferService.rows||L===0)&&(L=this._bufferService.rows),L>T&&(this._activeBuffer.scrollTop=T-1,this._activeBuffer.scrollBottom=L-1,this._setCursor(0,0)),!0}windowOptions(j){if(!I(j.params[0],this._optionsService.rawOptions.windowOptions))return!0;const T=j.length>1?j.params[1]:0;switch(j.params[0]){case 14:T!==2&&this._onRequestWindowsOptionsReport.fire(P.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(P.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${m.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:T!==0&&T!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),T!==0&&T!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:T!==0&&T!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),T!==0&&T!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(j){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(j){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(j){return this._windowTitle=j,this._onTitleChange.fire(j),!0}setIconName(j){return this._iconName=j,!0}setOrReportIndexedColor(j){const T=[],L=j.split(";");for(;L.length>1;){const $=L.shift(),V=L.shift();if(/^\d+$/.exec($)){const J=parseInt($);if(z(J))if(V==="?")T.push({type:0,index:J});else{const ue=(0,E.parseColor)(V);ue&&T.push({type:1,index:J,color:ue})}}}return T.length&&this._onColor.fire(T),!0}setHyperlink(j){const T=j.split(";");return!(T.length<2)&&(T[1]?this._createHyperlink(T[0],T[1]):!T[0]&&this._finishHyperlink())}_createHyperlink(j,T){this._getCurrentLinkId()&&this._finishHyperlink();const L=j.split(":");let $;const V=L.findIndex(J=>J.startsWith("id="));return V!==-1&&($=L[V].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:$,uri:T}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(j,T){const L=j.split(";");for(let $=0;$<L.length&&!(T>=this._specialColors.length);++$,++T)if(L[$]==="?")this._onColor.fire([{type:0,index:this._specialColors[T]}]);else{const V=(0,E.parseColor)(L[$]);V&&this._onColor.fire([{type:1,index:this._specialColors[T],color:V}])}return!0}setOrReportFgColor(j){return this._setOrReportSpecialColor(j,0)}setOrReportBgColor(j){return this._setOrReportSpecialColor(j,1)}setOrReportCursorColor(j){return this._setOrReportSpecialColor(j,2)}restoreIndexedColor(j){if(!j)return this._onColor.fire([{type:2}]),!0;const T=[],L=j.split(";");for(let $=0;$<L.length;++$)if(/^\d+$/.exec(L[$])){const V=parseInt(L[$]);z(V)&&T.push({type:2,index:V})}return T.length&&this._onColor.fire(T),!0}restoreFgColor(j){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(j){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(j){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,v.DEFAULT_CHARSET),!0}selectCharset(j){return j.length!==2?(this.selectDefaultCharset(),!0):(j[0]==="/"||this._charsetService.setgCharset(N[j[0]],v.CHARSETS[j[1]]||v.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const j=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,j,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=p.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=p.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(j){return this._charsetService.setgLevel(j),!0}screenAlignmentPattern(){const j=new f.CellData;j.content=4194373,j.fg=this._curAttrData.fg,j.bg=this._curAttrData.bg,this._setCursor(0,0);for(let T=0;T<this._bufferService.rows;++T){const L=this._activeBuffer.ybase+this._activeBuffer.y+T,$=this._activeBuffer.lines.get(L);$&&($.fill(j),$.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(j,T){const L=this._bufferService.buffer,$=this._optionsService.rawOptions;return(V=>(this._coreService.triggerDataEvent(`${m.C0.ESC}${V}${m.C0.ESC}\\`),!0))(j==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:j==='"p'?'P1$r61;1"p':j==="r"?`P1$r${L.scrollTop+1};${L.scrollBottom+1}r`:j==="m"?"P1$r0m":j===" q"?`P1$r${{block:2,underline:4,bar:6}[$.cursorStyle]-($.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(j,T){this._dirtyRowTracker.markRangeDirty(j,T)}}o.InputHandler=D;let H=class{constructor(B){this._bufferService=B,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(B){B<this.start?this.start=B:B>this.end&&(this.end=B)}markRangeDirty(B,j){B>j&&(U=B,B=j,j=U),B<this.start&&(this.start=B),j>this.end&&(this.end=j)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function z(B){return 0<=B&&B<256}H=d([g(0,k.IBufferService)],H)},844:(c,o)=>{function l(d){for(const g of d)g.dispose();d.length=0}Object.defineProperty(o,"__esModule",{value:!0}),o.getDisposeArrayDisposable=o.disposeArray=o.toDisposable=o.MutableDisposable=o.Disposable=void 0,o.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const d of this._disposables)d.dispose();this._disposables.length=0}register(d){return this._disposables.push(d),d}unregister(d){const g=this._disposables.indexOf(d);g!==-1&&this._disposables.splice(g,1)}},o.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(d){var g;this._isDisposed||d===this._value||((g=this._value)==null||g.dispose(),this._value=d)}clear(){this.value=void 0}dispose(){var d;this._isDisposed=!0,(d=this._value)==null||d.dispose(),this._value=void 0}},o.toDisposable=function(d){return{dispose:d}},o.disposeArray=l,o.getDisposeArrayDisposable=function(d){return{dispose:()=>l(d)}}},1505:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.FourKeyMap=o.TwoKeyMap=void 0;class l{constructor(){this._data={}}set(g,m,v){this._data[g]||(this._data[g]={}),this._data[g][m]=v}get(g,m){return this._data[g]?this._data[g][m]:void 0}clear(){this._data={}}}o.TwoKeyMap=l,o.FourKeyMap=class{constructor(){this._data=new l}set(d,g,m,v,y){this._data.get(d,g)||this._data.set(d,g,new l),this._data.get(d,g).set(m,v,y)}get(d,g,m,v){var y;return(y=this._data.get(d,g))==null?void 0:y.get(m,v)}clear(){this._data.clear()}}},6114:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isChromeOS=o.isLinux=o.isWindows=o.isIphone=o.isIpad=o.isMac=o.getSafariVersion=o.isSafari=o.isLegacyEdge=o.isFirefox=o.isNode=void 0,o.isNode=typeof process<"u"&&"title"in process;const l=o.isNode?"node":navigator.userAgent,d=o.isNode?"node":navigator.platform;o.isFirefox=l.includes("Firefox"),o.isLegacyEdge=l.includes("Edge"),o.isSafari=/^((?!chrome|android).)*safari/i.test(l),o.getSafariVersion=function(){if(!o.isSafari)return 0;const g=l.match(/Version\/(\d+)/);return g===null||g.length<2?0:parseInt(g[1])},o.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(d),o.isIpad=d==="iPad",o.isIphone=d==="iPhone",o.isWindows=["Windows","Win16","Win32","WinCE"].includes(d),o.isLinux=d.indexOf("Linux")>=0,o.isChromeOS=/\bCrOS\b/.test(l)},6106:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.SortedList=void 0;let l=0;o.SortedList=class{constructor(d){this._getKey=d,this._array=[]}clear(){this._array.length=0}insert(d){this._array.length!==0?(l=this._search(this._getKey(d)),this._array.splice(l,0,d)):this._array.push(d)}delete(d){if(this._array.length===0)return!1;const g=this._getKey(d);if(g===void 0||(l=this._search(g),l===-1)||this._getKey(this._array[l])!==g)return!1;do if(this._array[l]===d)return this._array.splice(l,1),!0;while(++l<this._array.length&&this._getKey(this._array[l])===g);return!1}*getKeyIterator(d){if(this._array.length!==0&&(l=this._search(d),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===d))do yield this._array[l];while(++l<this._array.length&&this._getKey(this._array[l])===d)}forEachByKey(d,g){if(this._array.length!==0&&(l=this._search(d),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===d))do g(this._array[l]);while(++l<this._array.length&&this._getKey(this._array[l])===d)}values(){return[...this._array].values()}_search(d){let g=0,m=this._array.length-1;for(;m>=g;){let v=g+m>>1;const y=this._getKey(this._array[v]);if(y>d)m=v-1;else{if(!(y<d)){for(;v>0&&this._getKey(this._array[v-1])===d;)v--;return v}g=v+1}}return g}}},7226:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DebouncedIdleTask=o.IdleTaskQueue=o.PriorityTaskQueue=void 0;const d=l(6114);class g{constructor(){this._tasks=[],this._i=0}enqueue(y){this._tasks.push(y),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(y){this._idleCallback=void 0;let w=0,_=0,p=y.timeRemaining(),h=0;for(;this._i<this._tasks.length;){if(w=Date.now(),this._tasks[this._i]()||this._i++,w=Math.max(1,Date.now()-w),_=Math.max(w,_),h=y.timeRemaining(),1.5*_>h)return p-w<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(p-w))}ms`),void this._start();p=h}this.clear()}}class m extends g{_requestCallback(y){return setTimeout(()=>y(this._createDeadline(16)))}_cancelCallback(y){clearTimeout(y)}_createDeadline(y){const w=Date.now()+y;return{timeRemaining:()=>Math.max(0,w-Date.now())}}}o.PriorityTaskQueue=m,o.IdleTaskQueue=!d.isNode&&"requestIdleCallback"in window?class extends g{_requestCallback(v){return requestIdleCallback(v)}_cancelCallback(v){cancelIdleCallback(v)}}:m,o.DebouncedIdleTask=class{constructor(){this._queue=new o.IdleTaskQueue}set(v){this._queue.clear(),this._queue.enqueue(v)}flush(){this._queue.flush()}}},9282:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.updateWindowsModeWrappedState=void 0;const d=l(643);o.updateWindowsModeWrappedState=function(g){const m=g.buffer.lines.get(g.buffer.ybase+g.buffer.y-1),v=m==null?void 0:m.get(g.cols-1),y=g.buffer.lines.get(g.buffer.ybase+g.buffer.y);y&&v&&(y.isWrapped=v[d.CHAR_DATA_CODE_INDEX]!==d.NULL_CELL_CODE&&v[d.CHAR_DATA_CODE_INDEX]!==d.WHITESPACE_CELL_CODE)}},3734:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ExtendedAttrs=o.AttributeData=void 0;class l{constructor(){this.fg=0,this.bg=0,this.extended=new d}static toColorRGB(m){return[m>>>16&255,m>>>8&255,255&m]}static fromColorRGB(m){return(255&m[0])<<16|(255&m[1])<<8|255&m[2]}clone(){const m=new l;return m.fg=this.fg,m.bg=this.bg,m.extended=this.extended.clone(),m}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}o.AttributeData=l;class d{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(m){this._ext=m}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(m){this._ext&=-469762049,this._ext|=m<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(m){this._ext&=-67108864,this._ext|=67108863&m}get urlId(){return this._urlId}set urlId(m){this._urlId=m}get underlineVariantOffset(){const m=(3758096384&this._ext)>>29;return m<0?4294967288^m:m}set underlineVariantOffset(m){this._ext&=536870911,this._ext|=m<<29&3758096384}constructor(m=0,v=0){this._ext=0,this._urlId=0,this._ext=m,this._urlId=v}clone(){return new d(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}o.ExtendedAttrs=d},9092:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Buffer=o.MAX_BUFFER_SIZE=void 0;const d=l(6349),g=l(7226),m=l(3734),v=l(8437),y=l(4634),w=l(511),_=l(643),p=l(4863),h=l(7116);o.MAX_BUFFER_SIZE=4294967295,o.Buffer=class{constructor(u,f,x){this._hasScrollback=u,this._optionsService=f,this._bufferService=x,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=v.DEFAULT_ATTR_DATA.clone(),this.savedCharset=h.DEFAULT_CHARSET,this.markers=[],this._nullCell=w.CellData.fromCharData([0,_.NULL_CELL_CHAR,_.NULL_CELL_WIDTH,_.NULL_CELL_CODE]),this._whitespaceCell=w.CellData.fromCharData([0,_.WHITESPACE_CELL_CHAR,_.WHITESPACE_CELL_WIDTH,_.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new g.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new d.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(u){return u?(this._nullCell.fg=u.fg,this._nullCell.bg=u.bg,this._nullCell.extended=u.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new m.ExtendedAttrs),this._nullCell}getWhitespaceCell(u){return u?(this._whitespaceCell.fg=u.fg,this._whitespaceCell.bg=u.bg,this._whitespaceCell.extended=u.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new m.ExtendedAttrs),this._whitespaceCell}getBlankLine(u,f){return new v.BufferLine(this._bufferService.cols,this.getNullCell(u),f)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const u=this.ybase+this.y-this.ydisp;return u>=0&&u<this._rows}_getCorrectBufferLength(u){if(!this._hasScrollback)return u;const f=u+this._optionsService.rawOptions.scrollback;return f>o.MAX_BUFFER_SIZE?o.MAX_BUFFER_SIZE:f}fillViewportRows(u){if(this.lines.length===0){u===void 0&&(u=v.DEFAULT_ATTR_DATA);let f=this._rows;for(;f--;)this.lines.push(this.getBlankLine(u))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new d.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(u,f){const x=this.getNullCell(v.DEFAULT_ATTR_DATA);let k=0;const C=this._getCorrectBufferLength(f);if(C>this.lines.maxLength&&(this.lines.maxLength=C),this.lines.length>0){if(this._cols<u)for(let b=0;b<this.lines.length;b++)k+=+this.lines.get(b).resize(u,x);let S=0;if(this._rows<f)for(let b=this._rows;b<f;b++)this.lines.length<f+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new v.BufferLine(u,x)):this.ybase>0&&this.lines.length<=this.ybase+this.y+S+1?(this.ybase--,S++,this.ydisp>0&&this.ydisp--):this.lines.push(new v.BufferLine(u,x)));else for(let b=this._rows;b>f;b--)this.lines.length>f+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(C<this.lines.maxLength){const b=this.lines.length-C;b>0&&(this.lines.trimStart(b),this.ybase=Math.max(this.ybase-b,0),this.ydisp=Math.max(this.ydisp-b,0),this.savedY=Math.max(this.savedY-b,0)),this.lines.maxLength=C}this.x=Math.min(this.x,u-1),this.y=Math.min(this.y,f-1),S&&(this.y+=S),this.savedX=Math.min(this.savedX,u-1),this.scrollTop=0}if(this.scrollBottom=f-1,this._isReflowEnabled&&(this._reflow(u,f),this._cols>u))for(let S=0;S<this.lines.length;S++)k+=+this.lines.get(S).resize(u,x);this._cols=u,this._rows=f,this._memoryCleanupQueue.clear(),k>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let u=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,u=!1);let f=0;for(;this._memoryCleanupPosition<this.lines.length;)if(f+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),f>100)return!0;return u}get _isReflowEnabled(){const u=this._optionsService.rawOptions.windowsPty;return u&&u.buildNumber?this._hasScrollback&&u.backend==="conpty"&&u.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(u,f){this._cols!==u&&(u>this._cols?this._reflowLarger(u,f):this._reflowSmaller(u,f))}_reflowLarger(u,f){const x=(0,y.reflowLargerGetLinesToRemove)(this.lines,this._cols,u,this.ybase+this.y,this.getNullCell(v.DEFAULT_ATTR_DATA));if(x.length>0){const k=(0,y.reflowLargerCreateNewLayout)(this.lines,x);(0,y.reflowLargerApplyNewLayout)(this.lines,k.layout),this._reflowLargerAdjustViewport(u,f,k.countRemoved)}}_reflowLargerAdjustViewport(u,f,x){const k=this.getNullCell(v.DEFAULT_ATTR_DATA);let C=x;for(;C-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<f&&this.lines.push(new v.BufferLine(u,k))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-x,0)}_reflowSmaller(u,f){const x=this.getNullCell(v.DEFAULT_ATTR_DATA),k=[];let C=0;for(let S=this.lines.length-1;S>=0;S--){let b=this.lines.get(S);if(!b||!b.isWrapped&&b.getTrimmedLength()<=u)continue;const E=[b];for(;b.isWrapped&&S>0;)b=this.lines.get(--S),E.unshift(b);const N=this.ybase+this.y;if(N>=S&&N<S+E.length)continue;const O=E[E.length-1].getTrimmedLength(),I=(0,y.reflowSmallerGetNewLineLengths)(E,this._cols,u),P=I.length-E.length;let U;U=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+P):Math.max(0,this.lines.length-this.lines.maxLength+P);const D=[];for(let L=0;L<P;L++){const $=this.getBlankLine(v.DEFAULT_ATTR_DATA,!0);D.push($)}D.length>0&&(k.push({start:S+E.length+C,newLines:D}),C+=D.length),E.push(...D);let H=I.length-1,z=I[H];z===0&&(H--,z=I[H]);let B=E.length-P-1,j=O;for(;B>=0;){const L=Math.min(j,z);if(E[H]===void 0)break;if(E[H].copyCellsFrom(E[B],j-L,z-L,L,!0),z-=L,z===0&&(H--,z=I[H]),j-=L,j===0){B--;const $=Math.max(B,0);j=(0,y.getWrappedLineTrimmedLength)(E,$,this._cols)}}for(let L=0;L<E.length;L++)I[L]<u&&E[L].setCell(I[L],x);let T=P-U;for(;T-- >0;)this.ybase===0?this.y<f-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+C)-f&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+P,this.ybase+f-1)}if(k.length>0){const S=[],b=[];for(let H=0;H<this.lines.length;H++)b.push(this.lines.get(H));const E=this.lines.length;let N=E-1,O=0,I=k[O];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+C);let P=0;for(let H=Math.min(this.lines.maxLength-1,E+C-1);H>=0;H--)if(I&&I.start>N+P){for(let z=I.newLines.length-1;z>=0;z--)this.lines.set(H--,I.newLines[z]);H++,S.push({index:N+1,amount:I.newLines.length}),P+=I.newLines.length,I=k[++O]}else this.lines.set(H,b[N--]);let U=0;for(let H=S.length-1;H>=0;H--)S[H].index+=U,this.lines.onInsertEmitter.fire(S[H]),U+=S[H].amount;const D=Math.max(0,E+C-this.lines.maxLength);D>0&&this.lines.onTrimEmitter.fire(D)}}translateBufferLineToString(u,f,x=0,k){const C=this.lines.get(u);return C?C.translateToString(f,x,k):""}getWrappedRangeForLine(u){let f=u,x=u;for(;f>0&&this.lines.get(f).isWrapped;)f--;for(;x+1<this.lines.length&&this.lines.get(x+1).isWrapped;)x++;return{first:f,last:x}}setupTabStops(u){for(u!=null?this.tabs[u]||(u=this.prevStop(u)):(this.tabs={},u=0);u<this._cols;u+=this._optionsService.rawOptions.tabStopWidth)this.tabs[u]=!0}prevStop(u){for(u==null&&(u=this.x);!this.tabs[--u]&&u>0;);return u>=this._cols?this._cols-1:u<0?0:u}nextStop(u){for(u==null&&(u=this.x);!this.tabs[++u]&&u<this._cols;);return u>=this._cols?this._cols-1:u<0?0:u}clearMarkers(u){this._isClearing=!0;for(let f=0;f<this.markers.length;f++)this.markers[f].line===u&&(this.markers[f].dispose(),this.markers.splice(f--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let u=0;u<this.markers.length;u++)this.markers[u].dispose(),this.markers.splice(u--,1);this._isClearing=!1}addMarker(u){const f=new p.Marker(u);return this.markers.push(f),f.register(this.lines.onTrim(x=>{f.line-=x,f.line<0&&f.dispose()})),f.register(this.lines.onInsert(x=>{f.line>=x.index&&(f.line+=x.amount)})),f.register(this.lines.onDelete(x=>{f.line>=x.index&&f.line<x.index+x.amount&&f.dispose(),f.line>x.index&&(f.line-=x.amount)})),f.register(f.onDispose(()=>this._removeMarker(f))),f}_removeMarker(u){this._isClearing||this.markers.splice(this.markers.indexOf(u),1)}}},8437:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferLine=o.DEFAULT_ATTR_DATA=void 0;const d=l(3734),g=l(511),m=l(643),v=l(482);o.DEFAULT_ATTR_DATA=Object.freeze(new d.AttributeData);let y=0;class w{constructor(p,h,u=!1){this.isWrapped=u,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*p);const f=h||g.CellData.fromCharData([0,m.NULL_CELL_CHAR,m.NULL_CELL_WIDTH,m.NULL_CELL_CODE]);for(let x=0;x<p;++x)this.setCell(x,f);this.length=p}get(p){const h=this._data[3*p+0],u=2097151&h;return[this._data[3*p+1],2097152&h?this._combined[p]:u?(0,v.stringFromCodePoint)(u):"",h>>22,2097152&h?this._combined[p].charCodeAt(this._combined[p].length-1):u]}set(p,h){this._data[3*p+1]=h[m.CHAR_DATA_ATTR_INDEX],h[m.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[p]=h[1],this._data[3*p+0]=2097152|p|h[m.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*p+0]=h[m.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|h[m.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(p){return this._data[3*p+0]>>22}hasWidth(p){return 12582912&this._data[3*p+0]}getFg(p){return this._data[3*p+1]}getBg(p){return this._data[3*p+2]}hasContent(p){return 4194303&this._data[3*p+0]}getCodePoint(p){const h=this._data[3*p+0];return 2097152&h?this._combined[p].charCodeAt(this._combined[p].length-1):2097151&h}isCombined(p){return 2097152&this._data[3*p+0]}getString(p){const h=this._data[3*p+0];return 2097152&h?this._combined[p]:2097151&h?(0,v.stringFromCodePoint)(2097151&h):""}isProtected(p){return 536870912&this._data[3*p+2]}loadCell(p,h){return y=3*p,h.content=this._data[y+0],h.fg=this._data[y+1],h.bg=this._data[y+2],2097152&h.content&&(h.combinedData=this._combined[p]),268435456&h.bg&&(h.extended=this._extendedAttrs[p]),h}setCell(p,h){2097152&h.content&&(this._combined[p]=h.combinedData),268435456&h.bg&&(this._extendedAttrs[p]=h.extended),this._data[3*p+0]=h.content,this._data[3*p+1]=h.fg,this._data[3*p+2]=h.bg}setCellFromCodepoint(p,h,u,f){268435456&f.bg&&(this._extendedAttrs[p]=f.extended),this._data[3*p+0]=h|u<<22,this._data[3*p+1]=f.fg,this._data[3*p+2]=f.bg}addCodepointToCell(p,h,u){let f=this._data[3*p+0];2097152&f?this._combined[p]+=(0,v.stringFromCodePoint)(h):2097151&f?(this._combined[p]=(0,v.stringFromCodePoint)(2097151&f)+(0,v.stringFromCodePoint)(h),f&=-2097152,f|=2097152):f=h|4194304,u&&(f&=-12582913,f|=u<<22),this._data[3*p+0]=f}insertCells(p,h,u){if((p%=this.length)&&this.getWidth(p-1)===2&&this.setCellFromCodepoint(p-1,0,1,u),h<this.length-p){const f=new g.CellData;for(let x=this.length-p-h-1;x>=0;--x)this.setCell(p+h+x,this.loadCell(p+x,f));for(let x=0;x<h;++x)this.setCell(p+x,u)}else for(let f=p;f<this.length;++f)this.setCell(f,u);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,u)}deleteCells(p,h,u){if(p%=this.length,h<this.length-p){const f=new g.CellData;for(let x=0;x<this.length-p-h;++x)this.setCell(p+x,this.loadCell(p+h+x,f));for(let x=this.length-h;x<this.length;++x)this.setCell(x,u)}else for(let f=p;f<this.length;++f)this.setCell(f,u);p&&this.getWidth(p-1)===2&&this.setCellFromCodepoint(p-1,0,1,u),this.getWidth(p)!==0||this.hasContent(p)||this.setCellFromCodepoint(p,0,1,u)}replaceCells(p,h,u,f=!1){if(f)for(p&&this.getWidth(p-1)===2&&!this.isProtected(p-1)&&this.setCellFromCodepoint(p-1,0,1,u),h<this.length&&this.getWidth(h-1)===2&&!this.isProtected(h)&&this.setCellFromCodepoint(h,0,1,u);p<h&&p<this.length;)this.isProtected(p)||this.setCell(p,u),p++;else for(p&&this.getWidth(p-1)===2&&this.setCellFromCodepoint(p-1,0,1,u),h<this.length&&this.getWidth(h-1)===2&&this.setCellFromCodepoint(h,0,1,u);p<h&&p<this.length;)this.setCell(p++,u)}resize(p,h){if(p===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const u=3*p;if(p>this.length){if(this._data.buffer.byteLength>=4*u)this._data=new Uint32Array(this._data.buffer,0,u);else{const f=new Uint32Array(u);f.set(this._data),this._data=f}for(let f=this.length;f<p;++f)this.setCell(f,h)}else{this._data=this._data.subarray(0,u);const f=Object.keys(this._combined);for(let k=0;k<f.length;k++){const C=parseInt(f[k],10);C>=p&&delete this._combined[C]}const x=Object.keys(this._extendedAttrs);for(let k=0;k<x.length;k++){const C=parseInt(x[k],10);C>=p&&delete this._extendedAttrs[C]}}return this.length=p,4*u*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const p=new Uint32Array(this._data.length);return p.set(this._data),this._data=p,1}return 0}fill(p,h=!1){if(h)for(let u=0;u<this.length;++u)this.isProtected(u)||this.setCell(u,p);else{this._combined={},this._extendedAttrs={};for(let u=0;u<this.length;++u)this.setCell(u,p)}}copyFrom(p){this.length!==p.length?this._data=new Uint32Array(p._data):this._data.set(p._data),this.length=p.length,this._combined={};for(const h in p._combined)this._combined[h]=p._combined[h];this._extendedAttrs={};for(const h in p._extendedAttrs)this._extendedAttrs[h]=p._extendedAttrs[h];this.isWrapped=p.isWrapped}clone(){const p=new w(0);p._data=new Uint32Array(this._data),p.length=this.length;for(const h in this._combined)p._combined[h]=this._combined[h];for(const h in this._extendedAttrs)p._extendedAttrs[h]=this._extendedAttrs[h];return p.isWrapped=this.isWrapped,p}getTrimmedLength(){for(let p=this.length-1;p>=0;--p)if(4194303&this._data[3*p+0])return p+(this._data[3*p+0]>>22);return 0}getNoBgTrimmedLength(){for(let p=this.length-1;p>=0;--p)if(4194303&this._data[3*p+0]||50331648&this._data[3*p+2])return p+(this._data[3*p+0]>>22);return 0}copyCellsFrom(p,h,u,f,x){const k=p._data;if(x)for(let S=f-1;S>=0;S--){for(let b=0;b<3;b++)this._data[3*(u+S)+b]=k[3*(h+S)+b];268435456&k[3*(h+S)+2]&&(this._extendedAttrs[u+S]=p._extendedAttrs[h+S])}else for(let S=0;S<f;S++){for(let b=0;b<3;b++)this._data[3*(u+S)+b]=k[3*(h+S)+b];268435456&k[3*(h+S)+2]&&(this._extendedAttrs[u+S]=p._extendedAttrs[h+S])}const C=Object.keys(p._combined);for(let S=0;S<C.length;S++){const b=parseInt(C[S],10);b>=h&&(this._combined[b-h+u]=p._combined[b])}}translateToString(p,h,u,f){h=h??0,u=u??this.length,p&&(u=Math.min(u,this.getTrimmedLength())),f&&(f.length=0);let x="";for(;h<u;){const k=this._data[3*h+0],C=2097151&k,S=2097152&k?this._combined[h]:C?(0,v.stringFromCodePoint)(C):m.WHITESPACE_CELL_CHAR;if(x+=S,f)for(let b=0;b<S.length;++b)f.push(h);h+=k>>22||1}return f&&f.push(h),x}}o.BufferLine=w},4841:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.getRangeLength=void 0,o.getRangeLength=function(l,d){if(l.start.y>l.end.y)throw new Error(`Buffer range end (${l.end.x}, ${l.end.y}) cannot be before start (${l.start.x}, ${l.start.y})`);return d*(l.end.y-l.start.y)+(l.end.x-l.start.x+1)}},4634:(c,o)=>{function l(d,g,m){if(g===d.length-1)return d[g].getTrimmedLength();const v=!d[g].hasContent(m-1)&&d[g].getWidth(m-1)===1,y=d[g+1].getWidth(0)===2;return v&&y?m-1:m}Object.defineProperty(o,"__esModule",{value:!0}),o.getWrappedLineTrimmedLength=o.reflowSmallerGetNewLineLengths=o.reflowLargerApplyNewLayout=o.reflowLargerCreateNewLayout=o.reflowLargerGetLinesToRemove=void 0,o.reflowLargerGetLinesToRemove=function(d,g,m,v,y){const w=[];for(let _=0;_<d.length-1;_++){let p=_,h=d.get(++p);if(!h.isWrapped)continue;const u=[d.get(_)];for(;p<d.length&&h.isWrapped;)u.push(h),h=d.get(++p);if(v>=_&&v<p){_+=u.length-1;continue}let f=0,x=l(u,f,g),k=1,C=0;for(;k<u.length;){const b=l(u,k,g),E=b-C,N=m-x,O=Math.min(E,N);u[f].copyCellsFrom(u[k],C,x,O,!1),x+=O,x===m&&(f++,x=0),C+=O,C===b&&(k++,C=0),x===0&&f!==0&&u[f-1].getWidth(m-1)===2&&(u[f].copyCellsFrom(u[f-1],m-1,x++,1,!1),u[f-1].setCell(m-1,y))}u[f].replaceCells(x,m,y);let S=0;for(let b=u.length-1;b>0&&(b>f||u[b].getTrimmedLength()===0);b--)S++;S>0&&(w.push(_+u.length-S),w.push(S)),_+=u.length-1}return w},o.reflowLargerCreateNewLayout=function(d,g){const m=[];let v=0,y=g[v],w=0;for(let _=0;_<d.length;_++)if(y===_){const p=g[++v];d.onDeleteEmitter.fire({index:_-w,amount:p}),_+=p-1,w+=p,y=g[++v]}else m.push(_);return{layout:m,countRemoved:w}},o.reflowLargerApplyNewLayout=function(d,g){const m=[];for(let v=0;v<g.length;v++)m.push(d.get(g[v]));for(let v=0;v<m.length;v++)d.set(v,m[v]);d.length=g.length},o.reflowSmallerGetNewLineLengths=function(d,g,m){const v=[],y=d.map((h,u)=>l(d,u,g)).reduce((h,u)=>h+u);let w=0,_=0,p=0;for(;p<y;){if(y-p<m){v.push(y-p);break}w+=m;const h=l(d,_,g);w>h&&(w-=h,_++);const u=d[_].getWidth(w-1)===2;u&&w--;const f=u?m-1:m;v.push(f),p+=f}return v},o.getWrappedLineTrimmedLength=l},5295:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferSet=void 0;const d=l(8460),g=l(844),m=l(9092);class v extends g.Disposable{constructor(w,_){super(),this._optionsService=w,this._bufferService=_,this._onBufferActivate=this.register(new d.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new m.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new m.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(w){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(w),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(w,_){this._normal.resize(w,_),this._alt.resize(w,_),this.setupTabStops(w)}setupTabStops(w){this._normal.setupTabStops(w),this._alt.setupTabStops(w)}}o.BufferSet=v},511:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CellData=void 0;const d=l(482),g=l(643),m=l(3734);class v extends m.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new m.ExtendedAttrs,this.combinedData=""}static fromCharData(w){const _=new v;return _.setFromCharData(w),_}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,d.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(w){this.fg=w[g.CHAR_DATA_ATTR_INDEX],this.bg=0;let _=!1;if(w[g.CHAR_DATA_CHAR_INDEX].length>2)_=!0;else if(w[g.CHAR_DATA_CHAR_INDEX].length===2){const p=w[g.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=p&&p<=56319){const h=w[g.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=h&&h<=57343?this.content=1024*(p-55296)+h-56320+65536|w[g.CHAR_DATA_WIDTH_INDEX]<<22:_=!0}else _=!0}else this.content=w[g.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|w[g.CHAR_DATA_WIDTH_INDEX]<<22;_&&(this.combinedData=w[g.CHAR_DATA_CHAR_INDEX],this.content=2097152|w[g.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}o.CellData=v},643:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.WHITESPACE_CELL_CODE=o.WHITESPACE_CELL_WIDTH=o.WHITESPACE_CELL_CHAR=o.NULL_CELL_CODE=o.NULL_CELL_WIDTH=o.NULL_CELL_CHAR=o.CHAR_DATA_CODE_INDEX=o.CHAR_DATA_WIDTH_INDEX=o.CHAR_DATA_CHAR_INDEX=o.CHAR_DATA_ATTR_INDEX=o.DEFAULT_EXT=o.DEFAULT_ATTR=o.DEFAULT_COLOR=void 0,o.DEFAULT_COLOR=0,o.DEFAULT_ATTR=256|o.DEFAULT_COLOR<<9,o.DEFAULT_EXT=0,o.CHAR_DATA_ATTR_INDEX=0,o.CHAR_DATA_CHAR_INDEX=1,o.CHAR_DATA_WIDTH_INDEX=2,o.CHAR_DATA_CODE_INDEX=3,o.NULL_CELL_CHAR="",o.NULL_CELL_WIDTH=1,o.NULL_CELL_CODE=0,o.WHITESPACE_CELL_CHAR=" ",o.WHITESPACE_CELL_WIDTH=1,o.WHITESPACE_CELL_CODE=32},4863:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Marker=void 0;const d=l(8460),g=l(844);class m{get id(){return this._id}constructor(y){this.line=y,this.isDisposed=!1,this._disposables=[],this._id=m._nextId++,this._onDispose=this.register(new d.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,g.disposeArray)(this._disposables),this._disposables.length=0)}register(y){return this._disposables.push(y),y}}o.Marker=m,m._nextId=1},7116:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DEFAULT_CHARSET=o.CHARSETS=void 0,o.CHARSETS={},o.DEFAULT_CHARSET=o.CHARSETS.B,o.CHARSETS[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},o.CHARSETS.A={"#":""},o.CHARSETS.B=void 0,o.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},o.CHARSETS.C=o.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},o.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},o.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},o.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},o.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},o.CHARSETS.E=o.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},o.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},o.CHARSETS.H=o.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},o.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},2584:(c,o)=>{var l,d,g;Object.defineProperty(o,"__esModule",{value:!0}),o.C1_ESCAPED=o.C1=o.C0=void 0,function(m){m.NUL="\0",m.SOH="",m.STX="",m.ETX="",m.EOT="",m.ENQ="",m.ACK="",m.BEL="\x07",m.BS="\b",m.HT="	",m.LF=`
`,m.VT="\v",m.FF="\f",m.CR="\r",m.SO="",m.SI="",m.DLE="",m.DC1="",m.DC2="",m.DC3="",m.DC4="",m.NAK="",m.SYN="",m.ETB="",m.CAN="",m.EM="",m.SUB="",m.ESC="\x1B",m.FS="",m.GS="",m.RS="",m.US="",m.SP=" ",m.DEL=""}(l||(o.C0=l={})),function(m){m.PAD="",m.HOP="",m.BPH="",m.NBH="",m.IND="",m.NEL="",m.SSA="",m.ESA="",m.HTS="",m.HTJ="",m.VTS="",m.PLD="",m.PLU="",m.RI="",m.SS2="",m.SS3="",m.DCS="",m.PU1="",m.PU2="",m.STS="",m.CCH="",m.MW="",m.SPA="",m.EPA="",m.SOS="",m.SGCI="",m.SCI="",m.CSI="",m.ST="",m.OSC="",m.PM="",m.APC=""}(d||(o.C1=d={})),function(m){m.ST=`${l.ESC}\\`}(g||(o.C1_ESCAPED=g={}))},7399:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.evaluateKeyboardEvent=void 0;const d=l(2584),g={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};o.evaluateKeyboardEvent=function(m,v,y,w){const _={type:0,cancel:!1,key:void 0},p=(m.shiftKey?1:0)|(m.altKey?2:0)|(m.ctrlKey?4:0)|(m.metaKey?8:0);switch(m.keyCode){case 0:m.key==="UIKeyInputUpArrow"?_.key=v?d.C0.ESC+"OA":d.C0.ESC+"[A":m.key==="UIKeyInputLeftArrow"?_.key=v?d.C0.ESC+"OD":d.C0.ESC+"[D":m.key==="UIKeyInputRightArrow"?_.key=v?d.C0.ESC+"OC":d.C0.ESC+"[C":m.key==="UIKeyInputDownArrow"&&(_.key=v?d.C0.ESC+"OB":d.C0.ESC+"[B");break;case 8:_.key=m.ctrlKey?"\b":d.C0.DEL,m.altKey&&(_.key=d.C0.ESC+_.key);break;case 9:if(m.shiftKey){_.key=d.C0.ESC+"[Z";break}_.key=d.C0.HT,_.cancel=!0;break;case 13:_.key=m.altKey?d.C0.ESC+d.C0.CR:d.C0.CR,_.cancel=!0;break;case 27:_.key=d.C0.ESC,m.altKey&&(_.key=d.C0.ESC+d.C0.ESC),_.cancel=!0;break;case 37:if(m.metaKey)break;p?(_.key=d.C0.ESC+"[1;"+(p+1)+"D",_.key===d.C0.ESC+"[1;3D"&&(_.key=d.C0.ESC+(y?"b":"[1;5D"))):_.key=v?d.C0.ESC+"OD":d.C0.ESC+"[D";break;case 39:if(m.metaKey)break;p?(_.key=d.C0.ESC+"[1;"+(p+1)+"C",_.key===d.C0.ESC+"[1;3C"&&(_.key=d.C0.ESC+(y?"f":"[1;5C"))):_.key=v?d.C0.ESC+"OC":d.C0.ESC+"[C";break;case 38:if(m.metaKey)break;p?(_.key=d.C0.ESC+"[1;"+(p+1)+"A",y||_.key!==d.C0.ESC+"[1;3A"||(_.key=d.C0.ESC+"[1;5A")):_.key=v?d.C0.ESC+"OA":d.C0.ESC+"[A";break;case 40:if(m.metaKey)break;p?(_.key=d.C0.ESC+"[1;"+(p+1)+"B",y||_.key!==d.C0.ESC+"[1;3B"||(_.key=d.C0.ESC+"[1;5B")):_.key=v?d.C0.ESC+"OB":d.C0.ESC+"[B";break;case 45:m.shiftKey||m.ctrlKey||(_.key=d.C0.ESC+"[2~");break;case 46:_.key=p?d.C0.ESC+"[3;"+(p+1)+"~":d.C0.ESC+"[3~";break;case 36:_.key=p?d.C0.ESC+"[1;"+(p+1)+"H":v?d.C0.ESC+"OH":d.C0.ESC+"[H";break;case 35:_.key=p?d.C0.ESC+"[1;"+(p+1)+"F":v?d.C0.ESC+"OF":d.C0.ESC+"[F";break;case 33:m.shiftKey?_.type=2:m.ctrlKey?_.key=d.C0.ESC+"[5;"+(p+1)+"~":_.key=d.C0.ESC+"[5~";break;case 34:m.shiftKey?_.type=3:m.ctrlKey?_.key=d.C0.ESC+"[6;"+(p+1)+"~":_.key=d.C0.ESC+"[6~";break;case 112:_.key=p?d.C0.ESC+"[1;"+(p+1)+"P":d.C0.ESC+"OP";break;case 113:_.key=p?d.C0.ESC+"[1;"+(p+1)+"Q":d.C0.ESC+"OQ";break;case 114:_.key=p?d.C0.ESC+"[1;"+(p+1)+"R":d.C0.ESC+"OR";break;case 115:_.key=p?d.C0.ESC+"[1;"+(p+1)+"S":d.C0.ESC+"OS";break;case 116:_.key=p?d.C0.ESC+"[15;"+(p+1)+"~":d.C0.ESC+"[15~";break;case 117:_.key=p?d.C0.ESC+"[17;"+(p+1)+"~":d.C0.ESC+"[17~";break;case 118:_.key=p?d.C0.ESC+"[18;"+(p+1)+"~":d.C0.ESC+"[18~";break;case 119:_.key=p?d.C0.ESC+"[19;"+(p+1)+"~":d.C0.ESC+"[19~";break;case 120:_.key=p?d.C0.ESC+"[20;"+(p+1)+"~":d.C0.ESC+"[20~";break;case 121:_.key=p?d.C0.ESC+"[21;"+(p+1)+"~":d.C0.ESC+"[21~";break;case 122:_.key=p?d.C0.ESC+"[23;"+(p+1)+"~":d.C0.ESC+"[23~";break;case 123:_.key=p?d.C0.ESC+"[24;"+(p+1)+"~":d.C0.ESC+"[24~";break;default:if(!m.ctrlKey||m.shiftKey||m.altKey||m.metaKey)if(y&&!w||!m.altKey||m.metaKey)!y||m.altKey||m.ctrlKey||m.shiftKey||!m.metaKey?m.key&&!m.ctrlKey&&!m.altKey&&!m.metaKey&&m.keyCode>=48&&m.key.length===1?_.key=m.key:m.key&&m.ctrlKey&&(m.key==="_"&&(_.key=d.C0.US),m.key==="@"&&(_.key=d.C0.NUL)):m.keyCode===65&&(_.type=1);else{const h=g[m.keyCode],u=h==null?void 0:h[m.shiftKey?1:0];if(u)_.key=d.C0.ESC+u;else if(m.keyCode>=65&&m.keyCode<=90){const f=m.ctrlKey?m.keyCode-64:m.keyCode+32;let x=String.fromCharCode(f);m.shiftKey&&(x=x.toUpperCase()),_.key=d.C0.ESC+x}else if(m.keyCode===32)_.key=d.C0.ESC+(m.ctrlKey?d.C0.NUL:" ");else if(m.key==="Dead"&&m.code.startsWith("Key")){let f=m.code.slice(3,4);m.shiftKey||(f=f.toLowerCase()),_.key=d.C0.ESC+f,_.cancel=!0}}else m.keyCode>=65&&m.keyCode<=90?_.key=String.fromCharCode(m.keyCode-64):m.keyCode===32?_.key=d.C0.NUL:m.keyCode>=51&&m.keyCode<=55?_.key=String.fromCharCode(m.keyCode-51+27):m.keyCode===56?_.key=d.C0.DEL:m.keyCode===219?_.key=d.C0.ESC:m.keyCode===220?_.key=d.C0.FS:m.keyCode===221&&(_.key=d.C0.GS)}return _}},482:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Utf8ToUtf32=o.StringToUtf32=o.utf32ToString=o.stringFromCodePoint=void 0,o.stringFromCodePoint=function(l){return l>65535?(l-=65536,String.fromCharCode(55296+(l>>10))+String.fromCharCode(l%1024+56320)):String.fromCharCode(l)},o.utf32ToString=function(l,d=0,g=l.length){let m="";for(let v=d;v<g;++v){let y=l[v];y>65535?(y-=65536,m+=String.fromCharCode(55296+(y>>10))+String.fromCharCode(y%1024+56320)):m+=String.fromCharCode(y)}return m},o.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(l,d){const g=l.length;if(!g)return 0;let m=0,v=0;if(this._interim){const y=l.charCodeAt(v++);56320<=y&&y<=57343?d[m++]=1024*(this._interim-55296)+y-56320+65536:(d[m++]=this._interim,d[m++]=y),this._interim=0}for(let y=v;y<g;++y){const w=l.charCodeAt(y);if(55296<=w&&w<=56319){if(++y>=g)return this._interim=w,m;const _=l.charCodeAt(y);56320<=_&&_<=57343?d[m++]=1024*(w-55296)+_-56320+65536:(d[m++]=w,d[m++]=_)}else w!==65279&&(d[m++]=w)}return m}},o.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(l,d){const g=l.length;if(!g)return 0;let m,v,y,w,_=0,p=0,h=0;if(this.interim[0]){let x=!1,k=this.interim[0];k&=(224&k)==192?31:(240&k)==224?15:7;let C,S=0;for(;(C=63&this.interim[++S])&&S<4;)k<<=6,k|=C;const b=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,E=b-S;for(;h<E;){if(h>=g)return 0;if(C=l[h++],(192&C)!=128){h--,x=!0;break}this.interim[S++]=C,k<<=6,k|=63&C}x||(b===2?k<128?h--:d[_++]=k:b===3?k<2048||k>=55296&&k<=57343||k===65279||(d[_++]=k):k<65536||k>1114111||(d[_++]=k)),this.interim.fill(0)}const u=g-4;let f=h;for(;f<g;){for(;!(!(f<u)||128&(m=l[f])||128&(v=l[f+1])||128&(y=l[f+2])||128&(w=l[f+3]));)d[_++]=m,d[_++]=v,d[_++]=y,d[_++]=w,f+=4;if(m=l[f++],m<128)d[_++]=m;else if((224&m)==192){if(f>=g)return this.interim[0]=m,_;if(v=l[f++],(192&v)!=128){f--;continue}if(p=(31&m)<<6|63&v,p<128){f--;continue}d[_++]=p}else if((240&m)==224){if(f>=g)return this.interim[0]=m,_;if(v=l[f++],(192&v)!=128){f--;continue}if(f>=g)return this.interim[0]=m,this.interim[1]=v,_;if(y=l[f++],(192&y)!=128){f--;continue}if(p=(15&m)<<12|(63&v)<<6|63&y,p<2048||p>=55296&&p<=57343||p===65279)continue;d[_++]=p}else if((248&m)==240){if(f>=g)return this.interim[0]=m,_;if(v=l[f++],(192&v)!=128){f--;continue}if(f>=g)return this.interim[0]=m,this.interim[1]=v,_;if(y=l[f++],(192&y)!=128){f--;continue}if(f>=g)return this.interim[0]=m,this.interim[1]=v,this.interim[2]=y,_;if(w=l[f++],(192&w)!=128){f--;continue}if(p=(7&m)<<18|(63&v)<<12|(63&y)<<6|63&w,p<65536||p>1114111)continue;d[_++]=p}}return _}}},225:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UnicodeV6=void 0;const d=l(1480),g=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],m=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let v;o.UnicodeV6=class{constructor(){if(this.version="6",!v){v=new Uint8Array(65536),v.fill(1),v[0]=0,v.fill(0,1,32),v.fill(0,127,160),v.fill(2,4352,4448),v[9001]=2,v[9002]=2,v.fill(2,11904,42192),v[12351]=1,v.fill(2,44032,55204),v.fill(2,63744,64256),v.fill(2,65040,65050),v.fill(2,65072,65136),v.fill(2,65280,65377),v.fill(2,65504,65511);for(let y=0;y<g.length;++y)v.fill(0,g[y][0],g[y][1]+1)}}wcwidth(y){return y<32?0:y<127?1:y<65536?v[y]:function(w,_){let p,h=0,u=_.length-1;if(w<_[0][0]||w>_[u][1])return!1;for(;u>=h;)if(p=h+u>>1,w>_[p][1])h=p+1;else{if(!(w<_[p][0]))return!0;u=p-1}return!1}(y,m)?0:y>=131072&&y<=196605||y>=196608&&y<=262141?2:1}charProperties(y,w){let _=this.wcwidth(y),p=_===0&&w!==0;if(p){const h=d.UnicodeService.extractWidth(w);h===0?p=!1:h>_&&(_=h)}return d.UnicodeService.createPropertyValue(0,_,p)}}},5981:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.WriteBuffer=void 0;const d=l(8460),g=l(844);class m extends g.Disposable{constructor(y){super(),this._action=y,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new d.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(y,w){if(w!==void 0&&this._syncCalls>w)return void(this._syncCalls=0);if(this._pendingData+=y.length,this._writeBuffer.push(y),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let _;for(this._isSyncWriting=!0;_=this._writeBuffer.shift();){this._action(_);const p=this._callbacks.shift();p&&p()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(y,w){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=y.length,this._writeBuffer.push(y),this._callbacks.push(w),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=y.length,this._writeBuffer.push(y),this._callbacks.push(w)}_innerWrite(y=0,w=!0){const _=y||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const p=this._writeBuffer[this._bufferOffset],h=this._action(p,w);if(h){const f=x=>Date.now()-_>=12?setTimeout(()=>this._innerWrite(0,x)):this._innerWrite(_,x);return void h.catch(x=>(queueMicrotask(()=>{throw x}),Promise.resolve(!1))).then(f)}const u=this._callbacks[this._bufferOffset];if(u&&u(),this._bufferOffset++,this._pendingData-=p.length,Date.now()-_>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}o.WriteBuffer=m},5941:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.toRgbString=o.parseColor=void 0;const l=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,d=/^[\da-f]+$/;function g(m,v){const y=m.toString(16),w=y.length<2?"0"+y:y;switch(v){case 4:return y[0];case 8:return w;case 12:return(w+w).slice(0,3);default:return w+w}}o.parseColor=function(m){if(!m)return;let v=m.toLowerCase();if(v.indexOf("rgb:")===0){v=v.slice(4);const y=l.exec(v);if(y){const w=y[1]?15:y[4]?255:y[7]?4095:65535;return[Math.round(parseInt(y[1]||y[4]||y[7]||y[10],16)/w*255),Math.round(parseInt(y[2]||y[5]||y[8]||y[11],16)/w*255),Math.round(parseInt(y[3]||y[6]||y[9]||y[12],16)/w*255)]}}else if(v.indexOf("#")===0&&(v=v.slice(1),d.exec(v)&&[3,6,9,12].includes(v.length))){const y=v.length/3,w=[0,0,0];for(let _=0;_<3;++_){const p=parseInt(v.slice(y*_,y*_+y),16);w[_]=y===1?p<<4:y===2?p:y===3?p>>4:p>>8}return w}},o.toRgbString=function(m,v=16){const[y,w,_]=m;return`rgb:${g(y,v)}/${g(w,v)}/${g(_,v)}`}},5770:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PAYLOAD_LIMIT=void 0,o.PAYLOAD_LIMIT=1e7},6351:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DcsHandler=o.DcsParser=void 0;const d=l(482),g=l(8742),m=l(5770),v=[];o.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=v,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=v}registerHandler(w,_){this._handlers[w]===void 0&&(this._handlers[w]=[]);const p=this._handlers[w];return p.push(_),{dispose:()=>{const h=p.indexOf(_);h!==-1&&p.splice(h,1)}}}clearHandler(w){this._handlers[w]&&delete this._handlers[w]}setHandlerFallback(w){this._handlerFb=w}reset(){if(this._active.length)for(let w=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;w>=0;--w)this._active[w].unhook(!1);this._stack.paused=!1,this._active=v,this._ident=0}hook(w,_){if(this.reset(),this._ident=w,this._active=this._handlers[w]||v,this._active.length)for(let p=this._active.length-1;p>=0;p--)this._active[p].hook(_);else this._handlerFb(this._ident,"HOOK",_)}put(w,_,p){if(this._active.length)for(let h=this._active.length-1;h>=0;h--)this._active[h].put(w,_,p);else this._handlerFb(this._ident,"PUT",(0,d.utf32ToString)(w,_,p))}unhook(w,_=!0){if(this._active.length){let p=!1,h=this._active.length-1,u=!1;if(this._stack.paused&&(h=this._stack.loopPosition-1,p=_,u=this._stack.fallThrough,this._stack.paused=!1),!u&&p===!1){for(;h>=0&&(p=this._active[h].unhook(w),p!==!0);h--)if(p instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=h,this._stack.fallThrough=!1,p;h--}for(;h>=0;h--)if(p=this._active[h].unhook(!1),p instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=h,this._stack.fallThrough=!0,p}else this._handlerFb(this._ident,"UNHOOK",w);this._active=v,this._ident=0}};const y=new g.Params;y.addParam(0),o.DcsHandler=class{constructor(w){this._handler=w,this._data="",this._params=y,this._hitLimit=!1}hook(w){this._params=w.length>1||w.params[0]?w.clone():y,this._data="",this._hitLimit=!1}put(w,_,p){this._hitLimit||(this._data+=(0,d.utf32ToString)(w,_,p),this._data.length>m.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(w){let _=!1;if(this._hitLimit)_=!1;else if(w&&(_=this._handler(this._data,this._params),_ instanceof Promise))return _.then(p=>(this._params=y,this._data="",this._hitLimit=!1,p));return this._params=y,this._data="",this._hitLimit=!1,_}}},2015:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.EscapeSequenceParser=o.VT500_TRANSITION_TABLE=o.TransitionTable=void 0;const d=l(844),g=l(8742),m=l(6242),v=l(6351);class y{constructor(h){this.table=new Uint8Array(h)}setDefault(h,u){this.table.fill(h<<4|u)}add(h,u,f,x){this.table[u<<8|h]=f<<4|x}addMany(h,u,f,x){for(let k=0;k<h.length;k++)this.table[u<<8|h[k]]=f<<4|x}}o.TransitionTable=y;const w=160;o.VT500_TRANSITION_TABLE=function(){const p=new y(4095),h=Array.apply(null,Array(256)).map((S,b)=>b),u=(S,b)=>h.slice(S,b),f=u(32,127),x=u(0,24);x.push(25),x.push.apply(x,u(28,32));const k=u(0,14);let C;for(C in p.setDefault(1,0),p.addMany(f,0,2,0),k)p.addMany([24,26,153,154],C,3,0),p.addMany(u(128,144),C,3,0),p.addMany(u(144,152),C,3,0),p.add(156,C,0,0),p.add(27,C,11,1),p.add(157,C,4,8),p.addMany([152,158,159],C,0,7),p.add(155,C,11,3),p.add(144,C,11,9);return p.addMany(x,0,3,0),p.addMany(x,1,3,1),p.add(127,1,0,1),p.addMany(x,8,0,8),p.addMany(x,3,3,3),p.add(127,3,0,3),p.addMany(x,4,3,4),p.add(127,4,0,4),p.addMany(x,6,3,6),p.addMany(x,5,3,5),p.add(127,5,0,5),p.addMany(x,2,3,2),p.add(127,2,0,2),p.add(93,1,4,8),p.addMany(f,8,5,8),p.add(127,8,5,8),p.addMany([156,27,24,26,7],8,6,0),p.addMany(u(28,32),8,0,8),p.addMany([88,94,95],1,0,7),p.addMany(f,7,0,7),p.addMany(x,7,0,7),p.add(156,7,0,0),p.add(127,7,0,7),p.add(91,1,11,3),p.addMany(u(64,127),3,7,0),p.addMany(u(48,60),3,8,4),p.addMany([60,61,62,63],3,9,4),p.addMany(u(48,60),4,8,4),p.addMany(u(64,127),4,7,0),p.addMany([60,61,62,63],4,0,6),p.addMany(u(32,64),6,0,6),p.add(127,6,0,6),p.addMany(u(64,127),6,0,0),p.addMany(u(32,48),3,9,5),p.addMany(u(32,48),5,9,5),p.addMany(u(48,64),5,0,6),p.addMany(u(64,127),5,7,0),p.addMany(u(32,48),4,9,5),p.addMany(u(32,48),1,9,2),p.addMany(u(32,48),2,9,2),p.addMany(u(48,127),2,10,0),p.addMany(u(48,80),1,10,0),p.addMany(u(81,88),1,10,0),p.addMany([89,90,92],1,10,0),p.addMany(u(96,127),1,10,0),p.add(80,1,11,9),p.addMany(x,9,0,9),p.add(127,9,0,9),p.addMany(u(28,32),9,0,9),p.addMany(u(32,48),9,9,12),p.addMany(u(48,60),9,8,10),p.addMany([60,61,62,63],9,9,10),p.addMany(x,11,0,11),p.addMany(u(32,128),11,0,11),p.addMany(u(28,32),11,0,11),p.addMany(x,10,0,10),p.add(127,10,0,10),p.addMany(u(28,32),10,0,10),p.addMany(u(48,60),10,8,10),p.addMany([60,61,62,63],10,0,11),p.addMany(u(32,48),10,9,12),p.addMany(x,12,0,12),p.add(127,12,0,12),p.addMany(u(28,32),12,0,12),p.addMany(u(32,48),12,9,12),p.addMany(u(48,64),12,0,11),p.addMany(u(64,127),12,12,13),p.addMany(u(64,127),10,12,13),p.addMany(u(64,127),9,12,13),p.addMany(x,13,13,13),p.addMany(f,13,13,13),p.add(127,13,0,13),p.addMany([27,156,24,26],13,14,0),p.add(w,0,2,0),p.add(w,8,5,8),p.add(w,6,0,6),p.add(w,11,0,11),p.add(w,13,13,13),p}();class _ extends d.Disposable{constructor(h=o.VT500_TRANSITION_TABLE){super(),this._transitions=h,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new g.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(u,f,x)=>{},this._executeHandlerFb=u=>{},this._csiHandlerFb=(u,f)=>{},this._escHandlerFb=u=>{},this._errorHandlerFb=u=>u,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,d.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new m.OscParser),this._dcsParser=this.register(new v.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(h,u=[64,126]){let f=0;if(h.prefix){if(h.prefix.length>1)throw new Error("only one byte as prefix supported");if(f=h.prefix.charCodeAt(0),f&&60>f||f>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(h.intermediates){if(h.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let k=0;k<h.intermediates.length;++k){const C=h.intermediates.charCodeAt(k);if(32>C||C>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");f<<=8,f|=C}}if(h.final.length!==1)throw new Error("final must be a single byte");const x=h.final.charCodeAt(0);if(u[0]>x||x>u[1])throw new Error(`final must be in range ${u[0]} .. ${u[1]}`);return f<<=8,f|=x,f}identToString(h){const u=[];for(;h;)u.push(String.fromCharCode(255&h)),h>>=8;return u.reverse().join("")}setPrintHandler(h){this._printHandler=h}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(h,u){const f=this._identifier(h,[48,126]);this._escHandlers[f]===void 0&&(this._escHandlers[f]=[]);const x=this._escHandlers[f];return x.push(u),{dispose:()=>{const k=x.indexOf(u);k!==-1&&x.splice(k,1)}}}clearEscHandler(h){this._escHandlers[this._identifier(h,[48,126])]&&delete this._escHandlers[this._identifier(h,[48,126])]}setEscHandlerFallback(h){this._escHandlerFb=h}setExecuteHandler(h,u){this._executeHandlers[h.charCodeAt(0)]=u}clearExecuteHandler(h){this._executeHandlers[h.charCodeAt(0)]&&delete this._executeHandlers[h.charCodeAt(0)]}setExecuteHandlerFallback(h){this._executeHandlerFb=h}registerCsiHandler(h,u){const f=this._identifier(h);this._csiHandlers[f]===void 0&&(this._csiHandlers[f]=[]);const x=this._csiHandlers[f];return x.push(u),{dispose:()=>{const k=x.indexOf(u);k!==-1&&x.splice(k,1)}}}clearCsiHandler(h){this._csiHandlers[this._identifier(h)]&&delete this._csiHandlers[this._identifier(h)]}setCsiHandlerFallback(h){this._csiHandlerFb=h}registerDcsHandler(h,u){return this._dcsParser.registerHandler(this._identifier(h),u)}clearDcsHandler(h){this._dcsParser.clearHandler(this._identifier(h))}setDcsHandlerFallback(h){this._dcsParser.setHandlerFallback(h)}registerOscHandler(h,u){return this._oscParser.registerHandler(h,u)}clearOscHandler(h){this._oscParser.clearHandler(h)}setOscHandlerFallback(h){this._oscParser.setHandlerFallback(h)}setErrorHandler(h){this._errorHandler=h}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(h,u,f,x,k){this._parseStack.state=h,this._parseStack.handlers=u,this._parseStack.handlerPos=f,this._parseStack.transition=x,this._parseStack.chunkPos=k}parse(h,u,f){let x,k=0,C=0,S=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,S=this._parseStack.chunkPos+1;else{if(f===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const b=this._parseStack.handlers;let E=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(f===!1&&E>-1){for(;E>=0&&(x=b[E](this._params),x!==!0);E--)if(x instanceof Promise)return this._parseStack.handlerPos=E,x}this._parseStack.handlers=[];break;case 4:if(f===!1&&E>-1){for(;E>=0&&(x=b[E](),x!==!0);E--)if(x instanceof Promise)return this._parseStack.handlerPos=E,x}this._parseStack.handlers=[];break;case 6:if(k=h[this._parseStack.chunkPos],x=this._dcsParser.unhook(k!==24&&k!==26,f),x)return x;k===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(k=h[this._parseStack.chunkPos],x=this._oscParser.end(k!==24&&k!==26,f),x)return x;k===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,S=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let b=S;b<u;++b){switch(k=h[b],C=this._transitions.table[this.currentState<<8|(k<160?k:w)],C>>4){case 2:for(let P=b+1;;++P){if(P>=u||(k=h[P])<32||k>126&&k<w){this._printHandler(h,b,P),b=P-1;break}if(++P>=u||(k=h[P])<32||k>126&&k<w){this._printHandler(h,b,P),b=P-1;break}if(++P>=u||(k=h[P])<32||k>126&&k<w){this._printHandler(h,b,P),b=P-1;break}if(++P>=u||(k=h[P])<32||k>126&&k<w){this._printHandler(h,b,P),b=P-1;break}}break;case 3:this._executeHandlers[k]?this._executeHandlers[k]():this._executeHandlerFb(k),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:b,code:k,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const E=this._csiHandlers[this._collect<<8|k];let N=E?E.length-1:-1;for(;N>=0&&(x=E[N](this._params),x!==!0);N--)if(x instanceof Promise)return this._preserveStack(3,E,N,C,b),x;N<0&&this._csiHandlerFb(this._collect<<8|k,this._params),this.precedingJoinState=0;break;case 8:do switch(k){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(k-48)}while(++b<u&&(k=h[b])>47&&k<60);b--;break;case 9:this._collect<<=8,this._collect|=k;break;case 10:const O=this._escHandlers[this._collect<<8|k];let I=O?O.length-1:-1;for(;I>=0&&(x=O[I](),x!==!0);I--)if(x instanceof Promise)return this._preserveStack(4,O,I,C,b),x;I<0&&this._escHandlerFb(this._collect<<8|k),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|k,this._params);break;case 13:for(let P=b+1;;++P)if(P>=u||(k=h[P])===24||k===26||k===27||k>127&&k<w){this._dcsParser.put(h,b,P),b=P-1;break}break;case 14:if(x=this._dcsParser.unhook(k!==24&&k!==26),x)return this._preserveStack(6,[],0,C,b),x;k===27&&(C|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let P=b+1;;P++)if(P>=u||(k=h[P])<32||k>127&&k<w){this._oscParser.put(h,b,P),b=P-1;break}break;case 6:if(x=this._oscParser.end(k!==24&&k!==26),x)return this._preserveStack(5,[],0,C,b),x;k===27&&(C|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&C}}}o.EscapeSequenceParser=_},6242:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.OscHandler=o.OscParser=void 0;const d=l(5770),g=l(482),m=[];o.OscParser=class{constructor(){this._state=0,this._active=m,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(v,y){this._handlers[v]===void 0&&(this._handlers[v]=[]);const w=this._handlers[v];return w.push(y),{dispose:()=>{const _=w.indexOf(y);_!==-1&&w.splice(_,1)}}}clearHandler(v){this._handlers[v]&&delete this._handlers[v]}setHandlerFallback(v){this._handlerFb=v}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=m}reset(){if(this._state===2)for(let v=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;v>=0;--v)this._active[v].end(!1);this._stack.paused=!1,this._active=m,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||m,this._active.length)for(let v=this._active.length-1;v>=0;v--)this._active[v].start();else this._handlerFb(this._id,"START")}_put(v,y,w){if(this._active.length)for(let _=this._active.length-1;_>=0;_--)this._active[_].put(v,y,w);else this._handlerFb(this._id,"PUT",(0,g.utf32ToString)(v,y,w))}start(){this.reset(),this._state=1}put(v,y,w){if(this._state!==3){if(this._state===1)for(;y<w;){const _=v[y++];if(_===59){this._state=2,this._start();break}if(_<48||57<_)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+_-48}this._state===2&&w-y>0&&this._put(v,y,w)}}end(v,y=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let w=!1,_=this._active.length-1,p=!1;if(this._stack.paused&&(_=this._stack.loopPosition-1,w=y,p=this._stack.fallThrough,this._stack.paused=!1),!p&&w===!1){for(;_>=0&&(w=this._active[_].end(v),w!==!0);_--)if(w instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!1,w;_--}for(;_>=0;_--)if(w=this._active[_].end(!1),w instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!0,w}else this._handlerFb(this._id,"END",v);this._active=m,this._id=-1,this._state=0}}},o.OscHandler=class{constructor(v){this._handler=v,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(v,y,w){this._hitLimit||(this._data+=(0,g.utf32ToString)(v,y,w),this._data.length>d.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(v){let y=!1;if(this._hitLimit)y=!1;else if(v&&(y=this._handler(this._data),y instanceof Promise))return y.then(w=>(this._data="",this._hitLimit=!1,w));return this._data="",this._hitLimit=!1,y}}},8742:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Params=void 0;const l=2147483647;class d{static fromArray(m){const v=new d;if(!m.length)return v;for(let y=Array.isArray(m[0])?1:0;y<m.length;++y){const w=m[y];if(Array.isArray(w))for(let _=0;_<w.length;++_)v.addSubParam(w[_]);else v.addParam(w)}return v}constructor(m=32,v=32){if(this.maxLength=m,this.maxSubParamsLength=v,v>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(m),this.length=0,this._subParams=new Int32Array(v),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(m),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const m=new d(this.maxLength,this.maxSubParamsLength);return m.params.set(this.params),m.length=this.length,m._subParams.set(this._subParams),m._subParamsLength=this._subParamsLength,m._subParamsIdx.set(this._subParamsIdx),m._rejectDigits=this._rejectDigits,m._rejectSubDigits=this._rejectSubDigits,m._digitIsSub=this._digitIsSub,m}toArray(){const m=[];for(let v=0;v<this.length;++v){m.push(this.params[v]);const y=this._subParamsIdx[v]>>8,w=255&this._subParamsIdx[v];w-y>0&&m.push(Array.prototype.slice.call(this._subParams,y,w))}return m}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(m){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(m<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=m>l?l:m}}addSubParam(m){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(m<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=m>l?l:m,this._subParamsIdx[this.length-1]++}}hasSubParams(m){return(255&this._subParamsIdx[m])-(this._subParamsIdx[m]>>8)>0}getSubParams(m){const v=this._subParamsIdx[m]>>8,y=255&this._subParamsIdx[m];return y-v>0?this._subParams.subarray(v,y):null}getSubParamsAll(){const m={};for(let v=0;v<this.length;++v){const y=this._subParamsIdx[v]>>8,w=255&this._subParamsIdx[v];w-y>0&&(m[v]=this._subParams.slice(y,w))}return m}addDigit(m){let v;if(this._rejectDigits||!(v=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const y=this._digitIsSub?this._subParams:this.params,w=y[v-1];y[v-1]=~w?Math.min(10*w+m,l):m}}o.Params=d},5741:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.AddonManager=void 0,o.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let l=this._addons.length-1;l>=0;l--)this._addons[l].instance.dispose()}loadAddon(l,d){const g={instance:d,dispose:d.dispose,isDisposed:!1};this._addons.push(g),d.dispose=()=>this._wrappedAddonDispose(g),d.activate(l)}_wrappedAddonDispose(l){if(l.isDisposed)return;let d=-1;for(let g=0;g<this._addons.length;g++)if(this._addons[g]===l){d=g;break}if(d===-1)throw new Error("Could not dispose an addon that has not been loaded");l.isDisposed=!0,l.dispose.apply(l.instance),this._addons.splice(d,1)}}},8771:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferApiView=void 0;const d=l(3785),g=l(511);o.BufferApiView=class{constructor(m,v){this._buffer=m,this.type=v}init(m){return this._buffer=m,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(m){const v=this._buffer.lines.get(m);if(v)return new d.BufferLineApiView(v)}getNullCell(){return new g.CellData}}},3785:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferLineApiView=void 0;const d=l(511);o.BufferLineApiView=class{constructor(g){this._line=g}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(g,m){if(!(g<0||g>=this._line.length))return m?(this._line.loadCell(g,m),m):this._line.loadCell(g,new d.CellData)}translateToString(g,m,v){return this._line.translateToString(g,m,v)}}},8285:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferNamespaceApi=void 0;const d=l(8771),g=l(8460),m=l(844);class v extends m.Disposable{constructor(w){super(),this._core=w,this._onBufferChange=this.register(new g.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new d.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new d.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}o.BufferNamespaceApi=v},7975:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ParserApi=void 0,o.ParserApi=class{constructor(l){this._core=l}registerCsiHandler(l,d){return this._core.registerCsiHandler(l,g=>d(g.toArray()))}addCsiHandler(l,d){return this.registerCsiHandler(l,d)}registerDcsHandler(l,d){return this._core.registerDcsHandler(l,(g,m)=>d(g,m.toArray()))}addDcsHandler(l,d){return this.registerDcsHandler(l,d)}registerEscHandler(l,d){return this._core.registerEscHandler(l,d)}addEscHandler(l,d){return this.registerEscHandler(l,d)}registerOscHandler(l,d){return this._core.registerOscHandler(l,d)}addOscHandler(l,d){return this.registerOscHandler(l,d)}}},7090:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UnicodeApi=void 0,o.UnicodeApi=class{constructor(l){this._core=l}register(l){this._core.unicodeService.register(l)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(l){this._core.unicodeService.activeVersion=l}}},744:function(c,o,l){var d=this&&this.__decorate||function(p,h,u,f){var x,k=arguments.length,C=k<3?h:f===null?f=Object.getOwnPropertyDescriptor(h,u):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(p,h,u,f);else for(var S=p.length-1;S>=0;S--)(x=p[S])&&(C=(k<3?x(C):k>3?x(h,u,C):x(h,u))||C);return k>3&&C&&Object.defineProperty(h,u,C),C},g=this&&this.__param||function(p,h){return function(u,f){h(u,f,p)}};Object.defineProperty(o,"__esModule",{value:!0}),o.BufferService=o.MINIMUM_ROWS=o.MINIMUM_COLS=void 0;const m=l(8460),v=l(844),y=l(5295),w=l(2585);o.MINIMUM_COLS=2,o.MINIMUM_ROWS=1;let _=o.BufferService=class extends v.Disposable{get buffer(){return this.buffers.active}constructor(p){super(),this.isUserScrolling=!1,this._onResize=this.register(new m.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new m.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(p.rawOptions.cols||0,o.MINIMUM_COLS),this.rows=Math.max(p.rawOptions.rows||0,o.MINIMUM_ROWS),this.buffers=this.register(new y.BufferSet(p,this))}resize(p,h){this.cols=p,this.rows=h,this.buffers.resize(p,h),this._onResize.fire({cols:p,rows:h})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(p,h=!1){const u=this.buffer;let f;f=this._cachedBlankLine,f&&f.length===this.cols&&f.getFg(0)===p.fg&&f.getBg(0)===p.bg||(f=u.getBlankLine(p,h),this._cachedBlankLine=f),f.isWrapped=h;const x=u.ybase+u.scrollTop,k=u.ybase+u.scrollBottom;if(u.scrollTop===0){const C=u.lines.isFull;k===u.lines.length-1?C?u.lines.recycle().copyFrom(f):u.lines.push(f.clone()):u.lines.splice(k+1,0,f.clone()),C?this.isUserScrolling&&(u.ydisp=Math.max(u.ydisp-1,0)):(u.ybase++,this.isUserScrolling||u.ydisp++)}else{const C=k-x+1;u.lines.shiftElements(x+1,C-1,-1),u.lines.set(k,f.clone())}this.isUserScrolling||(u.ydisp=u.ybase),this._onScroll.fire(u.ydisp)}scrollLines(p,h,u){const f=this.buffer;if(p<0){if(f.ydisp===0)return;this.isUserScrolling=!0}else p+f.ydisp>=f.ybase&&(this.isUserScrolling=!1);const x=f.ydisp;f.ydisp=Math.max(Math.min(f.ydisp+p,f.ybase),0),x!==f.ydisp&&(h||this._onScroll.fire(f.ydisp))}};o.BufferService=_=d([g(0,w.IOptionsService)],_)},7994:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CharsetService=void 0,o.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(l){this.glevel=l,this.charset=this._charsets[l]}setgCharset(l,d){this._charsets[l]=d,this.glevel===l&&(this.charset=d)}}},1753:function(c,o,l){var d=this&&this.__decorate||function(f,x,k,C){var S,b=arguments.length,E=b<3?x:C===null?C=Object.getOwnPropertyDescriptor(x,k):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(f,x,k,C);else for(var N=f.length-1;N>=0;N--)(S=f[N])&&(E=(b<3?S(E):b>3?S(x,k,E):S(x,k))||E);return b>3&&E&&Object.defineProperty(x,k,E),E},g=this&&this.__param||function(f,x){return function(k,C){x(k,C,f)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CoreMouseService=void 0;const m=l(2585),v=l(8460),y=l(844),w={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:f=>f.button!==4&&f.action===1&&(f.ctrl=!1,f.alt=!1,f.shift=!1,!0)},VT200:{events:19,restrict:f=>f.action!==32},DRAG:{events:23,restrict:f=>f.action!==32||f.button!==3},ANY:{events:31,restrict:f=>!0}};function _(f,x){let k=(f.ctrl?16:0)|(f.shift?4:0)|(f.alt?8:0);return f.button===4?(k|=64,k|=f.action):(k|=3&f.button,4&f.button&&(k|=64),8&f.button&&(k|=128),f.action===32?k|=32:f.action!==0||x||(k|=3)),k}const p=String.fromCharCode,h={DEFAULT:f=>{const x=[_(f,!1)+32,f.col+32,f.row+32];return x[0]>255||x[1]>255||x[2]>255?"":`\x1B[M${p(x[0])}${p(x[1])}${p(x[2])}`},SGR:f=>{const x=f.action===0&&f.button!==4?"m":"M";return`\x1B[<${_(f,!0)};${f.col};${f.row}${x}`},SGR_PIXELS:f=>{const x=f.action===0&&f.button!==4?"m":"M";return`\x1B[<${_(f,!0)};${f.x};${f.y}${x}`}};let u=o.CoreMouseService=class extends y.Disposable{constructor(f,x){super(),this._bufferService=f,this._coreService=x,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new v.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const k of Object.keys(w))this.addProtocol(k,w[k]);for(const k of Object.keys(h))this.addEncoding(k,h[k]);this.reset()}addProtocol(f,x){this._protocols[f]=x}addEncoding(f,x){this._encodings[f]=x}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(f){if(!this._protocols[f])throw new Error(`unknown protocol "${f}"`);this._activeProtocol=f,this._onProtocolChange.fire(this._protocols[f].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(f){if(!this._encodings[f])throw new Error(`unknown encoding "${f}"`);this._activeEncoding=f}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(f){if(f.col<0||f.col>=this._bufferService.cols||f.row<0||f.row>=this._bufferService.rows||f.button===4&&f.action===32||f.button===3&&f.action!==32||f.button!==4&&(f.action===2||f.action===3)||(f.col++,f.row++,f.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,f,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(f))return!1;const x=this._encodings[this._activeEncoding](f);return x&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(x):this._coreService.triggerDataEvent(x,!0)),this._lastEvent=f,!0}explainEvents(f){return{down:!!(1&f),up:!!(2&f),drag:!!(4&f),move:!!(8&f),wheel:!!(16&f)}}_equalEvents(f,x,k){if(k){if(f.x!==x.x||f.y!==x.y)return!1}else if(f.col!==x.col||f.row!==x.row)return!1;return f.button===x.button&&f.action===x.action&&f.ctrl===x.ctrl&&f.alt===x.alt&&f.shift===x.shift}};o.CoreMouseService=u=d([g(0,m.IBufferService),g(1,m.ICoreService)],u)},6975:function(c,o,l){var d=this&&this.__decorate||function(u,f,x,k){var C,S=arguments.length,b=S<3?f:k===null?k=Object.getOwnPropertyDescriptor(f,x):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(u,f,x,k);else for(var E=u.length-1;E>=0;E--)(C=u[E])&&(b=(S<3?C(b):S>3?C(f,x,b):C(f,x))||b);return S>3&&b&&Object.defineProperty(f,x,b),b},g=this&&this.__param||function(u,f){return function(x,k){f(x,k,u)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CoreService=void 0;const m=l(1439),v=l(8460),y=l(844),w=l(2585),_=Object.freeze({insertMode:!1}),p=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let h=o.CoreService=class extends y.Disposable{constructor(u,f,x){super(),this._bufferService=u,this._logService=f,this._optionsService=x,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new v.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new v.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new v.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new v.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,m.clone)(_),this.decPrivateModes=(0,m.clone)(p)}reset(){this.modes=(0,m.clone)(_),this.decPrivateModes=(0,m.clone)(p)}triggerDataEvent(u,f=!1){if(this._optionsService.rawOptions.disableStdin)return;const x=this._bufferService.buffer;f&&this._optionsService.rawOptions.scrollOnUserInput&&x.ybase!==x.ydisp&&this._onRequestScrollToBottom.fire(),f&&this._onUserInput.fire(),this._logService.debug(`sending data "${u}"`,()=>u.split("").map(k=>k.charCodeAt(0))),this._onData.fire(u)}triggerBinaryEvent(u){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${u}"`,()=>u.split("").map(f=>f.charCodeAt(0))),this._onBinary.fire(u))}};o.CoreService=h=d([g(0,w.IBufferService),g(1,w.ILogService),g(2,w.IOptionsService)],h)},9074:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DecorationService=void 0;const d=l(8055),g=l(8460),m=l(844),v=l(6106);let y=0,w=0;class _ extends m.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new v.SortedList(u=>u==null?void 0:u.marker.line),this._onDecorationRegistered=this.register(new g.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new g.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,m.toDisposable)(()=>this.reset()))}registerDecoration(u){if(u.marker.isDisposed)return;const f=new p(u);if(f){const x=f.marker.onDispose(()=>f.dispose());f.onDispose(()=>{f&&(this._decorations.delete(f)&&this._onDecorationRemoved.fire(f),x.dispose())}),this._decorations.insert(f),this._onDecorationRegistered.fire(f)}return f}reset(){for(const u of this._decorations.values())u.dispose();this._decorations.clear()}*getDecorationsAtCell(u,f,x){let k=0,C=0;for(const S of this._decorations.getKeyIterator(f))k=S.options.x??0,C=k+(S.options.width??1),u>=k&&u<C&&(!x||(S.options.layer??"bottom")===x)&&(yield S)}forEachDecorationAtCell(u,f,x,k){this._decorations.forEachByKey(f,C=>{y=C.options.x??0,w=y+(C.options.width??1),u>=y&&u<w&&(!x||(C.options.layer??"bottom")===x)&&k(C)})}}o.DecorationService=_;class p extends m.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=d.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=d.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(u){super(),this.options=u,this.onRenderEmitter=this.register(new g.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new g.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=u.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.InstantiationService=o.ServiceCollection=void 0;const d=l(2585),g=l(8343);class m{constructor(...y){this._entries=new Map;for(const[w,_]of y)this.set(w,_)}set(y,w){const _=this._entries.get(y);return this._entries.set(y,w),_}forEach(y){for(const[w,_]of this._entries.entries())y(w,_)}has(y){return this._entries.has(y)}get(y){return this._entries.get(y)}}o.ServiceCollection=m,o.InstantiationService=class{constructor(){this._services=new m,this._services.set(d.IInstantiationService,this)}setService(v,y){this._services.set(v,y)}getService(v){return this._services.get(v)}createInstance(v,...y){const w=(0,g.getServiceDependencies)(v).sort((h,u)=>h.index-u.index),_=[];for(const h of w){const u=this._services.get(h.id);if(!u)throw new Error(`[createInstance] ${v.name} depends on UNKNOWN service ${h.id}.`);_.push(u)}const p=w.length>0?w[0].index:y.length;if(y.length!==p)throw new Error(`[createInstance] First service dependency of ${v.name} at position ${p+1} conflicts with ${y.length} static arguments`);return new v(...y,..._)}}},7866:function(c,o,l){var d=this&&this.__decorate||function(p,h,u,f){var x,k=arguments.length,C=k<3?h:f===null?f=Object.getOwnPropertyDescriptor(h,u):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(p,h,u,f);else for(var S=p.length-1;S>=0;S--)(x=p[S])&&(C=(k<3?x(C):k>3?x(h,u,C):x(h,u))||C);return k>3&&C&&Object.defineProperty(h,u,C),C},g=this&&this.__param||function(p,h){return function(u,f){h(u,f,p)}};Object.defineProperty(o,"__esModule",{value:!0}),o.traceCall=o.setTraceLogger=o.LogService=void 0;const m=l(844),v=l(2585),y={trace:v.LogLevelEnum.TRACE,debug:v.LogLevelEnum.DEBUG,info:v.LogLevelEnum.INFO,warn:v.LogLevelEnum.WARN,error:v.LogLevelEnum.ERROR,off:v.LogLevelEnum.OFF};let w,_=o.LogService=class extends m.Disposable{get logLevel(){return this._logLevel}constructor(p){super(),this._optionsService=p,this._logLevel=v.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),w=this}_updateLogLevel(){this._logLevel=y[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(p){for(let h=0;h<p.length;h++)typeof p[h]=="function"&&(p[h]=p[h]())}_log(p,h,u){this._evalLazyOptionalParams(u),p.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+h,...u)}trace(p,...h){var u;this._logLevel<=v.LogLevelEnum.TRACE&&this._log(((u=this._optionsService.options.logger)==null?void 0:u.trace.bind(this._optionsService.options.logger))??console.log,p,h)}debug(p,...h){var u;this._logLevel<=v.LogLevelEnum.DEBUG&&this._log(((u=this._optionsService.options.logger)==null?void 0:u.debug.bind(this._optionsService.options.logger))??console.log,p,h)}info(p,...h){var u;this._logLevel<=v.LogLevelEnum.INFO&&this._log(((u=this._optionsService.options.logger)==null?void 0:u.info.bind(this._optionsService.options.logger))??console.info,p,h)}warn(p,...h){var u;this._logLevel<=v.LogLevelEnum.WARN&&this._log(((u=this._optionsService.options.logger)==null?void 0:u.warn.bind(this._optionsService.options.logger))??console.warn,p,h)}error(p,...h){var u;this._logLevel<=v.LogLevelEnum.ERROR&&this._log(((u=this._optionsService.options.logger)==null?void 0:u.error.bind(this._optionsService.options.logger))??console.error,p,h)}};o.LogService=_=d([g(0,v.IOptionsService)],_),o.setTraceLogger=function(p){w=p},o.traceCall=function(p,h,u){if(typeof u.value!="function")throw new Error("not supported");const f=u.value;u.value=function(...x){if(w.logLevel!==v.LogLevelEnum.TRACE)return f.apply(this,x);w.trace(`GlyphRenderer#${f.name}(${x.map(C=>JSON.stringify(C)).join(", ")})`);const k=f.apply(this,x);return w.trace(`GlyphRenderer#${f.name} return`,k),k}}},7302:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.OptionsService=o.DEFAULT_OPTIONS=void 0;const d=l(8460),g=l(844),m=l(6114);o.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:m.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const v=["normal","bold","100","200","300","400","500","600","700","800","900"];class y extends g.Disposable{constructor(_){super(),this._onOptionChange=this.register(new d.EventEmitter),this.onOptionChange=this._onOptionChange.event;const p={...o.DEFAULT_OPTIONS};for(const h in _)if(h in p)try{const u=_[h];p[h]=this._sanitizeAndValidateOption(h,u)}catch(u){console.error(u)}this.rawOptions=p,this.options={...p},this._setupOptions(),this.register((0,g.toDisposable)(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(_,p){return this.onOptionChange(h=>{h===_&&p(this.rawOptions[_])})}onMultipleOptionChange(_,p){return this.onOptionChange(h=>{_.indexOf(h)!==-1&&p()})}_setupOptions(){const _=h=>{if(!(h in o.DEFAULT_OPTIONS))throw new Error(`No option with key "${h}"`);return this.rawOptions[h]},p=(h,u)=>{if(!(h in o.DEFAULT_OPTIONS))throw new Error(`No option with key "${h}"`);u=this._sanitizeAndValidateOption(h,u),this.rawOptions[h]!==u&&(this.rawOptions[h]=u,this._onOptionChange.fire(h))};for(const h in this.rawOptions){const u={get:_.bind(this,h),set:p.bind(this,h)};Object.defineProperty(this.options,h,u)}}_sanitizeAndValidateOption(_,p){switch(_){case"cursorStyle":if(p||(p=o.DEFAULT_OPTIONS[_]),!function(h){return h==="block"||h==="underline"||h==="bar"}(p))throw new Error(`"${p}" is not a valid value for ${_}`);break;case"wordSeparator":p||(p=o.DEFAULT_OPTIONS[_]);break;case"fontWeight":case"fontWeightBold":if(typeof p=="number"&&1<=p&&p<=1e3)break;p=v.includes(p)?p:o.DEFAULT_OPTIONS[_];break;case"cursorWidth":p=Math.floor(p);case"lineHeight":case"tabStopWidth":if(p<1)throw new Error(`${_} cannot be less than 1, value: ${p}`);break;case"minimumContrastRatio":p=Math.max(1,Math.min(21,Math.round(10*p)/10));break;case"scrollback":if((p=Math.min(p,4294967295))<0)throw new Error(`${_} cannot be less than 0, value: ${p}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(p<=0)throw new Error(`${_} cannot be less than or equal to 0, value: ${p}`);break;case"rows":case"cols":if(!p&&p!==0)throw new Error(`${_} must be numeric, value: ${p}`);break;case"windowsPty":p=p??{}}return p}}o.OptionsService=y},2660:function(c,o,l){var d=this&&this.__decorate||function(y,w,_,p){var h,u=arguments.length,f=u<3?w:p===null?p=Object.getOwnPropertyDescriptor(w,_):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(y,w,_,p);else for(var x=y.length-1;x>=0;x--)(h=y[x])&&(f=(u<3?h(f):u>3?h(w,_,f):h(w,_))||f);return u>3&&f&&Object.defineProperty(w,_,f),f},g=this&&this.__param||function(y,w){return function(_,p){w(_,p,y)}};Object.defineProperty(o,"__esModule",{value:!0}),o.OscLinkService=void 0;const m=l(2585);let v=o.OscLinkService=class{constructor(y){this._bufferService=y,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(y){const w=this._bufferService.buffer;if(y.id===void 0){const x=w.addMarker(w.ybase+w.y),k={data:y,id:this._nextId++,lines:[x]};return x.onDispose(()=>this._removeMarkerFromLink(k,x)),this._dataByLinkId.set(k.id,k),k.id}const _=y,p=this._getEntryIdKey(_),h=this._entriesWithId.get(p);if(h)return this.addLineToLink(h.id,w.ybase+w.y),h.id;const u=w.addMarker(w.ybase+w.y),f={id:this._nextId++,key:this._getEntryIdKey(_),data:_,lines:[u]};return u.onDispose(()=>this._removeMarkerFromLink(f,u)),this._entriesWithId.set(f.key,f),this._dataByLinkId.set(f.id,f),f.id}addLineToLink(y,w){const _=this._dataByLinkId.get(y);if(_&&_.lines.every(p=>p.line!==w)){const p=this._bufferService.buffer.addMarker(w);_.lines.push(p),p.onDispose(()=>this._removeMarkerFromLink(_,p))}}getLinkData(y){var w;return(w=this._dataByLinkId.get(y))==null?void 0:w.data}_getEntryIdKey(y){return`${y.id};;${y.uri}`}_removeMarkerFromLink(y,w){const _=y.lines.indexOf(w);_!==-1&&(y.lines.splice(_,1),y.lines.length===0&&(y.data.id!==void 0&&this._entriesWithId.delete(y.key),this._dataByLinkId.delete(y.id)))}};o.OscLinkService=v=d([g(0,m.IBufferService)],v)},8343:(c,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.createDecorator=o.getServiceDependencies=o.serviceRegistry=void 0;const l="di$target",d="di$dependencies";o.serviceRegistry=new Map,o.getServiceDependencies=function(g){return g[d]||[]},o.createDecorator=function(g){if(o.serviceRegistry.has(g))return o.serviceRegistry.get(g);const m=function(v,y,w){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(_,p,h){p[l]===p?p[d].push({id:_,index:h}):(p[d]=[{id:_,index:h}],p[l]=p)})(m,v,w)};return m.toString=()=>g,o.serviceRegistry.set(g,m),m}},2585:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.IDecorationService=o.IUnicodeService=o.IOscLinkService=o.IOptionsService=o.ILogService=o.LogLevelEnum=o.IInstantiationService=o.ICharsetService=o.ICoreService=o.ICoreMouseService=o.IBufferService=void 0;const d=l(8343);var g;o.IBufferService=(0,d.createDecorator)("BufferService"),o.ICoreMouseService=(0,d.createDecorator)("CoreMouseService"),o.ICoreService=(0,d.createDecorator)("CoreService"),o.ICharsetService=(0,d.createDecorator)("CharsetService"),o.IInstantiationService=(0,d.createDecorator)("InstantiationService"),function(m){m[m.TRACE=0]="TRACE",m[m.DEBUG=1]="DEBUG",m[m.INFO=2]="INFO",m[m.WARN=3]="WARN",m[m.ERROR=4]="ERROR",m[m.OFF=5]="OFF"}(g||(o.LogLevelEnum=g={})),o.ILogService=(0,d.createDecorator)("LogService"),o.IOptionsService=(0,d.createDecorator)("OptionsService"),o.IOscLinkService=(0,d.createDecorator)("OscLinkService"),o.IUnicodeService=(0,d.createDecorator)("UnicodeService"),o.IDecorationService=(0,d.createDecorator)("DecorationService")},1480:(c,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UnicodeService=void 0;const d=l(8460),g=l(225);class m{static extractShouldJoin(y){return(1&y)!=0}static extractWidth(y){return y>>1&3}static extractCharKind(y){return y>>3}static createPropertyValue(y,w,_=!1){return(16777215&y)<<3|(3&w)<<1|(_?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new d.EventEmitter,this.onChange=this._onChange.event;const y=new g.UnicodeV6;this.register(y),this._active=y.version,this._activeProvider=y}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(y){if(!this._providers[y])throw new Error(`unknown Unicode version "${y}"`);this._active=y,this._activeProvider=this._providers[y],this._onChange.fire(y)}register(y){this._providers[y.version]=y}wcwidth(y){return this._activeProvider.wcwidth(y)}getStringCellWidth(y){let w=0,_=0;const p=y.length;for(let h=0;h<p;++h){let u=y.charCodeAt(h);if(55296<=u&&u<=56319){if(++h>=p)return w+this.wcwidth(u);const k=y.charCodeAt(h);56320<=k&&k<=57343?u=1024*(u-55296)+k-56320+65536:w+=this.wcwidth(k)}const f=this.charProperties(u,_);let x=m.extractWidth(f);m.extractShouldJoin(f)&&(x-=m.extractWidth(_)),w+=x,_=f}return w}charProperties(y,w){return this._activeProvider.charProperties(y,w)}}o.UnicodeService=m}},s={};function n(c){var o=s[c];if(o!==void 0)return o.exports;var l=s[c]={exports:{}};return r[c].call(l.exports,l,l.exports,n),l.exports}var i={};return(()=>{var c=i;Object.defineProperty(c,"__esModule",{value:!0}),c.Terminal=void 0;const o=n(9042),l=n(3236),d=n(844),g=n(5741),m=n(8285),v=n(7975),y=n(7090),w=["cols","rows"];class _ extends d.Disposable{constructor(h){super(),this._core=this.register(new l.Terminal(h)),this._addonManager=this.register(new g.AddonManager),this._publicOptions={...this._core.options};const u=x=>this._core.options[x],f=(x,k)=>{this._checkReadonlyOptions(x),this._core.options[x]=k};for(const x in this._core.options){const k={get:u.bind(this,x),set:f.bind(this,x)};Object.defineProperty(this._publicOptions,x,k)}}_checkReadonlyOptions(h){if(w.includes(h))throw new Error(`Option "${h}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new v.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new y.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new m.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const h=this._core.coreService.decPrivateModes;let u="none";switch(this._core.coreMouseService.activeProtocol){case"X10":u="x10";break;case"VT200":u="vt200";break;case"DRAG":u="drag";break;case"ANY":u="any"}return{applicationCursorKeysMode:h.applicationCursorKeys,applicationKeypadMode:h.applicationKeypad,bracketedPasteMode:h.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:u,originMode:h.origin,reverseWraparoundMode:h.reverseWraparound,sendFocusMode:h.sendFocus,wraparoundMode:h.wraparound}}get options(){return this._publicOptions}set options(h){for(const u in h)this._publicOptions[u]=h[u]}blur(){this._core.blur()}focus(){this._core.focus()}input(h,u=!0){this._core.input(h,u)}resize(h,u){this._verifyIntegers(h,u),this._core.resize(h,u)}open(h){this._core.open(h)}attachCustomKeyEventHandler(h){this._core.attachCustomKeyEventHandler(h)}attachCustomWheelEventHandler(h){this._core.attachCustomWheelEventHandler(h)}registerLinkProvider(h){return this._core.registerLinkProvider(h)}registerCharacterJoiner(h){return this._checkProposedApi(),this._core.registerCharacterJoiner(h)}deregisterCharacterJoiner(h){this._checkProposedApi(),this._core.deregisterCharacterJoiner(h)}registerMarker(h=0){return this._verifyIntegers(h),this._core.registerMarker(h)}registerDecoration(h){return this._checkProposedApi(),this._verifyPositiveIntegers(h.x??0,h.width??0,h.height??0),this._core.registerDecoration(h)}hasSelection(){return this._core.hasSelection()}select(h,u,f){this._verifyIntegers(h,u,f),this._core.select(h,u,f)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(h,u){this._verifyIntegers(h,u),this._core.selectLines(h,u)}dispose(){super.dispose()}scrollLines(h){this._verifyIntegers(h),this._core.scrollLines(h)}scrollPages(h){this._verifyIntegers(h),this._core.scrollPages(h)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(h){this._verifyIntegers(h),this._core.scrollToLine(h)}clear(){this._core.clear()}write(h,u){this._core.write(h,u)}writeln(h,u){this._core.write(h),this._core.write(`\r
`,u)}paste(h){this._core.paste(h)}refresh(h,u){this._verifyIntegers(h,u),this._core.refresh(h,u)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(h){this._addonManager.loadAddon(this,h)}static get strings(){return o}_verifyIntegers(...h){for(const u of h)if(u===1/0||isNaN(u)||u%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...h){for(const u of h)if(u&&(u===1/0||isNaN(u)||u%1!=0||u<0))throw new Error("This API only accepts positive integers")}}c.Terminal=_})(),i})())})(Tx);var Ox=Tx.exports,Px={exports:{}};(function(t,e){(function(r,s){t.exports=s()})(self,()=>(()=>{var r={};return(()=>{var s=r;Object.defineProperty(s,"__esModule",{value:!0}),s.FitAddon=void 0,s.FitAddon=class{activate(n){this._terminal=n}dispose(){}fit(){const n=this.proposeDimensions();if(!n||!this._terminal||isNaN(n.cols)||isNaN(n.rows))return;const i=this._terminal._core;this._terminal.rows===n.rows&&this._terminal.cols===n.cols||(i._renderService.clear(),this._terminal.resize(n.cols,n.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const n=this._terminal._core,i=n._renderService.dimensions;if(i.css.cell.width===0||i.css.cell.height===0)return;const c=this._terminal.options.scrollback===0?0:n.viewport.scrollBarWidth,o=window.getComputedStyle(this._terminal.element.parentElement),l=parseInt(o.getPropertyValue("height")),d=Math.max(0,parseInt(o.getPropertyValue("width"))),g=window.getComputedStyle(this._terminal.element),m=l-(parseInt(g.getPropertyValue("padding-top"))+parseInt(g.getPropertyValue("padding-bottom"))),v=d-(parseInt(g.getPropertyValue("padding-right"))+parseInt(g.getPropertyValue("padding-left")))-c;return{cols:Math.max(2,Math.floor(v/i.css.cell.width)),rows:Math.max(1,Math.floor(m/i.css.cell.height))}}}})(),r})())})(Px);var Lx=Px.exports;const de={RESET:"\x1B[0m",BOLD:"\x1B[1m",FG_WHITE:"\x1B[37m",FG_BRIGHT_BLACK:"\x1B[90m",FG_BRIGHT_RED:"\x1B[91m",FG_BRIGHT_GREEN:"\x1B[92m",FG_BRIGHT_YELLOW:"\x1B[93m",FG_BRIGHT_BLUE:"\x1B[94m",FG_BRIGHT_CYAN:"\x1B[96m"};function aT(t){switch(t.type){case"ready":return`${de.FG_BRIGHT_GREEN}${de.BOLD} Container ready${de.RESET}
${de.FG_BRIGHT_BLACK}  Workspace: ${t.workspace||"default"}${de.RESET}`;case"log":{const e=t,r=e.line||"";switch(e.level){case"error":return`${de.FG_BRIGHT_RED}${r}${de.RESET}`;case"warn":return`${de.FG_BRIGHT_YELLOW}${r}${de.RESET}`;case"debug":return`${de.FG_BRIGHT_BLACK}${r}${de.RESET}`;default:return`${de.FG_WHITE}${r}${de.RESET}`}}case"progress":{const e=t,r=[];return e.stage&&r.push(e.stage),e.step&&r.push(e.step),e.percentage!==void 0&&r.push(`${e.percentage}%`),e.iteration!==void 0&&e.total_iterations!==void 0&&r.push(`[${e.iteration}/${e.total_iterations}]`),`${de.FG_BRIGHT_CYAN}[PROGRESS] ${r.join(" - ")}${de.RESET}`}case"iteration_complete":return`${de.FG_BRIGHT_GREEN} Iteration ${t.iteration} complete${de.RESET}`;case"all_work_complete":return`
${de.FG_BRIGHT_GREEN}${de.BOLD}${de.RESET}
${de.FG_BRIGHT_GREEN}${de.BOLD} Generation Complete!${de.RESET}
${de.FG_BRIGHT_BLACK}  Reason: ${t.completion_reason}${de.RESET}
${de.FG_BRIGHT_BLACK}  Total iterations: ${t.total_iterations}${de.RESET}
`+(t.github_url?`${de.FG_BRIGHT_BLUE}  GitHub: ${t.github_url}${de.RESET}
`:"")+(t.download_url?`${de.FG_BRIGHT_BLUE}  Download: ${t.download_url}${de.RESET}
`:"")+`${de.FG_BRIGHT_GREEN}${de.BOLD}${de.RESET}`;case"error":{const e=t;let r=`${de.BOLD}${de.FG_BRIGHT_RED}ERROR: ${e.message}${de.RESET}`;return e.error_code&&(r+=`
${de.FG_BRIGHT_BLACK}  Code: ${e.error_code}${de.RESET}`),e.recovery_hint&&(r+=`
${de.FG_BRIGHT_YELLOW}  Hint: ${e.recovery_hint}${de.RESET}`),r}case"decision_prompt":{const e=t;let r=`
${de.FG_BRIGHT_YELLOW}${de.BOLD} ${e.prompt}${de.RESET}`;return e.options&&e.options.length>0&&(r+=`
${de.FG_BRIGHT_BLACK}Options:${de.RESET}`,e.options.forEach((s,n)=>{r+=`
  ${de.FG_BRIGHT_CYAN}${n+1}.${de.RESET} ${s}`})),e.allow_editor&&(r+=`
${de.FG_BRIGHT_BLACK}  (Custom response allowed)${de.RESET}`),r}case"connection_status":return`${de.FG_BRIGHT_BLACK}[Status] Browser: ${t.browser_connected?"":""} | Container: ${t.container_connected?"":""}${de.RESET}`;case"status":return`${de.FG_BRIGHT_BLACK}[Status] ${t.message}${de.RESET}`;default:return null}}function lT({messages:t,isConnected:e,containerConnected:r}){const s=R.useRef(null),n=R.useRef(null),i=R.useRef(null),c=R.useRef(0),[o,l]=R.useState(!1),d=R.useRef(!1),g=R.useRef(null),m=R.useCallback(()=>{n.current&&(n.current.scrollToBottom(),l(!1))},[]);return R.useEffect(()=>{var h;if(!s.current)return;const v=new Ox.Terminal({theme:{background:"#09090b",foreground:"#fafafa",cursor:"#fbbf24",black:"#000000",red:"#ef4444",green:"#10b981",yellow:"#f59e0b",blue:"#3b82f6",magenta:"#a855f7",cyan:"#06b6d4",white:"#fafafa",brightBlack:"#52525b",brightRed:"#f87171",brightGreen:"#34d399",brightYellow:"#fbbf24",brightBlue:"#60a5fa",brightMagenta:"#c084fc",brightCyan:"#22d3ee",brightWhite:"#ffffff"},fontFamily:"JetBrains Mono, Consolas, monospace",fontSize:14,fontWeight:"400",fontWeightBold:"700",cursorBlink:!1,cursorStyle:"block",scrollback:1e4,allowProposedApi:!0,disableStdin:!0}),y=new Lx.FitAddon;i.current=y,v.loadAddon(y),v.open(s.current);try{y.fit()}catch(u){console.warn("Xterm fit addon error:",u)}n.current=v,v.writeln(`${de.FG_BRIGHT_CYAN}${de.BOLD}Leo Console${de.RESET}`),v.writeln(`${de.FG_BRIGHT_BLACK}WSI Protocol v2.1 - Direct container communication${de.RESET}`),v.writeln("");const w=s.current.querySelector(".xterm-viewport");if(w){const u=()=>{g.current&&clearTimeout(g.current),d.current=!0,g.current=setTimeout(()=>{d.current=!1;const x=w.scrollTop,k=w.scrollHeight,C=w.clientHeight,S=k-x-C<50;l(!S)},100)};w.addEventListener("scroll",u,{passive:!0});const f=()=>{w.removeEventListener("scroll",u),g.current&&clearTimeout(g.current)};s.current._scrollCleanup=f}const _=()=>{try{y.fit()}catch(u){console.warn("Xterm fit addon error:",u)}};window.addEventListener("resize",_);const p=new ResizeObserver(()=>{try{y.fit()}catch(u){console.warn("Xterm fit addon error:",u)}});return(h=s.current)!=null&&h.parentElement&&p.observe(s.current.parentElement),()=>{p.disconnect(),window.removeEventListener("resize",_),s.current&&s.current._scrollCleanup&&s.current._scrollCleanup(),v.dispose()}},[]),R.useEffect(()=>{const v=n.current;if(!v)return;const y=t.slice(c.current);c.current=t.length,y.forEach(w=>{const _=aT(w);_&&(v.writeln(_),o||v.scrollToBottom())})},[t,o]),R.useEffect(()=>{const v=n.current;v&&e&&!r&&v.writeln(`${de.FG_BRIGHT_YELLOW}Waiting for container...${de.RESET}`)},[e,r]),a.jsxs("div",{className:"relative w-full h-full",children:[a.jsx("div",{ref:s,className:"w-full h-full",style:{padding:0,margin:0}}),o&&a.jsxs("button",{onClick:m,className:"absolute bottom-4 right-4 flex items-center gap-2 px-3 py-2 bg-primary/90 hover:bg-primary text-primary-foreground text-sm font-medium rounded-lg shadow-lg transition-all duration-200 animate-fade-in-up z-10",title:"Scroll to bottom","aria-label":"Scroll to bottom - new messages available",children:[a.jsx(ME,{className:"w-4 h-4"}),a.jsx("span",{children:"New output"})]})]})}const Nl={TOOL_INPUT_TRUNCATE:5e3,THINKING_BLOCK_TRUNCATE:500},Y={RESET:"\x1B[0m",BOLD:"\x1B[1m",DIM:"\x1B[2m",FG_WHITE:"\x1B[37m",FG_BRIGHT_BLACK:"\x1B[90m",FG_BRIGHT_RED:"\x1B[91m",FG_BRIGHT_GREEN:"\x1B[92m",FG_BRIGHT_YELLOW:"\x1B[93m",FG_BRIGHT_BLUE:"\x1B[94m",FG_BRIGHT_MAGENTA:"\x1B[95m",FG_BRIGHT_CYAN:"\x1B[96m"};function cT(t){var n,i;const e=[],r=t.timestamp?new Date(t.timestamp).toLocaleTimeString():"",s=t.agent||"Unknown Agent";switch(t.entry_type){case"user_prompt":e.push(`${Y.FG_BRIGHT_CYAN}${Y.BOLD}${Y.RESET}`),e.push(`${Y.FG_BRIGHT_CYAN}${Y.BOLD} USER PROMPT${Y.RESET} ${Y.FG_BRIGHT_BLACK}[${s}] ${r}${Y.RESET}`),e.push(`${Y.FG_BRIGHT_CYAN}${Y.RESET}`),t.content&&e.push(`${Y.FG_WHITE}${t.content}${Y.RESET}`),e.push("");break;case"assistant_message":e.push(`${Y.FG_BRIGHT_MAGENTA}${Y.BOLD}${Y.RESET}`),e.push(`${Y.FG_BRIGHT_MAGENTA}${Y.BOLD} ASSISTANT${Y.RESET} ${Y.FG_BRIGHT_BLACK}[${s}] Turn ${t.turn||"?"} ${r}${Y.RESET}`),e.push(`${Y.FG_BRIGHT_MAGENTA}${Y.RESET}`),t.thinking_blocks&&t.thinking_blocks.length>0&&(e.push(`${Y.FG_BRIGHT_YELLOW}${Y.DIM} Thinking:${Y.RESET}`),t.thinking_blocks.forEach(o=>{const l=o.length>Nl.THINKING_BLOCK_TRUNCATE?o.slice(0,Nl.THINKING_BLOCK_TRUNCATE)+"...":o;e.push(`${Y.FG_BRIGHT_BLACK}${Y.DIM}   ${l.replace(/\n/g,`
   `)}${Y.RESET}`)})),t.text_blocks&&t.text_blocks.length>0&&(e.push(`${Y.FG_BRIGHT_GREEN} Response:${Y.RESET}`),t.text_blocks.forEach(o=>{e.push(`${Y.FG_WHITE}   ${o.replace(/\n/g,`
   `)}${Y.RESET}`)})),t.tool_uses&&t.tool_uses.length>0&&(e.push(`${Y.FG_BRIGHT_BLUE} Tool Uses:${Y.RESET}`),t.tool_uses.forEach(o=>{e.push(`${Y.FG_BRIGHT_CYAN}    ${o.name}${Y.RESET}`);const l=JSON.stringify(o.input);l.length>Nl.TOOL_INPUT_TRUNCATE?e.push(`${Y.FG_BRIGHT_BLACK}     ${l.slice(0,Nl.TOOL_INPUT_TRUNCATE)}...${Y.RESET}`):e.push(`${Y.FG_BRIGHT_BLACK}     ${l}${Y.RESET}`)})),e.push("");break;case"result":e.push(`${Y.FG_BRIGHT_GREEN}${Y.BOLD}${Y.RESET}`),e.push(`${t.success?Y.FG_BRIGHT_GREEN:Y.FG_BRIGHT_RED}${Y.BOLD} RESULT${Y.RESET} ${Y.FG_BRIGHT_BLACK}[${s}] ${r}${Y.RESET}`),e.push(`${Y.FG_BRIGHT_GREEN}${Y.RESET}`),e.push(`${Y.FG_WHITE}   Success: ${t.success?" Yes":" No"}${Y.RESET}`),t.termination_reason&&e.push(`${Y.FG_WHITE}   Reason: ${t.termination_reason}${Y.RESET}`),t.cost_usd!==void 0&&e.push(`${Y.FG_WHITE}   Cost: $${t.cost_usd.toFixed(4)}${Y.RESET}`),t.duration_ms!==void 0&&e.push(`${Y.FG_WHITE}   Duration: ${(t.duration_ms/1e3).toFixed(1)}s${Y.RESET}`),(t.input_tokens!==void 0||t.output_tokens!==void 0)&&e.push(`${Y.FG_WHITE}   Tokens: ${((n=t.input_tokens)==null?void 0:n.toLocaleString())||0} in / ${((i=t.output_tokens)==null?void 0:i.toLocaleString())||0} out${Y.RESET}`),e.push("");break;case"error":e.push(`${Y.FG_BRIGHT_RED}${Y.BOLD}${Y.RESET}`),e.push(`${Y.FG_BRIGHT_RED}${Y.BOLD} ERROR${Y.RESET} ${Y.FG_BRIGHT_BLACK}[${s}] ${r}${Y.RESET}`),e.push(`${Y.FG_BRIGHT_RED}${Y.RESET}`),t.error_type&&e.push(`${Y.FG_BRIGHT_RED}   Type: ${t.error_type}${Y.RESET}`),t.error_message&&e.push(`${Y.FG_BRIGHT_RED}   Message: ${t.error_message}${Y.RESET}`),e.push("");break;case"system":const c=t.level==="ERROR"?Y.FG_BRIGHT_RED:t.level==="WARNING"?Y.FG_BRIGHT_YELLOW:Y.FG_BRIGHT_BLACK;e.push(`${c}[${t.level}] ${t.message||""}${Y.RESET}`);break;default:e.push(`${Y.FG_BRIGHT_BLACK}[${t.entry_type}] ${JSON.stringify(t)}${Y.RESET}`)}return e}function uT({conversationLogs:t}){const e=R.useRef(null),r=R.useRef(null),s=R.useRef(null),n=R.useRef(0),[i,c]=R.useState(!1),[o,l]=R.useState([]);return R.useEffect(()=>{var y;if(!e.current)return;const d=new Ox.Terminal({theme:{background:"#09090b",foreground:"#fafafa",cursor:"#fbbf24",black:"#000000",red:"#ef4444",green:"#10b981",yellow:"#f59e0b",blue:"#3b82f6",magenta:"#a855f7",cyan:"#06b6d4",white:"#fafafa",brightBlack:"#52525b",brightRed:"#f87171",brightGreen:"#34d399",brightYellow:"#fbbf24",brightBlue:"#60a5fa",brightMagenta:"#c084fc",brightCyan:"#22d3ee",brightWhite:"#ffffff"},fontFamily:"JetBrains Mono, Consolas, monospace",fontSize:13,fontWeight:"400",fontWeightBold:"700",cursorBlink:!1,cursorStyle:"block",scrollback:1e4,allowProposedApi:!0,disableStdin:!0}),g=new Lx.FitAddon;s.current=g,d.loadAddon(g),d.open(e.current);try{g.fit()}catch(w){console.warn("Xterm fit addon error:",w)}r.current=d,d.writeln(`${Y.FG_BRIGHT_MAGENTA}${Y.BOLD}Agent Conversations${Y.RESET}`),d.writeln(`${Y.FG_BRIGHT_BLACK}Real-time agent reasoning, tool use, and responses${Y.RESET}`),d.writeln("");const m=()=>{try{g.fit()}catch(w){console.warn("Xterm fit addon error:",w)}};window.addEventListener("resize",m);const v=new ResizeObserver(()=>{try{g.fit()}catch(w){console.warn("Xterm fit addon error:",w)}});return(y=e.current)!=null&&y.parentElement&&v.observe(e.current.parentElement),()=>{v.disconnect(),window.removeEventListener("resize",m),d.dispose()}},[]),R.useEffect(()=>{const d=r.current;if(!d)return;const g=t.slice(n.current);n.current=t.length,g.forEach(m=>{cT(m).forEach(y=>{d.writeln(y)}),d.scrollToBottom()})},[t]),R.useEffect(()=>{const d=[];t.slice(-10).forEach(m=>{m.entry_type==="assistant_message"&&m.tool_uses&&m.tool_uses.forEach(v=>{d.push({name:v.name,input:v.input})})}),l(d.slice(-20))},[t]),a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsx("div",{ref:e,className:"flex-1 min-h-0",style:{padding:0,margin:0}}),o.length>0&&a.jsxs("div",{className:"border-t border-zinc-800 bg-zinc-950",children:[a.jsxs("button",{onClick:()=>c(!i),className:"w-full px-3 py-2 text-left text-sm text-zinc-400 hover:bg-zinc-900 hover:text-zinc-300 transition-colors flex items-center gap-2",children:[a.jsx("span",{className:"text-xs",children:i?"":""}),a.jsxs("span",{children:["Tool Details (",o.length," recent)"]})]}),i&&a.jsx("div",{className:"px-3 pb-3 max-h-64 overflow-auto",children:o.map((d,g)=>a.jsxs("div",{className:"mb-3 last:mb-0",children:[a.jsxs("div",{className:"text-cyan-400 font-mono text-sm mb-1",children:[" ",d.name]}),a.jsx("pre",{className:"text-xs text-zinc-400 bg-zinc-900 p-2 rounded overflow-x-auto whitespace-pre-wrap font-mono",children:JSON.stringify(d.input,null,2)})]},g))})]})]})}function dT({activeGenerations:t,activeTabId:e,onTabChange:r,onNewTab:s,concurrencyInfo:n}){const i=(n==null?void 0:n.canStartNew)??!1;return a.jsxs("div",{className:"flex items-center gap-1 px-2 py-1.5 bg-leo-bg-secondary border-b border-leo-border overflow-x-auto",children:[t.map(c=>{const o=c.id===e,l=c.currentIteration>0?`${c.currentIteration}/${c.maxIterations}`:c.status;return a.jsxs("button",{onClick:()=>r(c.id),className:`
              flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium
              transition-all duration-200 whitespace-nowrap min-w-0
              ${o?"bg-gradient-to-r from-purple-500/20 to-cyan-500/20 text-leo-text border border-purple-500/30":"bg-leo-bg-tertiary text-leo-text-secondary hover:bg-leo-bg-hover hover:text-leo-text"}
            `,children:[a.jsx("span",{className:`w-1.5 h-1.5 rounded-full flex-shrink-0 ${c.status==="generating"?"bg-green-500 animate-pulse":c.status==="queued"?"bg-yellow-500":c.status==="paused"?"bg-blue-500":"bg-gray-500"}`}),a.jsx("span",{className:"truncate max-w-[100px]",children:c.appName}),a.jsxs("span",{className:"text-[10px] text-leo-text-tertiary",children:["(",l,")"]})]},c.id)}),a.jsxs("button",{onClick:s,disabled:!i,className:`
          flex items-center gap-1 px-2 py-1.5 rounded-lg text-xs
          transition-all duration-200
          ${i?"bg-leo-bg-tertiary text-leo-text-secondary hover:bg-leo-bg-hover hover:text-leo-text":"text-leo-text-tertiary cursor-not-allowed opacity-50"}
        `,title:i?"Start new generation":`Max ${(n==null?void 0:n.maxConcurrent)||0} concurrent generations`,children:[a.jsx(C0,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"hidden sm:inline",children:"New"})]}),n&&a.jsxs("div",{className:"ml-auto flex items-center gap-1.5 text-[10px] text-leo-text-tertiary px-2",children:[a.jsxs("span",{children:[n.activeCount,"/",n.maxConcurrent," active"]}),n.poolInfo.mode==="pooled"&&a.jsxs("span",{className:"text-leo-text-quaternary",children:["(",n.poolInfo.total-n.poolInfo.available,"/",n.poolInfo.total," pools)"]})]})]})}function hT(t){const e=t+"CollectionProvider",[r,s]=eu(e),[n,i]=r(e,{collectionRef:{current:null},itemMap:new Map}),c=_=>{const{scope:p,children:h}=_,u=Cs.useRef(null),f=Cs.useRef(new Map).current;return a.jsx(n,{scope:p,itemMap:f,collectionRef:u,children:h})};c.displayName=e;const o=t+"CollectionSlot",l=Ec(o),d=Cs.forwardRef((_,p)=>{const{scope:h,children:u}=_,f=i(o,h),x=Kr(p,f.collectionRef);return a.jsx(l,{ref:x,children:u})});d.displayName=o;const g=t+"CollectionItemSlot",m="data-radix-collection-item",v=Ec(g),y=Cs.forwardRef((_,p)=>{const{scope:h,children:u,...f}=_,x=Cs.useRef(null),k=Kr(p,x),C=i(g,h);return Cs.useEffect(()=>(C.itemMap.set(x,{ref:x,...f}),()=>void C.itemMap.delete(x))),a.jsx(v,{[m]:"",ref:k,children:u})});y.displayName=g;function w(_){const p=i(t+"CollectionConsumer",_);return Cs.useCallback(()=>{const u=p.collectionRef.current;if(!u)return[];const f=Array.from(u.querySelectorAll(`[${m}]`));return Array.from(p.itemMap.values()).sort((C,S)=>f.indexOf(C.ref.current)-f.indexOf(S.ref.current))},[p.collectionRef,p.itemMap])}return[{Provider:c,Slot:d,ItemSlot:y},w,s]}var fT=R.createContext(void 0);function Ix(t){const e=R.useContext(fT);return t||e||"ltr"}var Yu="rovingFocusGroup.onEntryFocus",pT={bubbles:!1,cancelable:!0},Qa="RovingFocusGroup",[Bh,Dx,mT]=hT(Qa),[gT,Mx]=eu(Qa,[mT]),[vT,_T]=gT(Qa),Bx=R.forwardRef((t,e)=>a.jsx(Bh.Provider,{scope:t.__scopeRovingFocusGroup,children:a.jsx(Bh.Slot,{scope:t.__scopeRovingFocusGroup,children:a.jsx(yT,{...t,ref:e})})}));Bx.displayName=Qa;var yT=R.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,orientation:s,loop:n=!1,dir:i,currentTabStopId:c,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:d,preventScrollOnEntryFocus:g=!1,...m}=t,v=R.useRef(null),y=Kr(e,v),w=Ix(i),[_,p]=sp({prop:c,defaultProp:o??null,onChange:l,caller:Qa}),[h,u]=R.useState(!1),f=ho(d),x=Dx(r),k=R.useRef(!1),[C,S]=R.useState(0);return R.useEffect(()=>{const b=v.current;if(b)return b.addEventListener(Yu,f),()=>b.removeEventListener(Yu,f)},[f]),a.jsx(vT,{scope:r,orientation:s,dir:w,loop:n,currentTabStopId:_,onItemFocus:R.useCallback(b=>p(b),[p]),onItemShiftTab:R.useCallback(()=>u(!0),[]),onFocusableItemAdd:R.useCallback(()=>S(b=>b+1),[]),onFocusableItemRemove:R.useCallback(()=>S(b=>b-1),[]),children:a.jsx(Bt.div,{tabIndex:h||C===0?-1:0,"data-orientation":s,...m,ref:y,style:{outline:"none",...t.style},onMouseDown:wt(t.onMouseDown,()=>{k.current=!0}),onFocus:wt(t.onFocus,b=>{const E=!k.current;if(b.target===b.currentTarget&&E&&!h){const N=new CustomEvent(Yu,pT);if(b.currentTarget.dispatchEvent(N),!N.defaultPrevented){const O=x().filter(H=>H.focusable),I=O.find(H=>H.active),P=O.find(H=>H.id===_),D=[I,P,...O].filter(Boolean).map(H=>H.ref.current);Ux(D,g)}}k.current=!1}),onBlur:wt(t.onBlur,()=>u(!1))})})}),$x="RovingFocusGroupItem",Fx=R.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,focusable:s=!0,active:n=!1,tabStopId:i,children:c,...o}=t,l=na(),d=i||l,g=_T($x,r),m=g.currentTabStopId===d,v=Dx(r),{onFocusableItemAdd:y,onFocusableItemRemove:w,currentTabStopId:_}=g;return R.useEffect(()=>{if(s)return y(),()=>w()},[s,y,w]),a.jsx(Bh.ItemSlot,{scope:r,id:d,focusable:s,active:n,children:a.jsx(Bt.span,{tabIndex:m?0:-1,"data-orientation":g.orientation,...o,ref:e,onMouseDown:wt(t.onMouseDown,p=>{s?g.onItemFocus(d):p.preventDefault()}),onFocus:wt(t.onFocus,()=>g.onItemFocus(d)),onKeyDown:wt(t.onKeyDown,p=>{if(p.key==="Tab"&&p.shiftKey){g.onItemShiftTab();return}if(p.target!==p.currentTarget)return;const h=bT(p,g.orientation,g.dir);if(h!==void 0){if(p.metaKey||p.ctrlKey||p.altKey||p.shiftKey)return;p.preventDefault();let f=v().filter(x=>x.focusable).map(x=>x.ref.current);if(h==="last")f.reverse();else if(h==="prev"||h==="next"){h==="prev"&&f.reverse();const x=f.indexOf(p.currentTarget);f=g.loop?ST(f,x+1):f.slice(x+1)}setTimeout(()=>Ux(f))}}),children:typeof c=="function"?c({isCurrentTabStop:m,hasTabStop:_!=null}):c})})});Fx.displayName=$x;var xT={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function wT(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function bT(t,e,r){const s=wT(t.key,r);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return xT[s]}function Ux(t,e=!1){const r=document.activeElement;for(const s of t)if(s===r||(s.focus({preventScroll:e}),document.activeElement!==r))return}function ST(t,e){return t.map((r,s)=>t[(e+s)%t.length])}var CT=Bx,kT=Fx,su="Tabs",[ET]=eu(su,[Mx]),Hx=Mx(),[jT,xp]=ET(su),zx=R.forwardRef((t,e)=>{const{__scopeTabs:r,value:s,onValueChange:n,defaultValue:i,orientation:c="horizontal",dir:o,activationMode:l="automatic",...d}=t,g=Ix(o),[m,v]=sp({prop:s,onChange:n,defaultProp:i??"",caller:su});return a.jsx(jT,{scope:r,baseId:na(),value:m,onValueChange:v,orientation:c,dir:g,activationMode:l,children:a.jsx(Bt.div,{dir:g,"data-orientation":c,...d,ref:e})})});zx.displayName=su;var Wx="TabsList",qx=R.forwardRef((t,e)=>{const{__scopeTabs:r,loop:s=!0,...n}=t,i=xp(Wx,r),c=Hx(r);return a.jsx(CT,{asChild:!0,...c,orientation:i.orientation,dir:i.dir,loop:s,children:a.jsx(Bt.div,{role:"tablist","aria-orientation":i.orientation,...n,ref:e})})});qx.displayName=Wx;var Gx="TabsTrigger",Vx=R.forwardRef((t,e)=>{const{__scopeTabs:r,value:s,disabled:n=!1,...i}=t,c=xp(Gx,r),o=Hx(r),l=Qx(c.baseId,s),d=Zx(c.baseId,s),g=s===c.value;return a.jsx(kT,{asChild:!0,...o,focusable:!n,active:g,children:a.jsx(Bt.button,{type:"button",role:"tab","aria-selected":g,"aria-controls":d,"data-state":g?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:l,...i,ref:e,onMouseDown:wt(t.onMouseDown,m=>{!n&&m.button===0&&m.ctrlKey===!1?c.onValueChange(s):m.preventDefault()}),onKeyDown:wt(t.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&c.onValueChange(s)}),onFocus:wt(t.onFocus,()=>{const m=c.activationMode!=="manual";!g&&!n&&m&&c.onValueChange(s)})})})});Vx.displayName=Gx;var Kx="TabsContent",Jx=R.forwardRef((t,e)=>{const{__scopeTabs:r,value:s,forceMount:n,children:i,...c}=t,o=xp(Kx,r),l=Qx(o.baseId,s),d=Zx(o.baseId,s),g=s===o.value,m=R.useRef(g);return R.useEffect(()=>{const v=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(v)},[]),a.jsx(Va,{present:n||g,children:({present:v})=>a.jsx(Bt.div,{"data-state":g?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!v,id:d,tabIndex:0,...c,ref:e,style:{...t.style,animationDuration:m.current?"0s":void 0},children:v&&i})})});Jx.displayName=Kx;function Qx(t,e){return`${t}-trigger-${e}`}function Zx(t,e){return`${t}-content-${e}`}var RT=zx,Yx=qx,Xx=Vx,ew=Jx;const NT=RT,tw=R.forwardRef(({className:t,...e},r)=>a.jsx(Yx,{ref:r,className:Xe("inline-flex h-10 items-center justify-center rounded-md bg-leo-bg-tertiary p-1 text-leo-text-secondary",t),...e}));tw.displayName=Yx.displayName;const $h=R.forwardRef(({className:t,...e},r)=>a.jsx(Xx,{ref:r,className:Xe("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-leo-bg transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-leo-primary focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-leo-bg data-[state=active]:text-leo-text data-[state=active]:shadow-sm",t),...e}));$h.displayName=Xx.displayName;const TT=R.forwardRef(({className:t,...e},r)=>a.jsx(ew,{ref:r,className:Xe("mt-2 ring-offset-leo-bg focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-leo-primary focus-visible:ring-offset-2",t),...e}));TT.displayName=ew.displayName;function AT({position:t,onPositionChange:e,minPosition:r=20,maxPosition:s=80,className:n=""}){const[i,c]=R.useState(!1),[o,l]=R.useState(!1),d=R.useRef(null),g=R.useCallback(w=>{w.preventDefault(),c(!0)},[]),m=R.useCallback(w=>{var f;if(!i)return;const _=(f=d.current)==null?void 0:f.parentElement;if(!_)return;const p=_.getBoundingClientRect(),h=(w.clientX-p.left)/p.width*100,u=Math.min(Math.max(h,r),s);e(u)},[i,r,s,e]),v=R.useCallback(()=>{c(!1)},[]);R.useEffect(()=>(i&&(document.addEventListener("mousemove",m),document.addEventListener("mouseup",v),document.body.style.userSelect="none",document.body.style.cursor="col-resize"),()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",v),document.body.style.userSelect="",document.body.style.cursor=""}),[i,m,v]);const y=i||o;return a.jsxs("div",{ref:d,onMouseDown:g,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),className:`
        relative flex-shrink-0 w-1 cursor-col-resize
        transition-colors duration-150
        ${y?"bg-leo-primary/50":"bg-leo-border hover:bg-leo-primary/30"}
        ${n}
      `,role:"separator","aria-orientation":"vertical","aria-valuenow":t,"aria-valuemin":r,"aria-valuemax":s,children:[a.jsx("div",{className:"absolute inset-y-0 -left-1 -right-1 z-10"}),a.jsx("div",{className:`
          absolute inset-y-0 left-1/2 w-0.5 -translate-x-1/2
          transition-all duration-150
          ${y?"bg-leo-primary shadow-glow-sm scale-y-100":"bg-transparent scale-y-0"}
        `}),a.jsxs("div",{className:`
          absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2
          flex flex-col gap-1 transition-opacity duration-150
          ${y?"opacity-100":"opacity-0"}
        `,children:[a.jsx("div",{className:"w-1 h-1 rounded-full bg-leo-primary"}),a.jsx("div",{className:"w-1 h-1 rounded-full bg-leo-primary"}),a.jsx("div",{className:"w-1 h-1 rounded-full bg-leo-primary"})]})]})}function OT(t,e=50){const[r,s]=R.useState(()=>{if(typeof window<"u"){const i=localStorage.getItem(t);if(i){const c=parseFloat(i);if(!isNaN(c)&&c>=0&&c<=100)return c}}return e}),n=R.useCallback(i=>{s(i),typeof window<"u"&&localStorage.setItem(t,i.toString())},[t]);return[r,n]}function PT({credentialRequest:t,onSubmit:e,timeoutWarning:r}){const[s,n]=R.useState({}),[i,c]=R.useState({}),[o,l]=R.useState(!1);if(R.useEffect(()=>{if(t){const y={};t.credentials.forEach(w=>{y[w.key]=""}),n(y),c({}),l(!1)}},[t==null?void 0:t.id]),!t)return null;const d=(y,w)=>{n(_=>({..._,[y]:w})),i[y]&&c(_=>{const p={..._};return delete p[y],p})},g=()=>{const y={};return t.credentials.forEach(w=>{var p;const _=((p=s[w.key])==null?void 0:p.trim())||"";if(w.required&&!_){y[w.key]="This field is required";return}if(_&&w.validation_pattern)try{new RegExp(w.validation_pattern).test(_)||(y[w.key]="Invalid format")}catch{}}),c(y),Object.keys(y).length===0},m=y=>{if(y.preventDefault(),!g())return;l(!0);const w=t.credentials.map(_=>{var p;return{key:_.key,value:((p=s[_.key])==null?void 0:p.trim())||""}}).filter(_=>_.value);e(t.id,w,!1)},v=()=>{e(t.id,[],!0)};return a.jsx(hx,{open:!0,onOpenChange:()=>{},children:a.jsxs(lp,{className:"sm:max-w-lg",children:[a.jsxs(cp,{children:[a.jsxs(dp,{className:"flex items-center gap-2",children:[a.jsx(ZE,{className:"h-5 w-5 text-yellow-500"}),"Credentials Required"]}),a.jsx(hp,{children:t.context||"Leo needs the following credentials to continue."})]}),r&&a.jsxs(Ai,{variant:"destructive",className:"border-yellow-500/50 bg-yellow-500/10",children:[a.jsx(Qn,{className:"h-4 w-4"}),a.jsxs(Oi,{children:[Math.floor(r.remaining_seconds/60)," minutes remaining to enter credentials"]})]}),a.jsxs("form",{onSubmit:m,className:"space-y-4",children:[t.credentials.map(y=>a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(nr,{htmlFor:y.key,className:"flex items-center gap-1",children:[y.label,y.required&&a.jsx("span",{className:"text-red-500",children:"*"})]}),y.help_url&&a.jsxs("a",{href:y.help_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-500 hover:text-blue-400 flex items-center gap-1",children:["Get key ",a.jsx(So,{className:"h-3 w-3"})]})]}),a.jsx(Vt,{id:y.key,type:y.sensitive?"password":"text",value:s[y.key]||"",onChange:w=>d(y.key,w.target.value),placeholder:y.description||`Enter ${y.label}`,className:i[y.key]?"border-red-500":"",autoComplete:"off",disabled:o}),y.description&&!i[y.key]&&a.jsx("p",{className:"text-xs text-muted-foreground",children:y.description}),i[y.key]&&a.jsxs("p",{className:"text-xs text-red-500 flex items-center gap-1",children:[a.jsx(Kn,{className:"h-3 w-3"}),i[y.key]]})]},y.key)),a.jsxs(up,{className:"gap-2 sm:gap-0",children:[a.jsx(le,{type:"button",variant:"outline",onClick:v,disabled:o,children:"Cancel"}),a.jsx(le,{type:"submit",disabled:o,children:o?"Submitting...":"Continue"})]})]})]})})}const iv=2e3;function LT({screenshots:t,className:e=""}){const[r,s]=R.useState(0),[n,i]=R.useState(!1),[c,o]=R.useState(!0),[l,d]=R.useState(0),g=R.useRef(0),m=R.useRef(null);R.useEffect(()=>{if(!c||t.length===0)return;const p=t.length-1;if(r===p)return;const h=Date.now(),u=h-g.current;if(m.current&&(clearTimeout(m.current),m.current=null),u>=iv)s(p),g.current=h,d(0);else{const f=iv-u;d(p-r),m.current=setTimeout(()=>{s(p),g.current=Date.now(),d(0)},f)}return()=>{m.current&&clearTimeout(m.current)}},[t.length,c,r]);const v=t[r],y=R.useCallback(()=>{r>0&&(s(r-1),o(!1))},[r]),w=R.useCallback(()=>{r<t.length-1&&(s(r+1),r+1===t.length-1&&o(!0))},[r,t.length]);R.useEffect(()=>{const p=h=>{h.key==="ArrowLeft"?y():h.key==="ArrowRight"?w():h.key==="Escape"&&n&&i(!1)};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[y,w,n]);const _=p=>{try{return new Date(p).toLocaleTimeString()}catch{return p}};return t.length===0?a.jsx("div",{className:`flex flex-col items-center justify-center h-full ${e}`,children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-lg bg-leo-bg-tertiary flex items-center justify-center shadow-glow-sm",children:a.jsx(HE,{className:"w-8 h-8 text-leo-text-tertiary"})}),a.jsx("p",{className:"text-leo-text-secondary text-sm mb-2",children:"No screenshots yet"}),a.jsx("p",{className:"text-leo-text-tertiary text-xs max-w-md",children:"Screenshots will appear here during quality assurance testing"})]})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`flex flex-col h-full ${e}`,children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-leo-border bg-leo-bg-secondary",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-leo-text-secondary",children:[a.jsx(b0,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"font-medium",children:(v==null?void 0:v.filename)||"screenshot"}),(v==null?void 0:v.stage)&&a.jsx("span",{className:"px-1.5 py-0.5 bg-leo-primary/20 text-leo-primary rounded text-[10px]",children:v.stage})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[(v==null?void 0:v.timestamp)&&a.jsxs("span",{className:"flex items-center gap-1 text-xs text-leo-text-tertiary",children:[a.jsx(Qn,{className:"w-3 h-3"}),_(v.timestamp)]}),a.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-leo-bg-tertiary rounded-lg",children:[a.jsx("button",{onClick:y,disabled:r===0,className:"p-0.5 hover:bg-leo-bg-hover rounded disabled:opacity-30 disabled:cursor-not-allowed",title:"Previous screenshot",children:a.jsx(Sg,{className:"w-4 h-4"})}),a.jsxs("span",{className:"text-xs text-leo-text-secondary min-w-[3rem] text-center",children:[r+1," / ",t.length]}),a.jsx("button",{onClick:w,disabled:r===t.length-1,className:"p-0.5 hover:bg-leo-bg-hover rounded disabled:opacity-30 disabled:cursor-not-allowed",title:"Next screenshot",children:a.jsx(Cg,{className:"w-4 h-4"})})]}),c?l>0?a.jsxs("span",{className:"text-xs text-leo-text-tertiary animate-pulse",children:["+",l," pending"]}):null:a.jsx("button",{onClick:()=>{o(!0),s(t.length-1),g.current=Date.now()},className:"text-xs text-leo-primary hover:underline",title:"Jump to latest screenshot",children:"Live"}),a.jsx("button",{onClick:()=>i(!0),className:"p-1 hover:bg-leo-bg-tertiary rounded transition-colors",title:"View full size",children:a.jsx(t2,{className:"w-4 h-4"})})]})]}),a.jsx("div",{className:"flex-1 overflow-hidden bg-[#09090b] flex items-center justify-center p-4",children:v&&a.jsx("img",{src:v.image_base64,alt:v.description||v.filename,className:"max-w-full max-h-full object-contain rounded shadow-lg cursor-pointer",onClick:()=>i(!0)})}),(v==null?void 0:v.description)&&a.jsx("div",{className:"px-3 py-2 border-t border-leo-border bg-leo-bg-secondary",children:a.jsx("p",{className:"text-xs text-leo-text-secondary",children:v.description})})]}),n&&v&&a.jsxs("div",{className:"fixed inset-0 z-50 bg-black/90 flex items-center justify-center p-8",onClick:()=>i(!1),children:[a.jsx("button",{onClick:()=>i(!1),className:"absolute top-4 right-4 p-2 bg-white/10 hover:bg-white/20 rounded-full transition-colors",children:a.jsx(us,{className:"w-6 h-6 text-white"})}),a.jsx("button",{onClick:p=>{p.stopPropagation(),y()},disabled:r===0,className:"absolute left-4 p-3 bg-white/10 hover:bg-white/20 rounded-full transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:a.jsx(Sg,{className:"w-8 h-8 text-white"})}),a.jsx("button",{onClick:p=>{p.stopPropagation(),w()},disabled:r===t.length-1,className:"absolute right-4 p-3 bg-white/10 hover:bg-white/20 rounded-full transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:a.jsx(Cg,{className:"w-8 h-8 text-white"})}),a.jsx("img",{src:v.image_base64,alt:v.description||v.filename,className:"max-w-full max-h-full object-contain",onClick:p=>p.stopPropagation()}),a.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex items-center gap-4 px-4 py-2 bg-black/50 rounded-lg text-white text-sm",children:[a.jsx("span",{children:v.filename}),v.width&&v.height&&a.jsxs("span",{className:"text-white/60",children:[v.width," x ",v.height]}),a.jsxs("span",{className:"text-white/60",children:[r+1," / ",t.length]})]})]})]})}function ov(){const[,t]=dS("/console/:id"),e=t!=null&&t.id?parseInt(t.id,10):null,{user:r,profile:s}=ft(),{activeGenerations:n,activeTabId:i,setActiveTabId:c,concurrencyInfo:o,refreshActiveGenerations:l}=oT(),{isConnected:d,containerConnected:g,isGenerating:m,isCancelling:v,messages:y,conversationLogs:w,screenshots:_,currentPrompt:p,progress:h,completionInfo:u,globalAuthError:f,clearGlobalAuthError:x,startGeneration:k,sendResponse:C,requestStop:S,clearMessages:b,currentCredentialRequest:E,sendCredentialResponse:N}=GR(i),O=R.useMemo(()=>{if(!E)return null;const ne=[...y].reverse().find(ze=>ze.type==="credential_timeout_warning"&&ze.id===E.id);return ne&&"elapsed_seconds"in ne&&"remaining_seconds"in ne?{elapsed_seconds:ne.elapsed_seconds,remaining_seconds:ne.remaining_seconds}:null},[y,E]),[I,P]=R.useState(!0),[U,D]=R.useState("about:blank"),[H,z]=R.useState("new"),[B,j]=R.useState("autonomous"),[T,L]=R.useState(""),[$,V]=R.useState(""),[J,ue]=R.useState(null),[he,F]=R.useState(""),[A,K]=R.useState(10),q=!0,[ee,te]=R.useState([]),[Se,Ie]=R.useState(!1),[Ee,ct]=R.useState([]),[G,X]=R.useState(!1),[pt,Jr]=R.useState(!1),[ri,$t]=R.useState(null),Nt=async()=>{X(!0);try{const ne=await Mh.apps.list();ne.status===200&&ct(ne.body)}catch(ne){console.error("[ConsolePage] Failed to fetch apps:",ne)}finally{X(!1)}};R.useEffect(()=>{Nt()},[]),R.useEffect(()=>{e&&Ee.length>0&&J===null&&Ee.some(ze=>ze.id===e)&&(ue(e),z("resume"))},[e,Ee,J]),R.useEffect(()=>{K(H==="resume"?3:10)},[H]),R.useEffect(()=>{f&&($t(f),x())},[f,x]);const[Qr,cr]=R.useState("console"),[fn,si]=R.useState(!1),[St,pn]=R.useState(!0);R.useEffect(()=>{m&&!I&&pn(!1)},[m,I]);const[ur,mn]=OT("leo-console-panel-width",50),De=_.length>0||(u==null?void 0:u.download_url)&&u.download_url!=="about:blank",[jo,wp]=R.useState(""),bp=(h==null?void 0:h.iteration)||0,Sp=(h==null?void 0:h.total_iterations)||A,rw=ee.reduce((ne,ze)=>ne+ze.file.size,0),sw=ne=>{var Ct;const ze=ne.target.files;if(!ze)return;const Jt=[],Ze=[];for(let mt=0;mt<ze.length;mt++){const Qt=ze[mt],Tt="."+((Ct=Qt.name.split(".").pop())==null?void 0:Ct.toLowerCase());if(!Br.ALLOWED_EXTENSIONS.includes(Tt)){Ze.push(`${Qt.name}: File type not allowed`);continue}if(Qt.size>Br.MAX_FILE_SIZE){Ze.push(`${Qt.name}: File too large (max ${Br.MAX_FILE_SIZE/1024/1024}MB)`);continue}if(ee.length+Jt.length>=Br.MAX_FILES){Ze.push(`Maximum ${Br.MAX_FILES} files allowed`);break}if(rw+Jt.reduce((gn,Ro)=>gn+Ro.file.size,0)+Qt.size>Br.MAX_TOTAL_SIZE){Ze.push(`Total size would exceed ${Br.MAX_TOTAL_SIZE/1024/1024}MB`);break}Jt.push({file:Qt,id:`${Qt.name}-${Date.now()}-${Math.random().toString(36).slice(2)}`})}Ze.length>0&&$t(Ze.join(", ")),Jt.length>0&&te(mt=>[...mt,...Jt]),ne.target.value=""},nw=ne=>{te(ze=>ze.filter(Jt=>Jt.id!==ne))},iw=ne=>{var Jt;const ze=(Jt=ne.split(".").pop())==null?void 0:Jt.toLowerCase();return["png","jpg","jpeg","gif","svg"].includes(ze||"")?a.jsx(b0,{className:"w-3 h-3"}):a.jsx(QE,{className:"w-3 h-3"})},Cp=async ne=>{var Jt;if(ne.preventDefault(),!T.trim()||m&&!I||pt||!d)return;const ze=r==null?void 0:r.id;if(!ze){$t("You must be logged in to generate apps");return}Jr(!0),$t(null);try{const Ze=H==="new"?$.trim()||T.trim().toLowerCase().replace(/[^a-z0-9]+/g,"-").substring(0,30):((Jt=Ee.find(Tt=>Tt.id===J))==null?void 0:Jt.appName)||"unknown-app",Ct=H==="resume"?Ee.find(Tt=>Tt.id===J):null;if(H==="resume"&&!Ct){$t("Please select an app to resume"),Jr(!1);return}let mt,Qt=[];if(ee.length>0){Ie(!0);const Tt=new FormData;Tt.append("data",JSON.stringify({appName:Ze,prompt:T.trim(),mode:B,maxIterations:A,...H==="resume"&&Ct?{generationType:"resume",appId:Ct.appUuid}:{generationType:"new"}}));for(const Ro of ee)Tt.append("files",Ro.file);const Za=rn(),gn=await fetch("/api/generations/with-attachments",{method:"POST",headers:{Authorization:`Bearer ${Za}`},body:Tt});if(Ie(!1),!gn.ok){if(gn.status===401||gn.status===403)throw new Error("Your session has expired. Please log in again.");const Ro=await gn.json();throw new Error(Ro.error||"Failed to upload files")}mt=await gn.json(),Qt=mt.attachments||[]}else{const Tt=await Mh.generations.create({body:{appName:Ze,prompt:T.trim(),mode:B,maxIterations:A,...H==="resume"&&Ct?{generationType:"resume",appId:Ct.appUuid,githubUrl:Ct.githubUrl||void 0,deploymentUrl:Ct.deploymentUrl||void 0}:{generationType:"new"}}});if(Tt.status!==201){if(Tt.status===401||Tt.status===403)throw new Error("Your session has expired. Please log in again.");const Za=Tt.body;throw new Error(Za.error||"Failed to create generation request")}mt=Tt.body}k(H==="new"?{requestId:mt.id,prompt:T.trim(),mode:B,appName:Ze,userId:ze,appId:mt.appUuid,maxIterations:A,enableSubagents:q,attachments:Qt.length>0?Qt:void 0}:{requestId:mt.id,prompt:T.trim(),mode:B,appName:Ct.appName,userId:ze,appId:mt.appUuid,maxIterations:A,enableSubagents:q,githubUrl:Ct.githubUrl||void 0,resumeSessionId:he||void 0,attachments:Qt.length>0?Qt:void 0}),L(""),te([]),P(!1),l()}catch(Ze){if(console.error("[ConsolePage] Failed to create generation:",Ze),Ze&&typeof Ze=="object"&&"status"in Ze){const Ct=Ze.status;if(Ct===401||Ct===403)$t("Your session has expired. Please log in again.");else if(Ct===429){const mt=Ze.body;$t((mt==null?void 0:mt.error)||"Concurrency limit reached. Please wait for a generation to complete.")}else $t(Ze instanceof Error?Ze.message:"Failed to start generation")}else $t(Ze instanceof Error?Ze.message:"Failed to start generation")}finally{Jr(!1)}},ow=ne=>{(ne.metaKey||ne.ctrlKey)&&ne.key==="Enter"&&(ne.preventDefault(),Cp(ne))},aw=ne=>{ne.preventDefault(),!(!p||!jo.trim())&&(C(p.id,jo.trim()),wp(""))},lw=()=>{confirm(`Cancel generation?

Your work will be saved to GitHub before stopping. You can resume later from the saved state.`)&&S()};return u!=null&&u.download_url&&U==="about:blank"&&D(u.download_url),a.jsxs("div",{className:"flex flex-col h-screen bg-background relative overflow-hidden",children:[a.jsx("a",{href:"#main-content",className:"skip-link",children:"Skip to main content"}),a.jsx("div",{className:"fixed inset-0 leo-dots-pattern opacity-20 pointer-events-none","aria-hidden":"true"}),a.jsx("header",{className:"relative z-10 border-b border-border bg-background/95 backdrop-blur-md",role:"banner",children:a.jsx("div",{className:"max-w-full px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between h-16 md:h-20",children:[a.jsxs(Re,{href:"/",className:"group",children:[a.jsx("div",{className:"hidden sm:block",children:a.jsx(E0,{size:"md"})}),a.jsx("div",{className:"sm:hidden",children:a.jsx(Ta,{size:36})})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"hidden md:flex items-center gap-2 mr-4 text-xs text-muted-foreground",children:d?g?a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"w-1.5 h-1.5 bg-leo-verdigris rounded-full"}),"Container ready"]}):a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"}),"Server connected"]}):a.jsxs("span",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"w-1.5 h-1.5 bg-yellow-500 rounded-full animate-pulse"}),"Connecting..."]})}),v&&a.jsx(qs,{variant:"secondary",className:"bg-yellow-100 text-yellow-700 border-yellow-300 animate-pulse",children:"Cancelling..."}),m&&!v&&a.jsx(qs,{variant:"secondary",className:"bg-primary/10 text-primary border-primary/30 animate-pulse",children:"Generating..."}),u&&a.jsx(qs,{variant:"secondary",className:"bg-leo-verdigris/10 text-leo-verdigris border-leo-verdigris/30",children:"Complete"}),a.jsx(Re,{href:"/apps",children:a.jsxs("button",{className:"flex items-center gap-2 px-4 min-h-11 text-sm font-medium text-muted-foreground hover:text-foreground hover:bg-muted/50 rounded-xl transition-all duration-200",children:[a.jsx(bc,{className:"h-5 w-5"}),a.jsx("span",{className:"hidden sm:inline",children:"My Apps"})]})}),a.jsxs("button",{className:"flex items-center gap-2 px-4 min-h-11 text-sm font-medium text-primary bg-primary/10 rounded-xl",children:[a.jsx(kc,{className:"h-5 w-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Console"})]}),a.jsxs("button",{onClick:()=>si(!0),className:"flex items-center gap-2 px-4 min-h-11 text-sm text-muted-foreground hover:text-foreground hover:bg-muted/50 rounded-xl transition-colors btn-press focus-ring",title:"Send Feedback","aria-label":"Send Feedback",children:[a.jsx(tp,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Feedback"})]}),a.jsx("div",{className:"ml-2 pl-2 border-l border-border",children:a.jsx(xh,{})})]})]})})}),s&&(s.role==="dev"||s.role==="admin")&&!s.hasClaudeToken&&a.jsx("div",{className:"relative z-10 bg-yellow-50 border-b border-yellow-200 px-4 py-2.5",children:a.jsxs("div",{className:"max-w-full flex items-center justify-center gap-3 text-sm",children:[a.jsx(lo,{className:"h-4 w-4 text-yellow-600 flex-shrink-0"}),a.jsxs("span",{className:"text-yellow-800",children:[a.jsx("strong",{className:"font-semibold",children:"Developer token required."})," ","Configure your Claude API token to run app generations."]}),a.jsx(Re,{href:"/settings",children:a.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1 bg-yellow-100 hover:bg-yellow-200 text-yellow-800 rounded-md transition-colors text-xs font-medium",children:[a.jsx(Cc,{className:"h-3.5 w-3.5"}),"Go to Settings"]})})]})}),(n.length>0||I)&&a.jsx(dT,{activeGenerations:n,activeTabId:I?null:i,onTabChange:ne=>{c(ne),P(!1)},onNewTab:()=>P(!0),concurrencyInfo:o}),a.jsxs("main",{id:"main-content",className:"flex flex-1 overflow-hidden",role:"main",children:[a.jsxs("div",{className:"flex flex-col bg-card transition-all duration-300",style:{width:De?`${ur}%`:"100%"},children:[a.jsx("div",{className:"flex-shrink-0 border-b border-border bg-muted/30 px-4 py-2",children:a.jsx(NT,{value:Qr,onValueChange:ne=>cr(ne),children:a.jsxs(tw,{className:"h-11 bg-transparent",children:[a.jsxs($h,{value:"console",className:"flex items-center gap-2 min-h-9 px-4 data-[state=active]:bg-primary/10 data-[state=active]:text-primary rounded-lg",children:[a.jsx(kc,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Console"})]}),a.jsxs($h,{value:"conversations",className:"flex items-center gap-2 min-h-9 px-4 data-[state=active]:bg-primary/10 data-[state=active]:text-primary rounded-lg",children:[a.jsx(s2,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Conversations"}),w.length>0&&a.jsx(qs,{variant:"secondary",className:"ml-1 text-xs bg-primary/20 text-primary",children:w.length})]})]})})}),a.jsxs("div",{className:`flex-1 flex flex-col overflow-hidden ${Qr!=="console"?"hidden":""}`,children:[a.jsxs("div",{className:"flex-1 overflow-hidden bg-[#0a0a0f] relative",children:[y.length===0&&!m&&!d&&I&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10 bg-[#0a0a0f]/98 animate-fade-in-up",children:a.jsxs("div",{className:"text-center max-w-lg px-6",children:[a.jsx("div",{className:"w-20 h-20 mx-auto mb-8 rounded-2xl bg-gradient-to-br from-leo-sienna/20 to-leo-gold/20 flex items-center justify-center shadow-warm",children:a.jsx(Co,{className:"w-10 h-10 text-leo-sienna"})}),a.jsx("h2",{className:"text-3xl font-serif font-bold text-white mb-4",children:"Welcome to Leo Console"}),a.jsx("p",{className:"text-gray-400 mb-8 leading-relaxed text-lg",children:"Describe your app idea below and watch it come to life. Leo will generate a production-ready application with authentication, database, and deployment."}),a.jsxs("div",{className:"space-y-3 text-left bg-white/5 rounded-xl p-5 border border-white/10",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mb-3 font-medium",children:"Try something like:"}),a.jsx("p",{className:"text-sm text-gray-300",children:'"A project management app for remote teams"'}),a.jsx("p",{className:"text-sm text-gray-300",children:'"An invoice generator for freelancers"'}),a.jsx("p",{className:"text-sm text-gray-300",children:'"A recipe sharing platform with AI suggestions"'})]})]})}),a.jsx(lT,{messages:y,isConnected:d,containerConnected:g})]}),p&&a.jsxs("div",{className:"flex-shrink-0 border-t border-border bg-card p-4",children:[a.jsx("div",{className:"mb-3",children:a.jsx("span",{className:"text-sm font-medium text-foreground",children:p.prompt})}),p.options&&p.options.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:p.options.map((ne,ze)=>a.jsx("button",{onClick:()=>C(p.id,ne),className:"px-4 py-2 text-sm bg-muted hover:bg-muted/80 border border-border rounded-lg transition-colors min-h-11",children:ne},ze))}),p.allow_editor&&a.jsxs("form",{onSubmit:aw,className:"flex gap-2",children:[a.jsx("input",{type:"text",value:jo,onChange:ne=>wp(ne.target.value),placeholder:"Custom response...",className:"flex-1 px-4 py-2 text-sm bg-input border border-border rounded-lg text-foreground"}),a.jsx("button",{type:"submit",className:"leo-btn-primary px-4 py-2 text-sm rounded-lg",children:"Send"})]})]}),m&&h&&a.jsxs("div",{className:"flex-shrink-0 border-t border-border bg-card p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-2.5 h-2.5 bg-primary rounded-full animate-pulse"}),a.jsx("span",{className:"text-sm font-medium text-foreground",children:h.stage||"Generating"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Iteration"}),a.jsxs("span",{className:"text-sm font-semibold text-foreground bg-muted px-2.5 py-1 rounded-md",children:[bp,"/",Sp]})]})]}),h.step&&a.jsx("p",{className:"text-xs text-muted-foreground mb-3 truncate",children:h.step}),a.jsx("div",{className:"w-full bg-muted rounded-full h-2.5 mb-4 overflow-hidden",children:a.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-leo-sienna via-leo-gold to-leo-verdigris transition-all duration-500 ease-out",style:{width:`${Math.max(5,bp/Sp*100)}%`}})}),a.jsx("button",{onClick:lw,disabled:v,className:"flex items-center justify-center gap-2 min-h-11 px-4 text-sm bg-destructive/10 hover:bg-destructive/20 border border-destructive/30 text-destructive rounded-xl transition-all duration-200 disabled:opacity-50 btn-press focus-ring","aria-label":"Cancel current generation",children:v?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-destructive border-t-transparent rounded-full animate-spin"}),a.jsx("span",{children:"Cancelling..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(ti,{className:"w-4 h-4"}),a.jsx("span",{children:"Cancel Generation"})]})})]}),a.jsx("div",{className:"flex-shrink-0 border-t border-border bg-card",children:a.jsxs("form",{onSubmit:Cp,className:"p-3 space-y-2",children:[a.jsx("input",{type:"file",id:"file-attachment-input",multiple:!0,accept:Br.ALLOWED_EXTENSIONS.join(","),onChange:sw,className:"hidden"}),St&&a.jsx("div",{className:"p-2 bg-muted/30 border border-border rounded-xl animate-fade-in-up",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"flex rounded-md border border-border overflow-hidden bg-background",children:[a.jsx("button",{type:"button",onClick:()=>z("new"),disabled:m&&!I,className:`px-2 py-1 text-xs font-medium transition-all ${H==="new"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}`,children:"New"}),a.jsx("button",{type:"button",onClick:()=>{z("resume"),Nt()},disabled:m&&!I,className:`px-2 py-1 text-xs font-medium transition-all ${H==="resume"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}`,children:"Resume"})]}),H==="new"?a.jsx("input",{type:"text",value:$,onChange:ne=>V(ne.target.value),placeholder:"App name",disabled:m&&!I,className:"leo-input text-xs py-1 px-2 w-24"}):a.jsxs(a.Fragment,{children:[a.jsxs("select",{value:J??"",onChange:ne=>ue(ne.target.value?parseInt(ne.target.value):null),disabled:m&&!I||G||Ee.length===0,className:"leo-input text-xs py-1 px-2 w-28",children:[a.jsx("option",{value:"",children:G?"Loading...":Ee.length===0?"No apps":"Select app"}),Ee.map(ne=>a.jsx("option",{value:ne.id,children:ne.appName},ne.id))]}),a.jsx("input",{type:"text",value:he,onChange:ne=>F(ne.target.value),placeholder:"Session",disabled:m&&!I,className:"leo-input text-xs py-1 px-2 w-20"})]}),a.jsxs("div",{className:"flex rounded-md border border-border overflow-hidden bg-background",children:[a.jsx("button",{type:"button",onClick:()=>j("autonomous"),disabled:m&&!I,className:`px-2 py-1 text-xs font-medium transition-all ${B==="autonomous"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}`,title:"Run iterations automatically",children:"Auto"}),a.jsx("button",{type:"button",onClick:()=>j("confirm_first"),disabled:m&&!I,className:`px-2 py-1 text-xs font-medium transition-all ${B==="confirm_first"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}`,title:"Confirm each iteration",children:"Confirm"})]}),a.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-background border border-border rounded-md",children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Iterations:"}),a.jsx("input",{type:"range",value:A,onChange:ne=>K(parseInt(ne.target.value)),disabled:m&&!I,min:1,max:20,className:"w-12 h-1.5 bg-muted rounded-lg appearance-none cursor-pointer accent-primary"}),a.jsx("span",{className:"text-xs text-foreground font-semibold w-4",children:A})]}),u&&a.jsx("button",{type:"button",onClick:b,className:"text-xs text-muted-foreground hover:text-foreground transition-colors",children:"Clear"})]})}),!St&&a.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 bg-muted/20 rounded-lg",children:[a.jsxs("span",{className:"text-xs text-muted-foreground",children:[H==="new"?"New":"Resume","  ",B==="autonomous"?"Auto":"Confirm","  ",A," iterations"]}),u&&a.jsx("button",{type:"button",onClick:b,className:"ml-auto text-xs text-muted-foreground hover:text-foreground transition-colors",children:"Clear"})]}),ee.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5",children:ee.map(ne=>a.jsxs("div",{className:"inline-flex items-center gap-1.5 px-2 py-1 bg-muted border border-border rounded-md text-xs",children:[iw(ne.file.name),a.jsx("span",{className:"max-w-[80px] truncate text-foreground",children:ne.file.name}),a.jsx("button",{type:"button",onClick:()=>nw(ne.id),className:"p-0.5 hover:bg-destructive/20 rounded transition-colors",title:"Remove file","aria-label":`Remove ${ne.file.name}`,children:a.jsx(us,{className:"w-3 h-3 text-muted-foreground hover:text-destructive"})})]},ne.id))}),ri&&a.jsxs("div",{className:"flex items-start gap-2 text-xs text-destructive bg-destructive/10 border border-destructive/30 rounded-lg px-3 py-2",children:[a.jsx(lo,{className:"w-3.5 h-3.5 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:ri})]}),a.jsxs("div",{className:"flex items-end gap-2",children:[a.jsxs("div",{className:"flex flex-col gap-1 flex-shrink-0",children:[a.jsx("button",{type:"button",onClick:()=>pn(!St),className:`w-9 h-9 flex items-center justify-center rounded-lg transition-all duration-200 border ${St?"bg-primary/10 border-primary/50 text-primary":"bg-muted border-border text-muted-foreground hover:text-foreground hover:bg-muted/80"}`,"aria-label":St?"Hide settings":"Show settings","aria-expanded":St,title:St?"Hide settings":"Show settings",children:a.jsx(Cc,{className:"w-4 h-4"})}),a.jsx("button",{type:"button",onClick:()=>{var ne;return(ne=document.getElementById("file-attachment-input"))==null?void 0:ne.click()},disabled:m&&!I||pt||!d||ee.length>=Br.MAX_FILES,className:"w-9 h-9 flex items-center justify-center bg-muted hover:bg-muted/80 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-all duration-200 border border-border",title:`Attach files (${ee.length}/${Br.MAX_FILES})`,"aria-label":"Attach files",children:a.jsx(i2,{className:"w-4 h-4 text-muted-foreground"})}),a.jsx("div",{className:"w-9 h-9 flex items-center justify-center",children:a.jsx(px,{onTranscription:ne=>{L(ze=>ze?`${ze} ${ne}`:ne)},onError:ne=>{console.error("[ConsolePage] Voice input error:",ne)},disabled:m&&!I||pt||!d})})]}),a.jsx("textarea",{value:T,onChange:ne=>L(ne.target.value),onKeyDown:ow,placeholder:H==="new"?"Describe your app idea...":"What changes would you like?",disabled:m&&!I||pt||!d||H==="resume"&&J===null&&Ee.length>0,rows:4,className:"flex-1 px-3 py-2 bg-input border-2 border-border rounded-xl text-foreground text-sm leading-relaxed placeholder:text-muted-foreground/70 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary/50 resize-none disabled:opacity-50 min-h-[88px]"}),a.jsx("button",{type:"submit",disabled:!T.trim()||m&&!I||pt||Se||!d||H==="resume"&&J===null&&Ee.length>0,className:"leo-btn-primary h-[88px] px-4 text-sm rounded-xl flex flex-col items-center justify-center gap-0.5 focus-ring whitespace-nowrap flex-shrink-0","aria-label":"Generate app",children:Se||pt||m&&!I?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),a.jsx("span",{className:"text-xs",children:"Working"})]}):a.jsxs(a.Fragment,{children:[a.jsx(yh,{className:"w-5 h-5"}),a.jsx("span",{className:"text-xs",children:"Generate"})]})})]})]})})]}),a.jsx("div",{className:`flex-1 overflow-hidden bg-[#0a0a0f] ${Qr!=="conversations"?"hidden":""}`,children:a.jsx(uT,{conversationLogs:w})})]}),De&&a.jsx(AT,{position:ur,onPositionChange:mn,minPosition:25,maxPosition:75}),De&&a.jsxs("div",{className:"flex flex-col bg-card animate-fade-in-up border-l border-border",style:{width:`${100-ur}%`},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border bg-muted/30",children:[a.jsx("h2",{className:"text-sm font-semibold text-foreground",children:U&&U!=="about:blank"?"Browser Preview":"Live Screenshots"}),a.jsxs("div",{className:"flex items-center gap-3",children:[_.length>0&&a.jsxs("span",{className:"text-xs text-muted-foreground",children:[_.length," screenshot",_.length!==1?"s":""]}),U&&U!=="about:blank"&&a.jsx("a",{href:U,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline font-medium",children:"Open in new tab"})]})]}),a.jsx("div",{className:"flex-1 overflow-hidden",children:U&&U!=="about:blank"?a.jsx("iframe",{src:U,className:"w-full h-full border-0",title:"Browser Preview",sandbox:"allow-scripts allow-same-origin allow-forms allow-popups"}):a.jsx(LT,{screenshots:_})})]})]}),a.jsx(mx,{isOpen:fn,onClose:()=>si(!1),sourcePage:"console"}),a.jsx(PT,{credentialRequest:E,onSubmit:N,timeoutWarning:O})]})}function Tl({title:t,value:e,subtitle:r,icon:s,trend:n,color:i="default"}){const c={default:"from-purple-500/20 to-cyan-500/20 border-purple-500/30",success:"from-green-500/20 to-emerald-500/20 border-green-500/30",warning:"from-yellow-500/20 to-amber-500/20 border-yellow-500/30",danger:"from-red-500/20 to-rose-500/20 border-red-500/30"},o={default:"text-purple-400",success:"text-green-400",warning:"text-yellow-400",danger:"text-red-400"};return a.jsxs("div",{className:`bg-gradient-to-br ${c[i]} rounded-xl border p-4`,children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-leo-text-secondary",children:t}),a.jsx("p",{className:"text-2xl font-bold text-leo-text mt-1",children:e}),r&&a.jsx("p",{className:"text-xs text-leo-text-tertiary mt-1",children:r})]}),a.jsx("div",{className:`p-2 rounded-lg bg-black/20 ${o[i]}`,children:a.jsx(s,{className:"w-5 h-5"})})]}),n&&a.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-green-400",children:[a.jsx(d2,{className:"w-3 h-3"}),a.jsx("span",{children:n})]})]})}function av({status:t}){const r={completed:{color:"bg-green-500/20 text-green-400",label:"Completed"},generating:{color:"bg-blue-500/20 text-blue-400",label:"Generating"},queued:{color:"bg-yellow-500/20 text-yellow-400",label:"Queued"},failed:{color:"bg-red-500/20 text-red-400",label:"Failed"},cancelled:{color:"bg-gray-500/20 text-gray-400",label:"Cancelled"},paused:{color:"bg-purple-500/20 text-purple-400",label:"Paused"}}[t]||{color:"bg-gray-500/20 text-gray-400",label:t};return a.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${r.color}`,children:r.label})}function IT({data:t,maxBars:e=14}){const r=t.slice(-e),s=Math.max(...r.map(n=>n.count),1);return a.jsx("div",{className:"flex items-end gap-1 h-32",children:r.map((n,i)=>{const c=n.count/s*100,l=new Date(n.date).toLocaleDateString("en-US",{weekday:"short"});return a.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[a.jsxs("div",{className:"w-full flex flex-col items-center",children:[a.jsx("span",{className:"text-[10px] text-leo-text-tertiary mb-1",children:n.count>0?n.count:""}),a.jsx("div",{className:"w-full bg-gradient-to-t from-purple-500/60 to-cyan-500/60 rounded-t",style:{height:`${Math.max(c,2)}%`}})]}),i%2===0&&a.jsx("span",{className:"text-[9px] text-leo-text-tertiary",children:l})]},n.date)})})}function DT(){var y;const{profile:t,isLoading:e}=ft(),[,r]=Lr(),{data:s,isLoading:n,error:i,refetch:c,isFetching:o}=Qc({queryKey:["admin-analytics"],queryFn:async()=>{const w=rn(),_=await fetch("/api/admin/analytics",{credentials:"include",headers:w?{Authorization:`Bearer ${w}`}:{}});if(!_.ok){const h=await _.json().catch(()=>({}));throw new Error(h.message||"Failed to fetch analytics")}return(await _.json()).data},retry:1,staleTime:3e4,enabled:!e&&((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="dev")});if(!e&&t&&t.role!=="admin"&&t.role!=="dev")return r("/apps"),null;if(n||e)return a.jsx(lt,{children:a.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[a.jsx("div",{className:"flex items-center justify-between mb-6",children:a.jsxs("div",{children:[a.jsx(tr,{className:"h-8 w-48 mb-2"}),a.jsx(tr,{className:"h-4 w-64"})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[1,2,3,4].map(w=>a.jsx(tr,{className:"h-28 rounded-xl"},w))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsx(tr,{className:"h-64 rounded-xl"}),a.jsx(tr,{className:"h-64 rounded-xl"})]})]})});if(i)return a.jsx(lt,{children:a.jsx("div",{className:"p-6 max-w-7xl mx-auto",children:a.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-xl p-6 text-center",children:[a.jsx(Kn,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-leo-text mb-2",children:"Access Denied"}),a.jsx("p",{className:"text-leo-text-secondary mb-4",children:i instanceof Error?i.message:"Failed to load analytics"}),a.jsx("button",{onClick:()=>c(),className:"px-4 py-2 bg-leo-bg-tertiary hover:bg-leo-bg-hover rounded-lg text-sm",children:"Try Again"})]})})});const l=s==null?void 0:s.overview,d=(s==null?void 0:s.generationsByDay)||[],g=(s==null?void 0:s.generationsByStatus)||[],m=(s==null?void 0:s.topUsers)||[],v=(s==null?void 0:s.recentGenerations)||[];return a.jsx(lt,{children:a.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(_h,{className:"w-8 h-8 text-purple-400"}),a.jsx("h1",{className:"text-2xl font-bold text-leo-text",children:"Analytics Dashboard"}),a.jsx(qs,{variant:"outline",className:"bg-purple-500/20 text-purple-400 border-purple-500/30",children:"Admin"})]}),a.jsx("p",{className:"text-leo-text-secondary mt-1",children:"Usage metrics and generation statistics"})]}),a.jsxs("button",{onClick:()=>c(),disabled:o,className:"flex items-center gap-2 px-4 py-2 bg-leo-bg-tertiary hover:bg-leo-bg-hover rounded-lg text-sm transition-colors",children:[a.jsx(Xc,{className:`w-4 h-4 ${o?"animate-spin":""}`}),"Refresh"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[a.jsx(Tl,{title:"Total Users",value:(l==null?void 0:l.totalUsers)||0,subtitle:`${(l==null?void 0:l.approvedUsers)||0} approved, ${(l==null?void 0:l.pendingUsers)||0} pending`,icon:Rg}),a.jsx(Tl,{title:"Total Generations",value:(l==null?void 0:l.totalGenerations)||0,subtitle:`${((y=l==null?void 0:l.successRate)==null?void 0:y.toFixed(1))||0}% success rate`,icon:uo,color:"success"}),a.jsx(Tl,{title:"Credits Used",value:(l==null?void 0:l.totalCreditsUsed)||0,subtitle:`Across ${(l==null?void 0:l.activeUsers)||0} active users`,icon:w0,color:"warning"}),a.jsx(Tl,{title:"Avg Duration",value:`${Math.round(((l==null?void 0:l.avgGenerationDuration)||0)/60)}m`,subtitle:`${(l==null?void 0:l.deployedApps)||0} apps deployed`,icon:Qn})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{className:"bg-leo-bg-secondary border border-leo-border rounded-xl p-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-leo-text mb-4 flex items-center gap-2",children:[a.jsx(bg,{className:"w-5 h-5 text-purple-400"}),"Generations (Last 14 Days)"]}),d.length>0?a.jsx(IT,{data:d,maxBars:14}):a.jsx("div",{className:"h-32 flex items-center justify-center text-leo-text-tertiary",children:"No data available"})]}),a.jsxs("div",{className:"bg-leo-bg-secondary border border-leo-border rounded-xl p-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-leo-text mb-4 flex items-center gap-2",children:[a.jsx(_h,{className:"w-5 h-5 text-cyan-400"}),"Status Distribution"]}),a.jsx("div",{className:"space-y-3",children:g.map(w=>{const _=g.reduce((h,u)=>h+u.count,0),p=_>0?w.count/_*100:0;return a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(av,{status:w.status}),a.jsx("div",{className:"flex-1 h-2 bg-leo-bg-tertiary rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full rounded-full ${w.status==="completed"?"bg-green-500":w.status==="failed"?"bg-red-500":w.status==="generating"?"bg-blue-500":"bg-gray-500"}`,style:{width:`${p}%`}})}),a.jsx("span",{className:"text-sm text-leo-text-secondary w-12 text-right",children:w.count})]},w.status)})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-leo-bg-secondary border border-leo-border rounded-xl p-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-leo-text mb-4 flex items-center gap-2",children:[a.jsx(Rg,{className:"w-5 h-5 text-yellow-400"}),"Top Users"]}),a.jsx("div",{className:"space-y-2",children:m.length>0?m.slice(0,5).map((w,_)=>a.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-leo-bg-tertiary transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-500/20 flex items-center justify-center text-xs font-medium text-purple-400",children:_+1}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-leo-text font-medium truncate max-w-[180px]",children:w.email}),a.jsx("p",{className:"text-xs text-leo-text-tertiary",children:w.name||"No name"})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm font-medium text-leo-text",children:w.generationCount}),a.jsxs("p",{className:"text-xs text-leo-text-tertiary",children:[w.successCount," success"]})]})]},w.userId)):a.jsx("p",{className:"text-center text-leo-text-tertiary py-4",children:"No users yet"})})]}),a.jsxs("div",{className:"bg-leo-bg-secondary border border-leo-border rounded-xl p-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-leo-text mb-4 flex items-center gap-2",children:[a.jsx(Qn,{className:"w-5 h-5 text-green-400"}),"Recent Generations"]}),a.jsx("div",{className:"space-y-2 max-h-[280px] overflow-y-auto",children:v.length>0?v.slice(0,10).map(w=>a.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-leo-bg-tertiary transition-colors",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("p",{className:"text-sm text-leo-text font-medium truncate",children:w.appName}),a.jsx(av,{status:w.status})]}),a.jsx("p",{className:"text-xs text-leo-text-tertiary truncate",children:w.userEmail})]}),a.jsx("div",{className:"text-right text-xs text-leo-text-tertiary ml-2",children:new Date(w.createdAt).toLocaleDateString()})]},w.id)):a.jsx("p",{className:"text-center text-leo-text-tertiary py-4",children:"No generations yet"})})]})]}),a.jsxs("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-leo-bg-secondary border border-leo-border rounded-lg p-3 text-center",children:[a.jsx(Jn,{className:"w-5 h-5 text-green-400 mx-auto mb-1"}),a.jsx("p",{className:"text-lg font-bold text-leo-text",children:(l==null?void 0:l.completedGenerations)||0}),a.jsx("p",{className:"text-xs text-leo-text-tertiary",children:"Completed"})]}),a.jsxs("div",{className:"bg-leo-bg-secondary border border-leo-border rounded-lg p-3 text-center",children:[a.jsx(ti,{className:"w-5 h-5 text-red-400 mx-auto mb-1"}),a.jsx("p",{className:"text-lg font-bold text-leo-text",children:(l==null?void 0:l.failedGenerations)||0}),a.jsx("p",{className:"text-xs text-leo-text-tertiary",children:"Failed"})]}),a.jsxs("div",{className:"bg-leo-bg-secondary border border-leo-border rounded-lg p-3 text-center",children:[a.jsx(bg,{className:"w-5 h-5 text-purple-400 mx-auto mb-1"}),a.jsx("p",{className:"text-lg font-bold text-leo-text",children:(l==null?void 0:l.totalApps)||0}),a.jsx("p",{className:"text-xs text-leo-text-tertiary",children:"Total Apps"})]}),a.jsxs("div",{className:"bg-leo-bg-secondary border border-leo-border rounded-lg p-3 text-center",children:[a.jsx(Xf,{className:"w-5 h-5 text-cyan-400 mx-auto mb-1"}),a.jsxs("p",{className:"text-lg font-bold text-leo-text",children:["$",((l==null?void 0:l.avgGenerationCost)||0).toFixed(4)]}),a.jsx("p",{className:"text-xs text-leo-text-tertiary",children:"Avg Cost"})]})]})]})})}const MT=[{tier:"free",name:"Free",description:"Get started with basic app generation",monthlyPrice:0,annualPrice:0,monthlyCredits:3,features:["Up to 3 generations per month","Basic app templates","Community support","GitHub integration"],priceIdMonthly:null,priceIdAnnual:null},{tier:"pro",name:"Pro",description:"For professional developers and teams",monthlyPrice:29,annualPrice:290,monthlyCredits:50,features:["Up to 50 generations per month","Priority generation queue","Advanced app templates","Deploy to Fly.io","Email support","Prompt history & search"],priceIdMonthly:null,priceIdAnnual:null,isPopular:!0},{tier:"enterprise",name:"Enterprise",description:"Custom solutions for large organizations",monthlyPrice:-1,annualPrice:-1,monthlyCredits:-1,features:["Unlimited generations","Dedicated support","Custom integrations","SLA guarantee","SSO/SAML","On-premise deployment option"],priceIdMonthly:null,priceIdAnnual:null}];function BT(){const{isAuthenticated:t,profile:e,session:r}=ft(),[s,n]=R.useState("monthly"),[i,c]=R.useState(null),[o,l]=R.useState(MT);R.useEffect(()=>{fetch("/api/subscriptions/products").then(p=>p.json()).then(p=>{p.success&&p.data&&l(p.data)}).catch(console.error)},[]);const d=(e==null?void 0:e.currentTier)||"free",g=async p=>{var u;if(p.tier==="free")return;if(p.tier==="enterprise"){window.location.href="mailto:sales@leo.dev?subject=Enterprise%20Inquiry";return}if(!t){window.location.href="/login?redirect=/pricing";return}const h=s==="monthly"?p.priceIdMonthly:p.priceIdAnnual;if(!h){console.error("No price ID configured for",p.tier,s);return}c(p.tier);try{const x=await(await fetch("/api/subscriptions/checkout",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r==null?void 0:r.access_token}`},body:JSON.stringify({priceId:h,billingPeriod:s})})).json();x.success&&((u=x.data)!=null&&u.url)?window.location.href=x.data.url:console.error("Failed to create checkout session:",x)}catch(f){console.error("Checkout error:",f)}finally{c(null)}},m=p=>p.tier===d?"Current Plan":p.tier==="enterprise"?"Contact Sales":p.tier==="free"?t?"Downgrade":"Get Started":t?"Upgrade":"Get Started",v=p=>p.tier===d,y=p=>p.monthlyPrice===-1?"Custom":`$${s==="monthly"?p.monthlyPrice:p.annualPrice}`,w=p=>p.monthlyPrice===-1?"pricing":s==="monthly"?"/month":"/year",_=p=>{if(p.monthlyPrice<=0)return null;const h=p.monthlyPrice*12,u=p.annualPrice,f=h-u,x=Math.round(f/h*100);return x>0?x:null};return a.jsxs(lt,{children:[a.jsxs("section",{className:"relative py-20 px-4 overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-[120px]"}),a.jsx("div",{className:"absolute bottom-0 right-1/4 w-80 h-80 bg-cyan-500/10 rounded-full blur-[100px]"}),a.jsxs("div",{className:"relative z-10 max-w-5xl mx-auto text-center",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/5 border border-white/10 mb-8",children:[a.jsx(uo,{className:"h-4 w-4 text-yellow-400"}),a.jsx("span",{className:"text-sm font-medium text-leo-text-secondary",children:"Simple, transparent pricing"})]}),a.jsx("h1",{className:"text-4xl sm:text-5xl md:text-6xl font-bold tracking-tight mb-6",children:a.jsx("span",{className:"leo-gradient-text",children:"Choose Your Plan"})}),a.jsx("p",{className:"text-xl text-leo-text-secondary max-w-2xl mx-auto mb-12",children:"Start free, upgrade when you need more power. All plans include core features."}),a.jsxs("div",{className:"inline-flex items-center gap-4 p-1.5 rounded-2xl bg-white/5 border border-white/10",children:[a.jsx("button",{onClick:()=>n("monthly"),className:Xe("px-6 py-2.5 rounded-xl text-sm font-medium transition-all",s==="monthly"?"bg-white/10 text-leo-text shadow-sm":"text-leo-text-secondary hover:text-leo-text"),children:"Monthly"}),a.jsxs("button",{onClick:()=>n("annual"),className:Xe("px-6 py-2.5 rounded-xl text-sm font-medium transition-all flex items-center gap-2",s==="annual"?"bg-white/10 text-leo-text shadow-sm":"text-leo-text-secondary hover:text-leo-text"),children:["Annual",a.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-400 text-xs font-semibold",children:"Save 17%"})]})]})]})]}),a.jsx("section",{className:"pb-24 px-4",children:a.jsx("div",{className:"max-w-6xl mx-auto",children:a.jsx("div",{className:"grid md:grid-cols-3 gap-6 lg:gap-8",children:o.map(p=>a.jsxs("div",{className:Xe("relative rounded-3xl border transition-all duration-300",p.isPopular?"bg-gradient-to-b from-purple-500/10 to-transparent border-purple-500/30 shadow-glow-sm scale-[1.02]":"bg-white/[0.02] border-white/10 hover:border-white/20"),children:[p.isPopular&&a.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2",children:a.jsx("div",{className:"px-4 py-1.5 rounded-full bg-gradient-to-r from-purple-500 to-purple-600 text-white text-sm font-semibold shadow-glow-sm",children:"Most Popular"})}),a.jsxs("div",{className:"p-8",children:[a.jsxs("div",{className:Xe("w-12 h-12 rounded-2xl flex items-center justify-center mb-6",p.tier==="free"&&"bg-cyan-500/20",p.tier==="pro"&&"bg-purple-500/20",p.tier==="enterprise"&&"bg-amber-500/20"),children:[p.tier==="free"&&a.jsx(Co,{className:"h-6 w-6 text-cyan-400"}),p.tier==="pro"&&a.jsx(uo,{className:"h-6 w-6 text-purple-400"}),p.tier==="enterprise"&&a.jsx(UE,{className:"h-6 w-6 text-amber-400"})]}),a.jsx("h3",{className:"text-2xl font-bold text-leo-text mb-2",children:p.name}),a.jsx("p",{className:"text-leo-text-secondary mb-6",children:p.description}),a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex items-baseline gap-1",children:[a.jsx("span",{className:"text-4xl font-bold text-leo-text",children:y(p)}),a.jsx("span",{className:"text-leo-text-secondary",children:w(p)})]}),s==="annual"&&_(p)&&a.jsxs("p",{className:"text-sm text-emerald-400 mt-1",children:["Save ",_(p),"% with annual billing"]}),p.monthlyCredits>0&&a.jsxs("p",{className:"text-sm text-leo-text-tertiary mt-2",children:[p.monthlyCredits," generations/month"]}),p.monthlyCredits===-1&&a.jsx("p",{className:"text-sm text-leo-text-tertiary mt-2",children:"Unlimited generations"})]}),a.jsx(le,{onClick:()=>g(p),disabled:v(p)||i===p.tier,className:Xe("w-full py-6 rounded-xl text-base font-semibold transition-all",p.isPopular?"leo-btn-primary":p.tier===d?"bg-white/5 text-leo-text-tertiary cursor-not-allowed":"leo-btn-secondary"),children:i===p.tier?a.jsx(at,{className:"h-5 w-5 animate-spin"}):a.jsxs(a.Fragment,{children:[m(p),p.tier!==d&&p.tier!=="free"&&a.jsx(Pr,{className:"ml-2 h-5 w-5"})]})}),a.jsx("ul",{className:"mt-8 space-y-4",children:p.features.map((h,u)=>a.jsxs("li",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 mt-0.5",children:a.jsx(Ar,{className:Xe("h-5 w-5",p.isPopular?"text-purple-400":"text-leo-emerald")})}),a.jsx("span",{className:"text-leo-text-secondary",children:h})]},u))})]})]},p.tier))})})}),a.jsx("section",{className:"py-16 px-4 border-t border-white/5",children:a.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-leo-text mb-4",children:"Questions?"}),a.jsx("p",{className:"text-leo-text-secondary mb-6",children:"Need help choosing the right plan? We're here to help."}),a.jsxs("div",{className:"flex items-center justify-center gap-4",children:[a.jsx(Re,{href:"/request-access",children:a.jsx(le,{variant:"ghost",className:"leo-btn-secondary",children:"Contact Support"})}),!t&&a.jsx(Re,{href:"/register",children:a.jsxs(le,{className:"leo-btn-primary",children:["Start Free Trial",a.jsx(Pr,{className:"ml-2 h-4 w-4"})]})})]})]})})]})}function $T(){var O,I,P,U;const{session:t,profile:e,refreshProfile:r}=ft(),s=uS(),[n,i]=R.useState(null),[c,o]=R.useState(!0),[l,d]=R.useState(!1),[g,m]=R.useState(!1),[v,y]=R.useState(!1),[w,_]=R.useState(null),[p,h]=R.useState(null);R.useEffect(()=>{new URLSearchParams(s).get("success")==="true"&&(h("Your subscription has been updated successfully!"),r(),window.history.replaceState({},"","/billing"))},[s,r]),R.useEffect(()=>{(async()=>{if(!(t!=null&&t.access_token)){o(!1);return}try{const H=await fetch("/api/subscriptions",{headers:{Authorization:`Bearer ${t.access_token}`}});if(H.ok){const z=await H.json();z.success&&i(z.data)}else _("Failed to load subscription data")}catch{_("Failed to load subscription data")}finally{o(!1)}})()},[t]);const u=async()=>{var D;if(t!=null&&t.access_token){d(!0),_(null);try{const z=await(await fetch("/api/subscriptions/portal",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`}})).json();z.success&&((D=z.data)!=null&&D.url)?window.location.href=z.data.url:_(z.message||"Failed to open billing portal")}catch{_("Failed to open billing portal")}finally{d(!1)}}},f=async()=>{if(t!=null&&t.access_token){m(!0),_(null);try{const H=await(await fetch("/api/subscriptions/cancel",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`}})).json();if(H.success){h("Your subscription will be canceled at the end of the billing period.");const B=await(await fetch("/api/subscriptions",{headers:{Authorization:`Bearer ${t.access_token}`}})).json();B.success&&i(B.data)}else _(H.message||"Failed to cancel subscription")}catch{_("Failed to cancel subscription")}finally{m(!1)}}},x=async()=>{if(t!=null&&t.access_token){y(!0),_(null);try{const H=await(await fetch("/api/subscriptions/resume",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`}})).json();if(H.success){h("Your subscription has been resumed.");const B=await(await fetch("/api/subscriptions",{headers:{Authorization:`Bearer ${t.access_token}`}})).json();B.success&&i(B.data)}else _(H.message||"Failed to resume subscription")}catch{_("Failed to resume subscription")}finally{y(!1)}}},k=D=>D?new Date(D).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A",C=D=>{switch(D){case"active":return"text-emerald-400 bg-emerald-500/10";case"trialing":return"text-cyan-400 bg-cyan-500/10";case"past_due":return"text-amber-400 bg-amber-500/10";case"canceled":return"text-red-400 bg-red-500/10";default:return"text-gray-400 bg-gray-500/10"}},S=(n==null?void 0:n.creditsUsed)||(e==null?void 0:e.creditsUsed)||0,b=(n==null?void 0:n.creditsRemaining)||(e==null?void 0:e.creditsRemaining)||0,E=S+b,N=E>0?S/E*100:0;return a.jsx(lt,{children:a.jsxs("div",{className:"max-w-4xl mx-auto py-12 px-4",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-leo-text mb-2",children:"Billing & Subscription"}),a.jsx("p",{className:"text-leo-text-secondary",children:"Manage your subscription and view your usage"})]}),p&&a.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-emerald-500/10 border border-emerald-500/20 flex items-start gap-3",children:[a.jsx(Ar,{className:"h-5 w-5 text-emerald-400 flex-shrink-0 mt-0.5"}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"text-emerald-400",children:p})}),a.jsx("button",{onClick:()=>h(null),className:"text-emerald-400 hover:text-emerald-300",children:a.jsx(us,{className:"h-4 w-4"})})]}),w&&a.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-red-500/10 border border-red-500/20 flex items-start gap-3",children:[a.jsx(Kn,{className:"h-5 w-5 text-red-400 flex-shrink-0 mt-0.5"}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"text-red-400",children:w})}),a.jsx("button",{onClick:()=>_(null),className:"text-red-400 hover:text-red-300",children:a.jsx(us,{className:"h-4 w-4"})})]}),c?a.jsx("div",{className:"flex items-center justify-center py-20",children:a.jsx(at,{className:"h-8 w-8 animate-spin text-leo-primary"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"rounded-2xl bg-white/[0.02] border border-white/10 p-6",children:[a.jsxs("div",{className:"flex items-start justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-leo-text mb-1",children:"Current Plan"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-2xl font-bold leo-gradient-text",children:((O=n==null?void 0:n.tierConfig)==null?void 0:O.name)||(e==null?void 0:e.currentTier)||"Free"}),((I=n==null?void 0:n.subscription)==null?void 0:I.status)&&a.jsx("span",{className:Xe("px-2.5 py-1 rounded-full text-xs font-medium capitalize",C(n.subscription.status)),children:n.subscription.status}),((P=n==null?void 0:n.subscription)==null?void 0:P.cancelAtPeriodEnd)&&a.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium text-amber-400 bg-amber-500/10",children:"Cancels at period end"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[(n==null?void 0:n.tier)!=="free"&&a.jsx(le,{onClick:u,disabled:l,variant:"ghost",className:"leo-btn-secondary",children:l?a.jsx(at,{className:"h-4 w-4 animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(GE,{className:"h-4 w-4 mr-2"}),"Manage Billing",a.jsx(So,{className:"h-3 w-3 ml-1.5"})]})}),a.jsx(Re,{href:"/pricing",children:a.jsxs(le,{className:"leo-btn-primary",children:[(n==null?void 0:n.tier)==="free"?"Upgrade":"Change Plan",a.jsx(Pr,{className:"h-4 w-4 ml-2"})]})})]})]}),(n==null?void 0:n.subscription)&&a.jsxs("div",{className:"grid sm:grid-cols-2 gap-4 mb-6 p-4 rounded-xl bg-white/[0.02]",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-leo-text-tertiary mb-1",children:"Current Period Ends"}),a.jsx("p",{className:"text-leo-text font-medium",children:k(n.subscription.currentPeriodEnd)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-leo-text-tertiary mb-1",children:"Monthly Credits"}),a.jsxs("p",{className:"text-leo-text font-medium",children:[n.subscription.monthlyCreditsIncluded," generations/month"]})]})]}),((U=n==null?void 0:n.tierConfig)==null?void 0:U.features)&&a.jsxs("div",{className:"border-t border-white/5 pt-4",children:[a.jsx("p",{className:"text-sm text-leo-text-tertiary mb-3",children:"Plan Features"}),a.jsx("ul",{className:"grid sm:grid-cols-2 gap-2",children:n.tierConfig.features.map((D,H)=>a.jsxs("li",{className:"flex items-center gap-2 text-sm text-leo-text-secondary",children:[a.jsx(Ar,{className:"h-4 w-4 text-leo-emerald flex-shrink-0"}),D]},H))})]})]}),a.jsxs("div",{className:"rounded-2xl bg-white/[0.02] border border-white/10 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold text-leo-text",children:"Credit Usage"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(uo,{className:"h-5 w-5 text-yellow-400"}),a.jsx("span",{className:"text-2xl font-bold text-leo-text",children:b}),a.jsx("span",{className:"text-leo-text-secondary",children:"credits remaining"})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[a.jsxs("span",{className:"text-leo-text-secondary",children:[S," used"]}),a.jsxs("span",{className:"text-leo-text-secondary",children:[E," total"]})]}),a.jsx("div",{className:"h-3 rounded-full bg-white/5 overflow-hidden",children:a.jsx("div",{className:Xe("h-full rounded-full transition-all duration-500",N>=90?"bg-red-500":N>=75?"bg-amber-500":"bg-gradient-to-r from-purple-500 to-cyan-500"),style:{width:`${Math.min(N,100)}%`}})}),N>=90&&a.jsxs("p",{className:"text-sm text-red-400 mt-2 flex items-center gap-1",children:[a.jsx(Kn,{className:"h-4 w-4"}),"You're running low on credits."," ",a.jsx(Re,{href:"/pricing",className:"underline hover:no-underline",children:"Upgrade for more"})]})]}),(n==null?void 0:n.subscription)&&a.jsxs("p",{className:"text-sm text-leo-text-tertiary",children:["Credits reset on ",k(n.subscription.currentPeriodEnd)]})]}),(n==null?void 0:n.tier)!=="free"&&(n==null?void 0:n.subscription)&&a.jsxs("div",{className:"rounded-2xl bg-white/[0.02] border border-white/10 p-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-leo-text mb-4",children:"Subscription Actions"}),a.jsx("div",{className:"flex flex-wrap gap-3",children:n.subscription.cancelAtPeriodEnd?a.jsxs(le,{onClick:x,disabled:v,className:"leo-btn-primary",children:[v?a.jsx(at,{className:"h-4 w-4 animate-spin mr-2"}):a.jsx(Xc,{className:"h-4 w-4 mr-2"}),"Resume Subscription"]}):a.jsxs(le,{onClick:f,disabled:g,variant:"ghost",className:"text-red-400 hover:text-red-300 hover:bg-red-500/10",children:[g?a.jsx(at,{className:"h-4 w-4 animate-spin mr-2"}):a.jsx(us,{className:"h-4 w-4 mr-2"}),"Cancel Subscription"]})}),n.subscription.cancelAtPeriodEnd&&a.jsxs("p",{className:"text-sm text-amber-400 mt-3",children:["Your subscription is scheduled to cancel on"," ",k(n.subscription.currentPeriodEnd),". You'll retain access until then."]})]}),(n==null?void 0:n.tier)==="free"&&a.jsx("div",{className:"rounded-2xl bg-gradient-to-br from-purple-500/10 to-cyan-500/10 border border-purple-500/20 p-6",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-500/20 flex items-center justify-center flex-shrink-0",children:a.jsx(uo,{className:"h-6 w-6 text-purple-400"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-leo-text mb-2",children:"Upgrade to Pro for More Power"}),a.jsx("p",{className:"text-leo-text-secondary mb-4",children:"Get 50 generations per month, priority queue, and deploy to Fly.io with a single click."}),a.jsx(Re,{href:"/pricing",children:a.jsxs(le,{className:"leo-btn-primary",children:["View Plans",a.jsx(Pr,{className:"h-4 w-4 ml-2"})]})})]})]})})]})]})})}function FT(){const{session:t,profile:e,refreshProfile:r}=ft(),[s,n]=R.useState(null),[i,c]=R.useState(!0),[o,l]=R.useState(!1),[d,g]=R.useState(!1),[m,v]=R.useState(""),[y,w]=R.useState(!1),[_,p]=R.useState(null),[h,u]=R.useState(null);R.useEffect(()=>{(async()=>{if(!(t!=null&&t.access_token)){c(!1);return}try{const S=await fetch("/api/settings/claude-token",{headers:{Authorization:`Bearer ${t.access_token}`}});if(S.ok){const b=await S.json();b.success&&n(b.data)}}catch(S){console.error("Failed to fetch token status:",S)}finally{c(!1)}})()},[t]);const f=async()=>{if(!(!(t!=null&&t.access_token)||!m.trim())){l(!0),p(null),u(null);try{const S=await(await fetch("/api/settings/claude-token",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`},body:JSON.stringify({token:m.trim()})})).json();S.success?(n({...s,configured:!0,masked:S.data.masked}),v(""),u("Token saved successfully!"),r()):p(S.error||"Failed to save token")}catch{p("Failed to save token - network error")}finally{l(!1)}}},x=async()=>{if(t!=null&&t.access_token){g(!0),p(null),u(null);try{const S=await(await fetch("/api/settings/claude-token",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`},body:JSON.stringify({token:null})})).json();S.success?(n({...s,configured:!1,masked:null}),u("Token removed"),r()):p(S.error||"Failed to remove token")}catch{p("Failed to remove token - network error")}finally{g(!1)}}},k=(s==null?void 0:s.canConfigure)||(e==null?void 0:e.role)==="dev"||(e==null?void 0:e.role)==="admin";return a.jsx(lt,{children:a.jsxs("div",{className:"max-w-3xl mx-auto py-12 px-4",children:[a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(Cc,{className:"h-8 w-8 text-leo-primary"}),a.jsx("h1",{className:"text-3xl font-bold text-leo-text",children:"Settings"})]}),a.jsx("p",{className:"text-leo-text-secondary",children:"Manage your account settings and preferences"})]}),i?a.jsx("div",{className:"flex items-center justify-center py-20",children:a.jsx(at,{className:"h-8 w-8 animate-spin text-leo-primary"})}):a.jsxs("div",{className:"space-y-6",children:[k&&a.jsxs("div",{className:"rounded-2xl bg-white/[0.02] border border-white/10 p-6",children:[a.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-500/20 flex items-center justify-center flex-shrink-0",children:a.jsx(YE,{className:"h-6 w-6 text-purple-400"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h2",{className:"text-xl font-semibold text-leo-text mb-1",children:"Claude Token"}),a.jsxs("p",{className:"text-leo-text-secondary text-sm",children:["Required for developers to run app generations. Use your OAuth token from Claude Pro/Max (run ",a.jsx("code",{className:"px-1.5 py-0.5 rounded bg-white/10 text-xs font-mono",children:"claude config get oauthToken"}),") or an API key from"," ",a.jsxs("a",{href:"https://console.anthropic.com/settings/keys",target:"_blank",rel:"noopener noreferrer",className:"text-leo-primary hover:underline inline-flex items-center gap-1",children:["console.anthropic.com",a.jsx(So,{className:"h-3 w-3"})]})]})]})]}),a.jsx("div",{className:"mb-6",children:s!=null&&s.configured?a.jsxs("div",{className:"flex items-center gap-2 text-emerald-400",children:[a.jsx(Ar,{className:"h-5 w-5"}),a.jsx("span",{className:"font-medium",children:"Token configured"}),a.jsxs("span",{className:"text-leo-text-tertiary ml-2",children:["(",s.masked,")"]})]}):a.jsxs("div",{className:"flex items-center gap-2 text-amber-400",children:[a.jsx(lo,{className:"h-5 w-5"}),a.jsx("span",{className:"font-medium",children:"Token required to run generations"})]})}),h&&a.jsx("div",{className:"mb-4 p-3 rounded-lg bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 text-sm",children:h}),_&&a.jsx("div",{className:"mb-4 p-3 rounded-lg bg-red-500/10 border border-red-500/20 text-red-400 text-sm",children:_}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:y?"text":"password",value:m,onChange:C=>v(C.target.value),placeholder:"sk-ant-...",className:Xe("w-full px-4 py-3 pr-12 rounded-xl","bg-white/5 border border-white/10","text-leo-text placeholder:text-leo-text-tertiary","focus:outline-none focus:ring-2 focus:ring-leo-primary/50 focus:border-leo-primary/50","font-mono text-sm")}),a.jsx("button",{type:"button",onClick:()=>w(!y),className:"absolute right-3 top-1/2 -translate-y-1/2 text-leo-text-tertiary hover:text-leo-text-secondary",children:y?a.jsx(VE,{className:"h-5 w-5"}):a.jsx(KE,{className:"h-5 w-5"})})]}),m&&m.startsWith("sk-ant-")&&a.jsx("div",{className:Xe("p-3 rounded-lg text-sm flex items-start gap-2",m.startsWith("sk-ant-api03-")?"bg-amber-500/10 border border-amber-500/20 text-amber-400":m.startsWith("sk-ant-oat01-")?"bg-emerald-500/10 border border-emerald-500/20 text-emerald-400":"bg-white/5 border border-white/10 text-leo-text-tertiary"),children:m.startsWith("sk-ant-api03-")?a.jsxs(a.Fragment,{children:[a.jsx(lo,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("strong",{children:"API Key detected"}),"  You will be charged per token used. Consider using an OAuth token from Claude Pro/Max for flat-rate billing."]})]}):m.startsWith("sk-ant-oat01-")?a.jsxs(a.Fragment,{children:[a.jsx(Ar,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("strong",{children:"OAuth token detected"}),"  Uses your Claude Pro/Max subscription (flat-rate)."]})]}):null}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(le,{onClick:f,disabled:o||!m.trim(),className:"leo-btn-primary",children:o?a.jsxs(a.Fragment,{children:[a.jsx(at,{className:"h-4 w-4 animate-spin mr-2"}),"Validating..."]}):"Save Token"}),(s==null?void 0:s.configured)&&a.jsxs(le,{onClick:x,disabled:d,variant:"ghost",className:"text-red-400 hover:text-red-300 hover:bg-red-500/10",children:[d?a.jsx(at,{className:"h-4 w-4 animate-spin mr-2"}):a.jsx(k0,{className:"h-4 w-4 mr-2"}),"Remove Token"]})]})]}),a.jsx("div",{className:"mt-6 p-4 rounded-xl bg-white/[0.02] border border-white/5",children:a.jsxs("p",{className:"text-sm text-leo-text-tertiary",children:[a.jsx("strong",{className:"text-leo-text-secondary",children:"How it works:"})," ","As a developer, you must provide your own Claude token (OAuth token or API key) to run app generations. Your token is stored securely and used only for your generation requests. OAuth tokens from Claude Pro/Max are recommended for flat-rate billing."]})})]}),!k&&a.jsxs("div",{className:"rounded-2xl bg-white/[0.02] border border-white/10 p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-cyan-500/20 flex items-center justify-center",children:a.jsx(Ar,{className:"h-5 w-5 text-cyan-400"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-semibold text-leo-text",children:"Account Settings"}),a.jsx("p",{className:"text-sm text-leo-text-secondary",children:"Your account is ready to use"})]})]}),a.jsx("p",{className:"text-leo-text-secondary",children:"No additional configuration is required. Your generations use the shared Leo platform resources."})]})]})]})})}function UT(){const[t,e]=R.useState(""),[r,s]=R.useState(""),[n,i]=R.useState(""),[c,o]=R.useState(!1),[l,d]=R.useState(!1),[g,m]=R.useState(null),{updatePassword:v,isAuthenticated:y}=ft(),[,w]=Lr();R.useEffect(()=>{(()=>{y?m(!0):setTimeout(()=>{y||m(!1)},2e3)})()},[y]);const _=async p=>{if(p.preventDefault(),i(""),t!==r){i("Passwords do not match");return}if(t.length<6){i("Password must be at least 6 characters");return}o(!0);try{await v(t),d(!0),setTimeout(()=>{w("/login")},2e3)}catch(h){i(h instanceof Error?h.message:"Failed to update password. Please try again.")}finally{o(!1)}};return g===null?a.jsx(lt,{children:a.jsx("div",{className:"min-h-[calc(100vh-8rem)] flex items-center justify-center px-4 py-16",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-purple-500/30 border-t-purple-500 rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-leo-text-secondary",children:"Verifying reset link..."})]})})}):g===!1?a.jsx(lt,{children:a.jsx("div",{className:"min-h-[calc(100vh-8rem)] flex items-center justify-center px-4 py-16",children:a.jsxs("div",{className:"text-center max-w-md",children:[a.jsx(ti,{className:"h-16 w-16 text-red-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-2xl font-bold text-leo-text mb-2",children:"Invalid or Expired Link"}),a.jsx("p",{className:"text-leo-text-secondary mb-6",children:"This password reset link is invalid or has expired. Please request a new one."}),a.jsx(le,{onClick:()=>w("/login"),className:"leo-btn-primary rounded-xl",children:"Back to Login"})]})})}):l?a.jsx(lt,{children:a.jsx("div",{className:"min-h-[calc(100vh-8rem)] flex items-center justify-center px-4 py-16",children:a.jsxs("div",{className:"text-center max-w-md",children:[a.jsx(Jn,{className:"h-16 w-16 text-emerald-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-2xl font-bold text-leo-text mb-2",children:"Password Updated!"}),a.jsx("p",{className:"text-leo-text-secondary",children:"Your password has been successfully updated. Redirecting to login..."})]})})}):a.jsx(lt,{children:a.jsxs("div",{className:"min-h-[calc(100vh-8rem)] flex items-center justify-center px-4 py-16 relative",children:[a.jsx("div",{className:"absolute top-1/4 -left-32 w-80 h-80 bg-purple-500/20 rounded-full blur-[120px]"}),a.jsx("div",{className:"absolute bottom-1/4 -right-32 w-64 h-64 bg-cyan-500/15 rounded-full blur-[100px]"}),a.jsxs("div",{className:"w-full max-w-md relative z-10 animate-fade-in-up",children:[a.jsx("div",{className:"flex justify-center mb-8",children:a.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-purple-500 to-cyan-500 flex items-center justify-center shadow-glow-md",children:a.jsx(Co,{className:"h-8 w-8 text-white"})})}),a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-leo-text mb-2",children:"Reset Password"}),a.jsx("p",{className:"text-leo-text-secondary",children:"Enter your new password below"})]}),a.jsx("div",{className:"leo-card p-8",children:a.jsxs("form",{onSubmit:_,className:"space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(nr,{htmlFor:"password",className:"text-sm font-medium text-leo-text",children:"New Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(Na,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-leo-text-tertiary"}),a.jsx(Vt,{id:"password",name:"password",type:"password",placeholder:"Enter new password",value:t,onChange:p=>e(p.target.value),required:!0,disabled:c,className:"pl-11 h-12 bg-white/5 border-white/10 text-leo-text placeholder:text-leo-text-tertiary focus:border-purple-500/50 focus:ring-purple-500/20 rounded-xl"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(nr,{htmlFor:"confirmPassword",className:"text-sm font-medium text-leo-text",children:"Confirm Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(Na,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-leo-text-tertiary"}),a.jsx(Vt,{id:"confirmPassword",name:"confirmPassword",type:"password",placeholder:"Confirm new password",value:r,onChange:p=>s(p.target.value),required:!0,disabled:c,className:"pl-11 h-12 bg-white/5 border-white/10 text-leo-text placeholder:text-leo-text-tertiary focus:border-purple-500/50 focus:ring-purple-500/20 rounded-xl"})]})]}),n&&a.jsx("div",{className:"p-4 rounded-xl bg-red-500/10 border border-red-500/30 animate-fade-in-up",children:a.jsx("p",{className:"text-sm text-red-400",children:n})}),a.jsx(le,{type:"submit",disabled:c,className:"w-full leo-btn-primary h-12 text-base rounded-xl",children:c?"Updating...":"Update Password"})]})})]})]})})}const HT=new BS({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});function zT(){return a.jsx($S,{client:HT,children:a.jsx(OE,{children:a.jsxs(pS,{children:[a.jsx(gt,{path:"/",component:h2}),a.jsx(gt,{path:"/login",component:g2}),a.jsx(gt,{path:"/register",component:v2}),a.jsx(gt,{path:"/request-access",component:y2}),a.jsx(gt,{path:"/pricing",component:BT}),a.jsx(gt,{path:"/auth/callback",component:b2}),a.jsx(gt,{path:"/reset-password",component:UT}),a.jsx(gt,{path:"/pending-approval",component:x2}),a.jsx(gt,{path:"/account-inactive",component:w2}),a.jsx(gt,{path:"/apps",children:a.jsx(yn,{children:a.jsx(FR,{})})}),a.jsx(gt,{path:"/apps/:id",children:a.jsx(yn,{children:a.jsx(WR,{})})}),a.jsx(gt,{path:"/console/:id?",children:a.jsx(yn,{children:a.jsx(ov,{})})}),a.jsx(gt,{path:"/console",children:a.jsx(yn,{children:a.jsx(ov,{})})}),a.jsx(gt,{path:"/billing",children:a.jsx(yn,{children:a.jsx($T,{})})}),a.jsx(gt,{path:"/settings",children:a.jsx(yn,{children:a.jsx(FT,{})})}),a.jsx(gt,{path:"/admin/analytics",children:a.jsx(yn,{children:a.jsx(DT,{})})}),a.jsx(gt,{children:a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-4xl font-bold text-foreground mb-4",children:"404"}),a.jsx("p",{className:"text-muted-foreground",children:"Page not found"})]})})})]})})})}Oy(document.getElementById("root")).render(a.jsx(R.StrictMode,{children:a.jsx(zT,{})}));
